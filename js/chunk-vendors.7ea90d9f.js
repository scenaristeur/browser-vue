(self["webpackChunkexample_browser_vue_3"]=self["webpackChunkexample_browser_vue_3"]||[]).push([[998],{9824:function(e,t){"use strict";const r=-8,n=-4,i=0,s=1,o=1,a=2,c=5,l=1024,u=2048,h=8192,d=0,f=4,p=8,y=12,g=12,m=16,w="undefined"!==typeof BigUint64Array,b=Symbol(),v=1024;function E(e,t){const r=new Uint32Array(e),i=new Uint16Array(e);var s=r[t+n>>>2]>>>1,o=t>>>1;if(s<=v)return String.fromCharCode.apply(String,i.subarray(o,o+s));const a=[];do{const e=i[o+v-1],t=e>=55296&&e<56320?v-1:v;a.push(String.fromCharCode.apply(String,i.subarray(o,o+=t))),s-=t}while(s>v);return a.join("")+String.fromCharCode.apply(String,i.subarray(o,o+s))}function _(e){const t={};function r(e,t){return e?E(e.buffer,t):"<yet unknown>"}const n=e.env=e.env||{};return n.abort=n.abort||function(e,i,s,o){const a=t.memory||n.memory;throw Error("abort: "+r(a,e)+" at "+r(a,i)+":"+s+":"+o)},n.trace=n.trace||function(e,i){const s=t.memory||n.memory;console.log("trace: "+r(s,e)+(i?" ":"")+Array.prototype.slice.call(arguments,2,2+i).join(", "))},e.Math=e.Math||Math,e.Date=e.Date||Date,t}function S(e,t){const b=t.exports,v=b.memory,_=b.table,S=b["__alloc"],A=b["__retain"],I=b["__rtti_base"]||-1;function C(e){const t=new Uint32Array(v.buffer),r=t[I>>>2];if((e>>>=0)>=r)throw Error("invalid id: "+e);return t[(I+4>>>2)+2*e]}function k(e){const t=new Uint32Array(v.buffer),r=t[I>>>2];if((e>>>=0)>=r)throw Error("invalid id: "+e);return t[(I+4>>>2)+2*e+1]}function R(e){return 31-Math.clz32(e>>>c&31)}function P(e){const t=e.length,r=S(t<<1,s),n=new Uint16Array(v.buffer);for(var i=0,o=r>>>1;i<t;++i)n[o+i]=e.charCodeAt(i);return r}function x(e){const t=v.buffer,n=new Uint32Array(t)[e+r>>>2];if(n!==s)throw Error("not a string: "+e);return E(t,e)}function D(e,t,r){const n=v.buffer;if(r)switch(e){case 2:return new Float32Array(n);case 3:return new Float64Array(n)}else switch(e){case 0:return new(t?Int8Array:Uint8Array)(n);case 1:return new(t?Int16Array:Uint16Array)(n);case 2:return new(t?Int32Array:Uint32Array)(n);case 3:return new(t?BigInt64Array:BigUint64Array)(n)}throw Error("unsupported align: "+e)}function O(e,t){const r=C(e);if(!(r&(o|a)))throw Error("not an array: "+e+" @ "+r);const n=R(r),s=t.length,c=S(s<<n,i),w=S(r&a?m:y,e),b=new Uint32Array(v.buffer);b[w+d>>>2]=A(c),b[w+f>>>2]=c,b[w+p>>>2]=s<<n,r&a&&(b[w+g>>>2]=s);const E=D(n,r&l,r&u);if(r&h)for(let i=0;i<s;++i)E[(c>>>n)+i]=A(t[i]);else E.set(t,c>>>n);return w}function N(e){const t=new Uint32Array(v.buffer),i=t[e+r>>>2],s=C(i);if(!(s&o))throw Error("not an array: "+i);const c=R(s);var h=t[e+f>>>2];const d=s&a?t[e+g>>>2]:t[h+n>>>2]>>>c;return D(c,s&l,s&u).subarray(h>>>=c,h+d)}function L(e){const t=N(e),r=t.length,n=new Array(r);for(let i=0;i<r;i++)n[i]=t[i];return n}function B(e){const t=v.buffer,r=new Uint32Array(t)[e+n>>>2];return t.slice(e,e+r)}function U(e,t,r){return new e(M(e,t,r))}function M(e,t,r){const i=v.buffer,s=new Uint32Array(i),o=s[r+f>>>2];return new e(i,o,s[o+n>>>2]>>>t)}function j(e,t){const n=new Uint32Array(v.buffer);var i=n[e+r>>>2];if(i<=n[I>>>2])do{if(i==t)return!0}while(i=k(i));return!1}return e.__allocString=P,e.__getString=x,e.__allocArray=O,e.__getArrayView=N,e.__getArray=L,e.__getArrayBuffer=B,e.__getInt8Array=U.bind(null,Int8Array,0),e.__getInt8ArrayView=M.bind(null,Int8Array,0),e.__getUint8Array=U.bind(null,Uint8Array,0),e.__getUint8ArrayView=M.bind(null,Uint8Array,0),e.__getUint8ClampedArray=U.bind(null,Uint8ClampedArray,0),e.__getUint8ClampedArrayView=M.bind(null,Uint8ClampedArray,0),e.__getInt16Array=U.bind(null,Int16Array,1),e.__getInt16ArrayView=M.bind(null,Int16Array,1),e.__getUint16Array=U.bind(null,Uint16Array,1),e.__getUint16ArrayView=M.bind(null,Uint16Array,1),e.__getInt32Array=U.bind(null,Int32Array,2),e.__getInt32ArrayView=M.bind(null,Int32Array,2),e.__getUint32Array=U.bind(null,Uint32Array,2),e.__getUint32ArrayView=M.bind(null,Uint32Array,2),w&&(e.__getInt64Array=U.bind(null,BigInt64Array,3),e.__getInt64ArrayView=M.bind(null,BigInt64Array,3),e.__getUint64Array=U.bind(null,BigUint64Array,3),e.__getUint64ArrayView=M.bind(null,BigUint64Array,3)),e.__getFloat32Array=U.bind(null,Float32Array,2),e.__getFloat32ArrayView=M.bind(null,Float32Array,2),e.__getFloat64Array=U.bind(null,Float64Array,3),e.__getFloat64ArrayView=M.bind(null,Float64Array,3),e.__instanceof=j,e.memory=e.memory||v,e.table=e.table||_,T(b,e)}function A(e){return"undefined"!==typeof Response&&e instanceof Response}async function I(e,t){return A(e=await e)?k(e,t):S(_(t||(t={})),await WebAssembly.instantiate(e instanceof WebAssembly.Module?e:await WebAssembly.compile(e),t))}function C(e,t){return S(_(t||(t={})),new WebAssembly.Instance(e instanceof WebAssembly.Module?e:new WebAssembly.Module(e),t))}async function k(e,t){return WebAssembly.instantiateStreaming?S(_(t||(t={})),(await WebAssembly.instantiateStreaming(e,t)).instance):I(A(e=await e)?e.arrayBuffer():e,t)}function T(e,t){var r=t?Object.create(t):{},n=e["__argumentsLength"]?function(t){e["__argumentsLength"].value=t}:e["__setArgumentsLength"]||e["__setargc"]||function(){};for(let i in e){if(!Object.prototype.hasOwnProperty.call(e,i))continue;const t=e[i];let s=i.split("."),o=r;while(s.length>1){let e=s.shift();Object.prototype.hasOwnProperty.call(o,e)||(o[e]={}),o=o[e]}let a=s[0],c=a.indexOf("#");if(c>=0){let r=a.substring(0,c),s=o[r];if("undefined"===typeof s||!s.prototype){let e=function(...t){return e.wrap(e.prototype.constructor(0,...t))};e.prototype={valueOf:function(){return this[b]}},e.wrap=function(t){return Object.create(e.prototype,{[b]:{value:t,writable:!1}})},s&&Object.getOwnPropertyNames(s).forEach((t=>Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t)))),o[r]=e}if(a=a.substring(c+1),o=o[r].prototype,/^(get|set):/.test(a)){if(!Object.prototype.hasOwnProperty.call(o,a=a.substring(4))){let t=e[i.replace("set:","get:")],r=e[i.replace("get:","set:")];Object.defineProperty(o,a,{get:function(){return t(this[b])},set:function(e){r(this[b],e)},enumerable:!0})}}else"constructor"===a?(o[a]=(...e)=>(n(e.length),t(...e))).original=t:(o[a]=function(...e){return n(e.length),t(this[b],...e)}).original=t}else/^(get|set):/.test(a)?Object.prototype.hasOwnProperty.call(o,a=a.substring(4))||Object.defineProperty(o,a,{get:e[i.replace("set:","get:")],set:e[i.replace("get:","set:")],enumerable:!0}):"function"===typeof t&&t!==n?(o[a]=(...e)=>(n(e.length),t(...e))).original=t:o[a]=t}return r}t.instantiate=I,t.instantiateSync=C,t.instantiateStreaming=k,t.demangle=T},2450:function(e,t,r){"use strict";e.exports=r(77)},77:function(e,t,r){"use strict";var n=t;function i(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(8482),n.BufferWriter=r(5628),n.Reader=r(9958),n.BufferReader=r(3055),n.util=r(1436),n.rpc=r(3971),n.roots=r(9149),n.configure=i,i()},9958:function(e,t,r){"use strict";e.exports=c;var n,i=r(1436),s=i.LongBits,o=i.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var l="undefined"!==typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},u=function(){return i.Buffer?function(e){return(c.create=function(e){return i.Buffer.isBuffer(e)?new n(e):l(e)})(e)}:l};function h(){var e=new s(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new s(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}c.create=u(),c.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,c.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return e}}(),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return d(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|d(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},c.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},c.prototype.skip=function(e){if("number"===typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:while(4!==(e=7&this.uint32()))this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){n=e,c.create=u(),n._configure();var t=i.Long?"toLong":"toNumber";i.merge(c.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},3055:function(e,t,r){"use strict";e.exports=s;var n=r(9958);(s.prototype=Object.create(n.prototype)).constructor=s;var i=r(1436);function s(e){n.call(this,e)}s._configure=function(){i.Buffer&&(s.prototype._slice=i.Buffer.prototype.slice)},s.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},s._configure()},9149:function(e){"use strict";e.exports={}},3971:function(e,t,r){"use strict";var n=t;n.Service=r(8295)},8295:function(e,t,r){"use strict";e.exports=i;var n=r(1436);function i(e,t,r){if("function"!==typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(i.prototype=Object.create(n.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,r,i,s,o){if(!s)throw TypeError("request must be specified");var a=this;if(!o)return n.asPromise(e,a,t,r,i,s);if(a.rpcImpl)try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](s).finish(),(function(e,r){if(e)return a.emit("error",e,t),o(e);if(null!==r){if(!(r instanceof i))try{r=i[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",r,t),o(null,r)}a.end(!0)}))}catch(c){return a.emit("error",c,t),void setTimeout((function(){o(c)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},9961:function(e,t,r){"use strict";e.exports=i;var n=r(1436);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var s=i.zero=new i(0,0);s.toNumber=function(){return 0},s.zzEncode=s.zzDecode=function(){return this},s.length=function(){return 1};var o=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return s;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new i(r,n)},i.from=function(e){if("number"===typeof e)return i.fromNumber(e);if(n.isString(e)){if(!n.Long)return i.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):s},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;i.fromHash=function(e){return e===o?s:new i((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},1436:function(e,t,r){"use strict";var n=t;function i(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)void 0!==e[n[i]]&&r||(e[n[i]]=t[n[i]]);return e}function s(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&i(this,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}n.asPromise=r(4537),n.base64=r(7419),n.EventEmitter=r(9211),n.float=r(945),n.inquire=r(7199),n.utf8=r(4997),n.pool=r(6662),n.LongBits=r(9961),n.isNode=Boolean("undefined"!==typeof r.g&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),n.global=n.isNode&&r.g||"undefined"!==typeof window&&window||"undefined"!==typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"===typeof e||e instanceof String},n.isObject=function(e){return e&&"object"===typeof e},n.isset=n.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!==typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(t){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"===typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"===typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!==typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=i,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=s,n.ProtocolError=s("ProtocolError"),n.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},n.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},8482:function(e,t,r){"use strict";e.exports=h;var n,i=r(1436),s=i.LongBits,o=i.base64,a=i.utf8;function c(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function l(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}var d=function(){return i.Buffer?function(){return(h.create=function(){return new n})()}:function(){return new h}};function f(e,t,r){t[r]=255&e}function p(e,t,r){while(e>127)t[r++]=127&e|128,e>>>=7;t[r]=e}function y(e,t){this.len=e,this.next=void 0,this.val=t}function g(e,t,r){while(e.hi)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;while(e.lo>127)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function m(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}h.create=d(),h.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(h.alloc=i.pool(h.alloc,i.Array.prototype.subarray)),h.prototype._push=function(e,t,r){return this.tail=this.tail.next=new c(e,t,r),this.len+=t,this},y.prototype=Object.create(c.prototype),y.prototype.fn=p,h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new y((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(g,10,s.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=s.from(e);return this._push(g,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=s.from(e).zzEncode();return this._push(g,t.length(),t)},h.prototype.bool=function(e){return this._push(f,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(m,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=s.from(e);return this._push(m,4,t.lo)._push(m,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var w=i.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(i.isString(e)){var r=h.alloc(t=o.length(e));o.decode(e,r,0),e=r}return this.uint32(t)._push(w,t,e)},h.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},h.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new c(l,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},h.prototype.finish=function(){var e=this.head.next,t=this.constructor.alloc(this.len),r=0;while(e)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},h._configure=function(e){n=e,h.create=d(),n._configure()}},5628:function(e,t,r){"use strict";e.exports=s;var n=r(8482);(s.prototype=Object.create(n.prototype)).constructor=s;var i=r(1436);function s(){n.call(this)}function o(e,t,r){e.length<40?i.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}s._configure=function(){s.alloc=i._Buffer_allocUnsafe,s.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},s.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(s.writeBytesBuffer,t,e),this},s.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},s._configure()},4537:function(e){"use strict";function t(e,t){var r=new Array(arguments.length-1),n=0,i=2,s=!0;while(i<arguments.length)r[n++]=arguments[i++];return new Promise((function(i,o){r[n]=function(e){if(s)if(s=!1,e)o(e);else{var t=new Array(arguments.length-1),r=0;while(r<t.length)t[r++]=arguments[r];i.apply(null,t)}};try{e.apply(t||null,r)}catch(a){s&&(s=!1,o(a))}}))}e.exports=t},7419:function(e,t){"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;var r=0;while(--t%4>1&&"="===e.charAt(t))++r;return Math.ceil(3*e.length)/4-r};for(var n=new Array(64),i=new Array(123),s=0;s<64;)i[n[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;r.encode=function(e,t,r){var i,s=null,o=[],a=0,c=0;while(t<r){var l=e[t++];switch(c){case 0:o[a++]=n[l>>2],i=(3&l)<<4,c=1;break;case 1:o[a++]=n[i|l>>4],i=(15&l)<<2,c=2;break;case 2:o[a++]=n[i|l>>6],o[a++]=n[63&l],c=0;break}a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0)}return c&&(o[a++]=n[i],o[a++]=61,1===c&&(o[a++]=61)),s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};var o="invalid encoding";r.decode=function(e,t,r){for(var n,s=r,a=0,c=0;c<e.length;){var l=e.charCodeAt(c++);if(61===l&&a>1)break;if(void 0===(l=i[l]))throw Error(o);switch(a){case 0:n=l,a=1;break;case 1:t[r++]=n<<2|(48&l)>>4,n=l,a=2;break;case 2:t[r++]=(15&n)<<4|(60&l)>>2,n=l,a=3;break;case 3:t[r++]=(3&n)<<6|l,a=0;break}}if(1===a)throw Error(o);return r-s},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},5124:function(e){"use strict";function t(e,r){"string"===typeof e&&(r=e,e=void 0);var n=[];function i(e){if("string"!==typeof e){var r=s();if(t.verbose&&console.log("codegen: "+r),r="return "+r,e){var o=Object.keys(e),a=new Array(o.length+1),c=new Array(o.length),l=0;while(l<o.length)a[l]=o[l],c[l]=e[o[l++]];return a[l]=r,Function.apply(null,a).apply(null,c)}return Function(r)()}var u=new Array(arguments.length-1),h=0;while(h<u.length)u[h]=arguments[++h];if(h=0,e=e.replace(/%([%dfijs])/g,(function(e,t){var r=u[h++];switch(t){case"d":case"f":return String(Number(r));case"i":return String(Math.floor(r));case"j":return JSON.stringify(r);case"s":return String(r)}return"%"})),h!==u.length)throw Error("parameter count mismatch");return n.push(e),i}function s(t){return"function "+(t||r||"")+"("+(e&&e.join(",")||"")+"){\n  "+n.join("\n  ")+"\n}"}return i.toString=s,i}e.exports=t,t.verbose=!1},9211:function(e){"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}},9054:function(e,t,r){"use strict";e.exports=o;var n=r(4537),i=r(7199),s=i("fs");function o(e,t,r){return"function"===typeof t?(r=t,t={}):t||(t={}),r?!t.xhr&&s&&s.readFile?s.readFile(e,(function(n,i){return n&&"undefined"!==typeof XMLHttpRequest?o.xhr(e,t,r):n?r(n):r(null,t.binary?i:i.toString("utf8"))})):o.xhr(e,t,r):n(o,this,e,t)}o.xhr=function(e,t,r){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState){if(0!==n.status&&200!==n.status)return r(Error("status "+n.status));if(t.binary){var e=n.response;if(!e){e=[];for(var i=0;i<n.responseText.length;++i)e.push(255&n.responseText.charCodeAt(i))}return r(null,"undefined"!==typeof Uint8Array?new Uint8Array(e):e)}return r(null,n.responseText)}},t.binary&&("overrideMimeType"in n&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.responseType="arraybuffer"),n.open("GET",e),n.send()}},945:function(e){"use strict";function t(e){return"undefined"!==typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3]}function s(e,n,i){t[0]=e,n[i]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0]}function o(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function a(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?i:s,e.writeFloatBE=n?s:i,e.readFloatLE=n?o:a,e.readFloatBE=n?a:o}():function(){function t(e,t,r,n){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var s=Math.floor(Math.log(t)/Math.LN2),o=8388607&Math.round(t*Math.pow(2,-s)*8388608);e((i<<31|s+127<<23|o)>>>0,r,n)}}function o(e,t,r){var n=e(t,r),i=2*(n>>31)+1,s=n>>>23&255,o=8388607&n;return 255===s?o?NaN:i*(1/0):0===s?1401298464324817e-60*i*o:i*Math.pow(2,s-150)*(o+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,n),e.readFloatLE=o.bind(null,i),e.readFloatBE=o.bind(null,s)}(),"undefined"!==typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3],n[i+4]=r[4],n[i+5]=r[5],n[i+6]=r[6],n[i+7]=r[7]}function s(e,n,i){t[0]=e,n[i]=r[7],n[i+1]=r[6],n[i+2]=r[5],n[i+3]=r[4],n[i+4]=r[3],n[i+5]=r[2],n[i+6]=r[1],n[i+7]=r[0]}function o(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function a(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?i:s,e.writeDoubleBE=n?s:i,e.readDoubleLE=n?o:a,e.readDoubleBE=n?a:o}():function(){function t(e,t,r,n,i,s){var o=n<0?1:0;if(o&&(n=-n),0===n)e(0,i,s+t),e(1/n>0?0:2147483648,i,s+r);else if(isNaN(n))e(0,i,s+t),e(2146959360,i,s+r);else if(n>17976931348623157e292)e(0,i,s+t),e((o<<31|2146435072)>>>0,i,s+r);else{var a;if(n<22250738585072014e-324)a=n/5e-324,e(a>>>0,i,s+t),e((o<<31|a/4294967296)>>>0,i,s+r);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),a=n*Math.pow(2,-c),e(4503599627370496*a>>>0,i,s+t),e((o<<31|c+1023<<20|1048576*a&1048575)>>>0,i,s+r)}}}function o(e,t,r,n,i){var s=e(n,i+t),o=e(n,i+r),a=2*(o>>31)+1,c=o>>>20&2047,l=4294967296*(1048575&o)+s;return 2047===c?l?NaN:a*(1/0):0===c?5e-324*a*l:a*Math.pow(2,c-1075)*(l+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,n,4,0),e.readDoubleLE=o.bind(null,i,0,4),e.readDoubleBE=o.bind(null,s,4,0)}(),e}function r(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function n(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},7199:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},8626:function(e,t){"use strict";var r=t,n=r.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},i=r.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var t=e.split("/"),r=n(e),i="";r&&(i=t.shift()+"/");for(var s=0;s<t.length;)".."===t[s]?s>0&&".."!==t[s-1]?t.splice(--s,2):r?t.splice(s,1):++s:"."===t[s]?t.splice(s,1):++s;return i+t.join("/")};r.resolve=function(e,t,r){return r||(t=i(t)),n(t)?t:(r||(e=i(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?i(e+"/"+t):t)}},6662:function(e){"use strict";function t(e,t,r){var n=r||8192,i=n>>>1,s=null,o=n;return function(r){if(r<1||r>i)return e(r);o+r>n&&(s=e(n),o=0);var a=t.call(s,o,o+=r);return 7&o&&(o=1+(7|o)),a}}e.exports=t},4997:function(e,t){"use strict";var r=t;r.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)r=e.charCodeAt(n),r<128?t+=1:r<2048?t+=2:55296===(64512&r)&&56320===(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},r.read=function(e,t,r){var n=r-t;if(n<1)return"";var i,s=null,o=[],a=0;while(t<r)i=e[t++],i<128?o[a++]=i:i>191&&i<224?o[a++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(i>>10),o[a++]=56320+(1023&i)):o[a++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))},r.write=function(e,t,r){for(var n,i,s=r,o=0;o<e.length;++o)n=e.charCodeAt(o),n<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296===(64512&n)&&56320===(64512&(i=e.charCodeAt(o+1)))?(n=65536+((1023&n)<<10)+(1023&i),++o,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-s}},8099:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7117);function i(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}function s(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])>>>0}function o(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])<<16>>16}function a(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])>>>0}function c(e,t,r){return void 0===t&&(t=new Uint8Array(2)),void 0===r&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}function l(e,t,r){return void 0===t&&(t=new Uint8Array(2)),void 0===r&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}function u(e,t){return void 0===t&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function h(e,t){return void 0===t&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function d(e,t){return void 0===t&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function f(e,t){return void 0===t&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}function p(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}function y(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}function g(e,t){void 0===t&&(t=0);var r=u(e,t),n=u(e,t+4);return 4294967296*r+n-4294967296*(n>>31)}function m(e,t){void 0===t&&(t=0);var r=h(e,t),n=h(e,t+4);return 4294967296*r+n}function w(e,t){void 0===t&&(t=0);var r=d(e,t),n=d(e,t+4);return 4294967296*n+r-4294967296*(r>>31)}function b(e,t){void 0===t&&(t=0);var r=f(e,t),n=f(e,t+4);return 4294967296*n+r}function v(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),p(e/4294967296>>>0,t,r),p(e>>>0,t,r+4),t}function E(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),y(e>>>0,t,r),y(e/4294967296>>>0,t,r+4),t}function _(e,t,r){if(void 0===r&&(r=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=e/8+r-1;s>=r;s--)n+=t[s]*i,i*=256;return n}function S(e,t,r){if(void 0===r&&(r=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+e/8;s++)n+=t[s]*i,i*=256;return n}function A(e,t,r,i){if(void 0===r&&(r=new Uint8Array(e/8)),void 0===i&&(i=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!n.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var s=1,o=e/8+i-1;o>=i;o--)r[o]=t/s&255,s*=256;return r}function I(e,t,r,i){if(void 0===r&&(r=new Uint8Array(e/8)),void 0===i&&(i=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!n.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var s=1,o=i;o<i+e/8;o++)r[o]=t/s&255,s*=256;return r}function C(e,t){void 0===t&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t)}function k(e,t){void 0===t&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t,!0)}function T(e,t){void 0===t&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t)}function R(e,t){void 0===t&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t,!0)}function P(e,t,r){void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e),t}function x(e,t,r){void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e,!0),t}function D(e,t,r){void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e),t}function O(e,t,r){void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e,!0),t}t.readInt16BE=i,t.readUint16BE=s,t.readInt16LE=o,t.readUint16LE=a,t.writeUint16BE=c,t.writeInt16BE=c,t.writeUint16LE=l,t.writeInt16LE=l,t.readInt32BE=u,t.readUint32BE=h,t.readInt32LE=d,t.readUint32LE=f,t.writeUint32BE=p,t.writeInt32BE=p,t.writeUint32LE=y,t.writeInt32LE=y,t.readInt64BE=g,t.readUint64BE=m,t.readInt64LE=w,t.readUint64LE=b,t.writeUint64BE=v,t.writeInt64BE=v,t.writeUint64LE=E,t.writeInt64LE=E,t.readUintBE=_,t.readUintLE=S,t.writeUintBE=A,t.writeUintLE=I,t.readFloat32BE=C,t.readFloat32LE=k,t.readFloat64BE=T,t.readFloat64LE=R,t.writeFloat32BE=P,t.writeFloat32LE=x,t.writeFloat64BE=D,t.writeFloat64LE=O},5439:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8099),i=r(7309),s=20;function o(e,t,r){for(var i=1634760805,o=857760878,a=2036477234,c=1797285236,l=r[3]<<24|r[2]<<16|r[1]<<8|r[0],u=r[7]<<24|r[6]<<16|r[5]<<8|r[4],h=r[11]<<24|r[10]<<16|r[9]<<8|r[8],d=r[15]<<24|r[14]<<16|r[13]<<8|r[12],f=r[19]<<24|r[18]<<16|r[17]<<8|r[16],p=r[23]<<24|r[22]<<16|r[21]<<8|r[20],y=r[27]<<24|r[26]<<16|r[25]<<8|r[24],g=r[31]<<24|r[30]<<16|r[29]<<8|r[28],m=t[3]<<24|t[2]<<16|t[1]<<8|t[0],w=t[7]<<24|t[6]<<16|t[5]<<8|t[4],b=t[11]<<24|t[10]<<16|t[9]<<8|t[8],v=t[15]<<24|t[14]<<16|t[13]<<8|t[12],E=i,_=o,S=a,A=c,I=l,C=u,k=h,T=d,R=f,P=p,x=y,D=g,O=m,N=w,L=b,B=v,U=0;U<s;U+=2)E=E+I|0,O^=E,O=O>>>16|O<<16,R=R+O|0,I^=R,I=I>>>20|I<<12,_=_+C|0,N^=_,N=N>>>16|N<<16,P=P+N|0,C^=P,C=C>>>20|C<<12,S=S+k|0,L^=S,L=L>>>16|L<<16,x=x+L|0,k^=x,k=k>>>20|k<<12,A=A+T|0,B^=A,B=B>>>16|B<<16,D=D+B|0,T^=D,T=T>>>20|T<<12,S=S+k|0,L^=S,L=L>>>24|L<<8,x=x+L|0,k^=x,k=k>>>25|k<<7,A=A+T|0,B^=A,B=B>>>24|B<<8,D=D+B|0,T^=D,T=T>>>25|T<<7,_=_+C|0,N^=_,N=N>>>24|N<<8,P=P+N|0,C^=P,C=C>>>25|C<<7,E=E+I|0,O^=E,O=O>>>24|O<<8,R=R+O|0,I^=R,I=I>>>25|I<<7,E=E+C|0,B^=E,B=B>>>16|B<<16,x=x+B|0,C^=x,C=C>>>20|C<<12,_=_+k|0,O^=_,O=O>>>16|O<<16,D=D+O|0,k^=D,k=k>>>20|k<<12,S=S+T|0,N^=S,N=N>>>16|N<<16,R=R+N|0,T^=R,T=T>>>20|T<<12,A=A+I|0,L^=A,L=L>>>16|L<<16,P=P+L|0,I^=P,I=I>>>20|I<<12,S=S+T|0,N^=S,N=N>>>24|N<<8,R=R+N|0,T^=R,T=T>>>25|T<<7,A=A+I|0,L^=A,L=L>>>24|L<<8,P=P+L|0,I^=P,I=I>>>25|I<<7,_=_+k|0,O^=_,O=O>>>24|O<<8,D=D+O|0,k^=D,k=k>>>25|k<<7,E=E+C|0,B^=E,B=B>>>24|B<<8,x=x+B|0,C^=x,C=C>>>25|C<<7;n.writeUint32LE(E+i|0,e,0),n.writeUint32LE(_+o|0,e,4),n.writeUint32LE(S+a|0,e,8),n.writeUint32LE(A+c|0,e,12),n.writeUint32LE(I+l|0,e,16),n.writeUint32LE(C+u|0,e,20),n.writeUint32LE(k+h|0,e,24),n.writeUint32LE(T+d|0,e,28),n.writeUint32LE(R+f|0,e,32),n.writeUint32LE(P+p|0,e,36),n.writeUint32LE(x+y|0,e,40),n.writeUint32LE(D+g|0,e,44),n.writeUint32LE(O+m|0,e,48),n.writeUint32LE(N+w|0,e,52),n.writeUint32LE(L+b|0,e,56),n.writeUint32LE(B+v|0,e,60)}function a(e,t,r,n,s){if(void 0===s&&(s=0),32!==e.length)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var a,c;if(0===s){if(8!==t.length&&12!==t.length)throw new Error("ChaCha nonce must be 8 or 12 bytes");a=new Uint8Array(16),c=a.length-t.length,a.set(t,c)}else{if(16!==t.length)throw new Error("ChaCha nonce with counter must be 16 bytes");a=t,c=s}for(var u=new Uint8Array(64),h=0;h<r.length;h+=64){o(u,a,e);for(var d=h;d<h+64&&d<r.length;d++)n[d]=r[d]^u[d-h];l(a,0,c)}return i.wipe(u),0===s&&i.wipe(a),n}function c(e,t,r,n){return void 0===n&&(n=0),i.wipe(r),a(e,t,r,r,n)}function l(e,t,r){var n=1;while(r--)n=n+(255&e[t])|0,e[t]=255&n,n>>>=8,t++;if(n>0)throw new Error("ChaCha: counter overflow")}t.streamXOR=a,t.stream=c},5501:function(e,t,r){"use strict";var n=r(5439),i=r(3027),s=r(7309),o=r(8099),a=r(4153);t.Cv=32,t.WH=12,t.pg=16;var c=new Uint8Array(16),l=function(){function e(e){if(this.nonceLength=t.WH,this.tagLength=t.pg,e.length!==t.Cv)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return e.prototype.seal=function(e,t,r,i){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var o=new Uint8Array(16);o.set(e,o.length-e.length);var a=new Uint8Array(32);n.stream(this._key,o,a,4);var c,l=t.length+this.tagLength;if(i){if(i.length!==l)throw new Error("ChaCha20Poly1305: incorrect destination length");c=i}else c=new Uint8Array(l);return n.streamXOR(this._key,o,t,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),a,c.subarray(0,c.length-this.tagLength),r),s.wipe(o),c},e.prototype.open=function(e,t,r,i){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(t.length<this.tagLength)return null;var o=new Uint8Array(16);o.set(e,o.length-e.length);var c=new Uint8Array(32);n.stream(this._key,o,c,4);var l=new Uint8Array(this.tagLength);if(this._authenticate(l,c,t.subarray(0,t.length-this.tagLength),r),!a.equal(l,t.subarray(t.length-this.tagLength,t.length)))return null;var u,h=t.length-this.tagLength;if(i){if(i.length!==h)throw new Error("ChaCha20Poly1305: incorrect destination length");u=i}else u=new Uint8Array(h);return n.streamXOR(this._key,o,t.subarray(0,t.length-this.tagLength),u,4),s.wipe(o),u},e.prototype.clean=function(){return s.wipe(this._key),this},e.prototype._authenticate=function(e,t,r,n){var a=new i.Poly1305(t);n&&(a.update(n),n.length%16>0&&a.update(c.subarray(n.length%16))),a.update(r),r.length%16>0&&a.update(c.subarray(r.length%16));var l=new Uint8Array(8);n&&o.writeUint64LE(n.length,l),a.update(l),o.writeUint64LE(r.length,l),a.update(l);for(var u=a.digest(),h=0;h<u.length;h++)e[h]=u[h];a.clean(),s.wipe(u),s.wipe(l)},e}();t.OK=l},4153:function(e,t){"use strict";function r(e,t,r){return~(e-1)&t|e-1&r}function n(e,t){return(0|e)-(0|t)-1>>>31&1}function i(e,t){if(e.length!==t.length)return 0;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 1&r-1>>>8}function s(e,t){return 0!==e.length&&0!==t.length&&0!==i(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.select=r,t.lessOrEqual=n,t.compare=i,t.equal=s},9984:function(e,t){"use strict";function r(e){return"undefined"!==typeof e.saveState&&"undefined"!==typeof e.restoreState&&"undefined"!==typeof e.cleanSavedState}Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializableHash=r},512:function(e,t,r){"use strict";var n=r(5629),i=r(7309),s=function(){function e(e,t,r,i){void 0===r&&(r=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var s=n.hmac(this._hash,r,t);this._hmac=new n.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return e.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(0===e)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},e.prototype.expand=function(e){for(var t=new Uint8Array(e),r=0;r<t.length;r++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[r]=this._buffer[this._bufpos++];return t},e.prototype.clean=function(){this._hmac.clean(),i.wipe(this._buffer),i.wipe(this._counter),this._bufpos=0},e}();t.t=s},5629:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9984),i=r(4153),s=r(7309),o=function(){function e(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var r=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(r).clean():r.set(t);for(var i=0;i<r.length;i++)r[i]^=54;this._inner.update(r);for(i=0;i<r.length;i++)r[i]^=106;this._outer.update(r),n.isSerializableHash(this._inner)&&n.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),s.wipe(r)}return e.prototype.reset=function(){if(!n.isSerializableHash(this._inner)||!n.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.clean=function(){n.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),n.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},e.prototype.update=function(e){return this._inner.update(e),this},e.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(!n.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},e.prototype.restoreState=function(e){if(!n.isSerializableHash(this._inner)||!n.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.cleanSavedState=function(e){if(!n.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},e}();function a(e,t,r){var n=new o(e,t);n.update(r);var i=n.digest();return n.clean(),i}t.HMAC=o,t.hmac=a,t.equal=i.equal},7117:function(e,t){"use strict";function r(e,t){var r=e>>>16&65535,n=65535&e,i=t>>>16&65535,s=65535&t;return n*s+(r*s+n*i<<16>>>0)|0}function n(e,t){return e+t|0}function i(e,t){return e-t|0}function s(e,t){return e<<t|e>>>32-t}function o(e,t){return e<<32-t|e>>>t}function a(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e}Object.defineProperty(t,"__esModule",{value:!0}),t.mul=Math.imul||r,t.add=n,t.sub=i,t.rotl=s,t.rotr=o,t.isInteger=Number.isInteger||a,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(e){return t.isInteger(e)&&e>=-t.MAX_SAFE_INTEGER&&e<=t.MAX_SAFE_INTEGER}},3027:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4153),i=r(7309);t.DIGEST_LENGTH=16;var s=function(){function e(e){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=e[0]|e[1]<<8;this._r[0]=8191&r;var n=e[2]|e[3]<<8;this._r[1]=8191&(r>>>13|n<<3);var i=e[4]|e[5]<<8;this._r[2]=7939&(n>>>10|i<<6);var s=e[6]|e[7]<<8;this._r[3]=8191&(i>>>7|s<<9);var o=e[8]|e[9]<<8;this._r[4]=255&(s>>>4|o<<12),this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=8191&(o>>>14|a<<2);var c=e[12]|e[13]<<8;this._r[7]=8065&(a>>>11|c<<5);var l=e[14]|e[15]<<8;this._r[8]=8191&(c>>>8|l<<8),this._r[9]=l>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return e.prototype._blocks=function(e,t,r){var n=this._fin?0:2048,i=this._h[0],s=this._h[1],o=this._h[2],a=this._h[3],c=this._h[4],l=this._h[5],u=this._h[6],h=this._h[7],d=this._h[8],f=this._h[9],p=this._r[0],y=this._r[1],g=this._r[2],m=this._r[3],w=this._r[4],b=this._r[5],v=this._r[6],E=this._r[7],_=this._r[8],S=this._r[9];while(r>=16){var A=e[t+0]|e[t+1]<<8;i+=8191&A;var I=e[t+2]|e[t+3]<<8;s+=8191&(A>>>13|I<<3);var C=e[t+4]|e[t+5]<<8;o+=8191&(I>>>10|C<<6);var k=e[t+6]|e[t+7]<<8;a+=8191&(C>>>7|k<<9);var T=e[t+8]|e[t+9]<<8;c+=8191&(k>>>4|T<<12),l+=T>>>1&8191;var R=e[t+10]|e[t+11]<<8;u+=8191&(T>>>14|R<<2);var P=e[t+12]|e[t+13]<<8;h+=8191&(R>>>11|P<<5);var x=e[t+14]|e[t+15]<<8;d+=8191&(P>>>8|x<<8),f+=x>>>5|n;var D=0,O=D;O+=i*p,O+=s*(5*S),O+=o*(5*_),O+=a*(5*E),O+=c*(5*v),D=O>>>13,O&=8191,O+=l*(5*b),O+=u*(5*w),O+=h*(5*m),O+=d*(5*g),O+=f*(5*y),D+=O>>>13,O&=8191;var N=D;N+=i*y,N+=s*p,N+=o*(5*S),N+=a*(5*_),N+=c*(5*E),D=N>>>13,N&=8191,N+=l*(5*v),N+=u*(5*b),N+=h*(5*w),N+=d*(5*m),N+=f*(5*g),D+=N>>>13,N&=8191;var L=D;L+=i*g,L+=s*y,L+=o*p,L+=a*(5*S),L+=c*(5*_),D=L>>>13,L&=8191,L+=l*(5*E),L+=u*(5*v),L+=h*(5*b),L+=d*(5*w),L+=f*(5*m),D+=L>>>13,L&=8191;var B=D;B+=i*m,B+=s*g,B+=o*y,B+=a*p,B+=c*(5*S),D=B>>>13,B&=8191,B+=l*(5*_),B+=u*(5*E),B+=h*(5*v),B+=d*(5*b),B+=f*(5*w),D+=B>>>13,B&=8191;var U=D;U+=i*w,U+=s*m,U+=o*g,U+=a*y,U+=c*p,D=U>>>13,U&=8191,U+=l*(5*S),U+=u*(5*_),U+=h*(5*E),U+=d*(5*v),U+=f*(5*b),D+=U>>>13,U&=8191;var M=D;M+=i*b,M+=s*w,M+=o*m,M+=a*g,M+=c*y,D=M>>>13,M&=8191,M+=l*p,M+=u*(5*S),M+=h*(5*_),M+=d*(5*E),M+=f*(5*v),D+=M>>>13,M&=8191;var j=D;j+=i*v,j+=s*b,j+=o*w,j+=a*m,j+=c*g,D=j>>>13,j&=8191,j+=l*y,j+=u*p,j+=h*(5*S),j+=d*(5*_),j+=f*(5*E),D+=j>>>13,j&=8191;var V=D;V+=i*E,V+=s*v,V+=o*b,V+=a*w,V+=c*m,D=V>>>13,V&=8191,V+=l*g,V+=u*y,V+=h*p,V+=d*(5*S),V+=f*(5*_),D+=V>>>13,V&=8191;var z=D;z+=i*_,z+=s*E,z+=o*v,z+=a*b,z+=c*w,D=z>>>13,z&=8191,z+=l*m,z+=u*g,z+=h*y,z+=d*p,z+=f*(5*S),D+=z>>>13,z&=8191;var F=D;F+=i*S,F+=s*_,F+=o*E,F+=a*v,F+=c*b,D=F>>>13,F&=8191,F+=l*w,F+=u*m,F+=h*g,F+=d*y,F+=f*p,D+=F>>>13,F&=8191,D=(D<<2)+D|0,D=D+O|0,O=8191&D,D>>>=13,N+=D,i=O,s=N,o=L,a=B,c=U,l=M,u=j,h=V,d=z,f=F,t+=16,r-=16}this._h[0]=i,this._h[1]=s,this._h[2]=o,this._h[3]=a,this._h[4]=c,this._h[5]=l,this._h[6]=u,this._h[7]=h,this._h[8]=d,this._h[9]=f},e.prototype.finish=function(e,t){void 0===t&&(t=0);var r,n,i,s,o=new Uint16Array(10);if(this._leftover){for(s=this._leftover,this._buffer[s++]=1;s<16;s++)this._buffer[s]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(r=this._h[1]>>>13,this._h[1]&=8191,s=2;s<10;s++)this._h[s]+=r,r=this._h[s]>>>13,this._h[s]&=8191;for(this._h[0]+=5*r,r=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=r,r=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=r,o[0]=this._h[0]+5,r=o[0]>>>13,o[0]&=8191,s=1;s<10;s++)o[s]=this._h[s]+r,r=o[s]>>>13,o[s]&=8191;for(o[9]-=8192,n=(1^r)-1,s=0;s<10;s++)o[s]&=n;for(n=~n,s=0;s<10;s++)this._h[s]=this._h[s]&n|o[s];for(this._h[0]=65535&(this._h[0]|this._h[1]<<13),this._h[1]=65535&(this._h[1]>>>3|this._h[2]<<10),this._h[2]=65535&(this._h[2]>>>6|this._h[3]<<7),this._h[3]=65535&(this._h[3]>>>9|this._h[4]<<4),this._h[4]=65535&(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14),this._h[5]=65535&(this._h[6]>>>2|this._h[7]<<11),this._h[6]=65535&(this._h[7]>>>5|this._h[8]<<8),this._h[7]=65535&(this._h[8]>>>8|this._h[9]<<5),i=this._h[0]+this._pad[0],this._h[0]=65535&i,s=1;s<8;s++)i=(this._h[s]+this._pad[s]|0)+(i>>>16)|0,this._h[s]=65535&i;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},e.prototype.update=function(e){var t,r=0,n=e.length;if(this._leftover){t=16-this._leftover,t>n&&(t=n);for(var i=0;i<t;i++)this._buffer[this._leftover+i]=e[r+i];if(n-=t,r+=t,this._leftover+=t,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(n>=16&&(t=n-n%16,this._blocks(e,r,t),r+=t,n-=t),n){for(i=0;i<n;i++)this._buffer[this._leftover+i]=e[r+i];this._leftover+=n}return this},e.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},e.prototype.clean=function(){return i.wipe(this._buffer),i.wipe(this._r),i.wipe(this._h),i.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},e}();function o(e,t){var r=new s(e);r.update(t);var n=r.digest();return r.clean(),n}function a(e,r){return e.length===t.DIGEST_LENGTH&&r.length===t.DIGEST_LENGTH&&n.equal(e,r)}t.Poly1305=s,t.oneTimeAuth=o,t.equal=a},1416:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const n=r(6008),i=r(8099),s=r(7309);function o(e,r=t.defaultRandomSource){return r.randomBytes(e)}function a(e=t.defaultRandomSource){const r=o(4,e),n=(0,i.readUint32LE)(r);return(0,s.wipe)(r),n}t.defaultRandomSource=new n.SystemRandomSource,t.randomBytes=o,t.randomUint32=a;const c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function l(e,r=c,n=t.defaultRandomSource){if(r.length<2)throw new Error("randomString charset is too short");if(r.length>256)throw new Error("randomString charset is too long");let i="";const a=r.length,l=256-256%a;while(e>0){const t=o(Math.ceil(256*e/l),n);for(let n=0;n<t.length&&e>0;n++){const s=t[n];s<l&&(i+=r.charAt(s%a),e--)}(0,s.wipe)(t)}return i}function u(e,r=c,n=t.defaultRandomSource){const i=Math.ceil(e/(Math.log(r.length)/Math.LN2));return l(i,r,n)}t.randomString=l,t.randomStringForEntropy=u},5455:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserRandomSource=void 0;const r=65536;class n{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e="undefined"!==typeof self?self.crypto||self.msCrypto:null;e&&void 0!==e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let n=0;n<t.length;n+=r)this._crypto.getRandomValues(t.subarray(n,n+Math.min(t.length-n,r)));return t}}t.BrowserRandomSource=n},8871:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeRandomSource=void 0;const n=r(7309);class i{constructor(){this.isAvailable=!1,this.isInstantiated=!1;{const e=r(5883);e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const r=new Uint8Array(e);for(let n=0;n<r.length;n++)r[n]=t[n];return(0,n.wipe)(t),r}}t.NodeRandomSource=i},6008:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SystemRandomSource=void 0;const n=r(5455),i=r(8871);class s{constructor(){return this.isAvailable=!1,this.name="",this._source=new n.BrowserRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Browser")):(this._source=new i.NodeRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Node")):void 0)}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}t.SystemRandomSource=s},3989:function(e,t,r){"use strict";var n=r(8099),i=r(7309);t.k=32,t.cn=64;var s=function(){function e(){this.digestLength=t.k,this.blockSize=t.cn,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return e.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},e.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},e.prototype.clean=function(){i.wipe(this._buffer),i.wipe(this._temp),this.reset()},e.prototype.update=function(e,t){if(void 0===t&&(t=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var r=0;if(this._bytesHashed+=t,this._bufferLength>0){while(this._bufferLength<this.blockSize&&t>0)this._buffer[this._bufferLength++]=e[r++],t--;this._bufferLength===this.blockSize&&(a(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}t>=this.blockSize&&(r=a(this._temp,this._state,e,r,t),t%=this.blockSize);while(t>0)this._buffer[this._bufferLength++]=e[r++],t--;return this},e.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,r=this._bufferLength,i=t/536870912|0,s=t<<3,o=t%64<56?64:128;this._buffer[r]=128;for(var c=r+1;c<o-8;c++)this._buffer[c]=0;n.writeUint32BE(i,this._buffer,o-8),n.writeUint32BE(s,this._buffer,o-4),a(this._temp,this._state,this._buffer,0,o),this._finished=!0}for(c=0;c<this.digestLength/4;c++)n.writeUint32BE(this._state[c],e,4*c);return this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},e.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},e.prototype.cleanSavedState=function(e){i.wipe(e.state),e.buffer&&i.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},e}();t.mE=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function a(e,t,r,i,s){while(s>=64){for(var a=t[0],c=t[1],l=t[2],u=t[3],h=t[4],d=t[5],f=t[6],p=t[7],y=0;y<16;y++){var g=i+4*y;e[y]=n.readUint32BE(r,g)}for(y=16;y<64;y++){var m=e[y-2],w=(m>>>17|m<<15)^(m>>>19|m<<13)^m>>>10;m=e[y-15];var b=(m>>>7|m<<25)^(m>>>18|m<<14)^m>>>3;e[y]=(w+e[y-7]|0)+(b+e[y-16]|0)}for(y=0;y<64;y++){w=(((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&d^~h&f)|0)+(p+(o[y]+e[y]|0)|0)|0,b=((a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+(a&c^a&l^c&l)|0;p=f,f=d,d=h,h=u+w|0,u=l,l=c,c=a,a=w+b|0}t[0]+=a,t[1]+=c,t[2]+=l,t[3]+=u,t[4]+=h,t[5]+=d,t[6]+=f,t[7]+=p,i+=64,s-=64}return i}function c(e){var t=new s;t.update(e);var r=t.digest();return t.clean(),r}t.vp=c},7309:function(e,t){"use strict";function r(e){for(var t=0;t<e.length;t++)e[t]=0;return e}Object.defineProperty(t,"__esModule",{value:!0}),t.wipe=r},7664:function(e,t,r){"use strict";t.gi=t.Au=t._w=t.KS=t.kz=void 0;const n=r(1416),i=r(7309);function s(e){const t=new Float64Array(16);if(e)for(let r=0;r<e.length;r++)t[r]=e[r];return t}t.kz=32,t.KS=32;const o=new Uint8Array(32);o[0]=9;const a=s([56129,1]);function c(e){let t=1;for(let r=0;r<16;r++){let n=e[r]+t+65535;t=Math.floor(n/65536),e[r]=n-65536*t}e[0]+=t-1+37*(t-1)}function l(e,t,r){const n=~(r-1);for(let i=0;i<16;i++){const r=n&(e[i]^t[i]);e[i]^=r,t[i]^=r}}function u(e,t){const r=s(),n=s();for(let i=0;i<16;i++)n[i]=t[i];c(n),c(n),c(n);for(let i=0;i<2;i++){r[0]=n[0]-65517;for(let t=1;t<15;t++)r[t]=n[t]-65535-(r[t-1]>>16&1),r[t-1]&=65535;r[15]=n[15]-32767-(r[14]>>16&1);const e=r[15]>>16&1;r[14]&=65535,l(n,r,1-e)}for(let i=0;i<16;i++)e[2*i]=255&n[i],e[2*i+1]=n[i]>>8}function h(e,t){for(let r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function d(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]+r[n]}function f(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]-r[n]}function p(e,t,r){let n,i,s=0,o=0,a=0,c=0,l=0,u=0,h=0,d=0,f=0,p=0,y=0,g=0,m=0,w=0,b=0,v=0,E=0,_=0,S=0,A=0,I=0,C=0,k=0,T=0,R=0,P=0,x=0,D=0,O=0,N=0,L=0,B=r[0],U=r[1],M=r[2],j=r[3],V=r[4],z=r[5],F=r[6],$=r[7],K=r[8],q=r[9],H=r[10],G=r[11],W=r[12],Y=r[13],J=r[14],Q=r[15];n=t[0],s+=n*B,o+=n*U,a+=n*M,c+=n*j,l+=n*V,u+=n*z,h+=n*F,d+=n*$,f+=n*K,p+=n*q,y+=n*H,g+=n*G,m+=n*W,w+=n*Y,b+=n*J,v+=n*Q,n=t[1],o+=n*B,a+=n*U,c+=n*M,l+=n*j,u+=n*V,h+=n*z,d+=n*F,f+=n*$,p+=n*K,y+=n*q,g+=n*H,m+=n*G,w+=n*W,b+=n*Y,v+=n*J,E+=n*Q,n=t[2],a+=n*B,c+=n*U,l+=n*M,u+=n*j,h+=n*V,d+=n*z,f+=n*F,p+=n*$,y+=n*K,g+=n*q,m+=n*H,w+=n*G,b+=n*W,v+=n*Y,E+=n*J,_+=n*Q,n=t[3],c+=n*B,l+=n*U,u+=n*M,h+=n*j,d+=n*V,f+=n*z,p+=n*F,y+=n*$,g+=n*K,m+=n*q,w+=n*H,b+=n*G,v+=n*W,E+=n*Y,_+=n*J,S+=n*Q,n=t[4],l+=n*B,u+=n*U,h+=n*M,d+=n*j,f+=n*V,p+=n*z,y+=n*F,g+=n*$,m+=n*K,w+=n*q,b+=n*H,v+=n*G,E+=n*W,_+=n*Y,S+=n*J,A+=n*Q,n=t[5],u+=n*B,h+=n*U,d+=n*M,f+=n*j,p+=n*V,y+=n*z,g+=n*F,m+=n*$,w+=n*K,b+=n*q,v+=n*H,E+=n*G,_+=n*W,S+=n*Y,A+=n*J,I+=n*Q,n=t[6],h+=n*B,d+=n*U,f+=n*M,p+=n*j,y+=n*V,g+=n*z,m+=n*F,w+=n*$,b+=n*K,v+=n*q,E+=n*H,_+=n*G,S+=n*W,A+=n*Y,I+=n*J,C+=n*Q,n=t[7],d+=n*B,f+=n*U,p+=n*M,y+=n*j,g+=n*V,m+=n*z,w+=n*F,b+=n*$,v+=n*K,E+=n*q,_+=n*H,S+=n*G,A+=n*W,I+=n*Y,C+=n*J,k+=n*Q,n=t[8],f+=n*B,p+=n*U,y+=n*M,g+=n*j,m+=n*V,w+=n*z,b+=n*F,v+=n*$,E+=n*K,_+=n*q,S+=n*H,A+=n*G,I+=n*W,C+=n*Y,k+=n*J,T+=n*Q,n=t[9],p+=n*B,y+=n*U,g+=n*M,m+=n*j,w+=n*V,b+=n*z,v+=n*F,E+=n*$,_+=n*K,S+=n*q,A+=n*H,I+=n*G,C+=n*W,k+=n*Y,T+=n*J,R+=n*Q,n=t[10],y+=n*B,g+=n*U,m+=n*M,w+=n*j,b+=n*V,v+=n*z,E+=n*F,_+=n*$,S+=n*K,A+=n*q,I+=n*H,C+=n*G,k+=n*W,T+=n*Y,R+=n*J,P+=n*Q,n=t[11],g+=n*B,m+=n*U,w+=n*M,b+=n*j,v+=n*V,E+=n*z,_+=n*F,S+=n*$,A+=n*K,I+=n*q,C+=n*H,k+=n*G,T+=n*W,R+=n*Y,P+=n*J,x+=n*Q,n=t[12],m+=n*B,w+=n*U,b+=n*M,v+=n*j,E+=n*V,_+=n*z,S+=n*F,A+=n*$,I+=n*K,C+=n*q,k+=n*H,T+=n*G,R+=n*W,P+=n*Y,x+=n*J,D+=n*Q,n=t[13],w+=n*B,b+=n*U,v+=n*M,E+=n*j,_+=n*V,S+=n*z,A+=n*F,I+=n*$,C+=n*K,k+=n*q,T+=n*H,R+=n*G,P+=n*W,x+=n*Y,D+=n*J,O+=n*Q,n=t[14],b+=n*B,v+=n*U,E+=n*M,_+=n*j,S+=n*V,A+=n*z,I+=n*F,C+=n*$,k+=n*K,T+=n*q,R+=n*H,P+=n*G,x+=n*W,D+=n*Y,O+=n*J,N+=n*Q,n=t[15],v+=n*B,E+=n*U,_+=n*M,S+=n*j,A+=n*V,I+=n*z,C+=n*F,k+=n*$,T+=n*K,R+=n*q,P+=n*H,x+=n*G,D+=n*W,O+=n*Y,N+=n*J,L+=n*Q,s+=38*E,o+=38*_,a+=38*S,c+=38*A,l+=38*I,u+=38*C,h+=38*k,d+=38*T,f+=38*R,p+=38*P,y+=38*x,g+=38*D,m+=38*O,w+=38*N,b+=38*L,i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-65536*i,n=o+i+65535,i=Math.floor(n/65536),o=n-65536*i,n=a+i+65535,i=Math.floor(n/65536),a=n-65536*i,n=c+i+65535,i=Math.floor(n/65536),c=n-65536*i,n=l+i+65535,i=Math.floor(n/65536),l=n-65536*i,n=u+i+65535,i=Math.floor(n/65536),u=n-65536*i,n=h+i+65535,i=Math.floor(n/65536),h=n-65536*i,n=d+i+65535,i=Math.floor(n/65536),d=n-65536*i,n=f+i+65535,i=Math.floor(n/65536),f=n-65536*i,n=p+i+65535,i=Math.floor(n/65536),p=n-65536*i,n=y+i+65535,i=Math.floor(n/65536),y=n-65536*i,n=g+i+65535,i=Math.floor(n/65536),g=n-65536*i,n=m+i+65535,i=Math.floor(n/65536),m=n-65536*i,n=w+i+65535,i=Math.floor(n/65536),w=n-65536*i,n=b+i+65535,i=Math.floor(n/65536),b=n-65536*i,n=v+i+65535,i=Math.floor(n/65536),v=n-65536*i,s+=i-1+37*(i-1),i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-65536*i,n=o+i+65535,i=Math.floor(n/65536),o=n-65536*i,n=a+i+65535,i=Math.floor(n/65536),a=n-65536*i,n=c+i+65535,i=Math.floor(n/65536),c=n-65536*i,n=l+i+65535,i=Math.floor(n/65536),l=n-65536*i,n=u+i+65535,i=Math.floor(n/65536),u=n-65536*i,n=h+i+65535,i=Math.floor(n/65536),h=n-65536*i,n=d+i+65535,i=Math.floor(n/65536),d=n-65536*i,n=f+i+65535,i=Math.floor(n/65536),f=n-65536*i,n=p+i+65535,i=Math.floor(n/65536),p=n-65536*i,n=y+i+65535,i=Math.floor(n/65536),y=n-65536*i,n=g+i+65535,i=Math.floor(n/65536),g=n-65536*i,n=m+i+65535,i=Math.floor(n/65536),m=n-65536*i,n=w+i+65535,i=Math.floor(n/65536),w=n-65536*i,n=b+i+65535,i=Math.floor(n/65536),b=n-65536*i,n=v+i+65535,i=Math.floor(n/65536),v=n-65536*i,s+=i-1+37*(i-1),e[0]=s,e[1]=o,e[2]=a,e[3]=c,e[4]=l,e[5]=u,e[6]=h,e[7]=d,e[8]=f,e[9]=p,e[10]=y,e[11]=g,e[12]=m,e[13]=w,e[14]=b,e[15]=v}function y(e,t){p(e,t,t)}function g(e,t){const r=s();for(let n=0;n<16;n++)r[n]=t[n];for(let n=253;n>=0;n--)y(r,r),2!==n&&4!==n&&p(r,r,t);for(let n=0;n<16;n++)e[n]=r[n]}function m(e,t){const r=new Uint8Array(32),n=new Float64Array(80),i=s(),o=s(),c=s(),m=s(),w=s(),b=s();for(let s=0;s<31;s++)r[s]=e[s];r[31]=127&e[31]|64,r[0]&=248,h(n,t);for(let s=0;s<16;s++)o[s]=n[s];i[0]=m[0]=1;for(let s=254;s>=0;--s){const e=r[s>>>3]>>>(7&s)&1;l(i,o,e),l(c,m,e),d(w,i,c),f(i,i,c),d(c,o,m),f(o,o,m),y(m,w),y(b,i),p(i,c,i),p(c,o,w),d(w,i,c),f(i,i,c),y(o,i),f(c,m,b),p(i,c,a),d(i,i,m),p(c,c,i),p(i,m,b),p(m,o,n),y(o,w),l(i,o,e),l(c,m,e)}for(let s=0;s<16;s++)n[s+16]=i[s],n[s+32]=c[s],n[s+48]=o[s],n[s+64]=m[s];const v=n.subarray(32),E=n.subarray(16);g(v,v),p(E,E,v);const _=new Uint8Array(32);return u(_,E),_}function w(e){return m(e,o)}function b(e){if(e.length!==t.KS)throw new Error(`x25519: seed must be ${t.KS} bytes`);const r=new Uint8Array(e),n=w(r);return{publicKey:n,secretKey:r}}function v(e){const t=(0,n.randomBytes)(32,e),r=b(t);return(0,i.wipe)(t),r}function E(e,r,n=!1){if(e.length!==t.kz)throw new Error("X25519: incorrect secret key length");if(r.length!==t.kz)throw new Error("X25519: incorrect public key length");const i=m(e,r);if(n){let e=0;for(let t=0;t<i.length;t++)e|=i[t];if(0===e)throw new Error("X25519: invalid shared key")}return i}t._w=b,t.Au=v,t.gi=E},3573:function(e,t){"use strict";const r=Math.exp;e.exports=function(e){if("number"!==typeof e)throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,n,i=0,s=0,o=0,a={};function c(t,n){return 1-r(-(t-n)/e)}return a.push=function(e,r){if(n){const a=c(e,n),l=r-t,u=a*l;t=a*r+(1-a)*t,i=(1-a)*(i+l*u),s=Math.sqrt(i),o=t+a*l}else t=r;n=e},a.movingAverage=function(){return t},a.variance=function(){return i},a.deviation=function(){return s},a.forecast=function(){return o},a}},2262:function(e,t,r){"use strict";r.d(t,{Bj:function(){return s},Fl:function(){return Ve},IU:function(){return Te},Jd:function(){return S},PG:function(){return Ae},Um:function(){return Ee},WL:function(){return Ue},X$:function(){return k},X3:function(){return ke},Xl:function(){return Re},dq:function(){return Ne},j:function(){return I},lk:function(){return A},qj:function(){return ve},qq:function(){return b},yT:function(){return Ce}});var n=r(3577);let i;class s{constructor(e=!1){this.detached=e,this.active=!0,this.effects=[],this.cleanups=[],this.parent=i,!e&&i&&(this.index=(i.scopes||(i.scopes=[])).push(this)-1)}run(e){if(this.active){const t=i;try{return i=this,e()}finally{i=t}}else 0}on(){i=this}off(){i=this.parent}stop(e){if(this.active){let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0,this.active=!1}}}function o(e,t=i){t&&t.active&&t.effects.push(e)}const a=e=>{const t=new Set(e);return t.w=0,t.n=0,t},c=e=>(e.w&p)>0,l=e=>(e.n&p)>0,u=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=p},h=e=>{const{deps:t}=e;if(t.length){let r=0;for(let n=0;n<t.length;n++){const i=t[n];c(i)&&!l(i)?i.delete(e):t[r++]=i,i.w&=~p,i.n&=~p}t.length=r}},d=new WeakMap;let f=0,p=1;const y=30;let g;const m=Symbol(""),w=Symbol("");class b{constructor(e,t=null,r){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,o(this,r)}run(){if(!this.active)return this.fn();let e=g,t=E;while(e){if(e===this)return;e=e.parent}try{return this.parent=g,g=this,E=!0,p=1<<++f,f<=y?u(this):v(this),this.fn()}finally{f<=y&&h(this),p=1<<--f,g=this.parent,E=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){g===this?this.deferStop=!0:this.active&&(v(this),this.onStop&&this.onStop(),this.active=!1)}}function v(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let E=!0;const _=[];function S(){_.push(E),E=!1}function A(){const e=_.pop();E=void 0===e||e}function I(e,t,r){if(E&&g){let t=d.get(e);t||d.set(e,t=new Map);let n=t.get(r);n||t.set(r,n=a());const i=void 0;C(n,i)}}function C(e,t){let r=!1;f<=y?l(e)||(e.n|=p,r=!c(e)):r=!e.has(g),r&&(e.add(g),g.deps.push(e))}function k(e,t,r,i,s,o){const c=d.get(e);if(!c)return;let l=[];if("clear"===t)l=[...c.values()];else if("length"===r&&(0,n.kJ)(e)){const e=(0,n.He)(i);c.forEach(((t,r)=>{("length"===r||r>=e)&&l.push(t)}))}else switch(void 0!==r&&l.push(c.get(r)),t){case"add":(0,n.kJ)(e)?(0,n.S0)(r)&&l.push(c.get("length")):(l.push(c.get(m)),(0,n._N)(e)&&l.push(c.get(w)));break;case"delete":(0,n.kJ)(e)||(l.push(c.get(m)),(0,n._N)(e)&&l.push(c.get(w)));break;case"set":(0,n._N)(e)&&l.push(c.get(m));break}if(1===l.length)l[0]&&T(l[0]);else{const e=[];for(const t of l)t&&e.push(...t);T(a(e))}}function T(e,t){const r=(0,n.kJ)(e)?e:[...e];for(const n of r)n.computed&&R(n,t);for(const n of r)n.computed||R(n,t)}function R(e,t){(e!==g||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const P=(0,n.fY)("__proto__,__v_isRef,__isVue"),x=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(n.yk)),D=U(),O=U(!1,!0),N=U(!0),L=B();function B(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const r=Te(this);for(let t=0,i=this.length;t<i;t++)I(r,"get",t+"");const n=r[t](...e);return-1===n||!1===n?r[t](...e.map(Te)):n}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){S();const r=Te(this)[t].apply(this,e);return A(),r}})),e}function U(e=!1,t=!1){return function(r,i,s){if("__v_isReactive"===i)return!e;if("__v_isReadonly"===i)return e;if("__v_isShallow"===i)return t;if("__v_raw"===i&&s===(e?t?me:ge:t?ye:pe).get(r))return r;const o=(0,n.kJ)(r);if(!e&&o&&(0,n.RI)(L,i))return Reflect.get(L,i,s);const a=Reflect.get(r,i,s);return((0,n.yk)(i)?x.has(i):P(i))?a:(e||I(r,"get",i),t?a:Ne(a)?o&&(0,n.S0)(i)?a:a.value:(0,n.Kn)(a)?e?_e(a):ve(a):a)}}const M=V(),j=V(!0);function V(e=!1){return function(t,r,i,s){let o=t[r];if(Ie(o)&&Ne(o)&&!Ne(i))return!1;if(!e&&(Ce(i)||Ie(i)||(o=Te(o),i=Te(i)),!(0,n.kJ)(t)&&Ne(o)&&!Ne(i)))return o.value=i,!0;const a=(0,n.kJ)(t)&&(0,n.S0)(r)?Number(r)<t.length:(0,n.RI)(t,r),c=Reflect.set(t,r,i,s);return t===Te(s)&&(a?(0,n.aU)(i,o)&&k(t,"set",r,i,o):k(t,"add",r,i)),c}}function z(e,t){const r=(0,n.RI)(e,t),i=e[t],s=Reflect.deleteProperty(e,t);return s&&r&&k(e,"delete",t,void 0,i),s}function F(e,t){const r=Reflect.has(e,t);return(0,n.yk)(t)&&x.has(t)||I(e,"has",t),r}function $(e){return I(e,"iterate",(0,n.kJ)(e)?"length":m),Reflect.ownKeys(e)}const K={get:D,set:M,deleteProperty:z,has:F,ownKeys:$},q={get:N,set(e,t){return!0},deleteProperty(e,t){return!0}},H=(0,n.l7)({},K,{get:O,set:j}),G=e=>e,W=e=>Reflect.getPrototypeOf(e);function Y(e,t,r=!1,n=!1){e=e["__v_raw"];const i=Te(e),s=Te(t);r||(t!==s&&I(i,"get",t),I(i,"get",s));const{has:o}=W(i),a=n?G:r?xe:Pe;return o.call(i,t)?a(e.get(t)):o.call(i,s)?a(e.get(s)):void(e!==i&&e.get(t))}function J(e,t=!1){const r=this["__v_raw"],n=Te(r),i=Te(e);return t||(e!==i&&I(n,"has",e),I(n,"has",i)),e===i?r.has(e):r.has(e)||r.has(i)}function Q(e,t=!1){return e=e["__v_raw"],!t&&I(Te(e),"iterate",m),Reflect.get(e,"size",e)}function X(e){e=Te(e);const t=Te(this),r=W(t),n=r.has.call(t,e);return n||(t.add(e),k(t,"add",e,e)),this}function Z(e,t){t=Te(t);const r=Te(this),{has:i,get:s}=W(r);let o=i.call(r,e);o||(e=Te(e),o=i.call(r,e));const a=s.call(r,e);return r.set(e,t),o?(0,n.aU)(t,a)&&k(r,"set",e,t,a):k(r,"add",e,t),this}function ee(e){const t=Te(this),{has:r,get:n}=W(t);let i=r.call(t,e);i||(e=Te(e),i=r.call(t,e));const s=n?n.call(t,e):void 0,o=t.delete(e);return i&&k(t,"delete",e,void 0,s),o}function te(){const e=Te(this),t=0!==e.size,r=void 0,n=e.clear();return t&&k(e,"clear",void 0,void 0,r),n}function re(e,t){return function(r,n){const i=this,s=i["__v_raw"],o=Te(s),a=t?G:e?xe:Pe;return!e&&I(o,"iterate",m),s.forEach(((e,t)=>r.call(n,a(e),a(t),i)))}}function ne(e,t,r){return function(...i){const s=this["__v_raw"],o=Te(s),a=(0,n._N)(o),c="entries"===e||e===Symbol.iterator&&a,l="keys"===e&&a,u=s[e](...i),h=r?G:t?xe:Pe;return!t&&I(o,"iterate",l?w:m),{next(){const{value:e,done:t}=u.next();return t?{value:e,done:t}:{value:c?[h(e[0]),h(e[1])]:h(e),done:t}},[Symbol.iterator](){return this}}}}function ie(e){return function(...t){return"delete"!==e&&this}}function se(){const e={get(e){return Y(this,e)},get size(){return Q(this)},has:J,add:X,set:Z,delete:ee,clear:te,forEach:re(!1,!1)},t={get(e){return Y(this,e,!1,!0)},get size(){return Q(this)},has:J,add:X,set:Z,delete:ee,clear:te,forEach:re(!1,!0)},r={get(e){return Y(this,e,!0)},get size(){return Q(this,!0)},has(e){return J.call(this,e,!0)},add:ie("add"),set:ie("set"),delete:ie("delete"),clear:ie("clear"),forEach:re(!0,!1)},n={get(e){return Y(this,e,!0,!0)},get size(){return Q(this,!0)},has(e){return J.call(this,e,!0)},add:ie("add"),set:ie("set"),delete:ie("delete"),clear:ie("clear"),forEach:re(!0,!0)},i=["keys","values","entries",Symbol.iterator];return i.forEach((i=>{e[i]=ne(i,!1,!1),r[i]=ne(i,!0,!1),t[i]=ne(i,!1,!0),n[i]=ne(i,!0,!0)})),[e,r,t,n]}const[oe,ae,ce,le]=se();function ue(e,t){const r=t?e?le:ce:e?ae:oe;return(t,i,s)=>"__v_isReactive"===i?!e:"__v_isReadonly"===i?e:"__v_raw"===i?t:Reflect.get((0,n.RI)(r,i)&&i in t?r:t,i,s)}const he={get:ue(!1,!1)},de={get:ue(!1,!0)},fe={get:ue(!0,!1)};const pe=new WeakMap,ye=new WeakMap,ge=new WeakMap,me=new WeakMap;function we(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function be(e){return e["__v_skip"]||!Object.isExtensible(e)?0:we((0,n.W7)(e))}function ve(e){return Ie(e)?e:Se(e,!1,K,he,pe)}function Ee(e){return Se(e,!1,H,de,ye)}function _e(e){return Se(e,!0,q,fe,ge)}function Se(e,t,r,i,s){if(!(0,n.Kn)(e))return e;if(e["__v_raw"]&&(!t||!e["__v_isReactive"]))return e;const o=s.get(e);if(o)return o;const a=be(e);if(0===a)return e;const c=new Proxy(e,2===a?i:r);return s.set(e,c),c}function Ae(e){return Ie(e)?Ae(e["__v_raw"]):!(!e||!e["__v_isReactive"])}function Ie(e){return!(!e||!e["__v_isReadonly"])}function Ce(e){return!(!e||!e["__v_isShallow"])}function ke(e){return Ae(e)||Ie(e)}function Te(e){const t=e&&e["__v_raw"];return t?Te(t):e}function Re(e){return(0,n.Nj)(e,"__v_skip",!0),e}const Pe=e=>(0,n.Kn)(e)?ve(e):e,xe=e=>(0,n.Kn)(e)?_e(e):e;function De(e){E&&g&&(e=Te(e),C(e.dep||(e.dep=a())))}function Oe(e,t){e=Te(e),e.dep&&T(e.dep)}function Ne(e){return!(!e||!0!==e.__v_isRef)}function Le(e){return Ne(e)?e.value:e}const Be={get:(e,t,r)=>Le(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const i=e[t];return Ne(i)&&!Ne(r)?(i.value=r,!0):Reflect.set(e,t,r,n)}};function Ue(e){return Ae(e)?e:new Proxy(e,Be)}var Me;class je{constructor(e,t,r,n){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this[Me]=!1,this._dirty=!0,this.effect=new b(e,(()=>{this._dirty||(this._dirty=!0,Oe(this))})),this.effect.computed=this,this.effect.active=this._cacheable=!n,this["__v_isReadonly"]=r}get value(){const e=Te(this);return De(e),!e._dirty&&e._cacheable||(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function Ve(e,t,r=!1){let i,s;const o=(0,n.mf)(e);o?(i=e,s=n.dG):(i=e.get,s=e.set);const a=new je(i,s,o||!s,r);return a}Me="__v_isReadonly"},6252:function(e,t,r){"use strict";r.d(t,{$d:function(){return o},Cn:function(){return B},FN:function(){return lr},HY:function(){return Rt},P$:function(){return ne},Q6:function(){return le},U2:function(){return se},Uk:function(){return Xt},Us:function(){return St},Wm:function(){return Wt},Y8:function(){return ee},YP:function(){return Y},_:function(){return Gt},dD:function(){return L},f3:function(){return G},h:function(){return Cr},iD:function(){return Vt},ic:function(){return Ae},kq:function(){return Zt},nK:function(){return ce},up:function(){return Oe},wg:function(){return Lt}});var n=r(2262),i=r(3577);function s(e,t,r,n){let i;try{i=n?e(...n):e()}catch(s){a(s,t,r)}return i}function o(e,t,r,n){if((0,i.mf)(e)){const o=s(e,t,r,n);return o&&(0,i.tI)(o)&&o.catch((e=>{a(e,t,r)})),o}const c=[];for(let i=0;i<e.length;i++)c.push(o(e[i],t,r,n));return c}function a(e,t,r,n=!0){const i=t?t.vnode:null;if(t){let n=t.parent;const i=t.proxy,o=r;while(n){const t=n.ec;if(t)for(let r=0;r<t.length;r++)if(!1===t[r](e,i,o))return;n=n.parent}const a=t.appContext.config.errorHandler;if(a)return void s(a,null,10,[e,i,o])}c(e,r,i,n)}function c(e,t,r,n=!0){console.error(e)}let l=!1,u=!1;const h=[];let d=0;const f=[];let p=null,y=0;const g=Promise.resolve();let m=null;function w(e){const t=m||g;return e?t.then(this?e.bind(this):e):t}function b(e){let t=d+1,r=h.length;while(t<r){const n=t+r>>>1,i=C(h[n]);i<e?t=n+1:r=n}return t}function v(e){h.length&&h.includes(e,l&&e.allowRecurse?d+1:d)||(null==e.id?h.push(e):h.splice(b(e.id),0,e),E())}function E(){l||u||(u=!0,m=g.then(T))}function _(e){const t=h.indexOf(e);t>d&&h.splice(t,1)}function S(e){(0,i.kJ)(e)?f.push(...e):p&&p.includes(e,e.allowRecurse?y+1:y)||f.push(e),E()}function A(e,t=(l?d+1:0)){for(0;t<h.length;t++){const e=h[t];e&&e.pre&&(h.splice(t,1),t--,e())}}function I(e){if(f.length){const e=[...new Set(f)];if(f.length=0,p)return void p.push(...e);for(p=e,p.sort(((e,t)=>C(e)-C(t))),y=0;y<p.length;y++)p[y]();p=null,y=0}}const C=e=>null==e.id?1/0:e.id,k=(e,t)=>{const r=C(e)-C(t);if(0===r){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return r};function T(e){u=!1,l=!0,h.sort(k);i.dG;try{for(d=0;d<h.length;d++){const e=h[d];e&&!1!==e.active&&s(e,null,14)}}finally{d=0,h.length=0,I(e),l=!1,m=null,(h.length||f.length)&&T(e)}}new Set;new Map;function R(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||i.kT;let s=r;const a=t.startsWith("update:"),c=a&&t.slice(7);if(c&&c in n){const e=`${"modelValue"===c?"model":c}Modifiers`,{number:t,trim:o}=n[e]||i.kT;o&&(s=r.map((e=>(0,i.HD)(e)?e.trim():e))),t&&(s=r.map(i.He))}let l;let u=n[l=(0,i.hR)(t)]||n[l=(0,i.hR)((0,i._A)(t))];!u&&a&&(u=n[l=(0,i.hR)((0,i.rs)(t))]),u&&o(u,e,6,s);const h=n[l+"Once"];if(h){if(e.emitted){if(e.emitted[l])return}else e.emitted={};e.emitted[l]=!0,o(h,e,6,s)}}function P(e,t,r=!1){const n=t.emitsCache,s=n.get(e);if(void 0!==s)return s;const o=e.emits;let a={},c=!1;if(!(0,i.mf)(e)){const n=e=>{const r=P(e,t,!0);r&&(c=!0,(0,i.l7)(a,r))};!r&&t.mixins.length&&t.mixins.forEach(n),e.extends&&n(e.extends),e.mixins&&e.mixins.forEach(n)}return o||c?((0,i.kJ)(o)?o.forEach((e=>a[e]=null)):(0,i.l7)(a,o),(0,i.Kn)(e)&&n.set(e,a),a):((0,i.Kn)(e)&&n.set(e,null),null)}function x(e,t){return!(!e||!(0,i.F7)(t))&&(t=t.slice(2).replace(/Once$/,""),(0,i.RI)(e,t[0].toLowerCase()+t.slice(1))||(0,i.RI)(e,(0,i.rs)(t))||(0,i.RI)(e,t))}let D=null,O=null;function N(e){const t=D;return D=e,O=e&&e.type.__scopeId||null,t}function L(e){O=e}function B(){O=null}function U(e,t=D,r){if(!t)return e;if(e._n)return e;const n=(...r)=>{n._d&&Mt(-1);const i=N(t);let s;try{s=e(...r)}finally{N(i),n._d&&Mt(1)}return s};return n._n=!0,n._c=!0,n._d=!0,n}function M(e){const{type:t,vnode:r,proxy:n,withProxy:s,props:o,propsOptions:[c],slots:l,attrs:u,emit:h,render:d,renderCache:f,data:p,setupState:y,ctx:g,inheritAttrs:m}=e;let w,b;const v=N(e);try{if(4&r.shapeFlag){const e=s||n;w=er(d.call(e,e,f,o,y,p,g)),b=u}else{const e=t;0,w=er(e.length>1?e(o,{attrs:u,slots:l,emit:h}):e(o,null)),b=t.props?u:j(u)}}catch(_){Ot.length=0,a(_,e,1),w=Wt(xt)}let E=w;if(b&&!1!==m){const e=Object.keys(b),{shapeFlag:t}=E;e.length&&7&t&&(c&&e.some(i.tR)&&(b=V(b,c)),E=Qt(E,b))}return r.dirs&&(E=Qt(E),E.dirs=E.dirs?E.dirs.concat(r.dirs):r.dirs),r.transition&&(E.transition=r.transition),w=E,N(v),w}const j=e=>{let t;for(const r in e)("class"===r||"style"===r||(0,i.F7)(r))&&((t||(t={}))[r]=e[r]);return t},V=(e,t)=>{const r={};for(const n in e)(0,i.tR)(n)&&n.slice(9)in t||(r[n]=e[n]);return r};function z(e,t,r){const{props:n,children:i,component:s}=e,{props:o,children:a,patchFlag:c}=t,l=s.emitsOptions;if(t.dirs||t.transition)return!0;if(!(r&&c>=0))return!(!i&&!a||a&&a.$stable)||n!==o&&(n?!o||F(n,o,l):!!o);if(1024&c)return!0;if(16&c)return n?F(n,o,l):!!o;if(8&c){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const r=e[t];if(o[r]!==n[r]&&!x(l,r))return!0}}return!1}function F(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let i=0;i<n.length;i++){const s=n[i];if(t[s]!==e[s]&&!x(r,s))return!0}return!1}function $({vnode:e,parent:t},r){while(t&&t.subTree===e)(e=t.vnode).el=r,t=t.parent}const K=e=>e.__isSuspense;function q(e,t){t&&t.pendingBranch?(0,i.kJ)(e)?t.effects.push(...e):t.effects.push(e):S(e)}function H(e,t){if(cr){let r=cr.provides;const n=cr.parent&&cr.parent.provides;n===r&&(r=cr.provides=Object.create(n)),r[e]=t}else 0}function G(e,t,r=!1){const n=cr||D;if(n){const s=null==n.parent?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(s&&e in s)return s[e];if(arguments.length>1)return r&&(0,i.mf)(t)?t.call(n.proxy):t}else 0}const W={};function Y(e,t,r){return J(e,t,r)}function J(e,t,{immediate:r,deep:a,flush:c,onTrack:l,onTrigger:u}=i.kT){const h=cr;let d,f,p=!1,y=!1;if((0,n.dq)(e)?(d=()=>e.value,p=(0,n.yT)(e)):(0,n.PG)(e)?(d=()=>e,a=!0):(0,i.kJ)(e)?(y=!0,p=e.some((e=>(0,n.PG)(e)||(0,n.yT)(e))),d=()=>e.map((e=>(0,n.dq)(e)?e.value:(0,n.PG)(e)?Z(e):(0,i.mf)(e)?s(e,h,2):void 0))):d=(0,i.mf)(e)?t?()=>s(e,h,2):()=>{if(!h||!h.isUnmounted)return f&&f(),o(e,h,3,[m])}:i.dG,t&&a){const e=d;d=()=>Z(e())}let g,m=e=>{f=_.onStop=()=>{s(e,h,4)}};if(yr){if(m=i.dG,t?r&&o(t,h,3,[d(),y?[]:void 0,m]):d(),"sync"!==c)return i.dG;{const e=Tr();g=e.__watcherHandles||(e.__watcherHandles=[])}}let w=y?new Array(e.length).fill(W):W;const b=()=>{if(_.active)if(t){const e=_.run();(a||p||(y?e.some(((e,t)=>(0,i.aU)(e,w[t]))):(0,i.aU)(e,w)))&&(f&&f(),o(t,h,3,[e,w===W?void 0:y&&w[0]===W?[]:w,m]),w=e)}else _.run()};let E;b.allowRecurse=!!t,"sync"===c?E=b:"post"===c?E=()=>_t(b,h&&h.suspense):(b.pre=!0,h&&(b.id=h.uid),E=()=>v(b));const _=new n.qq(d,E);t?r?b():w=_.run():"post"===c?_t(_.run.bind(_),h&&h.suspense):_.run();const S=()=>{_.stop(),h&&h.scope&&(0,i.Od)(h.scope.effects,_)};return g&&g.push(S),S}function Q(e,t,r){const n=this.proxy,s=(0,i.HD)(e)?e.includes(".")?X(n,e):()=>n[e]:e.bind(n,n);let o;(0,i.mf)(t)?o=t:(o=t.handler,r=t);const a=cr;ur(this);const c=J(s,o.bind(n),r);return a?ur(a):hr(),c}function X(e,t){const r=t.split(".");return()=>{let t=e;for(let e=0;e<r.length&&t;e++)t=t[r[e]];return t}}function Z(e,t){if(!(0,i.Kn)(e)||e["__v_skip"])return e;if(t=t||new Set,t.has(e))return e;if(t.add(e),(0,n.dq)(e))Z(e.value,t);else if((0,i.kJ)(e))for(let r=0;r<e.length;r++)Z(e[r],t);else if((0,i.DM)(e)||(0,i._N)(e))e.forEach((e=>{Z(e,t)}));else if((0,i.PO)(e))for(const r in e)Z(e[r],t);return e}function ee(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return _e((()=>{e.isMounted=!0})),Ie((()=>{e.isUnmounting=!0})),e}const te=[Function,Array],re={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:te,onEnter:te,onAfterEnter:te,onEnterCancelled:te,onBeforeLeave:te,onLeave:te,onAfterLeave:te,onLeaveCancelled:te,onBeforeAppear:te,onAppear:te,onAfterAppear:te,onAppearCancelled:te},setup(e,{slots:t}){const r=lr(),i=ee();let s;return()=>{const o=t.default&&le(t.default(),!0);if(!o||!o.length)return;let a=o[0];if(o.length>1){let e=!1;for(const t of o)if(t.type!==xt){0,a=t,e=!0;break}}const c=(0,n.IU)(e),{mode:l}=c;if(i.isLeaving)return oe(a);const u=ae(a);if(!u)return oe(a);const h=se(u,c,i,r);ce(u,h);const d=r.subTree,f=d&&ae(d);let p=!1;const{getTransitionKey:y}=u.type;if(y){const e=y();void 0===s?s=e:e!==s&&(s=e,p=!0)}if(f&&f.type!==xt&&(!$t(u,f)||p)){const e=se(f,c,i,r);if(ce(f,e),"out-in"===l)return i.isLeaving=!0,e.afterLeave=()=>{i.isLeaving=!1,!1!==r.update.active&&r.update()},oe(a);"in-out"===l&&u.type!==xt&&(e.delayLeave=(e,t,r)=>{const n=ie(i,f);n[String(f.key)]=f,e._leaveCb=()=>{t(),e._leaveCb=void 0,delete h.delayedLeave},h.delayedLeave=r})}return a}}},ne=re;function ie(e,t){const{leavingVNodes:r}=e;let n=r.get(t.type);return n||(n=Object.create(null),r.set(t.type,n)),n}function se(e,t,r,n){const{appear:s,mode:a,persisted:c=!1,onBeforeEnter:l,onEnter:u,onAfterEnter:h,onEnterCancelled:d,onBeforeLeave:f,onLeave:p,onAfterLeave:y,onLeaveCancelled:g,onBeforeAppear:m,onAppear:w,onAfterAppear:b,onAppearCancelled:v}=t,E=String(e.key),_=ie(r,e),S=(e,t)=>{e&&o(e,n,9,t)},A=(e,t)=>{const r=t[1];S(e,t),(0,i.kJ)(e)?e.every((e=>e.length<=1))&&r():e.length<=1&&r()},I={mode:a,persisted:c,beforeEnter(t){let n=l;if(!r.isMounted){if(!s)return;n=m||l}t._leaveCb&&t._leaveCb(!0);const i=_[E];i&&$t(e,i)&&i.el._leaveCb&&i.el._leaveCb(),S(n,[t])},enter(e){let t=u,n=h,i=d;if(!r.isMounted){if(!s)return;t=w||u,n=b||h,i=v||d}let o=!1;const a=e._enterCb=t=>{o||(o=!0,S(t?i:n,[e]),I.delayedLeave&&I.delayedLeave(),e._enterCb=void 0)};t?A(t,[e,a]):a()},leave(t,n){const i=String(e.key);if(t._enterCb&&t._enterCb(!0),r.isUnmounting)return n();S(f,[t]);let s=!1;const o=t._leaveCb=r=>{s||(s=!0,n(),S(r?g:y,[t]),t._leaveCb=void 0,_[i]===e&&delete _[i])};_[i]=e,p?A(p,[t,o]):o()},clone(e){return se(e,t,r,n)}};return I}function oe(e){if(he(e))return e=Qt(e),e.children=null,e}function ae(e){return he(e)?e.children?e.children[0]:void 0:e}function ce(e,t){6&e.shapeFlag&&e.component?ce(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function le(e,t=!1,r){let n=[],i=0;for(let s=0;s<e.length;s++){let o=e[s];const a=null==r?o.key:String(r)+String(null!=o.key?o.key:s);o.type===Rt?(128&o.patchFlag&&i++,n=n.concat(le(o.children,t,a))):(t||o.type!==xt)&&n.push(null!=a?Qt(o,{key:a}):o)}if(i>1)for(let s=0;s<n.length;s++)n[s].patchFlag=-2;return n}const ue=e=>!!e.type.__asyncLoader;const he=e=>e.type.__isKeepAlive;RegExp,RegExp;function de(e,t){return(0,i.kJ)(e)?e.some((e=>de(e,t))):(0,i.HD)(e)?e.split(",").includes(t):!!e.test&&e.test(t)}function fe(e,t){ye(e,"a",t)}function pe(e,t){ye(e,"da",t)}function ye(e,t,r=cr){const n=e.__wdc||(e.__wdc=()=>{let t=r;while(t){if(t.isDeactivated)return;t=t.parent}return e()});if(be(t,n,r),r){let e=r.parent;while(e&&e.parent)he(e.parent.vnode)&&ge(n,t,r,e),e=e.parent}}function ge(e,t,r,n){const s=be(t,e,n,!0);Ce((()=>{(0,i.Od)(n[t],s)}),r)}function me(e){e.shapeFlag&=-257,e.shapeFlag&=-513}function we(e){return 128&e.shapeFlag?e.ssContent:e}function be(e,t,r=cr,i=!1){if(r){const s=r[e]||(r[e]=[]),a=t.__weh||(t.__weh=(...i)=>{if(r.isUnmounted)return;(0,n.Jd)(),ur(r);const s=o(t,r,e,i);return hr(),(0,n.lk)(),s});return i?s.unshift(a):s.push(a),a}}const ve=e=>(t,r=cr)=>(!yr||"sp"===e)&&be(e,((...e)=>t(...e)),r),Ee=ve("bm"),_e=ve("m"),Se=ve("bu"),Ae=ve("u"),Ie=ve("bum"),Ce=ve("um"),ke=ve("sp"),Te=ve("rtg"),Re=ve("rtc");function Pe(e,t=cr){be("ec",e,t)}function xe(e,t,r,i){const s=e.dirs,a=t&&t.dirs;for(let c=0;c<s.length;c++){const l=s[c];a&&(l.oldValue=a[c].value);let u=l.dir[i];u&&((0,n.Jd)(),o(u,r,8,[e.el,l,e,t]),(0,n.lk)())}}const De="components";function Oe(e,t){return Le(De,e,!0,t)||e}const Ne=Symbol();function Le(e,t,r=!0,n=!1){const s=D||cr;if(s){const r=s.type;if(e===De){const e=Sr(r,!1);if(e&&(e===t||e===(0,i._A)(t)||e===(0,i.kC)((0,i._A)(t))))return r}const o=Be(s[e]||r[e],t)||Be(s.appContext[e],t);return!o&&n?r:o}}function Be(e,t){return e&&(e[t]||e[(0,i._A)(t)]||e[(0,i.kC)((0,i._A)(t))])}const Ue=e=>e?dr(e)?_r(e)||e.proxy:Ue(e.parent):null,Me=(0,i.l7)(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Ue(e.parent),$root:e=>Ue(e.root),$emit:e=>e.emit,$options:e=>He(e),$forceUpdate:e=>e.f||(e.f=()=>v(e.update)),$nextTick:e=>e.n||(e.n=w.bind(e.proxy)),$watch:e=>Q.bind(e)}),je=(e,t)=>e!==i.kT&&!e.__isScriptSetup&&(0,i.RI)(e,t),Ve={get({_:e},t){const{ctx:r,setupState:s,data:o,props:a,accessCache:c,type:l,appContext:u}=e;let h;if("$"!==t[0]){const n=c[t];if(void 0!==n)switch(n){case 1:return s[t];case 2:return o[t];case 4:return r[t];case 3:return a[t]}else{if(je(s,t))return c[t]=1,s[t];if(o!==i.kT&&(0,i.RI)(o,t))return c[t]=2,o[t];if((h=e.propsOptions[0])&&(0,i.RI)(h,t))return c[t]=3,a[t];if(r!==i.kT&&(0,i.RI)(r,t))return c[t]=4,r[t];ze&&(c[t]=0)}}const d=Me[t];let f,p;return d?("$attrs"===t&&(0,n.j)(e,"get",t),d(e)):(f=l.__cssModules)&&(f=f[t])?f:r!==i.kT&&(0,i.RI)(r,t)?(c[t]=4,r[t]):(p=u.config.globalProperties,(0,i.RI)(p,t)?p[t]:void 0)},set({_:e},t,r){const{data:n,setupState:s,ctx:o}=e;return je(s,t)?(s[t]=r,!0):n!==i.kT&&(0,i.RI)(n,t)?(n[t]=r,!0):!(0,i.RI)(e.props,t)&&(("$"!==t[0]||!(t.slice(1)in e))&&(o[t]=r,!0))},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:s,propsOptions:o}},a){let c;return!!r[a]||e!==i.kT&&(0,i.RI)(e,a)||je(t,a)||(c=o[0])&&(0,i.RI)(c,a)||(0,i.RI)(n,a)||(0,i.RI)(Me,a)||(0,i.RI)(s.config.globalProperties,a)},defineProperty(e,t,r){return null!=r.get?e._.accessCache[t]=0:(0,i.RI)(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};let ze=!0;function Fe(e){const t=He(e),r=e.proxy,s=e.ctx;ze=!1,t.beforeCreate&&Ke(t.beforeCreate,e,"bc");const{data:o,computed:a,methods:c,watch:l,provide:u,inject:h,created:d,beforeMount:f,mounted:p,beforeUpdate:y,updated:g,activated:m,deactivated:w,beforeDestroy:b,beforeUnmount:v,destroyed:E,unmounted:_,render:S,renderTracked:A,renderTriggered:I,errorCaptured:C,serverPrefetch:k,expose:T,inheritAttrs:R,components:P,directives:x,filters:D}=t,O=null;if(h&&$e(h,s,O,e.appContext.config.unwrapInjectedRef),c)for(const n in c){const e=c[n];(0,i.mf)(e)&&(s[n]=e.bind(r))}if(o){0;const t=o.call(r,r);0,(0,i.Kn)(t)&&(e.data=(0,n.qj)(t))}if(ze=!0,a)for(const n in a){const e=a[n],t=(0,i.mf)(e)?e.bind(r,r):(0,i.mf)(e.get)?e.get.bind(r,r):i.dG;0;const o=!(0,i.mf)(e)&&(0,i.mf)(e.set)?e.set.bind(r):i.dG,c=Ir({get:t,set:o});Object.defineProperty(s,n,{enumerable:!0,configurable:!0,get:()=>c.value,set:e=>c.value=e})}if(l)for(const n in l)qe(l[n],s,r,n);if(u){const e=(0,i.mf)(u)?u.call(r):u;Reflect.ownKeys(e).forEach((t=>{H(t,e[t])}))}function N(e,t){(0,i.kJ)(t)?t.forEach((t=>e(t.bind(r)))):t&&e(t.bind(r))}if(d&&Ke(d,e,"c"),N(Ee,f),N(_e,p),N(Se,y),N(Ae,g),N(fe,m),N(pe,w),N(Pe,C),N(Re,A),N(Te,I),N(Ie,v),N(Ce,_),N(ke,k),(0,i.kJ)(T))if(T.length){const t=e.exposed||(e.exposed={});T.forEach((e=>{Object.defineProperty(t,e,{get:()=>r[e],set:t=>r[e]=t})}))}else e.exposed||(e.exposed={});S&&e.render===i.dG&&(e.render=S),null!=R&&(e.inheritAttrs=R),P&&(e.components=P),x&&(e.directives=x)}function $e(e,t,r=i.dG,s=!1){(0,i.kJ)(e)&&(e=Qe(e));for(const o in e){const r=e[o];let a;a=(0,i.Kn)(r)?"default"in r?G(r.from||o,r.default,!0):G(r.from||o):G(r),(0,n.dq)(a)&&s?Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:()=>a.value,set:e=>a.value=e}):t[o]=a}}function Ke(e,t,r){o((0,i.kJ)(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,r)}function qe(e,t,r,n){const s=n.includes(".")?X(r,n):()=>r[n];if((0,i.HD)(e)){const r=t[e];(0,i.mf)(r)&&Y(s,r)}else if((0,i.mf)(e))Y(s,e.bind(r));else if((0,i.Kn)(e))if((0,i.kJ)(e))e.forEach((e=>qe(e,t,r,n)));else{const n=(0,i.mf)(e.handler)?e.handler.bind(r):t[e.handler];(0,i.mf)(n)&&Y(s,n,e)}else 0}function He(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:s,optionsCache:o,config:{optionMergeStrategies:a}}=e.appContext,c=o.get(t);let l;return c?l=c:s.length||r||n?(l={},s.length&&s.forEach((e=>Ge(l,e,a,!0))),Ge(l,t,a)):l=t,(0,i.Kn)(t)&&o.set(t,l),l}function Ge(e,t,r,n=!1){const{mixins:i,extends:s}=t;s&&Ge(e,s,r,!0),i&&i.forEach((t=>Ge(e,t,r,!0)));for(const o in t)if(n&&"expose"===o);else{const n=We[o]||r&&r[o];e[o]=n?n(e[o],t[o]):t[o]}return e}const We={data:Ye,props:Ze,emits:Ze,methods:Ze,computed:Ze,beforeCreate:Xe,created:Xe,beforeMount:Xe,mounted:Xe,beforeUpdate:Xe,updated:Xe,beforeDestroy:Xe,beforeUnmount:Xe,destroyed:Xe,unmounted:Xe,activated:Xe,deactivated:Xe,errorCaptured:Xe,serverPrefetch:Xe,components:Ze,directives:Ze,watch:et,provide:Ye,inject:Je};function Ye(e,t){return t?e?function(){return(0,i.l7)((0,i.mf)(e)?e.call(this,this):e,(0,i.mf)(t)?t.call(this,this):t)}:t:e}function Je(e,t){return Ze(Qe(e),Qe(t))}function Qe(e){if((0,i.kJ)(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Xe(e,t){return e?[...new Set([].concat(e,t))]:t}function Ze(e,t){return e?(0,i.l7)((0,i.l7)(Object.create(null),e),t):t}function et(e,t){if(!e)return t;if(!t)return e;const r=(0,i.l7)(Object.create(null),e);for(const n in t)r[n]=Xe(e[n],t[n]);return r}function tt(e,t,r,s=!1){const o={},a={};(0,i.Nj)(a,Kt,1),e.propsDefaults=Object.create(null),nt(e,t,o,a);for(const n in e.propsOptions[0])n in o||(o[n]=void 0);r?e.props=s?o:(0,n.Um)(o):e.type.props?e.props=o:e.props=a,e.attrs=a}function rt(e,t,r,s){const{props:o,attrs:a,vnode:{patchFlag:c}}=e,l=(0,n.IU)(o),[u]=e.propsOptions;let h=!1;if(!(s||c>0)||16&c){let n;nt(e,t,o,a)&&(h=!0);for(const s in l)t&&((0,i.RI)(t,s)||(n=(0,i.rs)(s))!==s&&(0,i.RI)(t,n))||(u?!r||void 0===r[s]&&void 0===r[n]||(o[s]=it(u,l,s,void 0,e,!0)):delete o[s]);if(a!==l)for(const e in a)t&&(0,i.RI)(t,e)||(delete a[e],h=!0)}else if(8&c){const r=e.vnode.dynamicProps;for(let n=0;n<r.length;n++){let s=r[n];if(x(e.emitsOptions,s))continue;const c=t[s];if(u)if((0,i.RI)(a,s))c!==a[s]&&(a[s]=c,h=!0);else{const t=(0,i._A)(s);o[t]=it(u,l,t,c,e,!1)}else c!==a[s]&&(a[s]=c,h=!0)}}h&&(0,n.X$)(e,"set","$attrs")}function nt(e,t,r,s){const[o,a]=e.propsOptions;let c,l=!1;if(t)for(let n in t){if((0,i.Gg)(n))continue;const u=t[n];let h;o&&(0,i.RI)(o,h=(0,i._A)(n))?a&&a.includes(h)?(c||(c={}))[h]=u:r[h]=u:x(e.emitsOptions,n)||n in s&&u===s[n]||(s[n]=u,l=!0)}if(a){const t=(0,n.IU)(r),s=c||i.kT;for(let n=0;n<a.length;n++){const c=a[n];r[c]=it(o,t,c,s[c],e,!(0,i.RI)(s,c))}}return l}function it(e,t,r,n,s,o){const a=e[r];if(null!=a){const e=(0,i.RI)(a,"default");if(e&&void 0===n){const e=a.default;if(a.type!==Function&&(0,i.mf)(e)){const{propsDefaults:i}=s;r in i?n=i[r]:(ur(s),n=i[r]=e.call(null,t),hr())}else n=e}a[0]&&(o&&!e?n=!1:!a[1]||""!==n&&n!==(0,i.rs)(r)||(n=!0))}return n}function st(e,t,r=!1){const n=t.propsCache,s=n.get(e);if(s)return s;const o=e.props,a={},c=[];let l=!1;if(!(0,i.mf)(e)){const n=e=>{l=!0;const[r,n]=st(e,t,!0);(0,i.l7)(a,r),n&&c.push(...n)};!r&&t.mixins.length&&t.mixins.forEach(n),e.extends&&n(e.extends),e.mixins&&e.mixins.forEach(n)}if(!o&&!l)return(0,i.Kn)(e)&&n.set(e,i.Z6),i.Z6;if((0,i.kJ)(o))for(let h=0;h<o.length;h++){0;const e=(0,i._A)(o[h]);ot(e)&&(a[e]=i.kT)}else if(o){0;for(const e in o){const t=(0,i._A)(e);if(ot(t)){const r=o[e],n=a[t]=(0,i.kJ)(r)||(0,i.mf)(r)?{type:r}:Object.assign({},r);if(n){const e=lt(Boolean,n.type),r=lt(String,n.type);n[0]=e>-1,n[1]=r<0||e<r,(e>-1||(0,i.RI)(n,"default"))&&c.push(t)}}}}const u=[a,c];return(0,i.Kn)(e)&&n.set(e,u),u}function ot(e){return"$"!==e[0]}function at(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:null===e?"null":""}function ct(e,t){return at(e)===at(t)}function lt(e,t){return(0,i.kJ)(t)?t.findIndex((t=>ct(t,e))):(0,i.mf)(t)&&ct(t,e)?0:-1}const ut=e=>"_"===e[0]||"$stable"===e,ht=e=>(0,i.kJ)(e)?e.map(er):[er(e)],dt=(e,t,r)=>{if(t._n)return t;const n=U(((...e)=>ht(t(...e))),r);return n._c=!1,n},ft=(e,t,r)=>{const n=e._ctx;for(const s in e){if(ut(s))continue;const r=e[s];if((0,i.mf)(r))t[s]=dt(s,r,n);else if(null!=r){0;const e=ht(r);t[s]=()=>e}}},pt=(e,t)=>{const r=ht(t);e.slots.default=()=>r},yt=(e,t)=>{if(32&e.vnode.shapeFlag){const r=t._;r?(e.slots=(0,n.IU)(t),(0,i.Nj)(t,"_",r)):ft(t,e.slots={})}else e.slots={},t&&pt(e,t);(0,i.Nj)(e.slots,Kt,1)},gt=(e,t,r)=>{const{vnode:n,slots:s}=e;let o=!0,a=i.kT;if(32&n.shapeFlag){const e=t._;e?r&&1===e?o=!1:((0,i.l7)(s,t),r||1!==e||delete s._):(o=!t.$stable,ft(t,s)),a=t}else t&&(pt(e,t),a={default:1});if(o)for(const i in s)ut(i)||i in a||delete s[i]};function mt(){return{app:null,config:{isNativeTag:i.NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let wt=0;function bt(e,t){return function(r,n=null){(0,i.mf)(r)||(r=Object.assign({},r)),null==n||(0,i.Kn)(n)||(n=null);const s=mt(),o=new Set;let a=!1;const c=s.app={_uid:wt++,_component:r,_props:n,_container:null,_context:s,_instance:null,version:Rr,get config(){return s.config},set config(e){0},use(e,...t){return o.has(e)||(e&&(0,i.mf)(e.install)?(o.add(e),e.install(c,...t)):(0,i.mf)(e)&&(o.add(e),e(c,...t))),c},mixin(e){return s.mixins.includes(e)||s.mixins.push(e),c},component(e,t){return t?(s.components[e]=t,c):s.components[e]},directive(e,t){return t?(s.directives[e]=t,c):s.directives[e]},mount(i,o,l){if(!a){0;const u=Wt(r,n);return u.appContext=s,o&&t?t(u,i):e(u,i,l),a=!0,c._container=i,i.__vue_app__=c,_r(u.component)||u.component.proxy}},unmount(){a&&(e(null,c._container),delete c._container.__vue_app__)},provide(e,t){return s.provides[e]=t,c}};return c}}function vt(e,t,r,o,a=!1){if((0,i.kJ)(e))return void e.forEach(((e,n)=>vt(e,t&&((0,i.kJ)(t)?t[n]:t),r,o,a)));if(ue(o)&&!a)return;const c=4&o.shapeFlag?_r(o.component)||o.component.proxy:o.el,l=a?null:c,{i:u,r:h}=e;const d=t&&t.r,f=u.refs===i.kT?u.refs={}:u.refs,p=u.setupState;if(null!=d&&d!==h&&((0,i.HD)(d)?(f[d]=null,(0,i.RI)(p,d)&&(p[d]=null)):(0,n.dq)(d)&&(d.value=null)),(0,i.mf)(h))s(h,u,12,[l,f]);else{const t=(0,i.HD)(h),s=(0,n.dq)(h);if(t||s){const n=()=>{if(e.f){const r=t?(0,i.RI)(p,h)?p[h]:f[h]:h.value;a?(0,i.kJ)(r)&&(0,i.Od)(r,c):(0,i.kJ)(r)?r.includes(c)||r.push(c):t?(f[h]=[c],(0,i.RI)(p,h)&&(p[h]=f[h])):(h.value=[c],e.k&&(f[e.k]=h.value))}else t?(f[h]=l,(0,i.RI)(p,h)&&(p[h]=l)):s&&(h.value=l,e.k&&(f[e.k]=l))};l?(n.id=-1,_t(n,r)):n()}else 0}}function Et(){}const _t=q;function St(e){return At(e)}function At(e,t){Et();const r=(0,i.E9)();r.__VUE__=!0;const{insert:s,remove:o,patchProp:a,createElement:c,createText:l,createComment:u,setText:h,setElementText:d,parentNode:f,nextSibling:p,setScopeId:y=i.dG,insertStaticContent:g}=e,m=(e,t,r,n=null,i=null,s=null,o=!1,a=null,c=!!t.dynamicChildren)=>{if(e===t)return;e&&!$t(e,t)&&(n=X(e),G(e,i,s,!0),e=null),-2===t.patchFlag&&(c=!1,t.dynamicChildren=null);const{type:l,ref:u,shapeFlag:h}=t;switch(l){case Pt:w(e,t,r,n);break;case xt:b(e,t,r,n);break;case Dt:null==e&&E(t,r,n,o);break;case Rt:N(e,t,r,n,i,s,o,a,c);break;default:1&h?k(e,t,r,n,i,s,o,a,c):6&h?L(e,t,r,n,i,s,o,a,c):(64&h||128&h)&&l.process(e,t,r,n,i,s,o,a,c,ee)}null!=u&&i&&vt(u,e&&e.ref,s,t||e,!t)},w=(e,t,r,n)=>{if(null==e)s(t.el=l(t.children),r,n);else{const r=t.el=e.el;t.children!==e.children&&h(r,t.children)}},b=(e,t,r,n)=>{null==e?s(t.el=u(t.children||""),r,n):t.el=e.el},E=(e,t,r,n)=>{[e.el,e.anchor]=g(e.children,t,r,n,e.el,e.anchor)},S=({el:e,anchor:t},r,n)=>{let i;while(e&&e!==t)i=p(e),s(e,r,n),e=i;s(t,r,n)},C=({el:e,anchor:t})=>{let r;while(e&&e!==t)r=p(e),o(e),e=r;o(t)},k=(e,t,r,n,i,s,o,a,c)=>{o=o||"svg"===t.type,null==e?T(t,r,n,i,s,o,a,c):x(e,t,i,s,o,a,c)},T=(e,t,r,n,o,l,u,h)=>{let f,p;const{type:y,props:g,shapeFlag:m,transition:w,dirs:b}=e;if(f=e.el=c(e.type,l,g&&g.is,g),8&m?d(f,e.children):16&m&&P(e.children,f,null,n,o,l&&"foreignObject"!==y,u,h),b&&xe(e,null,n,"created"),g){for(const t in g)"value"===t||(0,i.Gg)(t)||a(f,t,null,g[t],l,e.children,n,o,Q);"value"in g&&a(f,"value",null,g.value),(p=g.onVnodeBeforeMount)&&ir(p,n,e)}R(f,e,e.scopeId,u,n),b&&xe(e,null,n,"beforeMount");const v=(!o||o&&!o.pendingBranch)&&w&&!w.persisted;v&&w.beforeEnter(f),s(f,t,r),((p=g&&g.onVnodeMounted)||v||b)&&_t((()=>{p&&ir(p,n,e),v&&w.enter(f),b&&xe(e,null,n,"mounted")}),o)},R=(e,t,r,n,i)=>{if(r&&y(e,r),n)for(let s=0;s<n.length;s++)y(e,n[s]);if(i){let r=i.subTree;if(t===r){const t=i.vnode;R(e,t,t.scopeId,t.slotScopeIds,i.parent)}}},P=(e,t,r,n,i,s,o,a,c=0)=>{for(let l=c;l<e.length;l++){const c=e[l]=a?tr(e[l]):er(e[l]);m(null,c,t,r,n,i,s,o,a)}},x=(e,t,r,n,s,o,c)=>{const l=t.el=e.el;let{patchFlag:u,dynamicChildren:h,dirs:f}=t;u|=16&e.patchFlag;const p=e.props||i.kT,y=t.props||i.kT;let g;r&&It(r,!1),(g=y.onVnodeBeforeUpdate)&&ir(g,r,t,e),f&&xe(t,e,r,"beforeUpdate"),r&&It(r,!0);const m=s&&"foreignObject"!==t.type;if(h?D(e.dynamicChildren,h,l,r,n,m,o):c||F(e,t,l,null,r,n,m,o,!1),u>0){if(16&u)O(l,t,p,y,r,n,s);else if(2&u&&p.class!==y.class&&a(l,"class",null,y.class,s),4&u&&a(l,"style",p.style,y.style,s),8&u){const i=t.dynamicProps;for(let t=0;t<i.length;t++){const o=i[t],c=p[o],u=y[o];u===c&&"value"!==o||a(l,o,c,u,s,e.children,r,n,Q)}}1&u&&e.children!==t.children&&d(l,t.children)}else c||null!=h||O(l,t,p,y,r,n,s);((g=y.onVnodeUpdated)||f)&&_t((()=>{g&&ir(g,r,t,e),f&&xe(t,e,r,"updated")}),n)},D=(e,t,r,n,i,s,o)=>{for(let a=0;a<t.length;a++){const c=e[a],l=t[a],u=c.el&&(c.type===Rt||!$t(c,l)||70&c.shapeFlag)?f(c.el):r;m(c,l,u,null,n,i,s,o,!0)}},O=(e,t,r,n,s,o,c)=>{if(r!==n){if(r!==i.kT)for(const l in r)(0,i.Gg)(l)||l in n||a(e,l,r[l],null,c,t.children,s,o,Q);for(const l in n){if((0,i.Gg)(l))continue;const u=n[l],h=r[l];u!==h&&"value"!==l&&a(e,l,h,u,c,t.children,s,o,Q)}"value"in n&&a(e,"value",r.value,n.value)}},N=(e,t,r,n,i,o,a,c,u)=>{const h=t.el=e?e.el:l(""),d=t.anchor=e?e.anchor:l("");let{patchFlag:f,dynamicChildren:p,slotScopeIds:y}=t;y&&(c=c?c.concat(y):y),null==e?(s(h,r,n),s(d,r,n),P(t.children,r,d,i,o,a,c,u)):f>0&&64&f&&p&&e.dynamicChildren?(D(e.dynamicChildren,p,r,i,o,a,c),(null!=t.key||i&&t===i.subTree)&&Ct(e,t,!0)):F(e,t,r,d,i,o,a,c,u)},L=(e,t,r,n,i,s,o,a,c)=>{t.slotScopeIds=a,null==e?512&t.shapeFlag?i.ctx.activate(t,r,n,o,c):B(t,r,n,i,s,o,c):U(e,t,c)},B=(e,t,r,n,i,s,o)=>{const a=e.component=ar(e,n,i);if(he(e)&&(a.ctx.renderer=ee),gr(a),a.asyncDep){if(i&&i.registerDep(a,j),!e.el){const e=a.subTree=Wt(xt);b(null,e,t,r)}}else j(a,e,t,r,i,s,o)},U=(e,t,r)=>{const n=t.component=e.component;if(z(e,t,r)){if(n.asyncDep&&!n.asyncResolved)return void V(n,t,r);n.next=t,_(n.update),n.update()}else t.el=e.el,n.vnode=t},j=(e,t,r,s,o,a,c)=>{const l=()=>{if(e.isMounted){let t,{next:r,bu:n,u:s,parent:l,vnode:u}=e,h=r;0,It(e,!1),r?(r.el=u.el,V(e,r,c)):r=u,n&&(0,i.ir)(n),(t=r.props&&r.props.onVnodeBeforeUpdate)&&ir(t,l,r,u),It(e,!0);const d=M(e);0;const p=e.subTree;e.subTree=d,m(p,d,f(p.el),X(p),e,o,a),r.el=d.el,null===h&&$(e,d.el),s&&_t(s,o),(t=r.props&&r.props.onVnodeUpdated)&&_t((()=>ir(t,l,r,u)),o)}else{let n;const{el:c,props:l}=t,{bm:u,m:h,parent:d}=e,f=ue(t);if(It(e,!1),u&&(0,i.ir)(u),!f&&(n=l&&l.onVnodeBeforeMount)&&ir(n,d,t),It(e,!0),c&&re){const r=()=>{e.subTree=M(e),re(c,e.subTree,e,o,null)};f?t.type.__asyncLoader().then((()=>!e.isUnmounted&&r())):r()}else{0;const n=e.subTree=M(e);0,m(null,n,r,s,e,o,a),t.el=n.el}if(h&&_t(h,o),!f&&(n=l&&l.onVnodeMounted)){const e=t;_t((()=>ir(n,d,e)),o)}(256&t.shapeFlag||d&&ue(d.vnode)&&256&d.vnode.shapeFlag)&&e.a&&_t(e.a,o),e.isMounted=!0,t=r=s=null}},u=e.effect=new n.qq(l,(()=>v(h)),e.scope),h=e.update=()=>u.run();h.id=e.uid,It(e,!0),h()},V=(e,t,r)=>{t.component=e;const i=e.vnode.props;e.vnode=t,e.next=null,rt(e,t.props,i,r),gt(e,t.children,r),(0,n.Jd)(),A(),(0,n.lk)()},F=(e,t,r,n,i,s,o,a,c=!1)=>{const l=e&&e.children,u=e?e.shapeFlag:0,h=t.children,{patchFlag:f,shapeFlag:p}=t;if(f>0){if(128&f)return void q(l,h,r,n,i,s,o,a,c);if(256&f)return void K(l,h,r,n,i,s,o,a,c)}8&p?(16&u&&Q(l,i,s),h!==l&&d(r,h)):16&u?16&p?q(l,h,r,n,i,s,o,a,c):Q(l,i,s,!0):(8&u&&d(r,""),16&p&&P(h,r,n,i,s,o,a,c))},K=(e,t,r,n,s,o,a,c,l)=>{e=e||i.Z6,t=t||i.Z6;const u=e.length,h=t.length,d=Math.min(u,h);let f;for(f=0;f<d;f++){const n=t[f]=l?tr(t[f]):er(t[f]);m(e[f],n,r,null,s,o,a,c,l)}u>h?Q(e,s,o,!0,!1,d):P(t,r,n,s,o,a,c,l,d)},q=(e,t,r,n,s,o,a,c,l)=>{let u=0;const h=t.length;let d=e.length-1,f=h-1;while(u<=d&&u<=f){const n=e[u],i=t[u]=l?tr(t[u]):er(t[u]);if(!$t(n,i))break;m(n,i,r,null,s,o,a,c,l),u++}while(u<=d&&u<=f){const n=e[d],i=t[f]=l?tr(t[f]):er(t[f]);if(!$t(n,i))break;m(n,i,r,null,s,o,a,c,l),d--,f--}if(u>d){if(u<=f){const e=f+1,i=e<h?t[e].el:n;while(u<=f)m(null,t[u]=l?tr(t[u]):er(t[u]),r,i,s,o,a,c,l),u++}}else if(u>f)while(u<=d)G(e[u],s,o,!0),u++;else{const p=u,y=u,g=new Map;for(u=y;u<=f;u++){const e=t[u]=l?tr(t[u]):er(t[u]);null!=e.key&&g.set(e.key,u)}let w,b=0;const v=f-y+1;let E=!1,_=0;const S=new Array(v);for(u=0;u<v;u++)S[u]=0;for(u=p;u<=d;u++){const n=e[u];if(b>=v){G(n,s,o,!0);continue}let i;if(null!=n.key)i=g.get(n.key);else for(w=y;w<=f;w++)if(0===S[w-y]&&$t(n,t[w])){i=w;break}void 0===i?G(n,s,o,!0):(S[i-y]=u+1,i>=_?_=i:E=!0,m(n,t[i],r,null,s,o,a,c,l),b++)}const A=E?kt(S):i.Z6;for(w=A.length-1,u=v-1;u>=0;u--){const e=y+u,i=t[e],d=e+1<h?t[e+1].el:n;0===S[u]?m(null,i,r,d,s,o,a,c,l):E&&(w<0||u!==A[w]?H(i,r,d,2):w--)}}},H=(e,t,r,n,i=null)=>{const{el:o,type:a,transition:c,children:l,shapeFlag:u}=e;if(6&u)return void H(e.component.subTree,t,r,n);if(128&u)return void e.suspense.move(t,r,n);if(64&u)return void a.move(e,t,r,ee);if(a===Rt){s(o,t,r);for(let e=0;e<l.length;e++)H(l[e],t,r,n);return void s(e.anchor,t,r)}if(a===Dt)return void S(e,t,r);const h=2!==n&&1&u&&c;if(h)if(0===n)c.beforeEnter(o),s(o,t,r),_t((()=>c.enter(o)),i);else{const{leave:e,delayLeave:n,afterLeave:i}=c,a=()=>s(o,t,r),l=()=>{e(o,(()=>{a(),i&&i()}))};n?n(o,a,l):l()}else s(o,t,r)},G=(e,t,r,n=!1,i=!1)=>{const{type:s,props:o,ref:a,children:c,dynamicChildren:l,shapeFlag:u,patchFlag:h,dirs:d}=e;if(null!=a&&vt(a,null,r,e,!0),256&u)return void t.ctx.deactivate(e);const f=1&u&&d,p=!ue(e);let y;if(p&&(y=o&&o.onVnodeBeforeUnmount)&&ir(y,t,e),6&u)J(e.component,r,n);else{if(128&u)return void e.suspense.unmount(r,n);f&&xe(e,null,t,"beforeUnmount"),64&u?e.type.remove(e,t,r,i,ee,n):l&&(s!==Rt||h>0&&64&h)?Q(l,t,r,!1,!0):(s===Rt&&384&h||!i&&16&u)&&Q(c,t,r),n&&W(e)}(p&&(y=o&&o.onVnodeUnmounted)||f)&&_t((()=>{y&&ir(y,t,e),f&&xe(e,null,t,"unmounted")}),r)},W=e=>{const{type:t,el:r,anchor:n,transition:i}=e;if(t===Rt)return void Y(r,n);if(t===Dt)return void C(e);const s=()=>{o(r),i&&!i.persisted&&i.afterLeave&&i.afterLeave()};if(1&e.shapeFlag&&i&&!i.persisted){const{leave:t,delayLeave:n}=i,o=()=>t(r,s);n?n(e.el,s,o):o()}else s()},Y=(e,t)=>{let r;while(e!==t)r=p(e),o(e),e=r;o(t)},J=(e,t,r)=>{const{bum:n,scope:s,update:o,subTree:a,um:c}=e;n&&(0,i.ir)(n),s.stop(),o&&(o.active=!1,G(a,e,t,r)),c&&_t(c,t),_t((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},Q=(e,t,r,n=!1,i=!1,s=0)=>{for(let o=s;o<e.length;o++)G(e[o],t,r,n,i)},X=e=>6&e.shapeFlag?X(e.component.subTree):128&e.shapeFlag?e.suspense.next():p(e.anchor||e.el),Z=(e,t,r)=>{null==e?t._vnode&&G(t._vnode,null,null,!0):m(t._vnode||null,e,t,null,null,null,r),A(),I(),t._vnode=e},ee={p:m,um:G,m:H,r:W,mt:B,mc:P,pc:F,pbc:D,n:X,o:e};let te,re;return t&&([te,re]=t(ee)),{render:Z,hydrate:te,createApp:bt(Z,te)}}function It({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function Ct(e,t,r=!1){const n=e.children,s=t.children;if((0,i.kJ)(n)&&(0,i.kJ)(s))for(let i=0;i<n.length;i++){const e=n[i];let t=s[i];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=s[i]=tr(s[i]),t.el=e.el),r||Ct(e,t)),t.type===Pt&&(t.el=e.el)}}function kt(e){const t=e.slice(),r=[0];let n,i,s,o,a;const c=e.length;for(n=0;n<c;n++){const c=e[n];if(0!==c){if(i=r[r.length-1],e[i]<c){t[n]=i,r.push(n);continue}s=0,o=r.length-1;while(s<o)a=s+o>>1,e[r[a]]<c?s=a+1:o=a;c<e[r[s]]&&(s>0&&(t[n]=r[s-1]),r[s]=n)}}s=r.length,o=r[s-1];while(s-- >0)r[s]=o,o=t[o];return r}const Tt=e=>e.__isTeleport;const Rt=Symbol(void 0),Pt=Symbol(void 0),xt=Symbol(void 0),Dt=Symbol(void 0),Ot=[];let Nt=null;function Lt(e=!1){Ot.push(Nt=e?null:[])}function Bt(){Ot.pop(),Nt=Ot[Ot.length-1]||null}let Ut=1;function Mt(e){Ut+=e}function jt(e){return e.dynamicChildren=Ut>0?Nt||i.Z6:null,Bt(),Ut>0&&Nt&&Nt.push(e),e}function Vt(e,t,r,n,i,s){return jt(Gt(e,t,r,n,i,s,!0))}function zt(e,t,r,n,i){return jt(Wt(e,t,r,n,i,!0))}function Ft(e){return!!e&&!0===e.__v_isVNode}function $t(e,t){return e.type===t.type&&e.key===t.key}const Kt="__vInternal",qt=({key:e})=>null!=e?e:null,Ht=({ref:e,ref_key:t,ref_for:r})=>null!=e?(0,i.HD)(e)||(0,n.dq)(e)||(0,i.mf)(e)?{i:D,r:e,k:t,f:!!r}:e:null;function Gt(e,t=null,r=null,n=0,s=null,o=(e===Rt?0:1),a=!1,c=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&qt(t),ref:t&&Ht(t),scopeId:O,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:D};return c?(rr(l,r),128&o&&e.normalize(l)):r&&(l.shapeFlag|=(0,i.HD)(r)?8:16),Ut>0&&!a&&Nt&&(l.patchFlag>0||6&o)&&32!==l.patchFlag&&Nt.push(l),l}const Wt=Yt;function Yt(e,t=null,r=null,s=0,o=null,a=!1){if(e&&e!==Ne||(e=xt),Ft(e)){const n=Qt(e,t,!0);return r&&rr(n,r),Ut>0&&!a&&Nt&&(6&n.shapeFlag?Nt[Nt.indexOf(e)]=n:Nt.push(n)),n.patchFlag|=-2,n}if(Ar(e)&&(e=e.__vccOpts),t){t=Jt(t);let{class:e,style:r}=t;e&&!(0,i.HD)(e)&&(t.class=(0,i.C_)(e)),(0,i.Kn)(r)&&((0,n.X3)(r)&&!(0,i.kJ)(r)&&(r=(0,i.l7)({},r)),t.style=(0,i.j5)(r))}const c=(0,i.HD)(e)?1:K(e)?128:Tt(e)?64:(0,i.Kn)(e)?4:(0,i.mf)(e)?2:0;return Gt(e,t,r,s,o,c,a,!0)}function Jt(e){return e?(0,n.X3)(e)||Kt in e?(0,i.l7)({},e):e:null}function Qt(e,t,r=!1){const{props:n,ref:s,patchFlag:o,children:a}=e,c=t?nr(n||{},t):n,l={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&qt(c),ref:t&&t.ref?r&&s?(0,i.kJ)(s)?s.concat(Ht(t)):[s,Ht(t)]:Ht(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Rt?-1===o?16:16|o:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Qt(e.ssContent),ssFallback:e.ssFallback&&Qt(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx};return l}function Xt(e=" ",t=0){return Wt(Pt,null,e,t)}function Zt(e="",t=!1){return t?(Lt(),zt(xt,null,e)):Wt(xt,null,e)}function er(e){return null==e||"boolean"===typeof e?Wt(xt):(0,i.kJ)(e)?Wt(Rt,null,e.slice()):"object"===typeof e?tr(e):Wt(Pt,null,String(e))}function tr(e){return null===e.el&&-1!==e.patchFlag||e.memo?e:Qt(e)}function rr(e,t){let r=0;const{shapeFlag:n}=e;if(null==t)t=null;else if((0,i.kJ)(t))r=16;else if("object"===typeof t){if(65&n){const r=t.default;return void(r&&(r._c&&(r._d=!1),rr(e,r()),r._c&&(r._d=!0)))}{r=32;const n=t._;n||Kt in t?3===n&&D&&(1===D.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=D}}else(0,i.mf)(t)?(t={default:t,_ctx:D},r=32):(t=String(t),64&n?(r=16,t=[Xt(t)]):r=8);e.children=t,e.shapeFlag|=r}function nr(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const e in n)if("class"===e)t.class!==n.class&&(t.class=(0,i.C_)([t.class,n.class]));else if("style"===e)t.style=(0,i.j5)([t.style,n.style]);else if((0,i.F7)(e)){const r=t[e],s=n[e];!s||r===s||(0,i.kJ)(r)&&r.includes(s)||(t[e]=r?[].concat(r,s):s)}else""!==e&&(t[e]=n[e])}return t}function ir(e,t,r,n=null){o(e,t,7,[r,n])}const sr=mt();let or=0;function ar(e,t,r){const s=e.type,o=(t?t.appContext:e.appContext)||sr,a={uid:or++,vnode:e,type:s,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new n.Bj(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:st(s,o),emitsOptions:P(s,o),emit:null,emitted:null,propsDefaults:i.kT,inheritAttrs:s.inheritAttrs,ctx:i.kT,data:i.kT,props:i.kT,attrs:i.kT,slots:i.kT,refs:i.kT,setupState:i.kT,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=R.bind(null,a),e.ce&&e.ce(a),a}let cr=null;const lr=()=>cr||D,ur=e=>{cr=e,e.scope.on()},hr=()=>{cr&&cr.scope.off(),cr=null};function dr(e){return 4&e.vnode.shapeFlag}let fr,pr,yr=!1;function gr(e,t=!1){yr=t;const{props:r,children:n}=e.vnode,i=dr(e);tt(e,r,i,t),yt(e,n);const s=i?mr(e,t):void 0;return yr=!1,s}function mr(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=(0,n.Xl)(new Proxy(e.ctx,Ve));const{setup:o}=r;if(o){const r=e.setupContext=o.length>1?Er(e):null;ur(e),(0,n.Jd)();const c=s(o,e,0,[e.props,r]);if((0,n.lk)(),hr(),(0,i.tI)(c)){if(c.then(hr,hr),t)return c.then((r=>{wr(e,r,t)})).catch((t=>{a(t,e,0)}));e.asyncDep=c}else wr(e,c,t)}else br(e,t)}function wr(e,t,r){(0,i.mf)(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:(0,i.Kn)(t)&&(e.setupState=(0,n.WL)(t)),br(e,r)}function br(e,t,r){const s=e.type;if(!e.render){if(!t&&fr&&!s.render){const t=s.template||He(e).template;if(t){0;const{isCustomElement:r,compilerOptions:n}=e.appContext.config,{delimiters:o,compilerOptions:a}=s,c=(0,i.l7)((0,i.l7)({isCustomElement:r,delimiters:o},n),a);s.render=fr(t,c)}}e.render=s.render||i.dG,pr&&pr(e)}ur(e),(0,n.Jd)(),Fe(e),(0,n.lk)(),hr()}function vr(e){return new Proxy(e.attrs,{get(t,r){return(0,n.j)(e,"get","$attrs"),t[r]}})}function Er(e){const t=t=>{e.exposed=t||{}};let r;return{get attrs(){return r||(r=vr(e))},slots:e.slots,emit:e.emit,expose:t}}function _r(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy((0,n.WL)((0,n.Xl)(e.exposed)),{get(t,r){return r in t?t[r]:r in Me?Me[r](e):void 0},has(e,t){return t in e||t in Me}}))}function Sr(e,t=!0){return(0,i.mf)(e)?e.displayName||e.name:e.name||t&&e.__name}function Ar(e){return(0,i.mf)(e)&&"__vccOpts"in e}const Ir=(e,t)=>(0,n.Fl)(e,t,yr);function Cr(e,t,r){const n=arguments.length;return 2===n?(0,i.Kn)(t)&&!(0,i.kJ)(t)?Ft(t)?Wt(e,null,[t]):Wt(e,t):Wt(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):3===n&&Ft(r)&&(r=[r]),Wt(e,t,r))}const kr=Symbol(""),Tr=()=>{{const e=G(kr);return e}};const Rr="3.2.45"},9963:function(e,t,r){"use strict";r.d(t,{ri:function(){return Z}});var n=r(3577),i=r(6252);r(2262);const s="http://www.w3.org/2000/svg",o="undefined"!==typeof document?document:null,a=o&&o.createElement("template"),c={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const i=t?o.createElementNS(s,e):o.createElement(e,r?{is:r}:void 0);return"select"===e&&n&&null!=n.multiple&&i.setAttribute("multiple",n.multiple),i},createText:e=>o.createTextNode(e),createComment:e=>o.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>o.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,n,i,s){const o=r?r.previousSibling:t.lastChild;if(i&&(i===s||i.nextSibling)){while(1)if(t.insertBefore(i.cloneNode(!0),r),i===s||!(i=i.nextSibling))break}else{a.innerHTML=n?`<svg>${e}</svg>`:e;const i=a.content;if(n){const e=i.firstChild;while(e.firstChild)i.appendChild(e.firstChild);i.removeChild(e)}t.insertBefore(i,r)}return[o?o.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function l(e,t,r){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),null==t?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function u(e,t,r){const i=e.style,s=(0,n.HD)(r);if(r&&!s){for(const e in r)d(i,e,r[e]);if(t&&!(0,n.HD)(t))for(const e in t)null==r[e]&&d(i,e,"")}else{const n=i.display;s?t!==r&&(i.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(i.display=n)}}const h=/\s*!important$/;function d(e,t,r){if((0,n.kJ)(r))r.forEach((r=>d(e,t,r)));else if(null==r&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const i=y(e,t);h.test(r)?e.setProperty((0,n.rs)(i),r.replace(h,""),"important"):e[i]=r}}const f=["Webkit","Moz","ms"],p={};function y(e,t){const r=p[t];if(r)return r;let i=(0,n._A)(t);if("filter"!==i&&i in e)return p[t]=i;i=(0,n.kC)(i);for(let n=0;n<f.length;n++){const r=f[n]+i;if(r in e)return p[t]=r}return t}const g="http://www.w3.org/1999/xlink";function m(e,t,r,i,s){if(i&&t.startsWith("xlink:"))null==r?e.removeAttributeNS(g,t.slice(6,t.length)):e.setAttributeNS(g,t,r);else{const i=(0,n.Pq)(t);null==r||i&&!(0,n.yA)(r)?e.removeAttribute(t):e.setAttribute(t,i?"":r)}}function w(e,t,r,i,s,o,a){if("innerHTML"===t||"textContent"===t)return i&&a(i,s,o),void(e[t]=null==r?"":r);if("value"===t&&"PROGRESS"!==e.tagName&&!e.tagName.includes("-")){e._value=r;const n=null==r?"":r;return e.value===n&&"OPTION"!==e.tagName||(e.value=n),void(null==r&&e.removeAttribute(t))}let c=!1;if(""===r||null==r){const i=typeof e[t];"boolean"===i?r=(0,n.yA)(r):null==r&&"string"===i?(r="",c=!0):"number"===i&&(r=0,c=!0)}try{e[t]=r}catch(l){0}c&&e.removeAttribute(t)}function b(e,t,r,n){e.addEventListener(t,r,n)}function v(e,t,r,n){e.removeEventListener(t,r,n)}function E(e,t,r,n,i=null){const s=e._vei||(e._vei={}),o=s[t];if(n&&o)o.value=n;else{const[r,a]=S(t);if(n){const o=s[t]=k(n,i);b(e,r,o,a)}else o&&(v(e,r,o,a),s[t]=void 0)}}const _=/(?:Once|Passive|Capture)$/;function S(e){let t;if(_.test(e)){let r;t={};while(r=e.match(_))e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}const r=":"===e[2]?e.slice(3):(0,n.rs)(e.slice(2));return[r,t]}let A=0;const I=Promise.resolve(),C=()=>A||(I.then((()=>A=0)),A=Date.now());function k(e,t){const r=e=>{if(e._vts){if(e._vts<=r.attached)return}else e._vts=Date.now();(0,i.$d)(T(e,r.value),t,5,[e])};return r.value=e,r.attached=C(),r}function T(e,t){if((0,n.kJ)(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}const R=/^on[a-z]/,P=(e,t,r,i,s=!1,o,a,c,h)=>{"class"===t?l(e,i,s):"style"===t?u(e,r,i):(0,n.F7)(t)?(0,n.tR)(t)||E(e,t,r,i,a):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):x(e,t,i,s))?w(e,t,i,o,a,c,h):("true-value"===t?e._trueValue=i:"false-value"===t&&(e._falseValue=i),m(e,t,i,s))};function x(e,t,r,i){return i?"innerHTML"===t||"textContent"===t||!!(t in e&&R.test(t)&&(0,n.mf)(r)):"spellcheck"!==t&&"draggable"!==t&&"translate"!==t&&("form"!==t&&(("list"!==t||"INPUT"!==e.tagName)&&(("type"!==t||"TEXTAREA"!==e.tagName)&&((!R.test(t)||!(0,n.HD)(r))&&t in e))))}"undefined"!==typeof HTMLElement&&HTMLElement;const D="transition",O="animation",N=(e,{slots:t})=>(0,i.h)(i.P$,M(e),t);N.displayName="Transition";const L={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},B=(N.props=(0,n.l7)({},i.P$.props,L),(e,t=[])=>{(0,n.kJ)(e)?e.forEach((e=>e(...t))):e&&e(...t)}),U=e=>!!e&&((0,n.kJ)(e)?e.some((e=>e.length>1)):e.length>1);function M(e){const t={};for(const n in e)n in L||(t[n]=e[n]);if(!1===e.css)return t;const{name:r="v",type:i,duration:s,enterFromClass:o=`${r}-enter-from`,enterActiveClass:a=`${r}-enter-active`,enterToClass:c=`${r}-enter-to`,appearFromClass:l=o,appearActiveClass:u=a,appearToClass:h=c,leaveFromClass:d=`${r}-leave-from`,leaveActiveClass:f=`${r}-leave-active`,leaveToClass:p=`${r}-leave-to`}=e,y=j(s),g=y&&y[0],m=y&&y[1],{onBeforeEnter:w,onEnter:b,onEnterCancelled:v,onLeave:E,onLeaveCancelled:_,onBeforeAppear:S=w,onAppear:A=b,onAppearCancelled:I=v}=t,C=(e,t,r)=>{F(e,t?h:c),F(e,t?u:a),r&&r()},k=(e,t)=>{e._isLeaving=!1,F(e,d),F(e,p),F(e,f),t&&t()},T=e=>(t,r)=>{const n=e?A:b,s=()=>C(t,e,r);B(n,[t,s]),$((()=>{F(t,e?l:o),z(t,e?h:c),U(n)||q(t,i,g,s)}))};return(0,n.l7)(t,{onBeforeEnter(e){B(w,[e]),z(e,o),z(e,a)},onBeforeAppear(e){B(S,[e]),z(e,l),z(e,u)},onEnter:T(!1),onAppear:T(!0),onLeave(e,t){e._isLeaving=!0;const r=()=>k(e,t);z(e,d),Y(),z(e,f),$((()=>{e._isLeaving&&(F(e,d),z(e,p),U(E)||q(e,i,m,r))})),B(E,[e,r])},onEnterCancelled(e){C(e,!1),B(v,[e])},onAppearCancelled(e){C(e,!0),B(I,[e])},onLeaveCancelled(e){k(e),B(_,[e])}})}function j(e){if(null==e)return null;if((0,n.Kn)(e))return[V(e.enter),V(e.leave)];{const t=V(e);return[t,t]}}function V(e){const t=(0,n.He)(e);return t}function z(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.add(t))),(e._vtc||(e._vtc=new Set)).add(t)}function F(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.remove(t)));const{_vtc:r}=e;r&&(r.delete(t),r.size||(e._vtc=void 0))}function $(e){requestAnimationFrame((()=>{requestAnimationFrame(e)}))}let K=0;function q(e,t,r,n){const i=e._endId=++K,s=()=>{i===e._endId&&n()};if(r)return setTimeout(s,r);const{type:o,timeout:a,propCount:c}=H(e,t);if(!o)return n();const l=o+"end";let u=0;const h=()=>{e.removeEventListener(l,d),s()},d=t=>{t.target===e&&++u>=c&&h()};setTimeout((()=>{u<c&&h()}),a+1),e.addEventListener(l,d)}function H(e,t){const r=window.getComputedStyle(e),n=e=>(r[e]||"").split(", "),i=n(`${D}Delay`),s=n(`${D}Duration`),o=G(i,s),a=n(`${O}Delay`),c=n(`${O}Duration`),l=G(a,c);let u=null,h=0,d=0;t===D?o>0&&(u=D,h=o,d=s.length):t===O?l>0&&(u=O,h=l,d=c.length):(h=Math.max(o,l),u=h>0?o>l?D:O:null,d=u?u===D?s.length:c.length:0);const f=u===D&&/\b(transform|all)(,|$)/.test(n(`${D}Property`).toString());return{type:u,timeout:h,propCount:d,hasTransform:f}}function G(e,t){while(e.length<t.length)e=e.concat(e);return Math.max(...t.map(((t,r)=>W(t)+W(e[r]))))}function W(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function Y(){return document.body.offsetHeight}new WeakMap,new WeakMap;const J=(0,n.l7)({patchProp:P},c);let Q;function X(){return Q||(Q=(0,i.Us)(J))}const Z=(...e)=>{const t=X().createApp(...e);const{mount:r}=t;return t.mount=e=>{const i=ee(e);if(!i)return;const s=t._component;(0,n.mf)(s)||s.render||s.template||(s.template=i.innerHTML),i.innerHTML="";const o=r(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},t};function ee(e){if((0,n.HD)(e)){const t=document.querySelector(e);return t}return e}},3577:function(e,t,r){"use strict";function n(e,t){const r=Object.create(null),n=e.split(",");for(let i=0;i<n.length;i++)r[n[i]]=!0;return t?e=>!!r[e.toLowerCase()]:e=>!!r[e]}r.d(t,{C_:function(){return h},DM:function(){return O},E9:function(){return ie},F7:function(){return I},Gg:function(){return q},HD:function(){return B},He:function(){return re},Kn:function(){return M},NO:function(){return S},Nj:function(){return te},Od:function(){return T},PO:function(){return $},Pq:function(){return f},RI:function(){return P},S0:function(){return K},W7:function(){return F},WV:function(){return g},Z6:function(){return E},_A:function(){return W},_N:function(){return D},aU:function(){return Z},dG:function(){return _},e1:function(){return s},fY:function(){return n},hR:function(){return X},hq:function(){return m},ir:function(){return ee},j5:function(){return o},kC:function(){return Q},kJ:function(){return x},kT:function(){return v},l7:function(){return k},mf:function(){return L},rs:function(){return J},tI:function(){return j},tR:function(){return C},yA:function(){return p},yk:function(){return U},zw:function(){return w}});const i="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt",s=n(i);function o(e){if(x(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],i=B(n)?u(n):o(n);if(i)for(const e in i)t[e]=i[e]}return t}return B(e)||M(e)?e:void 0}const a=/;(?![^(]*\))/g,c=/:([^]+)/,l=/\/\*.*?\*\//gs;function u(e){const t={};return e.replace(l,"").split(a).forEach((e=>{if(e){const r=e.split(c);r.length>1&&(t[r[0].trim()]=r[1].trim())}})),t}function h(e){let t="";if(B(e))t=e;else if(x(e))for(let r=0;r<e.length;r++){const n=h(e[r]);n&&(t+=n+" ")}else if(M(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const d="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",f=n(d);function p(e){return!!e||""===e}function y(e,t){if(e.length!==t.length)return!1;let r=!0;for(let n=0;r&&n<e.length;n++)r=g(e[n],t[n]);return r}function g(e,t){if(e===t)return!0;let r=N(e),n=N(t);if(r||n)return!(!r||!n)&&e.getTime()===t.getTime();if(r=U(e),n=U(t),r||n)return e===t;if(r=x(e),n=x(t),r||n)return!(!r||!n)&&y(e,t);if(r=M(e),n=M(t),r||n){if(!r||!n)return!1;const i=Object.keys(e).length,s=Object.keys(t).length;if(i!==s)return!1;for(const r in e){const n=e.hasOwnProperty(r),i=t.hasOwnProperty(r);if(n&&!i||!n&&i||!g(e[r],t[r]))return!1}}return String(e)===String(t)}function m(e,t){return e.findIndex((e=>g(e,t)))}const w=e=>B(e)?e:null==e?"":x(e)||M(e)&&(e.toString===V||!L(e.toString))?JSON.stringify(e,b,2):String(e),b=(e,t)=>t&&t.__v_isRef?b(e,t.value):D(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,r])=>(e[`${t} =>`]=r,e)),{})}:O(t)?{[`Set(${t.size})`]:[...t.values()]}:!M(t)||x(t)||$(t)?t:String(t),v={},E=[],_=()=>{},S=()=>!1,A=/^on[^a-z]/,I=e=>A.test(e),C=e=>e.startsWith("onUpdate:"),k=Object.assign,T=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},R=Object.prototype.hasOwnProperty,P=(e,t)=>R.call(e,t),x=Array.isArray,D=e=>"[object Map]"===z(e),O=e=>"[object Set]"===z(e),N=e=>"[object Date]"===z(e),L=e=>"function"===typeof e,B=e=>"string"===typeof e,U=e=>"symbol"===typeof e,M=e=>null!==e&&"object"===typeof e,j=e=>M(e)&&L(e.then)&&L(e.catch),V=Object.prototype.toString,z=e=>V.call(e),F=e=>z(e).slice(8,-1),$=e=>"[object Object]"===z(e),K=e=>B(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,q=n(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),H=e=>{const t=Object.create(null);return r=>{const n=t[r];return n||(t[r]=e(r))}},G=/-(\w)/g,W=H((e=>e.replace(G,((e,t)=>t?t.toUpperCase():"")))),Y=/\B([A-Z])/g,J=H((e=>e.replace(Y,"-$1").toLowerCase())),Q=H((e=>e.charAt(0).toUpperCase()+e.slice(1))),X=H((e=>e?`on${Q(e)}`:"")),Z=(e,t)=>!Object.is(e,t),ee=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},te=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},re=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let ne;const ie=()=>ne||(ne="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof r.g?r.g:{})},9464:function(e,t,r){"use strict";const{fromCallback:n}=r(6957),i=r(4473),{getCallback:s,getOptions:o}=r(2520),a=Symbol("promise"),c=Symbol("status"),l=Symbol("operations"),u=Symbol("finishClose"),h=Symbol("closeCallbacks");class d{constructor(e){if("object"!==typeof e||null===e){const t=null===e?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${t}`)}this[l]=[],this[h]=[],this[c]="open",this[u]=this[u].bind(this),this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get length(){return this[l].length}put(e,t,r){if("open"!==this[c])throw new i("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const n=this.db._checkKey(e)||this.db._checkValue(t);if(n)throw n;const s=r&&null!=r.sublevel?r.sublevel:this.db,o=r,a=s.keyEncoding(r&&r.keyEncoding),u=s.valueEncoding(r&&r.valueEncoding),h=a.format;r={...r,keyEncoding:h,valueEncoding:u.format},s!==this.db&&(r.sublevel=null);const d=s.prefixKey(a.encode(e),h),f=u.encode(t);return this._put(d,f,r),this[l].push({...o,type:"put",key:e,value:t}),this}_put(e,t,r){}del(e,t){if("open"!==this[c])throw new i("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const r=this.db._checkKey(e);if(r)throw r;const n=t&&null!=t.sublevel?t.sublevel:this.db,s=t,o=n.keyEncoding(t&&t.keyEncoding),a=o.format;return t={...t,keyEncoding:a},n!==this.db&&(t.sublevel=null),this._del(n.prefixKey(o.encode(e),a),t),this[l].push({...s,type:"del",key:e}),this}_del(e,t){}clear(){if("open"!==this[c])throw new i("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[l]=[],this}_clear(){}write(e,t){return t=s(e,t),t=n(t,a),e=o(e),"open"!==this[c]?this.nextTick(t,new i("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):0===this.length?this.close(t):(this[c]="writing",this._write(e,(e=>{this[c]="closing",this[h].push((()=>t(e))),e||this.db.emit("batch",this[l]),this._close(this[u])}))),t[a]}_write(e,t){}close(e){return e=n(e,a),"closing"===this[c]?this[h].push(e):"closed"===this[c]?this.nextTick(e):(this[h].push(e),"writing"!==this[c]&&(this[c]="closing",this._close(this[u]))),e[a]}_close(e){this.nextTick(e)}[u](){this[c]="closed",this.db.detachResource(this);const e=this[h];this[h]=[];for(const t of e)t()}}t.AbstractChainedBatch=d},3961:function(e,t,r){"use strict";const{fromCallback:n}=r(6957),i=r(4473),{getOptions:s,getCallback:o}=r(2520),a=Symbol("promise"),c=Symbol("callback"),l=Symbol("working"),u=Symbol("handleOne"),h=Symbol("handleMany"),d=Symbol("autoClose"),f=Symbol("finishWork"),p=Symbol("returnMany"),y=Symbol("closing"),g=Symbol("handleClose"),m=Symbol("closed"),w=Symbol("closeCallbacks"),b=Symbol("keyEncoding"),v=Symbol("valueEncoding"),E=Symbol("abortOnClose"),_=Symbol("legacy"),S=Symbol("keys"),A=Symbol("values"),I=Symbol("limit"),C=Symbol("count"),k=Object.freeze({}),T=()=>{};let R=!1;class P{constructor(e,t,r){if("object"!==typeof e||null===e){const t=null===e?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${t}`)}if("object"!==typeof t||null===t)throw new TypeError("The second argument must be an options object");this[m]=!1,this[w]=[],this[l]=!1,this[y]=!1,this[d]=!1,this[c]=null,this[u]=this[u].bind(this),this[h]=this[h].bind(this),this[g]=this[g].bind(this),this[b]=t[b],this[v]=t[v],this[_]=r,this[I]=Number.isInteger(t.limit)&&t.limit>=0?t.limit:1/0,this[C]=0,this[E]=!!t.abortOnClose,this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get count(){return this[C]}get limit(){return this[I]}next(e){let t;if(void 0===e)t=new Promise(((t,r)=>{e=(e,n,i)=>{e?r(e):this[_]?void 0===n&&void 0===i?t():t([n,i]):t(n)}}));else if("function"!==typeof e)throw new TypeError("Callback must be a function");return this[y]?this.nextTick(e,new i("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[l]?this.nextTick(e,new i("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[l]=!0,this[c]=e,this[C]>=this[I]?this.nextTick(this[u],null):this._next(this[u])),t}_next(e){this.nextTick(e)}nextv(e,t,r){return r=o(t,r),r=n(r,a),t=s(t,k),Number.isInteger(e)?(this[y]?this.nextTick(r,new i("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[l]?this.nextTick(r,new i("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(e<1&&(e=1),this[I]<1/0&&(e=Math.min(e,this[I]-this[C])),this[l]=!0,this[c]=r,e<=0?this.nextTick(this[h],null,[]):this._nextv(e,t,this[h])),r[a]):(this.nextTick(r,new TypeError("The first argument 'size' must be an integer")),r[a])}_nextv(e,t,r){const n=[],i=(t,s,o)=>t?r(t):(this[_]?void 0===s&&void 0===o:void 0===s)?r(null,n):(n.push(this[_]?[s,o]:s),void(n.length===e?r(null,n):this._next(i)));this._next(i)}all(e,t){return t=o(e,t),t=n(t,a),e=s(e,k),this[y]?this.nextTick(t,new i("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[l]?this.nextTick(t,new i("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[l]=!0,this[c]=t,this[d]=!0,this[C]>=this[I]?this.nextTick(this[h],null,[]):this._all(e,this[h])),t[a]}_all(e,t){let r=this[C];const n=[],i=()=>{const e=this[I]<1/0?Math.min(1e3,this[I]-r):1e3;e<=0?this.nextTick(t,null,n):this._nextv(e,k,s)},s=(e,s)=>{e?t(e):0===s.length?t(null,n):(n.push.apply(n,s),r+=s.length,i())};i()}[f](){const e=this[c];return this[E]&&null===e?T:(this[l]=!1,this[c]=null,this[y]&&this._close(this[g]),e)}[p](e,t,r){this[d]?this.close(e.bind(null,t,r)):e(t,r)}seek(e,t){if(t=s(t,k),this[y]);else{if(this[l])throw new i("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const r=this.db.keyEncoding(t.keyEncoding||this[b]),n=r.format;t.keyEncoding!==n&&(t={...t,keyEncoding:n});const i=this.db.prefixKey(r.encode(e),n);this._seek(i,t)}}}_seek(e,t){throw new i("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(e){if(e=n(e,a),this[m])this.nextTick(e);else if(this[y])this[w].push(e);else if(this[y]=!0,this[w].push(e),this[l]){if(this[E]){const e=this[f]();e(new i("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))}}else this._close(this[g]);return e[a]}_close(e){this.nextTick(e)}[g](){this[m]=!0,this.db.detachResource(this);const e=this[w];this[w]=[];for(const t of e)t()}async*[Symbol.asyncIterator](){try{let e;while(void 0!==(e=await this.next()))yield e}finally{this[m]||await this.close()}}}class x extends P{constructor(e,t){super(e,t,!0),this[S]=!1!==t.keys,this[A]=!1!==t.values}[u](e,t,r){const n=this[f]();if(e)return n(e);try{t=this[S]&&void 0!==t?this[b].decode(t):void 0,r=this[A]&&void 0!==r?this[v].decode(r):void 0}catch(e){return n(new N("entry",e))}void 0===t&&void 0===r||this[C]++,n(null,t,r)}[h](e,t){const r=this[f]();if(e)return this[p](r,e);try{for(const e of t){const t=e[0],r=e[1];e[0]=this[S]&&void 0!==t?this[b].decode(t):void 0,e[1]=this[A]&&void 0!==r?this[v].decode(r):void 0}}catch(e){return this[p](r,new N("entries",e))}this[C]+=t.length,this[p](r,null,t)}end(e){return R||"undefined"===typeof console||(R=!0,console.warn(new i("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(e)}}class D extends P{constructor(e,t){super(e,t,!1)}[u](e,t){const r=this[f]();if(e)return r(e);try{t=void 0!==t?this[b].decode(t):void 0}catch(e){return r(new N("key",e))}void 0!==t&&this[C]++,r(null,t)}[h](e,t){const r=this[f]();if(e)return this[p](r,e);try{for(let e=0;e<t.length;e++){const r=t[e];t[e]=void 0!==r?this[b].decode(r):void 0}}catch(e){return this[p](r,new N("keys",e))}this[C]+=t.length,this[p](r,null,t)}}class O extends P{constructor(e,t){super(e,t,!1)}[u](e,t){const r=this[f]();if(e)return r(e);try{t=void 0!==t?this[v].decode(t):void 0}catch(e){return r(new N("value",e))}void 0!==t&&this[C]++,r(null,t)}[h](e,t){const r=this[f]();if(e)return this[p](r,e);try{for(let e=0;e<t.length;e++){const r=t[e];t[e]=void 0!==r?this[v].decode(r):void 0}}catch(e){return this[p](r,new N("values",e))}this[C]+=t.length,this[p](r,null,t)}}class N extends i{constructor(e,t){super(`Iterator could not decode ${e}`,{code:"LEVEL_DECODE_ERROR",cause:t})}}for(const L of["_ended property","_nexting property","_end method"])Object.defineProperty(x.prototype,L.split(" ")[0],{get(){throw new i(`The ${L} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new i(`The ${L} has been removed`,{code:"LEVEL_LEGACY"})}});x.keyEncoding=b,x.valueEncoding=v,t.AbstractIterator=x,t.AbstractKeyIterator=D,t.AbstractValueIterator=O},9071:function(e,t,r){"use strict";const{supports:n}=r(1675),{Transcoder:i}=r(8499),{EventEmitter:s}=r(7187),{fromCallback:o}=r(6957),a=r(4473),{AbstractIterator:c}=r(3961),{DefaultKeyIterator:l,DefaultValueIterator:u}=r(5429),{DeferredIterator:h,DeferredKeyIterator:d,DeferredValueIterator:f}=r(1791),{DefaultChainedBatch:p}=r(4765),{getCallback:y,getOptions:g}=r(2520),m=r(56),w=Symbol("promise"),b=Symbol("landed"),v=Symbol("resources"),E=Symbol("closeResources"),_=Symbol("operations"),S=Symbol("undefer"),A=Symbol("deferOpen"),I=Symbol("options"),C=Symbol("status"),k=Symbol("defaultOptions"),T=Symbol("transcoder"),R=Symbol("keyEncoding"),P=Symbol("valueEncoding"),x=()=>{};class D extends s{constructor(e,t){if(super(),"object"!==typeof e||null===e)throw new TypeError("The first argument 'manifest' must be an object");t=g(t);const{keyEncoding:r,valueEncoding:s,passive:o,...a}=t;this[v]=new Set,this[_]=[],this[A]=!0,this[I]=a,this[C]="opening",this.supports=n(e,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:!1!==e.snapshots,permanence:!1!==e.permanence,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:e.encodings||{},events:Object.assign({},e.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[T]=new i(L(this)),this[R]=this[T].encoding(r||"utf8"),this[P]=this[T].encoding(s||"utf8");for(const n of this[T].encodings())this.supports.encodings[n.commonName]||(this.supports.encodings[n.commonName]=!0);this[k]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[R].commonName,valueEncoding:this[P].commonName}),key:Object.freeze({keyEncoding:this[R].commonName})},this.nextTick((()=>{this[A]&&this.open({passive:!1},x)}))}get status(){return this[C]}keyEncoding(e){return this[T].encoding(null!=e?e:this[R])}valueEncoding(e){return this[T].encoding(null!=e?e:this[P])}open(e,t){t=y(e,t),t=o(t,w),e={...this[I],...g(e)},e.createIfMissing=!1!==e.createIfMissing,e.errorIfExists=!!e.errorIfExists;const r=e=>{"closing"===this[C]||"opening"===this[C]?this.once(b,e?()=>r(e):r):"open"!==this[C]?t(new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:e})):t()};return e.passive?"opening"===this[C]?this.once(b,r):this.nextTick(r):"closed"===this[C]||this[A]?(this[A]=!1,this[C]="opening",this.emit("opening"),this._open(e,(e=>{if(e)return this[C]="closed",this[E]((()=>{this.emit(b),r(e)})),void this[S]();this[C]="open",this[S](),this.emit(b),"open"===this[C]&&this.emit("open"),"open"===this[C]&&this.emit("ready"),r()}))):"open"===this[C]?this.nextTick(r):this.once(b,(()=>this.open(e,t))),t[w]}_open(e,t){this.nextTick(t)}close(e){e=o(e,w);const t=r=>{"opening"===this[C]||"closing"===this[C]?this.once(b,r?t(r):t):"closed"!==this[C]?e(new a("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:r})):e()};if("open"===this[C]){this[C]="closing",this.emit("closing");const e=e=>{this[C]="open",this[S](),this.emit(b),t(e)};this[E]((()=>{this._close((r=>{if(r)return e(r);this[C]="closed",this[S](),this.emit(b),"closed"===this[C]&&this.emit("closed"),t()}))}))}else"closed"===this[C]?this.nextTick(t):this.once(b,(()=>this.close(e)));return e[w]}[E](e){if(0===this[v].size)return this.nextTick(e);let t=this[v].size,r=!0;const n=()=>{0===--t&&(r?this.nextTick(e):e())};for(const i of this[v])i.close(n);r=!1,this[v].clear()}_close(e){this.nextTick(e)}get(e,t,r){if(r=y(t,r),r=o(r,w),t=g(t,this[k].entry),"opening"===this[C])return this.defer((()=>this.get(e,t,r))),r[w];if(N(this,r))return r[w];const n=this._checkKey(e);if(n)return this.nextTick(r,n),r[w];const i=this.keyEncoding(t.keyEncoding),s=this.valueEncoding(t.valueEncoding),c=i.format,l=s.format;return t.keyEncoding===c&&t.valueEncoding===l||(t=Object.assign({},t,{keyEncoding:c,valueEncoding:l})),this._get(this.prefixKey(i.encode(e),c),t,((e,t)=>{if(e)return("LEVEL_NOT_FOUND"===e.code||e.notFound||/NotFound/i.test(e))&&(e.code||(e.code="LEVEL_NOT_FOUND"),e.notFound||(e.notFound=!0),e.status||(e.status=404)),r(e);try{t=s.decode(t)}catch(e){return r(new a("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:e}))}r(null,t)})),r[w]}_get(e,t,r){this.nextTick(r,new Error("NotFound"))}getMany(e,t,r){if(r=y(t,r),r=o(r,w),t=g(t,this[k].entry),"opening"===this[C])return this.defer((()=>this.getMany(e,t,r))),r[w];if(N(this,r))return r[w];if(!Array.isArray(e))return this.nextTick(r,new TypeError("The first argument 'keys' must be an array")),r[w];if(0===e.length)return this.nextTick(r,null,[]),r[w];const n=this.keyEncoding(t.keyEncoding),i=this.valueEncoding(t.valueEncoding),s=n.format,c=i.format;t.keyEncoding===s&&t.valueEncoding===c||(t=Object.assign({},t,{keyEncoding:s,valueEncoding:c}));const l=new Array(e.length);for(let o=0;o<e.length;o++){const t=e[o],i=this._checkKey(t);if(i)return this.nextTick(r,i),r[w];l[o]=this.prefixKey(n.encode(t),s)}return this._getMany(l,t,((e,t)=>{if(e)return r(e);try{for(let e=0;e<t.length;e++)void 0!==t[e]&&(t[e]=i.decode(t[e]))}catch(e){return r(new a(`Could not decode one or more of ${t.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:e}))}r(null,t)})),r[w]}_getMany(e,t,r){this.nextTick(r,null,new Array(e.length).fill(void 0))}put(e,t,r,n){if(n=y(r,n),n=o(n,w),r=g(r,this[k].entry),"opening"===this[C])return this.defer((()=>this.put(e,t,r,n))),n[w];if(N(this,n))return n[w];const i=this._checkKey(e)||this._checkValue(t);if(i)return this.nextTick(n,i),n[w];const s=this.keyEncoding(r.keyEncoding),a=this.valueEncoding(r.valueEncoding),c=s.format,l=a.format;r.keyEncoding===c&&r.valueEncoding===l||(r=Object.assign({},r,{keyEncoding:c,valueEncoding:l}));const u=this.prefixKey(s.encode(e),c),h=a.encode(t);return this._put(u,h,r,(r=>{if(r)return n(r);this.emit("put",e,t),n()})),n[w]}_put(e,t,r,n){this.nextTick(n)}del(e,t,r){if(r=y(t,r),r=o(r,w),t=g(t,this[k].key),"opening"===this[C])return this.defer((()=>this.del(e,t,r))),r[w];if(N(this,r))return r[w];const n=this._checkKey(e);if(n)return this.nextTick(r,n),r[w];const i=this.keyEncoding(t.keyEncoding),s=i.format;return t.keyEncoding!==s&&(t=Object.assign({},t,{keyEncoding:s})),this._del(this.prefixKey(i.encode(e),s),t,(t=>{if(t)return r(t);this.emit("del",e),r()})),r[w]}_del(e,t,r){this.nextTick(r)}batch(e,t,r){if(!arguments.length){if("opening"===this[C])return new p(this);if("open"!==this[C])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(r="function"===typeof e?e:y(t,r),r=o(r,w),t=g(t,this[k].empty),"opening"===this[C])return this.defer((()=>this.batch(e,t,r))),r[w];if(N(this,r))return r[w];if(!Array.isArray(e))return this.nextTick(r,new TypeError("The first argument 'operations' must be an array")),r[w];if(0===e.length)return this.nextTick(r),r[w];const n=new Array(e.length),{keyEncoding:i,valueEncoding:s,...c}=t;for(let o=0;o<e.length;o++){if("object"!==typeof e[o]||null===e[o])return this.nextTick(r,new TypeError("A batch operation must be an object")),r[w];const t=Object.assign({},e[o]);if("put"!==t.type&&"del"!==t.type)return this.nextTick(r,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),r[w];const a=this._checkKey(t.key);if(a)return this.nextTick(r,a),r[w];const c=null!=t.sublevel?t.sublevel:this,l=c.keyEncoding(t.keyEncoding||i),u=l.format;if(t.key=c.prefixKey(l.encode(t.key),u),t.keyEncoding=u,"put"===t.type){const e=this._checkValue(t.value);if(e)return this.nextTick(r,e),r[w];const n=c.valueEncoding(t.valueEncoding||s);t.value=n.encode(t.value),t.valueEncoding=n.format}c!==this&&(t.sublevel=null),n[o]=t}return this._batch(n,c,(t=>{if(t)return r(t);this.emit("batch",e),r()})),r[w]}_batch(e,t,r){this.nextTick(r)}sublevel(e,t){return this._sublevel(e,O.defaults(t))}_sublevel(e,t){return new O(this,e,t)}prefixKey(e,t){return e}clear(e,t){if(t=y(e,t),t=o(t,w),e=g(e,this[k].empty),"opening"===this[C])return this.defer((()=>this.clear(e,t))),t[w];if(N(this,t))return t[w];const r=e,n=this.keyEncoding(e.keyEncoding);return e=m(e,n),e.keyEncoding=n.format,0===e.limit?this.nextTick(t):this._clear(e,(e=>{if(e)return t(e);this.emit("clear",r),t()})),t[w]}_clear(e,t){this.nextTick(t)}iterator(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if(e=m(e,t),e.keys=!1!==e.keys,e.values=!1!==e.values,e[c.keyEncoding]=t,e[c.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,"opening"===this[C])return new h(this,e);if("open"!==this[C])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(e)}_iterator(e){return new c(this,e)}keys(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if(e=m(e,t),e[c.keyEncoding]=t,e[c.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,"opening"===this[C])return new d(this,e);if("open"!==this[C])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(e)}_keys(e){return new l(this,e)}values(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if(e=m(e,t),e[c.keyEncoding]=t,e[c.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,"opening"===this[C])return new f(this,e);if("open"!==this[C])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(e)}_values(e){return new u(this,e)}defer(e){if("function"!==typeof e)throw new TypeError("The first argument must be a function");this[_].push(e)}[S](){if(0===this[_].length)return;const e=this[_];this[_]=[];for(const t of e)t()}attachResource(e){if("object"!==typeof e||null===e||"function"!==typeof e.close)throw new TypeError("The first argument must be a resource object");this[v].add(e)}detachResource(e){this[v].delete(e)}_chainedBatch(){return new p(this)}_checkKey(e){if(null===e||void 0===e)return new a("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(e){if(null===e||void 0===e)return new a("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}}D.prototype.nextTick=r(6909);const{AbstractSublevel:O}=r(9650)({AbstractLevel:D});t.AbstractLevel=D,t.AbstractSublevel=O;const N=function(e,t){return"open"!==e[C]&&(e.nextTick(t,new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0)},L=function(e){return Object.keys(e.supports.encodings).filter((t=>!!e.supports.encodings[t]))}},875:function(e,t,r){"use strict";t.AbstractLevel=r(9071).AbstractLevel,t.AbstractSublevel=r(9071).AbstractSublevel,t.AbstractIterator=r(3961).AbstractIterator,t.AbstractKeyIterator=r(3961).AbstractKeyIterator,t.AbstractValueIterator=r(3961).AbstractValueIterator,t.AbstractChainedBatch=r(9464).AbstractChainedBatch},2970:function(e,t,r){"use strict";const{AbstractIterator:n,AbstractKeyIterator:i,AbstractValueIterator:s}=r(3961),o=Symbol("unfix"),a=Symbol("iterator"),c=Symbol("handleOne"),l=Symbol("handleMany"),u=Symbol("callback");class h extends n{constructor(e,t,r,n){super(e,t),this[a]=r,this[o]=n,this[c]=this[c].bind(this),this[l]=this[l].bind(this),this[u]=null}[c](e,t,r){const n=this[u];if(e)return n(e);void 0!==t&&(t=this[o](t)),n(e,t,r)}[l](e,t){const r=this[u];if(e)return r(e);for(const n of t){const e=n[0];void 0!==e&&(n[0]=this[o](e))}r(e,t)}}class d extends i{constructor(e,t,r,n){super(e,t),this[a]=r,this[o]=n,this[c]=this[c].bind(this),this[l]=this[l].bind(this),this[u]=null}[c](e,t){const r=this[u];if(e)return r(e);void 0!==t&&(t=this[o](t)),r(e,t)}[l](e,t){const r=this[u];if(e)return r(e);for(let n=0;n<t.length;n++){const e=t[n];void 0!==e&&(t[n]=this[o](e))}r(e,t)}}class f extends s{constructor(e,t,r){super(e,t),this[a]=r}}for(const p of[h,d])p.prototype._next=function(e){this[u]=e,this[a].next(this[c])},p.prototype._nextv=function(e,t,r){this[u]=r,this[a].nextv(e,t,this[l])},p.prototype._all=function(e,t){this[u]=t,this[a].all(e,this[l])};for(const p of[f])p.prototype._next=function(e){this[a].next(e)},p.prototype._nextv=function(e,t,r){this[a].nextv(e,t,r)},p.prototype._all=function(e,t){this[a].all(e,t)};for(const p of[h,d,f])p.prototype._seek=function(e,t){this[a].seek(e,t)},p.prototype._close=function(e){this[a].close(e)};t.AbstractSublevelIterator=h,t.AbstractSublevelKeyIterator=d,t.AbstractSublevelValueIterator=f},9650:function(e,t,r){"use strict";const n=r(4473),{Buffer:i}=r(8764)||{},{AbstractSublevelIterator:s,AbstractSublevelKeyIterator:o,AbstractSublevelValueIterator:a}=r(2970),c=Symbol("prefix"),l=Symbol("upperBound"),u=Symbol("prefixRange"),h=Symbol("parent"),d=Symbol("unfix"),f=new TextEncoder,p={separator:"!"};e.exports=function({AbstractLevel:e}){class t extends e{static defaults(e){if("string"===typeof e)throw new n("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(e&&e.open)throw new n("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return null==e?p:e.separator?e:{...e,separator:"!"}}constructor(e,r,i){const{separator:s,manifest:o,...a}=t.defaults(i);r=b(r,s);const u=s.charCodeAt(0)+1,p=e[h]||e;if(!f.encode(r).every((e=>e>u&&e<127)))throw new n(`Prefix must use bytes > ${u} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(y(p,o),a);const g=(e.prefix||"")+s+r+s,v=g.slice(0,-1)+String.fromCharCode(u);this[h]=p,this[c]=new m(g),this[l]=new m(v),this[d]=new w,this.nextTick=p.nextTick}prefixKey(e,t){if("utf8"===t)return this[c].utf8+e;if(0===e.byteLength)return this[c][t];if("view"===t){const t=this[c].view,r=new Uint8Array(t.byteLength+e.byteLength);return r.set(t,0),r.set(e,t.byteLength),r}{const t=this[c].buffer;return i.concat([t,e],t.byteLength+e.byteLength)}}[u](e,t){void 0!==e.gte?e.gte=this.prefixKey(e.gte,t):void 0!==e.gt?e.gt=this.prefixKey(e.gt,t):e.gte=this[c][t],void 0!==e.lte?e.lte=this.prefixKey(e.lte,t):void 0!==e.lt?e.lt=this.prefixKey(e.lt,t):e.lte=this[l][t]}get prefix(){return this[c].utf8}get db(){return this[h]}_open(e,t){this[h].open({passive:!0},t)}_put(e,t,r,n){this[h].put(e,t,r,n)}_get(e,t,r){this[h].get(e,t,r)}_getMany(e,t,r){this[h].getMany(e,t,r)}_del(e,t,r){this[h].del(e,t,r)}_batch(e,t,r){this[h].batch(e,t,r)}_clear(e,t){this[u](e,e.keyEncoding),this[h].clear(e,t)}_iterator(e){this[u](e,e.keyEncoding);const t=this[h].iterator(e),r=this[d].get(this[c].utf8.length,e.keyEncoding);return new s(this,e,t,r)}_keys(e){this[u](e,e.keyEncoding);const t=this[h].keys(e),r=this[d].get(this[c].utf8.length,e.keyEncoding);return new o(this,e,t,r)}_values(e){this[u](e,e.keyEncoding);const t=this[h].values(e);return new a(this,e,t)}}return{AbstractSublevel:t}};const y=function(e,t){return{...e.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...t,encodings:{utf8:g(e,"utf8"),buffer:g(e,"buffer"),view:g(e,"view")}}},g=function(e,t){return!!e.supports.encodings[t]&&e.keyEncoding(t).name===t};class m{constructor(e){this.utf8=e,this.view=f.encode(e),this.buffer=i?i.from(this.view.buffer,0,this.view.byteLength):{}}}class w{constructor(){this.cache=new Map}get(e,t){let r=this.cache.get(t);return void 0===r&&(r="view"===t?function(e,t){return t.subarray(e)}.bind(null,e):function(e,t){return t.slice(e)}.bind(null,e),this.cache.set(t,r)),r}}const b=function(e,t){let r=0,n=e.length;while(r<n&&e[r]===t)r++;while(n>r&&e[n-1]===t)n--;return e.slice(r,n)}},2520:function(e,t){"use strict";t.getCallback=function(e,t){return"function"===typeof e?e:t},t.getOptions=function(e,t){return"object"===typeof e&&null!==e?e:void 0!==t?t:{}}},4765:function(e,t,r){"use strict";const{AbstractChainedBatch:n}=r(9464),i=r(4473),s=Symbol("encoded");class o extends n{constructor(e){super(e),this[s]=[]}_put(e,t,r){this[s].push({...r,type:"put",key:e,value:t})}_del(e,t){this[s].push({...t,type:"del",key:e})}_clear(){this[s]=[]}_write(e,t){"opening"===this.db.status?this.db.defer((()=>this._write(e,t))):"open"===this.db.status?0===this[s].length?this.nextTick(t):this.db._batch(this[s],e,t):this.nextTick(t,new i("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}}t.DefaultChainedBatch=o},5429:function(e,t,r){"use strict";const{AbstractKeyIterator:n,AbstractValueIterator:i}=r(3961),s=Symbol("iterator"),o=Symbol("callback"),a=Symbol("handleOne"),c=Symbol("handleMany");class l extends n{constructor(e,t){super(e,t),this[s]=e.iterator({...t,keys:!0,values:!1}),this[a]=this[a].bind(this),this[c]=this[c].bind(this)}}class u extends i{constructor(e,t){super(e,t),this[s]=e.iterator({...t,keys:!1,values:!0}),this[a]=this[a].bind(this),this[c]=this[c].bind(this)}}for(const h of[l,u]){const e=h===l,t=e?e=>e[0]:e=>e[1];h.prototype._next=function(e){this[o]=e,this[s].next(this[a])},h.prototype[a]=function(t,r,n){const i=this[o];t?i(t):i(null,e?r:n)},h.prototype._nextv=function(e,t,r){this[o]=r,this[s].nextv(e,t,this[c])},h.prototype._all=function(e,t){this[o]=t,this[s].all(e,this[c])},h.prototype[c]=function(e,r){const n=this[o];e?n(e):n(null,r.map(t))},h.prototype._seek=function(e,t){this[s].seek(e,t)},h.prototype._close=function(e){this[s].close(e)}}t.DefaultKeyIterator=l,t.DefaultValueIterator=u},1791:function(e,t,r){"use strict";const{AbstractIterator:n,AbstractKeyIterator:i,AbstractValueIterator:s}=r(3961),o=r(4473),a=Symbol("nut"),c=Symbol("undefer"),l=Symbol("factory");class u extends n{constructor(e,t){super(e,t),this[a]=null,this[l]=()=>e.iterator(t),this.db.defer((()=>this[c]()))}}class h extends i{constructor(e,t){super(e,t),this[a]=null,this[l]=()=>e.keys(t),this.db.defer((()=>this[c]()))}}class d extends s{constructor(e,t){super(e,t),this[a]=null,this[l]=()=>e.values(t),this.db.defer((()=>this[c]()))}}for(const f of[u,h,d])f.prototype[c]=function(){"open"===this.db.status&&(this[a]=this[l]())},f.prototype._next=function(e){null!==this[a]?this[a].next(e):"opening"===this.db.status?this.db.defer((()=>this._next(e))):this.nextTick(e,new o("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},f.prototype._nextv=function(e,t,r){null!==this[a]?this[a].nextv(e,t,r):"opening"===this.db.status?this.db.defer((()=>this._nextv(e,t,r))):this.nextTick(r,new o("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},f.prototype._all=function(e,t){null!==this[a]?this[a].all(t):"opening"===this.db.status?this.db.defer((()=>this._all(e,t))):this.nextTick(t,new o("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},f.prototype._seek=function(e,t){null!==this[a]?this[a]._seek(e,t):"opening"===this.db.status&&this.db.defer((()=>this._seek(e,t)))},f.prototype._close=function(e){null!==this[a]?this[a].close(e):"opening"===this.db.status?this.db.defer((()=>this._close(e))):this.nextTick(e)};t.DeferredIterator=u,t.DeferredKeyIterator=h,t.DeferredValueIterator=d},6909:function(e,t,r){"use strict";const n=r(4375);e.exports=function(e,...t){0===t.length?n(e):n((()=>e(...t)))}},56:function(e,t,r){"use strict";const n=r(4473),i=Object.prototype.hasOwnProperty,s=new Set(["lt","lte","gt","gte"]);e.exports=function(e,t){const r={};for(const o in e)if(i.call(e,o)&&"keyEncoding"!==o&&"valueEncoding"!==o){if("start"===o||"end"===o)throw new n(`The legacy range option '${o}' has been removed`,{code:"LEVEL_LEGACY"});if("encoding"===o)throw new n("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});s.has(o)?r[o]=t.encode(e[o]):r[o]=e[o]}return r.reverse=!!r.reverse,r.limit=Number.isInteger(r.limit)&&r.limit>=0?r.limit:-1,r}},2044:function(e){function t(e){const t=new globalThis.AbortController;function r(){t.abort();for(const t of e)t&&t.removeEventListener&&t.removeEventListener("abort",r)}for(const n of e)if(n&&n.addEventListener){if(n.aborted){r();break}n.addEventListener("abort",r)}return t.signal}e.exports=t,e.exports.anySignal=t},9742:function(e,t){"use strict";t.byteLength=l,t.toByteArray=h,t.fromByteArray=p;for(var r=[],n=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=s.length;o<a;++o)r[o]=s[o],n[s.charCodeAt(o)]=o;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}function l(e){var t=c(e),r=t[0],n=t[1];return 3*(r+n)/4-n}function u(e,t,r){return 3*(t+r)/4-r}function h(e){var t,r,s=c(e),o=s[0],a=s[1],l=new i(u(e,o,a)),h=0,d=a>0?o-4:o;for(r=0;r<d;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],l[h++]=t>>16&255,l[h++]=t>>8&255,l[h++]=255&t;return 2===a&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,l[h++]=255&t),1===a&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,l[h++]=t>>8&255,l[h++]=255&t),l}function d(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function f(e,t,r){for(var n,i=[],s=t;s<r;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(d(n));return i.join("")}function p(e){for(var t,n=e.length,i=n%3,s=[],o=16383,a=0,c=n-i;a<c;a+=o)s.push(f(e,a,a+o>c?c:a+o));return 1===i?(t=e[n-1],s.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],s.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},9668:function(e,t,r){"use strict";const{Buffer:n}=r(8764),i=Symbol.for("BufferList");function s(e){if(!(this instanceof s))return new s(e);s._init.call(this,e)}s._init=function(e){Object.defineProperty(this,i,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)},s.prototype._new=function(e){return new s(e)},s.prototype._offset=function(e){if(0===e)return[0,0];let t=0;for(let r=0;r<this._bufs.length;r++){const n=t+this._bufs[r].length;if(e<n||r===this._bufs.length-1)return[r,e-t];t=n}},s.prototype._reverseOffset=function(e){const t=e[0];let r=e[1];for(let n=0;n<t;n++)r+=this._bufs[n].length;return r},s.prototype.get=function(e){if(e>this.length||e<0)return;const t=this._offset(e);return this._bufs[t[0]][t[1]]},s.prototype.slice=function(e,t){return"number"===typeof e&&e<0&&(e+=this.length),"number"===typeof t&&t<0&&(t+=this.length),this.copy(null,0,e,t)},s.prototype.copy=function(e,t,r,i){if(("number"!==typeof r||r<0)&&(r=0),("number"!==typeof i||i>this.length)&&(i=this.length),r>=this.length)return e||n.alloc(0);if(i<=0)return e||n.alloc(0);const s=!!e,o=this._offset(r),a=i-r;let c=a,l=s&&t||0,u=o[1];if(0===r&&i===this.length){if(!s)return 1===this._bufs.length?this._bufs[0]:n.concat(this._bufs,this.length);for(let t=0;t<this._bufs.length;t++)this._bufs[t].copy(e,l),l+=this._bufs[t].length;return e}if(c<=this._bufs[o[0]].length-u)return s?this._bufs[o[0]].copy(e,t,u,u+c):this._bufs[o[0]].slice(u,u+c);s||(e=n.allocUnsafe(a));for(let n=o[0];n<this._bufs.length;n++){const t=this._bufs[n].length-u;if(!(c>t)){this._bufs[n].copy(e,l,u,u+c),l+=t;break}this._bufs[n].copy(e,l,u),l+=t,c-=t,u&&(u=0)}return e.length>l?e.slice(0,l):e},s.prototype.shallowSlice=function(e,t){if(e=e||0,t="number"!==typeof t?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();const r=this._offset(e),n=this._offset(t),i=this._bufs.slice(r[0],n[0]+1);return 0===n[1]?i.pop():i[i.length-1]=i[i.length-1].slice(0,n[1]),0!==r[1]&&(i[0]=i[0].slice(r[1])),this._new(i)},s.prototype.toString=function(e,t,r){return this.slice(t,r).toString(e)},s.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;while(this._bufs.length){if(!(e>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},s.prototype.duplicate=function(){const e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e},s.prototype.append=function(e){if(null==e)return this;if(e.buffer)this._appendBuffer(n.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else"number"===typeof e&&(e=e.toString()),this._appendBuffer(n.from(e));return this},s.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length},s.prototype.indexOf=function(e,t,r){if(void 0===r&&"string"===typeof t&&(r=t,t=void 0),"function"===typeof e||Array.isArray(e))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if("number"===typeof e?e=n.from([e]):"string"===typeof e?e=n.from(e,r):this._isBufferList(e)?e=e.slice():Array.isArray(e.buffer)?e=n.from(e.buffer,e.byteOffset,e.byteLength):n.isBuffer(e)||(e=n.from(e)),t=Number(t||0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),0===e.length)return t>this.length?this.length:t;const i=this._offset(t);let s=i[0],o=i[1];for(;s<this._bufs.length;s++){const t=this._bufs[s];while(o<t.length){const r=t.length-o;if(r>=e.length){const r=t.indexOf(e,o);if(-1!==r)return this._reverseOffset([s,r]);o=t.length-e.length+1}else{const t=this._reverseOffset([s,o]);if(this._match(t,e))return t;o++}}o=0}return-1},s.prototype._match=function(e,t){if(this.length-e<t.length)return!1;for(let r=0;r<t.length;r++)if(this.get(e+r)!==t[r])return!1;return!0},function(){const e={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(const t in e)(function(t){null===e[t]?s.prototype[t]=function(e,r){return this.slice(e,e+r)[t](0,r)}:s.prototype[t]=function(r=0){return this.slice(r,r+e[t])[t](0)}})(t)}(),s.prototype._isBufferList=function(e){return e instanceof s||s.isBufferList(e)},s.isBufferList=function(e){return null!=e&&e[i]},e.exports=s},3294:function(e,t,r){"use strict";const n=r(6154);function i(e){return"function"===typeof e.stream?n(e.stream()):n(new Response(e).body)}e.exports=i},1708:function(e,t,r){"use strict";const{AbstractLevel:n}=r(875),i=r(4473),s=r(9967),{fromCallback:o}=r(6957),{Iterator:a}=r(8212),c=r(9687),l=r(9968),u=r(1217),h="level-js-",d=Symbol("idb"),f=Symbol("namePrefix"),p=Symbol("location"),y=Symbol("version"),g=Symbol("store"),m=Symbol("onComplete"),w=Symbol("promise");class b extends n{constructor(e,t,r){if("function"===typeof t||"function"===typeof r)throw new i("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:n,version:s,...o}=t||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},o),"string"!==typeof e)throw new Error("constructor requires a location string argument");this[p]=e,this[f]=null==n?h:n,this[y]=parseInt(s||1,10),this[d]=null}get location(){return this[p]}get namePrefix(){return this[f]}get version(){return this[y]}get db(){return this[d]}get type(){return"browser-level"}_open(e,t){const r=indexedDB.open(this[f]+this[p],this[y]);r.onerror=function(){t(r.error||new Error("unknown error"))},r.onsuccess=()=>{this[d]=r.result,t()},r.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(this[p])||t.createObjectStore(this[p])}}[g](e){const t=this[d].transaction([this[p]],e);return t.objectStore(this[p])}[m](e,t){const r=e.transaction;r.onabort=function(){t(r.error||new Error("aborted by user"))},r.oncomplete=function(){t(null,e.result)}}_get(e,t,r){const n=this[g]("readonly");let s;try{s=n.get(e)}catch(o){return this.nextTick(r,o)}this[m](s,(function(e,t){return e?r(e):void 0===t?r(new i("Entry not found",{code:"LEVEL_NOT_FOUND"})):void r(null,c(t))}))}_getMany(e,t,r){const n=this[g]("readonly"),i=e.map((e=>t=>{let r;try{r=n.get(e)}catch(i){return t(i)}r.onsuccess=()=>{const e=r.result;t(null,void 0===e?e:c(e))},r.onerror=e=>{e.stopPropagation(),t(r.error)}}));s(i,16,r)}_del(e,t,r){const n=this[g]("readwrite");let i;try{i=n.delete(e)}catch(s){return this.nextTick(r,s)}this[m](i,r)}_put(e,t,r,n){const i=this[g]("readwrite");let s;try{s=i.put(t,e)}catch(o){return this.nextTick(n,o)}this[m](s,n)}_iterator(e){return new a(this,this[p],e)}_batch(e,t,r){const n=this[g]("readwrite"),i=n.transaction;let s,o=0;function a(){const t=e[o++],r=t.key;let c;try{c="del"===t.type?n.delete(r):n.put(t.value,r)}catch(l){return s=l,void i.abort()}o<e.length?c.onsuccess=a:"function"===typeof i.commit&&i.commit()}i.onabort=function(){r(s||i.error||new Error("aborted by user"))},i.oncomplete=function(){r()},a()}_clear(e,t){let r,n;try{r=u(e)}catch(i){return this.nextTick(t)}if(e.limit>=0)return l(this,this[p],r,e,t);try{const e=this[g]("readwrite");n=r?e.delete(r):e.clear()}catch(s){return this.nextTick(t,s)}this[m](n,t)}_close(e){this[d].close(),this.nextTick(e)}}b.destroy=function(e,t,r){"function"===typeof t&&(r=t,t=h),r=o(r,w);const n=indexedDB.deleteDatabase(t+e);return n.onsuccess=function(){r()},n.onerror=function(e){r(e)},r[w]},t.BrowserLevel=b},8212:function(e,t,r){"use strict";const{AbstractIterator:n}=r(875),i=r(1217),s=r(9687),o=Symbol("cache"),a=Symbol("finished"),c=Symbol("options"),l=Symbol("currentOptions"),u=Symbol("position"),h=Symbol("location"),d=Symbol("first"),f={};class p extends n{constructor(e,t,r){super(e,r),this[o]=[],this[a]=0===this.limit,this[c]=r,this[l]={...r},this[u]=void 0,this[h]=t,this[d]=!0}_nextv(e,t,r){if(this[d]=!1,this[a])return this.nextTick(r,null,[]);if(this[o].length>0)return e=Math.min(e,this[o].length),this.nextTick(r,null,this[o].splice(0,e));let n;void 0!==this[u]&&(this[c].reverse?(this[l].lt=this[u],this[l].lte=void 0):(this[l].gt=this[u],this[l].gte=void 0));try{n=i(this[l])}catch(m){return this[a]=!0,this.nextTick(r,null,[])}const f=this.db.db.transaction([this[h]],"readonly"),p=f.objectStore(this[h]),g=[];if(this[c].reverse){const t=!this[c].values&&p.openKeyCursor?"openKeyCursor":"openCursor";p[t](n,"prev").onsuccess=t=>{const r=t.target.result;if(r){const{key:t,value:n}=r;this[u]=t,g.push([this[c].keys&&void 0!==t?s(t):void 0,this[c].values&&void 0!==n?s(n):void 0]),g.length<e?r.continue():y(f)}else this[a]=!0}}else{let t,r;const i=()=>{if(void 0===t||void 0===r)return;const n=Math.max(t.length,r.length);0===n||e===1/0?this[a]=!0:this[u]=t[n-1],g.length=n;for(let e=0;e<n;e++){const n=t[e],i=r[e];g[e]=[this[c].keys&&void 0!==n?s(n):void 0,this[c].values&&void 0!==i?s(i):void 0]}y(f)};this[c].keys||e<1/0?p.getAllKeys(n,e<1/0?e:void 0).onsuccess=e=>{t=e.target.result,i()}:(t=[],this.nextTick(i)),this[c].values?p.getAll(n,e<1/0?e:void 0).onsuccess=e=>{r=e.target.result,i()}:(r=[],this.nextTick(i))}f.onabort=()=>{r(f.error||new Error("aborted by user")),r=null},f.oncomplete=()=>{r(null,g),r=null}}_next(e){if(this[o].length>0){const[t,r]=this[o].shift();this.nextTick(e,null,t,r)}else if(this[a])this.nextTick(e);else{let t=Math.min(100,this.limit-this.count);this[d]&&(this[d]=!1,t=1),this._nextv(t,f,((t,r)=>{if(t)return e(t);this[o]=r,this._next(e)}))}}_all(e,t){this[d]=!1;const r=this[o].splice(0,this[o].length),n=this.limit-this.count-r.length;if(n<=0)return this.nextTick(t,null,r);this._nextv(n,f,((e,n)=>{if(e)return t(e);r.length>0&&(n=r.concat(n)),t(null,n)}))}_seek(e,t){let r;this[d]=!0,this[o]=[],this[a]=!1,this[u]=void 0,this[l]={...this[c]};try{r=i(this[c])}catch(n){return void(this[a]=!0)}null===r||r.includes(e)?this[c].reverse?this[l].lte=e:this[l].gte=e:this[a]=!0}}function y(e){"function"===typeof e.commit&&e.commit()}t.Iterator=p},9968:function(e){"use strict";e.exports=function(e,t,r,n,i){if(0===n.limit)return e.nextTick(i);const s=e.db.transaction([t],"readwrite"),o=s.objectStore(t);let a=0;s.oncomplete=function(){i()},s.onabort=function(){i(s.error||new Error("aborted by user"))};const c=o.openKeyCursor?"openKeyCursor":"openCursor",l=n.reverse?"prev":"next";o[c](r,l).onsuccess=function(e){const t=e.target.result;t&&(o.delete(t.key).onsuccess=function(){(n.limit<=0||++a<n.limit)&&t.continue()})}}},9687:function(e){"use strict";const t=new TextEncoder;e.exports=function(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):t.encode(e)}},1217:function(e){"use strict";e.exports=function(e){const t=void 0!==e.gte?e.gte:void 0!==e.gt?e.gt:void 0,r=void 0!==e.lte?e.lte:void 0!==e.lt?e.lt:void 0,n=void 0===e.gte,i=void 0===e.lte;return void 0!==t&&void 0!==r?IDBKeyRange.bound(t,r,n,i):void 0!==t?IDBKeyRange.lowerBound(t,n):void 0!==r?IDBKeyRange.upperBound(r,i):null}},6154:function(e){"use strict";async function*t(e,t={}){const r=e.getReader();try{while(1){const e=await r.read();if(e.done)return;yield e.value}}finally{!0!==t.preventCancel&&r.cancel(),r.releaseLock()}}e.exports=t},8764:function(e,t,r){"use strict";
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const n=r(9742),i=r(645),s="function"===typeof Symbol&&"function"===typeof Symbol["for"]?Symbol["for"]("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=v,t.INSPECT_MAX_BYTES=50;const o=2147483647;function a(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}function c(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,r){if("number"===typeof e){if("string"===typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return f(e)}return u(e,t,r)}function u(e,t,r){if("string"===typeof e)return p(e,t);if(ArrayBuffer.isView(e))return g(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(oe(e,ArrayBuffer)||e&&oe(e.buffer,ArrayBuffer))return m(e,t,r);if("undefined"!==typeof SharedArrayBuffer&&(oe(e,SharedArrayBuffer)||e&&oe(e.buffer,SharedArrayBuffer)))return m(e,t,r);if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return l.from(n,t,r);const i=w(e);if(i)return i;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function h(e){if("number"!==typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e,t,r){return h(e),e<=0?c(e):void 0!==t?"string"===typeof r?c(e).fill(t,r):c(e).fill(t):c(e)}function f(e){return h(e),c(e<0?0:0|b(e))}function p(e,t){if("string"===typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|E(e,t);let n=c(r);const i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}function y(e){const t=e.length<0?0:0|b(e.length),r=c(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function g(e){if(oe(e,Uint8Array)){const t=new Uint8Array(e);return m(t.buffer,t.byteOffset,t.byteLength)}return y(e)}function m(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,l.prototype),n}function w(e){if(l.isBuffer(e)){const t=0|b(e.length),r=c(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!==typeof e.length||ae(e.length)?c(0):y(e):"Buffer"===e.type&&Array.isArray(e.data)?y(e.data):void 0}function b(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function v(e){return+e!=e&&(e=0),l.alloc(+e)}function E(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||oe(e,ArrayBuffer))return e.byteLength;if("string"!==typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return te(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return ie(e).length;default:if(i)return n?-1:te(e).length;t=(""+t).toLowerCase(),i=!0}}function _(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,t>>>=0,r<=t)return"";e||(e="utf8");while(1)switch(e){case"hex":return U(this,t,r);case"utf8":case"utf-8":return D(this,t,r);case"ascii":return L(this,t,r);case"latin1":case"binary":return B(this,t,r);case"base64":return x(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function S(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function A(e,t,r,n,i){if(0===e.length)return-1;if("string"===typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,ae(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"===typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:I(e,t,r,n,i);if("number"===typeof t)return t&=255,"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):I(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function I(e,t,r,n,i){let s,o=1,a=e.length,c=t.length;if(void 0!==n&&(n=String(n).toLowerCase(),"ucs2"===n||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,r/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let n=-1;for(s=r;s<a;s++)if(l(e,s)===l(t,-1===n?0:s-n)){if(-1===n&&(n=s),s-n+1===c)return n*o}else-1!==n&&(s-=s-n),n=-1}else for(r+c>a&&(r=a-c),s=r;s>=0;s--){let r=!0;for(let n=0;n<c;n++)if(l(e,s+n)!==l(t,n)){r=!1;break}if(r)return s}return-1}function C(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;const s=t.length;let o;for(n>s/2&&(n=s/2),o=0;o<n;++o){const n=parseInt(t.substr(2*o,2),16);if(ae(n))return o;e[r+o]=n}return o}function k(e,t,r,n){return se(te(t,e.length-r),e,r,n)}function T(e,t,r,n){return se(re(t),e,r,n)}function R(e,t,r,n){return se(ie(t),e,r,n)}function P(e,t,r,n){return se(ne(t,e.length-r),e,r,n)}function x(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function D(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;while(i<r){const t=e[i];let s=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=r){let r,n,a,c;switch(o){case 1:t<128&&(s=t);break;case 2:r=e[i+1],128===(192&r)&&(c=(31&t)<<6|63&r,c>127&&(s=c));break;case 3:r=e[i+1],n=e[i+2],128===(192&r)&&128===(192&n)&&(c=(15&t)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:r=e[i+1],n=e[i+2],a=e[i+3],128===(192&r)&&128===(192&n)&&128===(192&a)&&(c=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=o}return N(n)}t.kMaxLength=o,l.TYPED_ARRAY_SUPPORT=a(),l.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,r){return u(e,t,r)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,r){return d(e,t,r)},l.allocUnsafe=function(e){return f(e)},l.allocUnsafeSlow=function(e){return f(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(oe(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),oe(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=l.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(oe(t,Uint8Array))i+t.length>n.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},l.byteLength=E,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)S(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)S(this,t,t+3),S(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)S(this,t,t+7),S(this,t+1,t+6),S(this,t+2,t+5),S(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?D(this,0,e):_.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},s&&(l.prototype[s]=l.prototype.inspect),l.prototype.compare=function(e,t,r,n,i){if(oe(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;let s=i-n,o=r-t;const a=Math.min(s,o),c=this.slice(n,i),u=e.slice(t,r);for(let l=0;l<a;++l)if(c[l]!==u[l]){s=c[l],o=u[l];break}return s<o?-1:o<s?1:0},l.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return A(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return A(this,e,t,r,!1)},l.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"===typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return C(this,e,t,r);case"utf8":case"utf-8":return k(this,e,t,r);case"ascii":case"latin1":case"binary":return T(this,e,t,r);case"base64":return R(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const O=4096;function N(e){const t=e.length;if(t<=O)return String.fromCharCode.apply(String,e);let r="",n=0;while(n<t)r+=String.fromCharCode.apply(String,e.slice(n,n+=O));return r}function L(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function B(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function U(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let s=t;s<r;++s)i+=ce[e[s]];return i}function M(e,t,r){const n=e.slice(t,r);let i="";for(let s=0;s<n.length-1;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}function j(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function V(e,t,r,n,i,s){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function z(e,t,r,n,i){J(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function F(e,t,r,n,i){J(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function $(e,t,r,n,i,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function K(e,t,r,n,s){return t=+t,r>>>=0,s||$(e,t,r,4,34028234663852886e22,-34028234663852886e22),i.write(e,t,r,n,23,4),r+4}function q(e,t,r,n,s){return t=+t,r>>>=0,s||$(e,t,r,8,17976931348623157e292,-17976931348623157e292),i.write(e,t,r,n,52,8),r+8}l.prototype.slice=function(e,t){const r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,l.prototype),n},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||j(e,t,this.length);let n=this[e],i=1,s=0;while(++s<t&&(i*=256))n+=this[e+s]*i;return n},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||j(e,t,this.length);let n=this[e+--t],i=1;while(t>0&&(i*=256))n+=this[e+--t]*i;return n},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||j(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||j(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||j(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||j(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||j(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=le((function(e){e>>>=0,Q(e,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||X(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),l.prototype.readBigUInt64BE=le((function(e){e>>>=0,Q(e,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||X(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),l.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||j(e,t,this.length);let n=this[e],i=1,s=0;while(++s<t&&(i*=256))n+=this[e+s]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||j(e,t,this.length);let n=t,i=1,s=this[e+--n];while(n>0&&(i*=256))s+=this[e+--n]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},l.prototype.readInt8=function(e,t){return e>>>=0,t||j(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||j(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(e,t){e>>>=0,t||j(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||j(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||j(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=le((function(e){e>>>=0,Q(e,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||X(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=le((function(e){e>>>=0,Q(e,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||X(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||j(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||j(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||j(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||j(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){const n=Math.pow(2,8*r)-1;V(this,e,t,r,n,0)}let i=1,s=0;this[t]=255&e;while(++s<r&&(i*=256))this[t+s]=e/i&255;return t+r},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){const n=Math.pow(2,8*r)-1;V(this,e,t,r,n,0)}let i=r-1,s=1;this[t+i]=255&e;while(--i>=0&&(s*=256))this[t+i]=e/s&255;return t+r},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||V(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||V(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||V(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||V(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||V(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=le((function(e,t=0){return z(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=le((function(e,t=0){return F(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);V(this,e,t,r,n-1,-n)}let i=0,s=1,o=0;this[t]=255&e;while(++i<r&&(s*=256))e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+r},l.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);V(this,e,t,r,n-1,-n)}let i=r-1,s=1,o=0;this[t+i]=255&e;while(--i>=0&&(s*=256))e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||V(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||V(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||V(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||V(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||V(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=le((function(e,t=0){return z(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=le((function(e,t=0){return F(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,r){return K(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return K(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return q(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return q(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,n){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"===typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},l.prototype.fill=function(e,t,r,n){if("string"===typeof e){if("string"===typeof t?(n=t,t=0,r=this.length):"string"===typeof r&&(n=r,r=this.length),void 0!==n&&"string"!==typeof n)throw new TypeError("encoding must be a string");if("string"===typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"===typeof e?e&=255:"boolean"===typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"===typeof e)for(i=t;i<r;++i)this[i]=e;else{const s=l.isBuffer(e)?e:l.from(e,n),o=s.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=s[i%o]}return this};const H={};function G(e,t,r){H[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function W(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function Y(e,t,r){Q(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||X(t,e.length-(r+1))}function J(e,t,r,n,i,s){if(e>r||e<t){const n="bigint"===typeof t?"n":"";let i;throw i=s>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(s+1)}${n}`:`>= -(2${n} ** ${8*(s+1)-1}${n}) and < 2 ** ${8*(s+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new H.ERR_OUT_OF_RANGE("value",i,e)}Y(n,i,s)}function Q(e,t){if("number"!==typeof e)throw new H.ERR_INVALID_ARG_TYPE(t,"number",e)}function X(e,t,r){if(Math.floor(e)!==e)throw Q(e,r),new H.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new H.ERR_BUFFER_OUT_OF_BOUNDS;throw new H.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}G("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),G("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),G("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=W(String(r)):"bigint"===typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=W(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const Z=/[^+/0-9A-Za-z-_]/g;function ee(e){if(e=e.split("=")[0],e=e.trim().replace(Z,""),e.length<2)return"";while(e.length%4!==0)e+="=";return e}function te(e,t){let r;t=t||1/0;const n=e.length;let i=null;const s=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function re(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function ne(e,t){let r,n,i;const s=[];for(let o=0;o<e.length;++o){if((t-=2)<0)break;r=e.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n)}return s}function ie(e){return n.toByteArray(ee(e))}function se(e,t,r,n){let i;for(i=0;i<n;++i){if(i+r>=t.length||i>=e.length)break;t[i+r]=e[i]}return i}function oe(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function ae(e){return e!==e}const ce=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function le(e){return"undefined"===typeof BigInt?ue:e}function ue(){throw new Error("BigInt not supported")}},9830:function(e){"use strict";
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */e.exports=s,e.exports.format=o,e.exports.parse=a;var t=/\B(?=(\d{3})+(?!\d))/g,r=/(?:\.0*|(\.[^0]+)0+)$/,n={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},i=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function s(e,t){return"string"===typeof e?a(e):"number"===typeof e?o(e,t):null}function o(e,i){if(!Number.isFinite(e))return null;var s=Math.abs(e),o=i&&i.thousandsSeparator||"",a=i&&i.unitSeparator||"",c=i&&void 0!==i.decimalPlaces?i.decimalPlaces:2,l=Boolean(i&&i.fixedDecimals),u=i&&i.unit||"";u&&n[u.toLowerCase()]||(u=s>=n.pb?"PB":s>=n.tb?"TB":s>=n.gb?"GB":s>=n.mb?"MB":s>=n.kb?"KB":"B");var h=e/n[u.toLowerCase()],d=h.toFixed(c);return l||(d=d.replace(r,"$1")),o&&(d=d.split(".").map((function(e,r){return 0===r?e.replace(t,o):e})).join(".")),d+a+u}function a(e){if("number"===typeof e&&!isNaN(e))return e;if("string"!==typeof e)return null;var t,r=i.exec(e),s="b";return r?(t=parseFloat(r[1]),s=r[4].toLowerCase()):(t=parseInt(e,10),s="b"),isNaN(t)?null:Math.floor(n[s]*t)}},6957:function(e,t,r){"use strict";var n=r(886);t.fromCallback=function(e,t){if(void 0===e){var r=new Promise((function(t,r){e=function(e,n){e?r(e):t(n)}}));e[void 0!==t?t:"promise"]=r}else if("function"!==typeof e)throw new TypeError("Callback must be a function");return e},t.fromPromise=function(e,t){if(void 0===t)return e;e.then((function(e){n((()=>t(null,e)))})).catch((function(e){n((()=>t(e)))}))}},886:function(e){e.exports="function"===typeof queueMicrotask?queueMicrotask:e=>Promise.resolve().then(e)},9662:function(e,t,r){var n=r(614),i=r(6330),s=TypeError;e.exports=function(e){if(n(e))return e;throw s(i(e)+" is not a function")}},9670:function(e,t,r){var n=r(111),i=String,s=TypeError;e.exports=function(e){if(n(e))return e;throw s(i(e)+" is not an object")}},1318:function(e,t,r){var n=r(5656),i=r(1400),s=r(6244),o=function(e){return function(t,r,o){var a,c=n(t),l=s(c),u=i(o,l);if(e&&r!=r){while(l>u)if(a=c[u++],a!=a)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===r)return e||u||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},3658:function(e,t,r){"use strict";var n=r(9781),i=r(3157),s=TypeError,o=Object.getOwnPropertyDescriptor,a=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=a?function(e,t){if(i(e)&&!o(e,"length").writable)throw s("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},4326:function(e,t,r){var n=r(1702),i=n({}.toString),s=n("".slice);e.exports=function(e){return s(i(e),8,-1)}},9920:function(e,t,r){var n=r(2597),i=r(3887),s=r(1236),o=r(3070);e.exports=function(e,t,r){for(var a=i(t),c=o.f,l=s.f,u=0;u<a.length;u++){var h=a[u];n(e,h)||r&&n(r,h)||c(e,h,l(t,h))}}},8880:function(e,t,r){var n=r(9781),i=r(3070),s=r(9114);e.exports=n?function(e,t,r){return i.f(e,t,s(1,r))}:function(e,t,r){return e[t]=r,e}},9114:function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},8052:function(e,t,r){var n=r(614),i=r(3070),s=r(6339),o=r(3072);e.exports=function(e,t,r,a){a||(a={});var c=a.enumerable,l=void 0!==a.name?a.name:t;if(n(r)&&s(r,l,a),a.global)c?e[t]=r:o(t,r);else{try{a.unsafe?e[t]&&(c=!0):delete e[t]}catch(u){}c?e[t]=r:i.f(e,t,{value:r,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},3072:function(e,t,r){var n=r(7854),i=Object.defineProperty;e.exports=function(e,t){try{i(n,e,{value:t,configurable:!0,writable:!0})}catch(r){n[e]=t}return t}},9781:function(e,t,r){var n=r(7293);e.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4154:function(e){var t="object"==typeof document&&document.all,r="undefined"==typeof t&&void 0!==t;e.exports={all:t,IS_HTMLDDA:r}},317:function(e,t,r){var n=r(7854),i=r(111),s=n.document,o=i(s)&&i(s.createElement);e.exports=function(e){return o?s.createElement(e):{}}},7207:function(e){var t=TypeError,r=9007199254740991;e.exports=function(e){if(e>r)throw t("Maximum allowed index exceeded");return e}},8113:function(e,t,r){var n=r(5005);e.exports=n("navigator","userAgent")||""},7392:function(e,t,r){var n,i,s=r(7854),o=r(8113),a=s.process,c=s.Deno,l=a&&a.versions||c&&c.version,u=l&&l.v8;u&&(n=u.split("."),i=n[0]>0&&n[0]<4?1:+(n[0]+n[1])),!i&&o&&(n=o.match(/Edge\/(\d+)/),(!n||n[1]>=74)&&(n=o.match(/Chrome\/(\d+)/),n&&(i=+n[1]))),e.exports=i},748:function(e){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:function(e,t,r){var n=r(7854),i=r(1236).f,s=r(8880),o=r(8052),a=r(3072),c=r(9920),l=r(4705);e.exports=function(e,t){var r,u,h,d,f,p,y=e.target,g=e.global,m=e.stat;if(u=g?n:m?n[y]||a(y,{}):(n[y]||{}).prototype,u)for(h in t){if(f=t[h],e.dontCallGetSet?(p=i(u,h),d=p&&p.value):d=u[h],r=l(g?h:y+(m?".":"#")+h,e.forced),!r&&void 0!==d){if(typeof f==typeof d)continue;c(f,d)}(e.sham||d&&d.sham)&&s(f,"sham",!0),o(u,h,f,e)}}},7293:function(e){e.exports=function(e){try{return!!e()}catch(t){return!0}}},4374:function(e,t,r){var n=r(7293);e.exports=!n((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},6916:function(e,t,r){var n=r(4374),i=Function.prototype.call;e.exports=n?i.bind(i):function(){return i.apply(i,arguments)}},6530:function(e,t,r){var n=r(9781),i=r(2597),s=Function.prototype,o=n&&Object.getOwnPropertyDescriptor,a=i(s,"name"),c=a&&"something"===function(){}.name,l=a&&(!n||n&&o(s,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:l}},1702:function(e,t,r){var n=r(4374),i=Function.prototype,s=i.call,o=n&&i.bind.bind(s,s);e.exports=n?o:function(e){return function(){return s.apply(e,arguments)}}},5005:function(e,t,r){var n=r(7854),i=r(614),s=function(e){return i(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?s(n[e]):n[e]&&n[e][t]}},8173:function(e,t,r){var n=r(9662),i=r(8554);e.exports=function(e,t){var r=e[t];return i(r)?void 0:n(r)}},7854:function(e,t,r){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof r.g&&r.g)||function(){return this}()||Function("return this")()},2597:function(e,t,r){var n=r(1702),i=r(7908),s=n({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return s(i(e),t)}},3501:function(e){e.exports={}},4664:function(e,t,r){var n=r(9781),i=r(7293),s=r(317);e.exports=!n&&!i((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},8361:function(e,t,r){var n=r(1702),i=r(7293),s=r(4326),o=Object,a=n("".split);e.exports=i((function(){return!o("z").propertyIsEnumerable(0)}))?function(e){return"String"==s(e)?a(e,""):o(e)}:o},2788:function(e,t,r){var n=r(1702),i=r(614),s=r(5465),o=n(Function.toString);i(s.inspectSource)||(s.inspectSource=function(e){return o(e)}),e.exports=s.inspectSource},9909:function(e,t,r){var n,i,s,o=r(4811),a=r(7854),c=r(111),l=r(8880),u=r(2597),h=r(5465),d=r(6200),f=r(3501),p="Object already initialized",y=a.TypeError,g=a.WeakMap,m=function(e){return s(e)?i(e):n(e,{})},w=function(e){return function(t){var r;if(!c(t)||(r=i(t)).type!==e)throw y("Incompatible receiver, "+e+" required");return r}};if(o||h.state){var b=h.state||(h.state=new g);b.get=b.get,b.has=b.has,b.set=b.set,n=function(e,t){if(b.has(e))throw y(p);return t.facade=e,b.set(e,t),t},i=function(e){return b.get(e)||{}},s=function(e){return b.has(e)}}else{var v=d("state");f[v]=!0,n=function(e,t){if(u(e,v))throw y(p);return t.facade=e,l(e,v,t),t},i=function(e){return u(e,v)?e[v]:{}},s=function(e){return u(e,v)}}e.exports={set:n,get:i,has:s,enforce:m,getterFor:w}},3157:function(e,t,r){var n=r(4326);e.exports=Array.isArray||function(e){return"Array"==n(e)}},614:function(e,t,r){var n=r(4154),i=n.all;e.exports=n.IS_HTMLDDA?function(e){return"function"==typeof e||e===i}:function(e){return"function"==typeof e}},4705:function(e,t,r){var n=r(7293),i=r(614),s=/#|\.prototype\./,o=function(e,t){var r=c[a(e)];return r==u||r!=l&&(i(t)?n(t):!!t)},a=o.normalize=function(e){return String(e).replace(s,".").toLowerCase()},c=o.data={},l=o.NATIVE="N",u=o.POLYFILL="P";e.exports=o},8554:function(e){e.exports=function(e){return null===e||void 0===e}},111:function(e,t,r){var n=r(614),i=r(4154),s=i.all;e.exports=i.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:n(e)||e===s}:function(e){return"object"==typeof e?null!==e:n(e)}},1913:function(e){e.exports=!1},2190:function(e,t,r){var n=r(5005),i=r(614),s=r(7976),o=r(3307),a=Object;e.exports=o?function(e){return"symbol"==typeof e}:function(e){var t=n("Symbol");return i(t)&&s(t.prototype,a(e))}},6244:function(e,t,r){var n=r(7466);e.exports=function(e){return n(e.length)}},6339:function(e,t,r){var n=r(7293),i=r(614),s=r(2597),o=r(9781),a=r(6530).CONFIGURABLE,c=r(2788),l=r(9909),u=l.enforce,h=l.get,d=Object.defineProperty,f=o&&!n((function(){return 8!==d((function(){}),"length",{value:8}).length})),p=String(String).split("String"),y=e.exports=function(e,t,r){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!s(e,"name")||a&&e.name!==t)&&(o?d(e,"name",{value:t,configurable:!0}):e.name=t),f&&r&&s(r,"arity")&&e.length!==r.arity&&d(e,"length",{value:r.arity});try{r&&s(r,"constructor")&&r.constructor?o&&d(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(i){}var n=u(e);return s(n,"source")||(n.source=p.join("string"==typeof t?t:"")),e};Function.prototype.toString=y((function(){return i(this)&&h(this).source||c(this)}),"toString")},4758:function(e){var t=Math.ceil,r=Math.floor;e.exports=Math.trunc||function(e){var n=+e;return(n>0?r:t)(n)}},3070:function(e,t,r){var n=r(9781),i=r(4664),s=r(3353),o=r(9670),a=r(4948),c=TypeError,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",f="writable";t.f=n?s?function(e,t,r){if(o(e),t=a(t),o(r),"function"===typeof e&&"prototype"===t&&"value"in r&&f in r&&!r[f]){var n=u(e,t);n&&n[f]&&(e[t]=r.value,r={configurable:d in r?r[d]:n[d],enumerable:h in r?r[h]:n[h],writable:!1})}return l(e,t,r)}:l:function(e,t,r){if(o(e),t=a(t),o(r),i)try{return l(e,t,r)}catch(n){}if("get"in r||"set"in r)throw c("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},1236:function(e,t,r){var n=r(9781),i=r(6916),s=r(5296),o=r(9114),a=r(5656),c=r(4948),l=r(2597),u=r(4664),h=Object.getOwnPropertyDescriptor;t.f=n?h:function(e,t){if(e=a(e),t=c(t),u)try{return h(e,t)}catch(r){}if(l(e,t))return o(!i(s.f,e,t),e[t])}},8006:function(e,t,r){var n=r(6324),i=r(748),s=i.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,s)}},5181:function(e,t){t.f=Object.getOwnPropertySymbols},7976:function(e,t,r){var n=r(1702);e.exports=n({}.isPrototypeOf)},6324:function(e,t,r){var n=r(1702),i=r(2597),s=r(5656),o=r(1318).indexOf,a=r(3501),c=n([].push);e.exports=function(e,t){var r,n=s(e),l=0,u=[];for(r in n)!i(a,r)&&i(n,r)&&c(u,r);while(t.length>l)i(n,r=t[l++])&&(~o(u,r)||c(u,r));return u}},5296:function(e,t){"use strict";var r={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,i=n&&!r.call({1:2},1);t.f=i?function(e){var t=n(this,e);return!!t&&t.enumerable}:r},2140:function(e,t,r){var n=r(6916),i=r(614),s=r(111),o=TypeError;e.exports=function(e,t){var r,a;if("string"===t&&i(r=e.toString)&&!s(a=n(r,e)))return a;if(i(r=e.valueOf)&&!s(a=n(r,e)))return a;if("string"!==t&&i(r=e.toString)&&!s(a=n(r,e)))return a;throw o("Can't convert object to primitive value")}},3887:function(e,t,r){var n=r(5005),i=r(1702),s=r(8006),o=r(5181),a=r(9670),c=i([].concat);e.exports=n("Reflect","ownKeys")||function(e){var t=s.f(a(e)),r=o.f;return r?c(t,r(e)):t}},4488:function(e,t,r){var n=r(8554),i=TypeError;e.exports=function(e){if(n(e))throw i("Can't call method on "+e);return e}},6200:function(e,t,r){var n=r(2309),i=r(9711),s=n("keys");e.exports=function(e){return s[e]||(s[e]=i(e))}},5465:function(e,t,r){var n=r(7854),i=r(3072),s="__core-js_shared__",o=n[s]||i(s,{});e.exports=o},2309:function(e,t,r){var n=r(1913),i=r(5465);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.26.1",mode:n?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.1/LICENSE",source:"https://github.com/zloirock/core-js"})},6293:function(e,t,r){var n=r(7392),i=r(7293);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},1400:function(e,t,r){var n=r(9303),i=Math.max,s=Math.min;e.exports=function(e,t){var r=n(e);return r<0?i(r+t,0):s(r,t)}},5656:function(e,t,r){var n=r(8361),i=r(4488);e.exports=function(e){return n(i(e))}},9303:function(e,t,r){var n=r(4758);e.exports=function(e){var t=+e;return t!==t||0===t?0:n(t)}},7466:function(e,t,r){var n=r(9303),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},7908:function(e,t,r){var n=r(4488),i=Object;e.exports=function(e){return i(n(e))}},7593:function(e,t,r){var n=r(6916),i=r(111),s=r(2190),o=r(8173),a=r(2140),c=r(5112),l=TypeError,u=c("toPrimitive");e.exports=function(e,t){if(!i(e)||s(e))return e;var r,c=o(e,u);if(c){if(void 0===t&&(t="default"),r=n(c,e,t),!i(r)||s(r))return r;throw l("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},4948:function(e,t,r){var n=r(7593),i=r(2190);e.exports=function(e){var t=n(e,"string");return i(t)?t:t+""}},6330:function(e){var t=String;e.exports=function(e){try{return t(e)}catch(r){return"Object"}}},9711:function(e,t,r){var n=r(1702),i=0,s=Math.random(),o=n(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+o(++i+s,36)}},3307:function(e,t,r){var n=r(6293);e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:function(e,t,r){var n=r(9781),i=r(7293);e.exports=n&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},4811:function(e,t,r){var n=r(7854),i=r(614),s=n.WeakMap;e.exports=i(s)&&/native code/.test(String(s))},5112:function(e,t,r){var n=r(7854),i=r(2309),s=r(2597),o=r(9711),a=r(6293),c=r(3307),l=i("wks"),u=n.Symbol,h=u&&u["for"],d=c?u:u&&u.withoutSetter||o;e.exports=function(e){if(!s(l,e)||!a&&"string"!=typeof l[e]){var t="Symbol."+e;a&&s(u,e)?l[e]=u[e]:l[e]=c&&h?h(t):d(t)}return l[e]}},7658:function(e,t,r){"use strict";var n=r(2109),i=r(7908),s=r(6244),o=r(3658),a=r(7207),c=r(7293),l=c((function(){return 4294967297!==[].push.call({length:4294967296},1)})),u=!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}();n({target:"Array",proto:!0,arity:1,forced:l||u},{push:function(e){var t=i(this),r=s(t),n=arguments.length;a(r+n);for(var c=0;c<n;c++)t[r]=arguments[c],r++;return o(t,r),r}})},1227:function(e,t,r){function n(){return!("undefined"===typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"===typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function i(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)}function s(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(r){}}function o(){let e;try{e=t.storage.getItem("debug")}catch(r){}return!e&&"undefined"!==typeof process&&"env"in process&&(e={NODE_ENV:"production",BASE_URL:"/browser-vue/"}.DEBUG),e}function a(){try{return localStorage}catch(e){}}t.formatArgs=i,t.save=s,t.load=o,t.useColors=n,t.storage=a(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(2447)(t);const{formatters:c}=e.exports;c.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},2447:function(e,t,r){function n(e){function t(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return n.colors[Math.abs(t)%n.colors.length]}function n(e){let t,r,s,o=null;function a(...e){if(!a.enabled)return;const r=a,i=Number(new Date),s=i-(t||i);r.diff=s,r.prev=t,r.curr=i,t=i,e[0]=n.coerce(e[0]),"string"!==typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((t,i)=>{if("%%"===t)return"%";o++;const s=n.formatters[i];if("function"===typeof s){const n=e[o];t=s.call(r,n),e.splice(o,1),o--}return t})),n.formatArgs.call(r,e);const c=r.log||n.log;c.apply(r,e)}return a.namespace=e,a.useColors=n.useColors(),a.color=n.selectColor(e),a.extend=i,a.destroy=n.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(r!==n.namespaces&&(r=n.namespaces,s=n.enabled(e)),s),set:e=>{o=e}}),"function"===typeof n.init&&n.init(a),a}function i(e,t){const r=n(this.namespace+("undefined"===typeof t?":":t)+e);return r.log=this.log,r}function s(e){let t;n.save(e),n.namespaces=e,n.names=[],n.skips=[];const r=("string"===typeof e?e:"").split(/[\s,]+/),i=r.length;for(t=0;t<i;t++)r[t]&&(e=r[t].replace(/\*/g,".*?"),"-"===e[0]?n.skips.push(new RegExp("^"+e.slice(1)+"$")):n.names.push(new RegExp("^"+e+"$")))}function o(){const e=[...n.names.map(c),...n.skips.map(c).map((e=>"-"+e))].join(",");return n.enable(""),e}function a(e){if("*"===e[e.length-1])return!0;let t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1}function c(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}function l(e){return e instanceof Error?e.stack||e.message:e}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.debug=n,n.default=n,n.coerce=l,n.disable=o,n.enable=s,n.enabled=a,n.humanize=r(7824),n.destroy=u,Object.keys(e).forEach((t=>{n[t]=e[t]})),n.names=[],n.skips=[],n.formatters={},n.selectColor=t,n.enable(n.load()),n}e.exports=n},5780:function(e){"use strict";const t=(e,t)=>Math.floor(Math.random()*(t-e+1)+e),r=()=>{const e=new Error("Delay aborted");return e.name="AbortError",e},n=({clearTimeout:e,setTimeout:t,willResolve:n})=>(i,{value:s,signal:o}={})=>{if(o&&o.aborted)return Promise.reject(r());let a,c,l;const u=e||clearTimeout,h=()=>{u(a),l(r())},d=()=>{o&&o.removeEventListener("abort",h)},f=new Promise(((e,r)=>{c=()=>{d(),n?e(s):r(s)},l=r,a=(t||setTimeout)(c,i)}));return o&&o.addEventListener("abort",h,{once:!0}),f.clear=()=>{u(a),a=null,c()},f},i=e=>{const r=n({...e,willResolve:!0});return r.reject=n({...e,willResolve:!1}),r.range=(e,n,i)=>r(t(e,n),i),r},s=i();s.createWithTimers=i,e.exports=s,e.exports["default"]=s},5001:function(e){"use strict";function t(e,t){t=t||{};this._head=0,this._tail=0,this._capacity=t.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(e)&&this._fromArray(e)}t.prototype.peekAt=function(e){var t=e;if(t===(0|t)){var r=this.size();if(!(t>=r||t<-r))return t<0&&(t+=r),t=this._head+t&this._capacityMask,this._list[t]}},t.prototype.get=function(e){return this.peekAt(e)},t.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},t.prototype.peekFront=function(){return this.peek()},t.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(t.prototype,"length",{get:function(){return this.size()}}),t.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.unshift=function(e){if(void 0===e)return this.size();var t=this._list.length;return this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}},t.prototype.push=function(e){if(void 0===e)return this.size();var t=this._tail;return this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var r=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),r}},t.prototype.removeOne=function(e){var t=e;if(t===(0|t)&&this._head!==this._tail){var r=this.size(),n=this._list.length;if(!(t>=r||t<-r)){t<0&&(t+=r),t=this._head+t&this._capacityMask;var i,s=this._list[t];if(e<r/2){for(i=e;i>0;i--)this._list[t]=this._list[t=t-1+n&this._capacityMask];this._list[t]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(i=r-1-e;i>0;i--)this._list[t]=this._list[t=t+1+n&this._capacityMask];this._list[t]=void 0,this._tail=this._tail-1+n&this._capacityMask}return s}}},t.prototype.remove=function(e,t){var r,n=e,i=t;if(n===(0|n)&&this._head!==this._tail){var s=this.size(),o=this._list.length;if(!(n>=s||n<-s||t<1)){if(n<0&&(n+=s),1===t||!t)return r=new Array(1),r[0]=this.removeOne(n),r;if(0===n&&n+t>=s)return r=this.toArray(),this.clear(),r;var a;for(n+t>s&&(t=s-n),r=new Array(t),a=0;a<t;a++)r[a]=this._list[this._head+n+a&this._capacityMask];if(n=this._head+n&this._capacityMask,e+t===s){for(this._tail=this._tail-t+o&this._capacityMask,a=t;a>0;a--)this._list[n=n+1+o&this._capacityMask]=void 0;return r}if(0===e){for(this._head=this._head+t+o&this._capacityMask,a=t-1;a>0;a--)this._list[n=n+1+o&this._capacityMask]=void 0;return r}if(n<s/2){for(this._head=this._head+e+t+o&this._capacityMask,a=e;a>0;a--)this.unshift(this._list[n=n-1+o&this._capacityMask]);n=this._head-1+o&this._capacityMask;while(i>0)this._list[n=n-1+o&this._capacityMask]=void 0,i--;e<0&&(this._tail=n)}else{for(this._tail=n,n=n+t+o&this._capacityMask,a=s-(t+e);a>0;a--)this.push(this._list[n++]);n=this._tail;while(i>0)this._list[n=n+1+o&this._capacityMask]=void 0,i--}return this._head<2&&this._tail>1e4&&this._tail<=o>>>2&&this._shrinkArray(),r}}},t.prototype.splice=function(e,t){var r=e;if(r===(0|r)){var n=this.size();if(r<0&&(r+=n),!(r>n)){if(arguments.length>2){var i,s,o,a=arguments.length,c=this._list.length,l=2;if(!n||r<n/2){for(s=new Array(r),i=0;i<r;i++)s[i]=this._list[this._head+i&this._capacityMask];0===t?(o=[],r>0&&(this._head=this._head+r+c&this._capacityMask)):(o=this.remove(r,t),this._head=this._head+r+c&this._capacityMask);while(a>l)this.unshift(arguments[--a]);for(i=r;i>0;i--)this.unshift(s[i-1])}else{s=new Array(n-(r+t));var u=s.length;for(i=0;i<u;i++)s[i]=this._list[this._head+r+t+i&this._capacityMask];0===t?(o=[],r!=n&&(this._tail=this._head+r+c&this._capacityMask)):(o=this.remove(r,t),this._tail=this._tail-u+c&this._capacityMask);while(l<a)this.push(arguments[l++]);for(i=0;i<u;i++)this.push(s[i])}return o}return this.remove(r,t)}}},t.prototype.clear=function(){this._head=0,this._tail=0},t.prototype.isEmpty=function(){return this._head===this._tail},t.prototype.toArray=function(){return this._copyArray(!1)},t.prototype._fromArray=function(e){for(var t=0;t<e.length;t++)this.push(e[t])},t.prototype._copyArray=function(e){var t,r=[],n=this._list,i=n.length;if(e||this._head>this._tail){for(t=this._head;t<i;t++)r.push(n[t]);for(t=0;t<this._tail;t++)r.push(n[t])}else for(t=this._head;t<this._tail;t++)r.push(n[t]);return r},t.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1},t.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1},e.exports=t},6905:function(e){!function(t,r){e.exports=function(e,t,r,n,i){for(t=t.split?t.split("."):t,n=0;n<t.length;n++)e=e?e[t[n]]:i;return e===i?r:e}}()},2114:function(e){"use strict";function t(e,t){for(const r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}function r(e,r,n){if(!e||"string"===typeof e)throw new TypeError("Please pass an Error to err-code");n||(n={}),"object"===typeof r&&(n=r,r=""),r&&(n.code=r);try{return t(e,n)}catch(i){n.message=e.message,n.stack=e.stack;const r=function(){};r.prototype=Object.create(Object.getPrototypeOf(e));const s=t(new r,n);return s}}e.exports=r},507:function(e,t,r){"use strict";const n=r(8231);function i(e,t,r){return new n.EventIterator((({push:r})=>(this.addEventListener(e,r,t),()=>this.removeEventListener(e,r,t))),r)}t.zN=n.EventIterator,n.EventIterator},8231:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;const t={value:e,done:!1};if(this.pullQueue.length){const e=this.pullQueue.shift();e&&e.resolve(t)}else this.pushQueue.push(Promise.resolve(t)),void 0!==this.highWaterMark&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(const e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(const t of this.pullQueue)t.reject(e);this.pullQueue.length=0}else{const t=Promise.reject(e);t.catch((()=>{})),this.pushQueue.push(t)}}remove(){Promise.resolve().then((()=>{this.removeCallback&&this.removeCallback()}))}[Symbol.asyncIterator](){return{next:e=>{const t=this.pushQueue.shift();return t?(void 0!==this.lowWaterMark&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),t):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise(((e,t)=>{this.pullQueue.push({resolve:e,reject:t})}))},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}}class n{constructor(e,{highWaterMark:t=100,lowWaterMark:n=1}={}){const i=new r;i.highWaterMark=t,i.lowWaterMark=n,i.removeCallback=e({push:e=>i.push(e),stop:()=>i.stop(),fail:e=>i.fail(e),on:(e,t)=>{i.eventHandlers[e]=t}})||(()=>{}),this[Symbol.asyncIterator]=()=>i[Symbol.asyncIterator](),Object.freeze(this)}}t.EventIterator=n,t["default"]=n},6729:function(e){"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function s(e,t,n,s,o){if("function"!==typeof n)throw new TypeError("The listener must be a function");var a=new i(n,s||e,o),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function o(e,t){0===--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,o=new Array(s);i<s;i++)o[i]=n[i].fn;return o},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,i,s,o){var a=r?r+e:e;if(!this._events[a])return!1;var c,l,u=this._events[a],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,i),!0;case 5:return u.fn.call(u.context,t,n,i,s),!0;case 6:return u.fn.call(u.context,t,n,i,s,o),!0}for(l=1,c=new Array(h-1);l<h;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var d,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),h){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,n);break;case 4:u[l].fn.call(u[l].context,t,n,i);break;default:if(!c)for(d=1,c=new Array(h-1);d<h;d++)c[d-1]=arguments[d];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(e,t,r){return s(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return s(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,i){var s=r?r+e:e;if(!this._events[s])return this;if(!t)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==t||i&&!a.once||n&&a.context!==n||o(this,s);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==t||i&&!a[c].once||n&&a[c].context!==n)&&l.push(a[c]);l.length?this._events[s]=1===l.length?l[0]:l:o(this,s)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},7187:function(e){"use strict";var t,r="object"===typeof Reflect?Reflect:null,n=r&&"function"===typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};function i(e){console&&console.warn&&console.warn(e)}t=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!==e};function o(){o.init.call(this)}e.exports=o,e.exports.once=w,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function c(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var s,o,a;if(c(r),o=e._events,void 0===o?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),a=o[t]),void 0===a)a=o[t]=r,++e._eventsCount;else if("function"===typeof a?a=o[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),s=l(e),s>0&&a.length>s&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,i(u)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=h.bind(n);return i.listener=r,n.wrapFn=i,i}function f(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"===typeof i?r?[i.listener||i]:[i]:r?m(i):y(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function y(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function g(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function m(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function w(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,s),n(r)}function s(){"function"===typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}v(e,t,s,{once:!0}),"error"!==t&&b(e,i,{once:!0})}))}function b(e,t,r){"function"===typeof e.on&&v(e,"error",t,r)}function v(e,t,r,n){if("function"===typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(s){n.once&&e.removeEventListener(t,i),r(s)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!==typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(void 0===c)return!1;if("function"===typeof c)n(c,this,t);else{var l=c.length,u=y(c,l);for(r=0;r<l;++r)n(u[r],this,t)}return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return c(t),this.on(e,d(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,d(this,e,t)),this},o.prototype.removeListener=function(e,t){var r,n,i,s,o;if(c(t),n=this._events,void 0===n)return this;if(r=n[e],void 0===r)return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!==typeof r){for(i=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){o=r[s].listener,i=s;break}if(i<0)return this;0===i?r.shift():g(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,r,n;if(r=this._events,void 0===r)return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,s=Object.keys(r);for(n=0;n<s.length;++n)i=s[n],"removeListener"!==i&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],"function"===typeof t)this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return f(this,e,!0)},o.prototype.rawListeners=function(e){return f(this,e,!1)},o.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},3975:function(e){e.exports=class{constructor(e){if(!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return void 0===this.buffer[this.btm]}}},1607:function(e,t,r){const n=r(3975);e.exports=class{constructor(e){this.hwm=e||16,this.head=new n(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){const t=this.head;this.head=t.next=new n(2*this.head.buffer.length),this.head.push(e)}}shift(){const e=this.tail.shift();if(void 0===e&&this.tail.next){const e=this.tail.next;return this.tail.next=null,this.tail=e,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}},6132:function(e,t){"use strict";function r(e,t=r.BASE){const n=e.length;for(let r=0;r<n;r++)t^=e.charCodeAt(r),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}Object.defineProperty(t,"__esModule",{value:!0}),r.BASE=2166136261,t["default"]=r,e.exports=r},248:function(e){e.exports=function(e){if(!e)throw Error("hashlru must have a max value, of type number, greater than 0");var t=0,r=Object.create(null),n=Object.create(null);function i(i,s){r[i]=s,t++,t>=e&&(t=0,n=r,r=Object.create(null))}return{has:function(e){return void 0!==r[e]||void 0!==n[e]},remove:function(e){void 0!==r[e]&&(r[e]=void 0),void 0!==n[e]&&(n[e]=void 0)},get:function(e){var t=r[e];return void 0!==t?t:void 0!==(t=n[e])?(i(e,t),t):void 0},set:function(e,t){void 0!==r[e]?r[e]=t:i(e,t)},clear:function(){r=Object.create(null),n=Object.create(null)}}}},645:function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,r,n,i){var s,o,a=8*i-n-1,c=(1<<a)-1,l=c>>1,u=-7,h=r?i-1:0,d=r?-1:1,f=e[t+h];for(h+=d,s=f&(1<<-u)-1,f>>=-u,u+=a;u>0;s=256*s+e[t+h],h+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;u>0;o=256*o+e[t+h],h+=d,u-=8);if(0===s)s=1-l;else{if(s===c)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,n),s-=l}return(f?-1:1)*o*Math.pow(2,s-n)},t.write=function(e,t,r,n,i,s){var o,a,c,l=8*s-i-1,u=(1<<l)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:s-1,p=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),t+=o+h>=1?d/c:d*Math.pow(2,1-h),t*c>=2&&(o++,c/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(t*c-1)*Math.pow(2,i),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[r+f]=255&a,f+=p,a/=256,i-=8);for(o=o<<i|a,l+=i;l>0;e[r+f]=255&o,f+=p,o/=256,l-=8);e[r+f-p]|=128*y}},1476:function(e){"use strict";const t="[a-fA-F\\d:]",r=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${t})|(?<=${t})(?=\\s|$))`:"",n="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",i="[a-fA-F\\d]{1,4}",s=`\n(?:\n(?:${i}:){7}(?:${i}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${i}:){6}(?:${n}|:${i}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${i}:){5}(?::${n}|(?::${i}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${i}:){4}(?:(?::${i}){0,1}:${n}|(?::${i}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${i}:){3}(?:(?::${i}){0,2}:${n}|(?::${i}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${i}:){2}(?:(?::${i}){0,3}:${n}|(?::${i}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${i}:){1}(?:(?::${i}){0,4}:${n}|(?::${i}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::${i}){0,5}:${n}|(?::${i}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),o=new RegExp(`(?:^${n}$)|(?:^${s}$)`),a=new RegExp(`^${n}$`),c=new RegExp(`^${s}$`),l=e=>e&&e.exact?o:new RegExp(`(?:${r(e)}${n}${r(e)})|(?:${r(e)}${s}${r(e)})`,"g");l.v4=e=>e&&e.exact?a:new RegExp(`${r(e)}${n}${r(e)}`,"g"),l.v6=e=>e&&e.exact?c:new RegExp(`${r(e)}${s}${r(e)}`,"g"),e.exports=l},6512:function(e){(function(t){"use strict";const r="(0?\\d+|0x[a-f0-9]+)",n={fourOctet:new RegExp(`^${r}\\.${r}\\.${r}\\.${r}$`,"i"),threeOctet:new RegExp(`^${r}\\.${r}\\.${r}$`,"i"),twoOctet:new RegExp(`^${r}\\.${r}$`,"i"),longValue:new RegExp(`^${r}$`,"i")},i=new RegExp("^0[0-7]+$","i"),s=new RegExp("^0x[a-f0-9]+$","i"),o="%[0-9a-z]{1,}",a="(?:[0-9a-f]+::?)+",c={zoneIndex:new RegExp(o,"i"),native:new RegExp(`^(::)?(${a})?([0-9a-f]+)?(::)?(${o})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${r}\\.${r}\\.${r}\\.${r}(${o})?)$`,"i"),transitional:new RegExp(`^((?:${a})|(?:::)(?:${a})?)${r}\\.${r}\\.${r}\\.${r}(${o})?$`,"i")};function l(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let r,n,i=0,s=-1,o=(e.match(c.zoneIndex)||[])[0];o&&(o=o.substring(1),e=e.replace(/%.+$/,""));while((s=e.indexOf(":",s+1))>=0)i++;if("::"===e.substr(0,2)&&i--,"::"===e.substr(-2,2)&&i--,i>t)return null;n=t-i,r=":";while(n--)r+="0:";return e=e.replace("::",r),":"===e[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),t=function(){const t=e.split(":"),r=[];for(let e=0;e<t.length;e++)r.push(parseInt(t[e],16));return r}(),{parts:t,zoneId:o}}function u(e,t,r,n){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let i,s=0;while(n>0){if(i=r-n,i<0&&(i=0),e[s]>>i!==t[s]>>i)return!1;n-=r,s+=1}return!0}function h(e){if(s.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(i.test(e))return parseInt(e,8);throw new Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}function d(e,t){while(e.length<t)e=`0${e}`;return e}const f={};f.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,r;for(t=0;t<e.length;t++)if(r=e[t],!(0<=r&&r<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let n,i,s;for(n=3;n>=0;n-=1){if(i=this.octets[n],!(i in r))return null;if(s=r[i],t&&0!==s)return null;8!==s&&(t=!0),e+=s}return 32-e},e.prototype.range=function(){return f.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return f.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),f.IPv4.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),r=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let s=0;while(s<4)i.push(parseInt(r[s],10)|255^parseInt(n[s],10)),s++;return new this(i)}catch(t){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},f.IPv4.isIPv4=function(e){return null!==this.parser(e)},f.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(t){return!1}},f.IPv4.isValidFourPartDecimal=function(e){return!(!f.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},f.IPv4.networkAddressFromCIDR=function(e){let t,r,n,i,s;try{t=this.parseCIDR(e),n=t[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],r=0;while(r<4)i.push(parseInt(n[r],10)&parseInt(s[r],10)),r++;return new this(i)}catch(o){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},f.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},f.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const r=[this.parse(t[1]),e];return Object.defineProperty(r,"toString",{value:function(){return this.join("/")}}),r}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},f.IPv4.parser=function(e){let t,r,i;if(t=e.match(n.fourOctet))return function(){const e=t.slice(1,6),n=[];for(let t=0;t<e.length;t++)r=e[t],n.push(h(r));return n}();if(t=e.match(n.longValue)){if(i=h(t[1]),i>4294967295||i<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(i>>t&255);return e}().reverse()}return(t=e.match(n.twoOctet))?function(){const e=t.slice(1,4),r=[];if(i=h(e[1]),i>16777215||i<0)throw new Error("ipaddr: address outside defined range");return r.push(h(e[0])),r.push(i>>16&255),r.push(i>>8&255),r.push(255&i),r}():(t=e.match(n.threeOctet))?function(){const e=t.slice(1,5),r=[];if(i=h(e[2]),i>65535||i<0)throw new Error("ipaddr: address outside defined range");return r.push(h(e[0])),r.push(h(e[1])),r.push(i>>8&255),r.push(255&i),r}():null},f.IPv4.subnetMaskFromPrefixLength=function(e){if(e=parseInt(e),e<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let r=0;const n=Math.floor(e/8);while(r<n)t[r]=255,r++;return n<4&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},f.IPv6=function(){function e(e,t){let r,n;if(16===e.length)for(this.parts=[],r=0;r<=14;r+=2)this.parts.push(e[r]<<8|e[r+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(r=0;r<this.parts.length;r++)if(n=this.parts[r],!(0<=n&&n<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let n,i;for(let s=7;s>=0;s-=1){if(n=this.parts[s],!(n in r))return null;if(i=r[n],t&&0!==i)return null;16!==i&&(t=!0),e+=i}return 128-e},e.prototype.range=function(){return f.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],r=this.parts;for(let n=0;n<r.length;n++)e=r[n],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(d(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],r=e[1];return new f.IPv4([t>>8,255&t,r>>8,255&r])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let r,n=0,i=-1;while(r=e.exec(t))r[0].length>i&&(n=r.index,i=r[0].length);return i<0?t:`${t.substring(0,n)}::${t.substring(n+i)}`},e.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},e}(),f.IPv6.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),r=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let s=0;while(s<16)i.push(parseInt(r[s],10)|255^parseInt(n[s],10)),s++;return new this(i)}catch(t){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${t})`)}},f.IPv6.isIPv6=function(e){return null!==this.parser(e)},f.IPv6.isValid=function(e){if("string"===typeof e&&-1===e.indexOf(":"))return!1;try{const t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(t){return!1}},f.IPv6.networkAddressFromCIDR=function(e){let t,r,n,i,s;try{t=this.parseCIDR(e),n=t[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],r=0;while(r<16)i.push(parseInt(n[r],10)&parseInt(s[r],10)),r++;return new this(i)}catch(o){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${o})`)}},f.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},f.IPv6.parseCIDR=function(e){let t,r,n;if((r=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(r[2]),t>=0&&t<=128))return n=[this.parse(r[1]),t],Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},f.IPv6.parser=function(e){let t,r,n,i,s,o;if(n=e.match(c.deprecatedTransitional))return this.parser(`::ffff:${n[1]}`);if(c.native.test(e))return l(e,8);if((n=e.match(c.transitional))&&(o=n[6]||"",t=l(n[1].slice(0,-1)+o,6),t.parts)){for(s=[parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5])],r=0;r<s.length;r++)if(i=s[r],!(0<=i&&i<=255))return null;return t.parts.push(s[0]<<8|s[1]),t.parts.push(s[2]<<8|s[3]),{parts:t.parts,zoneId:t.zoneId}}return null},f.IPv6.subnetMaskFromPrefixLength=function(e){if(e=parseInt(e),e<0||e>128)throw new Error("ipaddr: invalid IPv6 prefix length");const t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let r=0;const n=Math.floor(e/8);while(r<n)t[r]=255,r++;return n<16&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},f.fromByteArray=function(e){const t=e.length;if(4===t)return new f.IPv4(e);if(16===t)return new f.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},f.isValid=function(e){return f.IPv6.isValid(e)||f.IPv4.isValid(e)},f.parse=function(e){if(f.IPv6.isValid(e))return f.IPv6.parse(e);if(f.IPv4.isValid(e))return f.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},f.parseCIDR=function(e){try{return f.IPv6.parseCIDR(e)}catch(t){try{return f.IPv4.parseCIDR(e)}catch(r){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},f.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},f.subnetMatch=function(e,t,r){let n,i,s,o;for(i in void 0!==r&&null!==r||(r="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,i))for(s=t[i],!s[0]||s[0]instanceof Array||(s=[s]),n=0;n<s.length;n++)if(o=s[n],e.kind()===o[0].kind()&&e.match.apply(e,o))return i;return r},e.exports?e.exports=f:t.ipaddr=f})(this)},2413:function(e,t,r){"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?e.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:e.exports={default:r(3300)["default"],Headers:r(3300).Headers,Request:r(3300).Request,Response:r(3300).Response}},106:function(e,t,r){"use strict";const n=r(9134),i="object"===typeof window&&"object"===typeof document&&9===document.nodeType,s=n(),o=i&&!s,a=s&&!i,c=s&&i,l="undefined"!==typeof process&&"undefined"!==typeof process.release&&"node"===process.release.name&&!s,u="function"===typeof importScripts&&"undefined"!==typeof self&&"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,h="undefined"!==typeof process&&!1,d="undefined"!==typeof navigator&&"ReactNative"===navigator.product;e.exports={isTest:h,isElectron:s,isElectronMain:a,isElectronRenderer:c,isNode:l,isBrowser:o,isWebWorker:u,isEnvWithDom:i,isReactNative:d}},8688:function(e,t,r){"use strict";e.exports=r(2413)},749:function(e,t,r){"use strict";const n=r(7137),i=(e,t)=>({path:decodeURIComponent(new URL(e).pathname.split("/").pop()||""),content:s(e,t)});async function*s(e,t){const r=new n,i=await r.get(e,t);yield*i.iterator()}e.exports=i},7137:function(e,t,r){"use strict";const{fetch:n,Request:i,Headers:s}=r(730),{TimeoutError:o,HTTPError:a}=r(4171),c=r(942).bind({ignoreUndefined:!0}),{URL:l,URLSearchParams:u}=r(7745),h=r(2044),d=(e,t,r)=>{if(void 0===t)return e;const n=Date.now(),i=()=>{const e=Date.now()-n;return e>=t};return new Promise(((n,s)=>{const a=setTimeout((()=>{i()&&(s(new o),r.abort())}),t),c=e=>{const t=t=>{clearTimeout(a),i()?s(new o):e(t)};return t};e.then(c(n),c(s))}))},f={throwHttpErrors:!0,credentials:"same-origin"};class p{constructor(e={}){this.opts=c(f,e)}async fetch(e,t={}){const r=c(this.opts,t),o=new s(r.headers);if("string"!==typeof e&&!(e instanceof l||e instanceof i))throw new TypeError("`resource` must be a string, URL, or Request");const f=new l(e.toString(),r.base),{searchParams:p,transformSearchParams:m,json:w}=r;p&&(f.search="function"===typeof m?m(new u(r.searchParams)):new u(r.searchParams)),w&&(r.body=JSON.stringify(r.json),o.set("content-type","application/json"));const b=new AbortController,v=h([b.signal,r.signal]),E=await d(n(f.toString(),{...r,signal:v,timeout:void 0,headers:o}),r.timeout,b);if(!E.ok&&r.throwHttpErrors)throw r.handleError&&await r.handleError(E),new a(E);return E.iterator=async function*(){yield*g(E.body)},E.ndjson=async function*(){for await(const e of y(E.iterator()))t.transform?yield t.transform(e):yield e},E}post(e,t={}){return this.fetch(e,{...t,method:"POST"})}get(e,t={}){return this.fetch(e,{...t,method:"GET"})}put(e,t={}){return this.fetch(e,{...t,method:"PUT"})}delete(e,t={}){return this.fetch(e,{...t,method:"DELETE"})}options(e,t={}){return this.fetch(e,{...t,method:"OPTIONS"})}}const y=async function*(e){const t=new TextDecoder;let r="";for await(const n of e){r+=t.decode(n,{stream:!0});const e=r.split(/\r?\n/);for(let t=0;t<e.length-1;t++){const r=e[t].trim();r.length>0&&(yield JSON.parse(r))}r=e[e.length-1]}r+=t.decode(),r=r.trim(),0!==r.length&&(yield JSON.parse(r))},g=e=>{if(b(e)){const t=e[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:t.next.bind(t),return(r){return e.destroy(),"function"===typeof t.return?t.return():Promise.resolve({done:!0,value:r})}}}}}if(w(e)){const t=e.getReader();return async function*(){try{while(1){const{done:e,value:r}=await t.read();if(e)return;r&&(yield r)}}finally{t.releaseLock()}}()}if(m(e))return e;throw new TypeError("Body can't be converted to AsyncIterable")},m=e=>"object"===typeof e&&null!==e&&"function"===typeof e[Symbol.asyncIterator],w=e=>e&&"function"===typeof e.getReader,b=e=>Object.prototype.hasOwnProperty.call(e,"readable")&&Object.prototype.hasOwnProperty.call(e,"writable");p.HTTPError=a,p.TimeoutError=o,p.streamToAsyncIterator=g,p.post=(e,t)=>new p(t).post(e,t),p.get=(e,t)=>new p(t).get(e,t),p.put=(e,t)=>new p(t).put(e,t),p.delete=(e,t)=>new p(t).delete(e,t),p.options=(e,t)=>new p(t).options(e,t),e.exports=p},4171:function(e,t){"use strict";class r extends Error{constructor(e="Request timed out"){super(e),this.name="TimeoutError"}}t.TimeoutError=r;class n extends Error{constructor(e="The operation was aborted."){super(e),this.name="AbortError"}}t.AbortError=n;class i extends Error{constructor(e){super(e.statusText),this.name="HTTPError",this.response=e}}t.HTTPError=i},730:function(e,t,r){"use strict";const{TimeoutError:n,AbortError:i}=r(4171),{Response:s,Request:o,Headers:a,default:c}=r(8688),l=(e,t={})=>{const r=new XMLHttpRequest;r.open(t.method||"GET",e.toString(),!0);const{timeout:o,headers:c}=t;if(o&&o>0&&o<1/0&&(r.timeout=o),null!=t.overrideMimeType&&r.overrideMimeType(t.overrideMimeType),c)for(const[n,i]of new a(c))r.setRequestHeader(n,i);return t.signal&&(t.signal.onabort=()=>r.abort()),t.onUploadProgress&&(r.upload.onprogress=t.onUploadProgress),r.responseType="arraybuffer",new Promise(((e,o)=>{const a=t=>{switch(t.type){case"error":e(s.error());break;case"load":e(new f(r.responseURL,r.response,{status:r.status,statusText:r.statusText,headers:d(r.getAllResponseHeaders())}));break;case"timeout":o(new n);break;case"abort":o(new i);break;default:break}};r.onerror=a,r.onload=a,r.ontimeout=a,r.onabort=a,r.send(t.body)}))},u=c,h=(e,t={})=>null!=t.onUploadProgress?l(e,t):u(e,t),d=e=>{const t=new a;for(const r of e.trim().split(/[\r\n]+/)){const e=r.indexOf(": ");e>0&&t.set(r.slice(0,e),r.slice(e+1))}return t};class f extends s{constructor(e,t,r){super(t,r),Object.defineProperty(this,"url",{value:e})}}e.exports={fetch:h,Request:o,Headers:a}},2734:function(e){"use strict";var t=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;e.exports=function(e,r){if(null==r&&(r=!1),e.length<2)return!1;if(e.length>255)return!1;var n=e[e.length-1];if(r){if("."!==n)return!1}else if("."===n)return!1;return t.test(e)}},9134:function(e){function t(){return"undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type||(!("undefined"===typeof process||"object"!==typeof process.versions||!process.versions.electron)||"object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}e.exports=t},5003:function(e,t,r){"use strict";const n=r(1476),i=e=>n({exact:!0}).test(e);i.v4=e=>n.v4({exact:!0}).test(e),i.v6=e=>n.v6({exact:!0}).test(e),i.version=e=>i(e)?i.v4(e)?4:6:void 0,e.exports=i},3310:function(e){"use strict";e.exports=e=>{if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}},1993:function(e){"use strict";e.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:256,RTLD_LOCAL:0,RTLD_DEEPBIND:8,E2BIG:7,EACCES:13,EADDRINUSE:98,EADDRNOTAVAIL:99,EAFNOSUPPORT:97,EAGAIN:11,EALREADY:114,EBADF:9,EBADMSG:74,EBUSY:16,ECANCELED:125,ECHILD:10,ECONNABORTED:103,ECONNREFUSED:111,ECONNRESET:104,EDEADLK:35,EDESTADDRREQ:89,EDOM:33,EDQUOT:122,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:113,EIDRM:43,EILSEQ:84,EINPROGRESS:115,EINTR:4,EINVAL:22,EIO:5,EISCONN:106,EISDIR:21,ELOOP:40,EMFILE:24,EMLINK:31,EMSGSIZE:90,EMULTIHOP:72,ENAMETOOLONG:36,ENETDOWN:100,ENETRESET:102,ENETUNREACH:101,ENFILE:23,ENOBUFS:105,ENODATA:61,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:37,ENOLINK:67,ENOMEM:12,ENOMSG:42,ENOPROTOOPT:92,ENOSPC:28,ENOSR:63,ENOSTR:60,ENOSYS:38,ENOTCONN:107,ENOTDIR:20,ENOTEMPTY:39,ENOTSOCK:88,ENOTSUP:95,ENOTTY:25,ENXIO:6,EOPNOTSUPP:95,EOVERFLOW:75,EPERM:1,EPIPE:32,EPROTO:71,EPROTONOSUPPORT:93,EPROTOTYPE:91,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:116,ETIME:62,ETIMEDOUT:110,ETXTBSY:26,EWOULDBLOCK:11,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:7,SIGFPE:8,SIGKILL:9,SIGUSR1:10,SIGSEGV:11,SIGUSR2:12,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:17,SIGSTKFLT:16,SIGCONT:18,SIGSTOP:19,SIGTSTP:20,SIGTTIN:21,SIGTTOU:22,SIGURG:23,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:29,SIGPOLL:29,SIGPWR:30,SIGSYS:31,SIGUNUSED:31,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,UV_FS_O_FILEMAP:0,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DSYNC:4096,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488415,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},1914:function(e){"use strict";const t=65536;function r(e){const r=new Uint8Array(e);let n=0;if(e>0)if(e>t)while(n<e)n+t>e?(crypto.getRandomValues(r.subarray(n,n+(e-n))),n+=e-n):(crypto.getRandomValues(r.subarray(n,n+t)),n+=t);else crypto.getRandomValues(r);return r}e.exports=r},7745:function(e,t,r){"use strict";const{URLWithLegacySupport:n,format:i,URLSearchParams:s,defaultBase:o}=r(2049),a=r(5939);e.exports={URL:n,URLSearchParams:s,format:i,relative:a,defaultBase:o}},5939:function(e,t,r){"use strict";const{URLWithLegacySupport:n,format:i}=r(2049);e.exports=(e,t={},r={},s)=>{let o,a=t.protocol?t.protocol.replace(":",""):"http";a=(r[a]||s||a)+":";try{o=new n(e)}catch(l){o={}}const c=Object.assign({},t,{protocol:a||o.protocol,host:t.host||o.host});return new n(e,i(c)).toString()}},2049:function(e){"use strict";const t="undefined"!==typeof navigator&&"ReactNative"===navigator.product;function r(){return t?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}const n=self.URL,i=r();class s{constructor(e="",t=i){this.super=new n(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return n.createObjectURL(e)}static revokeObjectURL(e){n.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}}function o(e){if("string"===typeof e){const t=new n(e);return t.toString()}if(!(e instanceof n)){const t=e.username&&e.password?`${e.username}:${e.password}@`:"",r=e.auth?e.auth+"@":"",n=e.port?":"+e.port:"",i=e.protocol?e.protocol+"//":"",s=e.host||"",o=e.hostname||"",a=e.search||(e.query?"?"+e.query:""),c=e.hash||"",l=e.pathname||"",u=e.path||l+a;return`${i}${t||r}${s||o+n}${u}${c}`}}e.exports={URLWithLegacySupport:s,URLSearchParams:self.URLSearchParams,defaultBase:i,format:o}},1303:function(e){"use strict";const t=async e=>{const t=[];for await(const r of e)t.push(r);return t};e.exports=t},8165:function(e){"use strict";async function*t(e,t=1){let r=[];t<1&&(t=1);for await(const n of e){r.push(n);while(r.length>=t)yield r.slice(0,t),r=r.slice(t)}while(r.length)yield r.slice(0,t),r=r.slice(t)}e.exports=t},4593:function(e){"use strict";const t=async e=>{for await(const t of e);};e.exports=t},5565:function(e){"use strict";const t=async function*(e,t){for await(const r of e)await t(r)&&(yield r)};e.exports=t},80:function(e){"use strict";const t=async e=>{for await(const t of e)return t};e.exports=t},4321:function(e){"use strict";const t=async function*(e,t){for await(const r of e)await t(r),yield r};e.exports=t},3093:function(e){"use strict";const t=async e=>{let t;for await(const r of e)t=r;return t};e.exports=t},308:function(e){"use strict";const t=async e=>{let t=0;for await(const r of e)t++;return t};e.exports=t},2121:function(e){"use strict";const t=async function*(e,t){for await(const r of e)yield t(r)};e.exports=t},4014:function(e,t,r){"use strict";const n=r(8580),i=async function*(...e){const t=n();setTimeout((async()=>{try{await Promise.all(e.map((async e=>{for await(const r of e)t.push(r)}))),t.end()}catch(r){t.end(r)}}),0),yield*t};e.exports=i},8580:function(e,t,r){const n=r(1607);e.exports=e=>{let t;e=e||{},"function"===typeof e?(t=e,e={}):t=e.onEnd;let r,i,s,o=new n;const a=()=>{if(!o.isEmpty()){if(e.writev){let e;const t=[];while(!o.isEmpty()){if(e=o.shift(),e.error)throw e.error;t.push(e.value)}return{done:e.done,value:t}}const t=o.shift();if(t.error)throw t.error;return t}return s?{done:!0}:new Promise(((t,n)=>{i=s=>(i=null,s.error?n(s.error):e.writev&&!s.done?t({done:s.done,value:[s.value]}):t(s),r)}))},c=e=>i?i(e):(o.push(e),r),l=e=>(o=new n,i?i({error:e}):(o.push({error:e}),r)),u=e=>s?r:c({done:!1,value:e}),h=e=>s?r:(s=!0,e?l(e):c({done:!0})),d=()=>(o=new n,h(),{done:!0}),f=e=>(h(e),{done:!0});if(r={[Symbol.asyncIterator](){return this},next:a,return:d,throw:f,push:u,end:h},!t)return r;const p=r;return r={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(e){return p.throw(e),t&&(t(e),t=null),{done:!0}},return(){return p.return(),t&&(t(),t=null),{done:!0}},push:u,end(e){return p.end(e),t&&(t(e),t=null),r}},r}},4810:function(e,t,r){"use strict";const n=r(8165);async function*i(e,t=1){for await(const r of n(e,t)){const e=r.map((e=>e().then((e=>({ok:!0,value:e})),(e=>({ok:!1,err:e})))));for(let t=0;t<e.length;t++){const r=await e[t];if(!r.ok)throw r.err;yield r.value}}}e.exports=i},8869:function(e,t,r){"use strict";const n=r(1590),i=globalThis.CustomEvent||Event;async function*s(e,t={}){let r=t.concurrency||1/0;r<1&&(r=1/0);const s=null!=t.ordered&&t.ordered,o=new EventTarget,a=[];let c,l=n(),u=n(),h=!1,d=!1;function f(){return s?Boolean(a[0]&&a[0].done):Boolean(a.find((e=>e.done)))}function*p(){while(a.length&&a[0].done){const e=a[0];if(a.shift(),!e.ok)throw d=!0,l.resolve(),e.err;yield e.value,l.resolve()}}function*y(){while(f())for(let e=0;e<a.length;e++)if(a[e].done){const t=a[e];if(a.splice(e,1),e--,!t.ok)throw d=!0,l.resolve(),t.err;yield t.value,l.resolve()}}o.addEventListener("task-complete",(()=>{u.resolve()})),Promise.resolve().then((async()=>{try{for await(const t of e){if(a.length===r&&(l=n(),await l.promise),d)break;const e={done:!1};a.push(e),t().then((t=>{e.done=!0,e.ok=!0,e.value=t,o.dispatchEvent(new i("task-complete"))}),(t=>{e.done=!0,e.err=t,o.dispatchEvent(new i("task-complete"))}))}h=!0,o.dispatchEvent(new i("task-complete"))}catch(t){c=t,o.dispatchEvent(new i("task-complete"))}}));while(1){if(f()||(u=n(),await u.promise),c)throw c;if(s?yield*p():yield*y(),h&&0===a.length)break}}e.exports=s},1590:function(e){"use strict";const t=()=>{const e={};return e.promise=new Promise(((t,r)=>{e.resolve=t,e.reject=r})),e};e.exports=t},8132:function(e){"use strict";function t(e){const[t,r]=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>t.next(),push:e=>{n.push(e)},next:()=>n.length?{done:!1,value:n.shift()}:t.next(),[r](){return this}}}e.exports=t},7939:function(e){"use strict";const t=async function*(e,t){let r=0;if(!(t<1))for await(const n of e)if(yield n,r++,r===t)return};e.exports=t},3053:function(e,t,r){"use strict";const{concat:n}=r(605);async function i(e){let t=new Uint8Array(0);for await(const r of e)t=n([t,r],t.length+r.length);return t}e.exports=i},9507:function(e,t,r){"use strict";const n=r(1798),{EventEmitter:i}=r(7187);function s(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;++r)if(e[r]!==t[r])return!1;return!0}function o(){return{contacts:[],dontSplit:!1,left:null,right:null}}function a(e,t){if(!(t instanceof Uint8Array))throw new TypeError(e+" is not a Uint8Array")}class c extends i{constructor(e={}){super(),this.localNodeId=e.localNodeId||n(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||c.distance,this.arbiter=e.arbiter||c.arbiter,this.metadata=Object.assign({},e.metadata),a("option.localNodeId as parameter 1",this.localNodeId),this.root=o()}static arbiter(e,t){return e.vectorClock>t.vectorClock?e:t}static distance(e,t){let r=0,n=0;const i=Math.min(e.length,t.length),s=Math.max(e.length,t.length);for(;n<i;++n)r=256*r+(e[n]^t[n]);for(;n<s;++n)r=256*r+255;return r}add(e){a("contact.id",(e||{}).id);let t=0,r=this.root;while(null===r.contacts)r=this._determineNode(r,e.id,t++);const n=this._indexOf(r,e.id);return n>=0?(this._update(r,n,e),this):r.contacts.length<this.numberOfNodesPerKBucket?(r.contacts.push(e),this.emit("added",e),this):r.dontSplit?(this.emit("ping",r.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(r,t),this.add(e))}closest(e,t=1/0){if(a("id",e),!Number.isInteger(t)&&t!==1/0||t<=0)throw new TypeError("n is not positive number");let r=[];for(let n=[this.root],i=0;n.length>0&&r.length<t;){const t=n.pop();if(null===t.contacts){const r=this._determineNode(t,e,i++);n.push(t.left===r?t.right:t.left),n.push(r)}else r=r.concat(t.contacts)}return r.map((t=>[this.distance(t.id,e),t])).sort(((e,t)=>e[0]-t[0])).slice(0,t).map((e=>e[1]))}count(){let e=0;for(const t=[this.root];t.length>0;){const r=t.pop();null===r.contacts?t.push(r.right,r.left):e+=r.contacts.length}return e}_determineNode(e,t,r){const n=r>>3,i=r%8;if(t.length<=n&&0!==i)return e.left;const s=t[n];return s&1<<7-i?e.right:e.left}get(e){a("id",e);let t=0,r=this.root;while(null===r.contacts)r=this._determineNode(r,e,t++);const n=this._indexOf(r,e);return n>=0?r.contacts[n]:null}_indexOf(e,t){for(let r=0;r<e.contacts.length;++r)if(s(e.contacts[r].id,t))return r;return-1}remove(e){a("the id as parameter 1",e);let t=0,r=this.root;while(null===r.contacts)r=this._determineNode(r,e,t++);const n=this._indexOf(r,e);if(n>=0){const e=r.contacts.splice(n,1)[0];this.emit("removed",e)}return this}_split(e,t){e.left=o(),e.right=o();for(const i of e.contacts)this._determineNode(e,i.id,t).contacts.push(i);e.contacts=null;const r=this._determineNode(e,this.localNodeId,t),n=e.left===r?e.right:e.left;n.dontSplit=!0}toArray(){let e=[];for(const t=[this.root];t.length>0;){const r=t.pop();null===r.contacts?t.push(r.right,r.left):e=e.concat(r.contacts)}return e}*toIterable(){for(const e=[this.root];e.length>0;){const t=e.pop();null===t.contacts?e.push(t.right,t.left):yield*t.contacts}}_update(e,t,r){if(!s(e.contacts[t].id,r.id))throw new Error("wrong index for _update");const n=e.contacts[t],i=this.arbiter(n,r);i===n&&n!==r||(e.contacts.splice(t,1),e.contacts.push(i),this.emit("updated",n,i))}}e.exports=c},1675:function(e,t){"use strict";t.supports=function(...e){const t=e.reduce(((e,t)=>Object.assign(e,t)),{});return Object.assign(t,{snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,getMany:t.getMany||!1,keyIterator:t.keyIterator||!1,valueIterator:t.valueIterator||!1,iteratorNextv:t.iteratorNextv||!1,iteratorAll:t.iteratorAll||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:Object.assign({},t.encodings),events:Object.assign({},t.events),additionalMethods:Object.assign({},t.additionalMethods)})}},8499:function(e,t,r){"use strict";const n=r(4473),i=r(8002),{Encoding:s}=r(8266),{BufferFormat:o,ViewFormat:a,UTF8Format:c}=r(2376),l=Symbol("formats"),u=Symbol("encodings"),h=new Set(["buffer","view","utf8"]);class d{constructor(e){if(!Array.isArray(e))throw new TypeError("The first argument 'formats' must be an array");if(!e.every((e=>h.has(e))))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'");this[u]=new Map,this[l]=new Set(e);for(const r in i)try{this.encoding(r)}catch(t){if("LEVEL_ENCODING_NOT_SUPPORTED"!==t.code)throw t}}encodings(){return Array.from(new Set(this[u].values()))}encoding(e){let t=this[u].get(e);if(void 0===t){if("string"===typeof e&&""!==e){if(t=g[e],!t)throw new n(`Encoding '${e}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if("object"!==typeof e||null===e)throw new TypeError("First argument 'encoding' must be a string or object");t=f(e)}const{name:r,format:i}=t;if(!this[l].has(i))if(this[l].has("view"))t=t.createViewTranscoder();else if(this[l].has("buffer"))t=t.createBufferTranscoder();else{if(!this[l].has("utf8"))throw new n(`Encoding '${r}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});t=t.createUTF8Transcoder()}for(const n of[e,r,t.name,t.commonName])this[u].set(n,t)}return t}}function f(e){if(e instanceof s)return e;const t="type"in e&&"string"===typeof e.type?e.type:void 0,r=e.name||t||"anonymous-"+m++;switch(p(e)){case"view":return new a({...e,name:r});case"utf8":return new c({...e,name:r});case"buffer":return new o({...e,name:r});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function p(e){return"format"in e&&void 0!==e.format?e.format:"buffer"in e&&"boolean"===typeof e.buffer?e.buffer?"buffer":"utf8":"code"in e&&Number.isInteger(e.code)?"view":"buffer"}t.Transcoder=d;const y={binary:i.buffer,"utf-8":i.utf8},g={...i,...y};let m=0},8266:function(e,t,r){"use strict";const n=r(4473),i=new Set(["buffer","view","utf8"]);class s{constructor(e){if(this.encode=e.encode||this.encode,this.decode=e.decode||this.decode,this.name=e.name||this.name,this.format=e.format||this.format,"function"!==typeof this.encode)throw new TypeError("The 'encode' property must be a function");if("function"!==typeof this.decode)throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),"string"!==typeof this.name||""===this.name)throw new TypeError("The 'name' property must be a string");if("string"!==typeof this.format||!i.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");e.createViewTranscoder&&(this.createViewTranscoder=e.createViewTranscoder),e.createBufferTranscoder&&(this.createBufferTranscoder=e.createBufferTranscoder),e.createUTF8Transcoder&&(this.createUTF8Transcoder=e.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}}t.Encoding=s},8002:function(e,t,r){"use strict";const{Buffer:n}=r(8764)||{Buffer:{isBuffer:()=>!1}},{textEncoder:i,textDecoder:s}=r(5850)(),{BufferFormat:o,ViewFormat:a,UTF8Format:c}=r(2376),l=e=>e;t.utf8=new c({encode:function(e){return n.isBuffer(e)?e.toString("utf8"):ArrayBuffer.isView(e)?s.decode(e):String(e)},decode:l,name:"utf8",createViewTranscoder(){return new a({encode:function(e){return ArrayBuffer.isView(e)?e:i.encode(e)},decode:function(e){return s.decode(e)},name:`${this.name}+view`})},createBufferTranscoder(){return new o({encode:function(e){return n.isBuffer(e)?e:ArrayBuffer.isView(e)?n.from(e.buffer,e.byteOffset,e.byteLength):n.from(String(e),"utf8")},decode:function(e){return e.toString("utf8")},name:`${this.name}+buffer`})}}),t.json=new c({encode:JSON.stringify,decode:JSON.parse,name:"json"}),t.buffer=new o({encode:function(e){return n.isBuffer(e)?e:ArrayBuffer.isView(e)?n.from(e.buffer,e.byteOffset,e.byteLength):n.from(String(e),"utf8")},decode:l,name:"buffer",createViewTranscoder(){return new a({encode:function(e){return ArrayBuffer.isView(e)?e:n.from(String(e),"utf8")},decode:function(e){return n.from(e.buffer,e.byteOffset,e.byteLength)},name:`${this.name}+view`})}}),t.view=new a({encode:function(e){return ArrayBuffer.isView(e)?e:i.encode(e)},decode:l,name:"view",createBufferTranscoder(){return new o({encode:function(e){return n.isBuffer(e)?e:ArrayBuffer.isView(e)?n.from(e.buffer,e.byteOffset,e.byteLength):n.from(String(e),"utf8")},decode:l,name:`${this.name}+buffer`})}}),t.hex=new o({encode:function(e){return n.isBuffer(e)?e:n.from(String(e),"hex")},decode:function(e){return e.toString("hex")},name:"hex"}),t.base64=new o({encode:function(e){return n.isBuffer(e)?e:n.from(String(e),"base64")},decode:function(e){return e.toString("base64")},name:"base64"})},2376:function(e,t,r){"use strict";const{Buffer:n}=r(8764)||{},{Encoding:i}=r(8266),s=r(5850);class o extends i{constructor(e){super({...e,format:"buffer"})}createViewTranscoder(){return new a({encode:this.encode,decode:e=>this.decode(n.from(e.buffer,e.byteOffset,e.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}}class a extends i{constructor(e){super({...e,format:"view"})}createBufferTranscoder(){return new o({encode:e=>{const t=this.encode(e);return n.from(t.buffer,t.byteOffset,t.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}}class c extends i{constructor(e){super({...e,format:"utf8"})}createBufferTranscoder(){return new o({encode:e=>n.from(this.encode(e),"utf8"),decode:e=>this.decode(e.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:e,textDecoder:t}=s();return new a({encode:t=>e.encode(this.encode(t)),decode:e=>this.decode(t.decode(e)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}}t.BufferFormat=o,t.ViewFormat=a,t.UTF8Format=c},5850:function(e){"use strict";let t=null;e.exports=function(){return null===t&&(t={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),t}},1301:function(e,t,r){t.Level=r(1708).BrowserLevel},1114:function(e,t,r){"use strict";const n=r(1303),i=async function*(e,t){const r=await n(e);yield*r.sort(t)};e.exports=i},942:function(e,t,r){"use strict";const n=r(3310),{hasOwnProperty:i}=Object.prototype,{propertyIsEnumerable:s}=Object,o=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0}),a=this,c={concatArrays:!1,ignoreUndefined:!1},l=e=>{const t=[];for(const r in e)i.call(e,r)&&t.push(r);if(Object.getOwnPropertySymbols){const r=Object.getOwnPropertySymbols(e);for(const n of r)s.call(e,n)&&t.push(n)}return t};function u(e){return Array.isArray(e)?h(e):n(e)?d(e):e}function h(e){const t=e.slice(0,0);return l(e).forEach((r=>{o(t,r,u(e[r]))})),t}function d(e){const t=null===Object.getPrototypeOf(e)?Object.create(null):{};return l(e).forEach((r=>{o(t,r,u(e[r]))})),t}const f=(e,t,r,n)=>(r.forEach((r=>{"undefined"===typeof t[r]&&n.ignoreUndefined||(r in e&&e[r]!==Object.getPrototypeOf(e)?o(e,r,y(e[r],t[r],n)):o(e,r,u(t[r])))})),e),p=(e,t,r)=>{let n=e.slice(0,0),s=0;return[e,t].forEach((t=>{const a=[];for(let r=0;r<t.length;r++)i.call(t,r)&&(a.push(String(r)),o(n,s++,t===e?t[r]:u(t[r])));n=f(n,t,l(t).filter((e=>!a.includes(e))),r)})),n};function y(e,t,r){return r.concatArrays&&Array.isArray(e)&&Array.isArray(t)?p(e,t,r):n(t)&&n(e)?f(e,t,l(t),r):u(t)}e.exports=function(...e){const t=y(u(c),this!==a&&this||{},c);let r={_:{}};for(const i of e)if(void 0!==i){if(!n(i))throw new TypeError("`"+i+"` is not an Option Object");r=y(r,{_:i},t)}return r._}},4473:function(e){"use strict";e.exports=class extends Error{constructor(e,t){super(e||""),"object"===typeof t&&null!==t&&(t.code&&(this.code=String(t.code)),t.expected&&(this.expected=!0),t.transient&&(this.transient=!0),t.cause&&(this.cause=t.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}},7824:function(e){var t=1e3,r=60*t,n=60*r,i=24*n,s=7*i,o=365.25*i;function a(e){if(e=String(e),!(e.length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(a){var c=parseFloat(a[1]),l=(a[2]||"ms").toLowerCase();switch(l){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*s;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}function c(e){var s=Math.abs(e);return s>=i?Math.round(e/i)+"d":s>=n?Math.round(e/n)+"h":s>=r?Math.round(e/r)+"m":s>=t?Math.round(e/t)+"s":e+"ms"}function l(e){var s=Math.abs(e);return s>=i?u(e,s,i,"day"):s>=n?u(e,s,n,"hour"):s>=r?u(e,s,r,"minute"):s>=t?u(e,s,t,"second"):e+" ms"}function u(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return a(e);if("number"===r&&isFinite(e))return t.long?l(e):c(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},469:function(e,t,r){e.exports=r(8027)},8027:function(e,t){(function(r,n){"use strict";var i={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function s(e){if(!Array.isArray(e)&&!ArrayBuffer.isView(e))return!1;for(var t=0;t<e.length;t++)if(!Number.isInteger(e[t])||e[t]<0||e[t]>255)return!1;return!0}function o(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function a(e,t){return e<<t|e>>>32-t}function c(e){return e^=e>>>16,e=o(e,2246822507),e^=e>>>13,e=o(e,3266489909),e^=e>>>16,e}function l(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]+t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]+t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]+t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]+t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function u(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]*t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]*t[3],r[1]+=r[2]>>>16,r[2]&=65535,r[2]+=e[3]*t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]*t[3],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[2]*t[2],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[3]*t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function h(e,t){return t%=64,32===t?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function d(e,t){return t%=64,0===t?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function f(e,t){return[e[0]^t[0],e[1]^t[1]]}function p(e){return e=f(e,[0,e[0]>>>1]),e=u(e,[4283543511,3981806797]),e=f(e,[0,e[0]>>>1]),e=u(e,[3301882366,444984403]),e=f(e,[0,e[0]>>>1]),e}i.x86.hash32=function(e,t){if(i.inputValidation&&!s(e))return n;t=t||0;for(var r=e.length%4,l=e.length-r,u=t,h=0,d=3432918353,f=461845907,p=0;p<l;p+=4)h=e[p]|e[p+1]<<8|e[p+2]<<16|e[p+3]<<24,h=o(h,d),h=a(h,15),h=o(h,f),u^=h,u=a(u,13),u=o(u,5)+3864292196;switch(h=0,r){case 3:h^=e[p+2]<<16;case 2:h^=e[p+1]<<8;case 1:h^=e[p],h=o(h,d),h=a(h,15),h=o(h,f),u^=h}return u^=e.length,u=c(u),u>>>0},i.x86.hash128=function(e,t){if(i.inputValidation&&!s(e))return n;t=t||0;for(var r=e.length%16,l=e.length-r,u=t,h=t,d=t,f=t,p=0,y=0,g=0,m=0,w=597399067,b=2869860233,v=951274213,E=2716044179,_=0;_<l;_+=16)p=e[_]|e[_+1]<<8|e[_+2]<<16|e[_+3]<<24,y=e[_+4]|e[_+5]<<8|e[_+6]<<16|e[_+7]<<24,g=e[_+8]|e[_+9]<<8|e[_+10]<<16|e[_+11]<<24,m=e[_+12]|e[_+13]<<8|e[_+14]<<16|e[_+15]<<24,p=o(p,w),p=a(p,15),p=o(p,b),u^=p,u=a(u,19),u+=h,u=o(u,5)+1444728091,y=o(y,b),y=a(y,16),y=o(y,v),h^=y,h=a(h,17),h+=d,h=o(h,5)+197830471,g=o(g,v),g=a(g,17),g=o(g,E),d^=g,d=a(d,15),d+=f,d=o(d,5)+2530024501,m=o(m,E),m=a(m,18),m=o(m,w),f^=m,f=a(f,13),f+=u,f=o(f,5)+850148119;switch(p=0,y=0,g=0,m=0,r){case 15:m^=e[_+14]<<16;case 14:m^=e[_+13]<<8;case 13:m^=e[_+12],m=o(m,E),m=a(m,18),m=o(m,w),f^=m;case 12:g^=e[_+11]<<24;case 11:g^=e[_+10]<<16;case 10:g^=e[_+9]<<8;case 9:g^=e[_+8],g=o(g,v),g=a(g,17),g=o(g,E),d^=g;case 8:y^=e[_+7]<<24;case 7:y^=e[_+6]<<16;case 6:y^=e[_+5]<<8;case 5:y^=e[_+4],y=o(y,b),y=a(y,16),y=o(y,v),h^=y;case 4:p^=e[_+3]<<24;case 3:p^=e[_+2]<<16;case 2:p^=e[_+1]<<8;case 1:p^=e[_],p=o(p,w),p=a(p,15),p=o(p,b),u^=p}return u^=e.length,h^=e.length,d^=e.length,f^=e.length,u+=h,u+=d,u+=f,h+=u,d+=u,f+=u,u=c(u),h=c(h),d=c(d),f=c(f),u+=h,u+=d,u+=f,h+=u,d+=u,f+=u,("00000000"+(u>>>0).toString(16)).slice(-8)+("00000000"+(h>>>0).toString(16)).slice(-8)+("00000000"+(d>>>0).toString(16)).slice(-8)+("00000000"+(f>>>0).toString(16)).slice(-8)},i.x64.hash128=function(e,t){if(i.inputValidation&&!s(e))return n;t=t||0;for(var r=e.length%16,o=e.length-r,a=[0,t],c=[0,t],y=[0,0],g=[0,0],m=[2277735313,289559509],w=[1291169091,658871167],b=0;b<o;b+=16)y=[e[b+4]|e[b+5]<<8|e[b+6]<<16|e[b+7]<<24,e[b]|e[b+1]<<8|e[b+2]<<16|e[b+3]<<24],g=[e[b+12]|e[b+13]<<8|e[b+14]<<16|e[b+15]<<24,e[b+8]|e[b+9]<<8|e[b+10]<<16|e[b+11]<<24],y=u(y,m),y=h(y,31),y=u(y,w),a=f(a,y),a=h(a,27),a=l(a,c),a=l(u(a,[0,5]),[0,1390208809]),g=u(g,w),g=h(g,33),g=u(g,m),c=f(c,g),c=h(c,31),c=l(c,a),c=l(u(c,[0,5]),[0,944331445]);switch(y=[0,0],g=[0,0],r){case 15:g=f(g,d([0,e[b+14]],48));case 14:g=f(g,d([0,e[b+13]],40));case 13:g=f(g,d([0,e[b+12]],32));case 12:g=f(g,d([0,e[b+11]],24));case 11:g=f(g,d([0,e[b+10]],16));case 10:g=f(g,d([0,e[b+9]],8));case 9:g=f(g,[0,e[b+8]]),g=u(g,w),g=h(g,33),g=u(g,m),c=f(c,g);case 8:y=f(y,d([0,e[b+7]],56));case 7:y=f(y,d([0,e[b+6]],48));case 6:y=f(y,d([0,e[b+5]],40));case 5:y=f(y,d([0,e[b+4]],32));case 4:y=f(y,d([0,e[b+3]],24));case 3:y=f(y,d([0,e[b+2]],16));case 2:y=f(y,d([0,e[b+1]],8));case 1:y=f(y,[0,e[b]]),y=u(y,m),y=h(y,31),y=u(y,w),a=f(a,y)}return a=f(a,[0,e.length]),c=f(c,[0,e.length]),a=l(a,c),c=l(c,a),a=p(a),c=p(c),a=l(a,c),c=l(c,a),("00000000"+(a[0]>>>0).toString(16)).slice(-8)+("00000000"+(a[1]>>>0).toString(16)).slice(-8)+("00000000"+(c[0]>>>0).toString(16)).slice(-8)+("00000000"+(c[1]>>>0).toString(16)).slice(-8)},e.exports&&(t=e.exports=i),t.murmurHash3=i})()},9633:function(e){"use strict";function t(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}e.exports=function(e){var r=void 0,n=void 0;function i(e){if(!(e instanceof Object))throw new Error('Target "'+e+'" is not an object');n=e}function s(e){Object.keys(e).forEach((function(t){var r=e[t];if("function"!==typeof r)throw new Error('Trap "'+t+": "+r+'" is not a function');if(!Reflect[t])throw new Error('Trap "'+t+": "+r+'" is not a valid trap')})),r=e}i((function(){})),e&&i(e),s(Reflect);var o=new Proxy({},{get:function(e,i){return function(){for(var e=arguments.length,s=Array(e),o=0;o<e;o++)s[o]=arguments[o];return r[i].apply(null,[n].concat(t(s.slice(1))))}}});return{setTarget:i,setHandler:s,getTarget:function(){return n},getHandler:function(){return r},proxy:new Proxy(n,o)}}},8951:function(e,t){(function(){var e,r,n,i,s,o,a,c;c=function(e){var t,r,n,i;return t=(e&255<<24)>>>24,r=(e&255<<16)>>>16,n=(65280&e)>>>8,i=255&e,[t,r,n,i].join(".")},a=function(e){var t,n,i,s,o,a;for(t=[],i=s=0;s<=3;i=++s){if(0===e.length)break;if(i>0){if("."!==e[0])throw new Error("Invalid IP");e=e.substring(1)}a=r(e),o=a[0],n=a[1],e=e.substring(n),t.push(o)}if(0!==e.length)throw new Error("Invalid IP");switch(t.length){case 1:if(t[0]>4294967295)throw new Error("Invalid IP");return t[0]>>>0;case 2:if(t[0]>255||t[1]>16777215)throw new Error("Invalid IP");return(t[0]<<24|t[1])>>>0;case 3:if(t[0]>255||t[1]>255||t[2]>65535)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2])>>>0;case 4:if(t[0]>255||t[1]>255||t[2]>255||t[3]>255)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2]<<8|t[3])>>>0;default:throw new Error("Invalid IP")}},n=function(e){return e.charCodeAt(0)},i=n("0"),o=n("a"),s=n("A"),r=function(e){var t,r,a,c,l;c=0,t=10,r="9",a=0,e.length>1&&"0"===e[a]&&("x"===e[a+1]||"X"===e[a+1]?(a+=2,t=16):"0"<=e[a+1]&&e[a+1]<="9"&&(a++,t=8,r="7")),l=a;while(a<e.length){if("0"<=e[a]&&e[a]<=r)c=c*t+(n(e[a])-i)>>>0;else{if(16!==t)break;if("a"<=e[a]&&e[a]<="f")c=c*t+(10+n(e[a])-o)>>>0;else{if(!("A"<=e[a]&&e[a]<="F"))break;c=c*t+(10+n(e[a])-s)>>>0}}if(c>4294967295)throw new Error("too large");a++}if(a===l)throw new Error("empty octet");return[c,a]},e=function(){function e(e,t){var r,n,i;if("string"!==typeof e)throw new Error("Missing `net' parameter");if(t||(i=e.split("/",2),e=i[0],t=i[1]),t||(t=32),"string"===typeof t&&t.indexOf(".")>-1){try{this.maskLong=a(t)}catch(s){throw s,new Error("Invalid mask: "+t)}for(r=n=32;n>=0;r=--n)if(this.maskLong===4294967295<<32-r>>>0){this.bitmask=r;break}}else{if(!t&&0!==t)throw new Error("Invalid mask: empty");this.bitmask=parseInt(t,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0)}try{this.netLong=(a(e)&this.maskLong)>>>0}catch(s){throw s,new Error("Invalid net address: "+e)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+t);this.size=Math.pow(2,32-this.bitmask),this.base=c(this.netLong),this.mask=c(this.maskLong),this.hostmask=c(~this.maskLong),this.first=this.bitmask<=30?c(this.netLong+1):this.base,this.last=this.bitmask<=30?c(this.netLong+this.size-2):c(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?c(this.netLong+this.size-1):void 0}return e.prototype.contains=function(t){return"string"===typeof t&&(t.indexOf("/")>0||4!==t.split(".").length)&&(t=new e(t)),t instanceof e?this.contains(t.base)&&this.contains(t.broadcast||t.last):(a(t)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},e.prototype.next=function(t){return null==t&&(t=1),new e(c(this.netLong+this.size*t),this.mask)},e.prototype.forEach=function(e){var t,r,n;n=a(this.first),r=a(this.last),t=0;while(n<=r)e(c(n),n,t),t++,n++},e.prototype.toString=function(){return this.base+"/"+this.bitmask},e}(),t.ip2long=a,t.long2ip=c,t.Netmask=e}).call(this)},3300:function(e,t){"use strict";var r=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n)return n;throw new Error("unable to locate global object")},n=r();e.exports=t=n.fetch,n.fetch&&(t["default"]=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},8925:function(e,t,r){var n=r(3832);function i(e,t){var r=function(){return new n.aes.Algorithm(e,t)};n.cipher.registerAlgorithm(e,r)}r(5649),r(1967),r(7116),e.exports=n.aes=n.aes||{},n.aes.startEncrypting=function(e,t,r,n){var i=y({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i},n.aes.createEncryptionCipher=function(e,t){return y({key:e,output:null,decrypt:!1,mode:t})},n.aes.startDecrypting=function(e,t,r,n){var i=y({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i},n.aes.createDecryptionCipher=function(e,t){return y({key:e,output:null,decrypt:!0,mode:t})},n.aes.Algorithm=function(e,t){u||d();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return p(r._w,e,t,!1)},decrypt:function(e,t){return p(r._w,e,t,!0)}}}),r._init=!1},n.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t,r=e.key;if("string"!==typeof r||16!==r.length&&24!==r.length&&32!==r.length){if(n.util.isArray(r)&&(16===r.length||24===r.length||32===r.length)){t=r,r=n.util.createBuffer();for(var i=0;i<t.length;++i)r.putByte(t[i])}}else r=n.util.createBuffer(r);if(!n.util.isArray(r)){t=r,r=[];var s=t.length();if(16===s||24===s||32===s){s>>>=2;for(i=0;i<s;++i)r.push(t.getInt32())}}if(!n.util.isArray(r)||4!==r.length&&6!==r.length&&8!==r.length)throw new Error("Invalid key parameter.");var o=this.mode.name,a=-1!==["CFB","OFB","CTR","GCM"].indexOf(o);this._w=f(r,e.decrypt&&!a),this._init=!0}},n.aes._expandKey=function(e,t){return u||d(),f(e,t)},n.aes._updateBlock=p,i("AES-ECB",n.cipher.modes.ecb),i("AES-CBC",n.cipher.modes.cbc),i("AES-CFB",n.cipher.modes.cfb),i("AES-OFB",n.cipher.modes.ofb),i("AES-CTR",n.cipher.modes.ctr),i("AES-GCM",n.cipher.modes.gcm);var s,o,a,c,l,u=!1,h=4;function d(){u=!0,a=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;s=new Array(256),o=new Array(256),c=new Array(4),l=new Array(4);for(t=0;t<4;++t)c[t]=new Array(256),l[t]=new Array(256);var r,n,i,h,d,f,p,y=0,g=0;for(t=0;t<256;++t){h=g^g<<1^g<<2^g<<3^g<<4,h=h>>8^255&h^99,s[y]=h,o[h]=y,d=e[h],r=e[y],n=e[r],i=e[n],f=d<<24^h<<16^h<<8^h^d,p=(r^n^i)<<24^(y^i)<<16^(y^n^i)<<8^y^r^i;for(var m=0;m<4;++m)c[m][y]=f,l[m][h]=p,f=f<<24|f>>>8,p=p<<24|p>>>8;0===y?y=g=1:(y=r^e[e[e[r^i]]],g^=e[e[g]])}}function f(e,t){for(var r,n=e.slice(0),i=1,o=n.length,c=o+6+1,u=h*c,d=o;d<u;++d)r=n[d-1],d%o===0?(r=s[r>>>16&255]<<24^s[r>>>8&255]<<16^s[255&r]<<8^s[r>>>24]^a[i]<<24,i++):o>6&&d%o===4&&(r=s[r>>>24]<<24^s[r>>>16&255]<<16^s[r>>>8&255]<<8^s[255&r]),n[d]=n[d-o]^r;if(t){var f,p=l[0],y=l[1],g=l[2],m=l[3],w=n.slice(0);u=n.length;d=0;for(var b=u-h;d<u;d+=h,b-=h)if(0===d||d===u-h)w[d]=n[b],w[d+1]=n[b+3],w[d+2]=n[b+2],w[d+3]=n[b+1];else for(var v=0;v<h;++v)f=n[b+v],w[d+(3&-v)]=p[s[f>>>24]]^y[s[f>>>16&255]]^g[s[f>>>8&255]]^m[s[255&f]];n=w}return n}function p(e,t,r,n){var i,a,u,h,d,f,p,y,g,m,w,b,v=e.length/4-1;n?(i=l[0],a=l[1],u=l[2],h=l[3],d=o):(i=c[0],a=c[1],u=c[2],h=c[3],d=s),f=t[0]^e[0],p=t[n?3:1]^e[1],y=t[2]^e[2],g=t[n?1:3]^e[3];for(var E=3,_=1;_<v;++_)m=i[f>>>24]^a[p>>>16&255]^u[y>>>8&255]^h[255&g]^e[++E],w=i[p>>>24]^a[y>>>16&255]^u[g>>>8&255]^h[255&f]^e[++E],b=i[y>>>24]^a[g>>>16&255]^u[f>>>8&255]^h[255&p]^e[++E],g=i[g>>>24]^a[f>>>16&255]^u[p>>>8&255]^h[255&y]^e[++E],f=m,p=w,y=b;r[0]=d[f>>>24]<<24^d[p>>>16&255]<<16^d[y>>>8&255]<<8^d[255&g]^e[++E],r[n?3:1]=d[p>>>24]<<24^d[y>>>16&255]<<16^d[g>>>8&255]<<8^d[255&f]^e[++E],r[2]=d[y>>>24]<<24^d[g>>>16&255]<<16^d[f>>>8&255]<<8^d[255&p]^e[++E],r[n?1:3]=d[g>>>24]<<24^d[f>>>16&255]<<16^d[p>>>8&255]<<8^d[255&y]^e[++E]}function y(e){e=e||{};var t,r=(e.mode||"CBC").toUpperCase(),i="AES-"+r;t=e.decrypt?n.cipher.createDecipher(i,e.key):n.cipher.createCipher(i,e.key);var s=t.start;return t.start=function(e,r){var i=null;r instanceof n.util.ByteBuffer&&(i=r,r={}),r=r||{},r.output=i,r.iv=e,s.call(t,r)},t}},3068:function(e,t,r){var n=r(3832);r(7116),r(6270);var i=e.exports=n.asn1=n.asn1||{};function s(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}i.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},i.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},i.create=function(e,t,r,s,o){if(n.util.isArray(s)){for(var a=[],c=0;c<s.length;++c)void 0!==s[c]&&a.push(s[c]);s=a}var l={tagClass:e,type:t,constructed:r,composed:r||n.util.isArray(s),value:s};return o&&"bitStringContents"in o&&(l.bitStringContents=o.bitStringContents,l.original=i.copy(l)),l},i.copy=function(e,t){var r;if(n.util.isArray(e)){r=[];for(var s=0;s<e.length;++s)r.push(i.copy(e[s],t));return r}return"string"===typeof e?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:i.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)},i.equals=function(e,t,r){if(n.util.isArray(e)){if(!n.util.isArray(t))return!1;if(e.length!==t.length)return!1;for(var s=0;s<e.length;++s)if(!i.equals(e[s],t[s]))return!1;return!0}if(typeof e!==typeof t)return!1;if("string"===typeof e)return e===t;var o=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&i.equals(e.value,t.value);return r&&r.includeBitStringContents&&(o=o&&e.bitStringContents===t.bitStringContents),o},i.getBerValueLength=function(e){var t=e.getByte();if(128!==t){var r,n=128&t;return r=n?e.getInt((127&t)<<3):t,r}};var o=function(e,t){var r=e.getByte();if(t--,128!==r){var n,i=128&r;if(i){var o=127&r;s(e,t,o),n=e.getInt(o<<3)}else n=r;if(n<0)throw new Error("Negative length: "+n);return n}};function a(e,t,r,n){var c;s(e,t,2);var l=e.getByte();t--;var u=192&l,h=31&l;c=e.length();var d,f,p=o(e,t);if(t-=c-e.length(),void 0!==p&&p>t){if(n.strict){var y=new Error("Too few bytes to read ASN.1 value.");throw y.available=e.length(),y.remaining=t,y.requested=p,y}p=t}var g=32===(32&l);if(g)if(d=[],void 0===p)for(;;){if(s(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}c=e.length(),d.push(a(e,t,r+1,n)),t-=c-e.length()}else while(p>0)c=e.length(),d.push(a(e,p,r+1,n)),t-=c-e.length(),p-=c-e.length();if(void 0===d&&u===i.Class.UNIVERSAL&&h===i.Type.BITSTRING&&(f=e.bytes(p)),void 0===d&&n.decodeBitStrings&&u===i.Class.UNIVERSAL&&h===i.Type.BITSTRING&&p>1){var m=e.read,w=t,b=0;if(h===i.Type.BITSTRING&&(s(e,t,1),b=e.getByte(),t--),0===b)try{c=e.length();var v={strict:!0,decodeBitStrings:!0},E=a(e,t,r+1,v),_=c-e.length();t-=_,h==i.Type.BITSTRING&&_++;var S=E.tagClass;_!==p||S!==i.Class.UNIVERSAL&&S!==i.Class.CONTEXT_SPECIFIC||(d=[E])}catch(I){}void 0===d&&(e.read=m,t=w)}if(void 0===d){if(void 0===p){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");p=t}if(h===i.Type.BMPSTRING)for(d="";p>0;p-=2)s(e,t,2),d+=String.fromCharCode(e.getInt16()),t-=2;else d=e.getBytes(p),t-=p}var A=void 0===f?null:{bitStringContents:f};return i.create(u,h,g,d,A)}i.fromDer=function(e,t){void 0===t&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),"boolean"===typeof t&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"string"===typeof e&&(e=n.util.createBuffer(e));var r=e.length(),i=a(e,e.length(),0,t);if(t.parseAllBytes&&0!==e.length()){var s=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw s.byteCount=r,s.remaining=e.length(),s}return i},i.toDer=function(e){var t=n.util.createBuffer(),r=e.tagClass|e.type,s=n.util.createBuffer(),o=!1;if("bitStringContents"in e&&(o=!0,e.original&&(o=i.equals(e,e.original))),o)s.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:s.putByte(0);for(var a=0;a<e.value.length;++a)void 0!==e.value[a]&&s.putBuffer(i.toDer(e.value[a]))}else if(e.type===i.Type.BMPSTRING)for(a=0;a<e.value.length;++a)s.putInt16(e.value.charCodeAt(a));else e.type===i.Type.INTEGER&&e.value.length>1&&(0===e.value.charCodeAt(0)&&0===(128&e.value.charCodeAt(1))||255===e.value.charCodeAt(0)&&128===(128&e.value.charCodeAt(1)))?s.putBytes(e.value.substr(1)):s.putBytes(e.value);if(t.putByte(r),s.length()<=127)t.putByte(127&s.length());else{var c=s.length(),l="";do{l+=String.fromCharCode(255&c),c>>>=8}while(c>0);t.putByte(128|l.length);for(a=l.length-1;a>=0;--a)t.putByte(l.charCodeAt(a))}return t.putBuffer(s),t},i.oidToDer=function(e){var t,r,i,s,o=e.split("."),a=n.util.createBuffer();a.putByte(40*parseInt(o[0],10)+parseInt(o[1],10));for(var c=2;c<o.length;++c){t=!0,r=[],i=parseInt(o[c],10);do{s=127&i,i>>>=7,t||(s|=128),r.push(s),t=!1}while(i>0);for(var l=r.length-1;l>=0;--l)a.putByte(r[l])}return a},i.derToOid=function(e){var t;"string"===typeof e&&(e=n.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;var i=0;while(e.length()>0)r=e.getByte(),i<<=7,128&r?i+=127&r:(t+="."+(i+r),i=0);return t},i.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),s=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var c=e.charAt(10),l=10;"+"!==c&&"-"!==c&&(a=parseInt(e.substr(10,2),10),l+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(s,o,a,0),l&&(c=e.charAt(l),"+"===c||"-"===c)){var u=parseInt(e.substr(l+1,2),10),h=parseInt(e.substr(l+4,2),10),d=60*u+h;d*=6e4,"+"===c?t.setTime(+t-d):t.setTime(+t+d)}return t},i.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),c=0,l=0,u=!1;"Z"===e.charAt(e.length-1)&&(u=!0);var h=e.length-5,d=e.charAt(h);if("+"===d||"-"===d){var f=parseInt(e.substr(h+1,2),10),p=parseInt(e.substr(h+4,2),10);l=60*f+p,l*=6e4,"+"===d&&(l*=-1),u=!0}return"."===e.charAt(14)&&(c=1e3*parseFloat(e.substr(14),10)),u?(t.setUTCFullYear(r,n,i),t.setUTCHours(s,o,a,c),t.setTime(+t+l)):(t.setFullYear(r,n,i),t.setHours(s,o,a,c)),t},i.dateToUtcTime=function(e){if("string"===typeof e)return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t},i.dateToGeneralizedTime=function(e){if("string"===typeof e)return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t},i.integerToDer=function(e){var t=n.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r},i.derToInteger=function(e){"string"===typeof e&&(e=n.util.createBuffer(e));var t=8*e.length();if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)},i.validate=function(e,t,r,s){var o=!1;if(e.tagClass!==t.tagClass&&"undefined"!==typeof t.tagClass||e.type!==t.type&&"undefined"!==typeof t.type)s&&(e.tagClass!==t.tagClass&&s.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&s.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));else if(e.constructed===t.constructed||"undefined"===typeof t.constructed){if(o=!0,t.value&&n.util.isArray(t.value))for(var a=0,c=0;o&&c<t.value.length;++c)o=t.value[c].optional||!1,e.value[a]&&(o=i.validate(e.value[a],t.value[c],r,s),o?++a:t.value[c].optional&&(o=!0)),!o&&s&&s.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(o&&r)if(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{var l=e.bitStringContents.charCodeAt(0);if(0!==l)throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else s&&s.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');return o};var c=/[^\\u0000-\\u00ff]/;i.prettyPrint=function(e,t,r){var s="";t=t||0,r=r||2,t>0&&(s+="\n");for(var o="",a=0;a<t*r;++a)o+=" ";switch(s+=o+"Tag: ",e.tagClass){case i.Class.UNIVERSAL:s+="Universal:";break;case i.Class.APPLICATION:s+="Application:";break;case i.Class.CONTEXT_SPECIFIC:s+="Context-Specific:";break;case i.Class.PRIVATE:s+="Private:";break}if(e.tagClass===i.Class.UNIVERSAL)switch(s+=e.type,e.type){case i.Type.NONE:s+=" (None)";break;case i.Type.BOOLEAN:s+=" (Boolean)";break;case i.Type.INTEGER:s+=" (Integer)";break;case i.Type.BITSTRING:s+=" (Bit string)";break;case i.Type.OCTETSTRING:s+=" (Octet string)";break;case i.Type.NULL:s+=" (Null)";break;case i.Type.OID:s+=" (Object Identifier)";break;case i.Type.ODESC:s+=" (Object Descriptor)";break;case i.Type.EXTERNAL:s+=" (External or Instance of)";break;case i.Type.REAL:s+=" (Real)";break;case i.Type.ENUMERATED:s+=" (Enumerated)";break;case i.Type.EMBEDDED:s+=" (Embedded PDV)";break;case i.Type.UTF8:s+=" (UTF8)";break;case i.Type.ROID:s+=" (Relative Object Identifier)";break;case i.Type.SEQUENCE:s+=" (Sequence)";break;case i.Type.SET:s+=" (Set)";break;case i.Type.PRINTABLESTRING:s+=" (Printable String)";break;case i.Type.IA5String:s+=" (IA5String (ASCII))";break;case i.Type.UTCTIME:s+=" (UTC time)";break;case i.Type.GENERALIZEDTIME:s+=" (Generalized time)";break;case i.Type.BMPSTRING:s+=" (BMP String)";break}else s+=e.type;if(s+="\n",s+=o+"Constructed: "+e.constructed+"\n",e.composed){var l=0,u="";for(a=0;a<e.value.length;++a)void 0!==e.value[a]&&(l+=1,u+=i.prettyPrint(e.value[a],t+1,r),a+1<e.value.length&&(u+=","));s+=o+"Sub values: "+l+u}else{if(s+=o+"Value: ",e.type===i.Type.OID){var h=i.derToOid(e.value);s+=h,n.pki&&n.pki.oids&&h in n.pki.oids&&(s+=" ("+n.pki.oids[h]+") ")}if(e.type===i.Type.INTEGER)try{s+=i.derToInteger(e.value)}catch(f){s+="0x"+n.util.bytesToHex(e.value)}else if(e.type===i.Type.BITSTRING){if(e.value.length>1?s+="0x"+n.util.bytesToHex(e.value.slice(1)):s+="(none)",e.value.length>0){var d=e.value.charCodeAt(0);1==d?s+=" (1 unused bit shown)":d>1&&(s+=" ("+d+" unused bits shown)")}}else if(e.type===i.Type.OCTETSTRING)c.test(e.value)||(s+="("+e.value+") "),s+="0x"+n.util.bytesToHex(e.value);else if(e.type===i.Type.UTF8)try{s+=n.util.decodeUtf8(e.value)}catch(p){if("URI malformed"!==p.message)throw p;s+="0x"+n.util.bytesToHex(e.value)+" (malformed UTF8)"}else e.type===i.Type.PRINTABLESTRING||e.type===i.Type.IA5String?s+=e.value:c.test(e.value)?s+="0x"+n.util.bytesToHex(e.value):0===e.value.length?s+="[null]":s+=e.value}return s}},8807:function(e){var t={};e.exports=t;var r={};function n(e,t){var r=0,n=t.length,i=t.charAt(0),s=[0];for(r=0;r<e.length();++r){for(var o=0,a=e.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;while(a>0)s.push(a%n),a=a/n|0}var c="";for(r=0;0===e.at(r)&&r<e.length()-1;++r)c+=i;for(r=s.length-1;r>=0;--r)c+=t[s[r]];return c}t.encode=function(e,t,r){if("string"!==typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==r&&"number"!==typeof r)throw new TypeError('"maxline" must be a number.');var i="";if(e instanceof Uint8Array){var s=0,o=t.length,a=t.charAt(0),c=[0];for(s=0;s<e.length;++s){for(var l=0,u=e[s];l<c.length;++l)u+=c[l]<<8,c[l]=u%o,u=u/o|0;while(u>0)c.push(u%o),u=u/o|0}for(s=0;0===e[s]&&s<e.length-1;++s)i+=a;for(s=c.length-1;s>=0;--s)i+=t[c[s]]}else i=n(e,t);if(r){var h=new RegExp(".{1,"+r+"}","g");i=i.match(h).join("\r\n")}return i},t.decode=function(e,t){if("string"!==typeof e)throw new TypeError('"input" must be a string.');if("string"!==typeof t)throw new TypeError('"alphabet" must be a string.');var n=r[t];if(!n){n=r[t]=[];for(var i=0;i<t.length;++i)n[t.charCodeAt(i)]=i}e=e.replace(/\s/g,"");var s=t.length,o=t.charAt(0),a=[0];for(i=0;i<e.length;i++){var c=n[e.charCodeAt(i)];if(void 0===c)return;for(var l=0,u=c;l<a.length;++l)u+=a[l]*s,a[l]=255&u,u>>=8;while(u>0)a.push(255&u),u>>=8}for(var h=0;e[h]===o&&h<e.length-1;++h)a.push(0);return"undefined"!==typeof Buffer?Buffer.from(a.reverse()):new Uint8Array(a.reverse())}},5649:function(e,t,r){var n=r(3832);r(7116),e.exports=n.cipher=n.cipher||{},n.cipher.algorithms=n.cipher.algorithms||{},n.cipher.createCipher=function(e,t){var r=e;if("string"===typeof r&&(r=n.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})},n.cipher.createDecipher=function(e,t){var r=e;if("string"===typeof r&&(r=n.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})},n.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),n.cipher.algorithms[e]=t},n.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in n.cipher.algorithms?n.cipher.algorithms[e]:null};var i=n.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};i.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=n.util.createBuffer(),this.output=e.output||n.util.createBuffer(),this.mode.start(t)},i.prototype.update=function(e){e&&this._input.putBuffer(e);while(!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish);this._input.compact()},i.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))&&!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)))}},1967:function(e,t,r){var n=r(3832);r(7116),n.cipher=n.cipher||{};var i=e.exports=n.cipher.modes=n.cipher.modes||{};function s(e,t){if("string"===typeof e&&(e=n.util.createBuffer(e)),n.util.isArray(e)&&e.length>4){var r=e;e=n.util.createBuffer();for(var i=0;i<r.length;++i)e.putByte(r[i])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!n.util.isArray(e)){var s=[],o=t/4;for(i=0;i<o;++i)s.push(e.getInt32());e=s}return e}function o(e){e[e.length-1]=e[e.length-1]+1&4294967295}function a(e){return[e/4294967296|0,4294967295&e]}i.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.ecb.prototype.start=function(e){},i.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},i.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=s(e.iv,this.blockSize),this._prev=this._iv.slice(0)}},i.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock},i.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)},i.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},i.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=s(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=s(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===e.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb.prototype.decrypt=i.ofb.prototype.encrypt,i.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=s(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}o(this._inBlock)},i.ctr.prototype.decrypt=i.ctr.prototype.encrypt,i.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0,this._R=3774873600},i.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t,r=n.util.createBuffer(e.iv);if(this._cipherLength=0,t="additionalData"in e?n.util.createBuffer(e.additionalData):n.util.createBuffer(),this._tagLength="tagLength"in e?e.tagLength:128,this._tag=null,e.decrypt&&(this._tag=n.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=r.length();if(12===i)this._j0=[r.getInt32(),r.getInt32(),r.getInt32(),1];else{this._j0=[0,0,0,0];while(r.length()>0)this._j0=this.ghash(this._hashSubkey,this._j0,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(a(8*i)))}this._inBlock=this._j0.slice(0),o(this._inBlock),this._partialBytes=0,t=n.util.createBuffer(t),this._aDataLength=a(8*t.length());var s=t.length()%this.blockSize;s&&t.fillWithByte(0,this.blockSize-s),this._s=[0,0,0,0];while(t.length()>0)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},i.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),o(this._inBlock)},i.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),o(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize},i.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=n.util.createBuffer();var i=this._aDataLength.concat(a(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,i);var s=[];this.cipher.encrypt(this._j0,s);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^s[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r},i.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){var s=e[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r},i.gcm.prototype.pow=function(e,t){for(var r=1&e[3],n=3;n>0;--n)t[n]=e[n]>>>1|(1&e[n-1])<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)},i.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=e[n]>>>4*(7-r%8)&15,s=this._m[r][i];t[0]^=s[0],t[1]^=s[1],t[2]^=s[2],t[3]^=s[3]}return t},i.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)},i.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],c=o/n|0,l=(n-1-o%n)*t;a[c]=1<<t-1<<l,s[o]=this.generateSubHashTable(this.multiply(a,e),t)}return s},i.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);var s=n>>>1;while(s>0)this.pow(i[2*s],i[s]=[]),s>>=1;s=2;while(s<n){for(var o=1;o<s;++o){var a=i[s],c=i[o];i[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var l=i[s^n];i[s]=[e[0]^l[0],e[1]^l[1],e[2]^l[2],e[3]^l[3]]}return i}},3480:function(e,t,r){var n=r(3832);function i(e,t){var r=function(){return new n.des.Algorithm(e,t)};n.cipher.registerAlgorithm(e,r)}r(5649),r(1967),r(7116),e.exports=n.des=n.des||{},n.des.startEncrypting=function(e,t,r,n){var i=y({key:e,output:r,decrypt:!1,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createEncryptionCipher=function(e,t){return y({key:e,output:null,decrypt:!1,mode:t})},n.des.startDecrypting=function(e,t,r,n){var i=y({key:e,output:r,decrypt:!0,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createDecryptionCipher=function(e,t){return y({key:e,output:null,decrypt:!0,mode:t})},n.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return p(r._keys,e,t,!1)},decrypt:function(e,t){return p(r._keys,e,t,!0)}}}),r._init=!1},n.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=n.util.createBuffer(e.key);if(0===this.name.indexOf("3DES")&&24!==t.length())throw new Error("Invalid Triple-DES key size: "+8*t.length());this._keys=f(t),this._init=!0}},i("DES-ECB",n.cipher.modes.ecb),i("DES-CBC",n.cipher.modes.cbc),i("DES-CFB",n.cipher.modes.cfb),i("DES-OFB",n.cipher.modes.ofb),i("DES-CTR",n.cipher.modes.ctr),i("3DES-ECB",n.cipher.modes.ecb),i("3DES-CBC",n.cipher.modes.cbc),i("3DES-CFB",n.cipher.modes.cfb),i("3DES-OFB",n.cipher.modes.ofb),i("3DES-CTR",n.cipher.modes.ctr);var s=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],a=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],c=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],l=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],u=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],d=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function f(e){for(var t,r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],s=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],l=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],d=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],f=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],y=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=e.length()>8?3:1,m=[],w=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],b=0,v=0;v<g;v++){var E=e.getInt32(),_=e.getInt32();t=252645135&(E>>>4^_),_^=t,E^=t<<4,t=65535&(_>>>-16^E),E^=t,_^=t<<-16,t=858993459&(E>>>2^_),_^=t,E^=t<<2,t=65535&(_>>>-16^E),E^=t,_^=t<<-16,t=1431655765&(E>>>1^_),_^=t,E^=t<<1,t=16711935&(_>>>8^E),E^=t,_^=t<<8,t=1431655765&(E>>>1^_),_^=t,E^=t<<1,t=E<<8|_>>>20&240,E=_<<24|_<<8&16711680|_>>>8&65280|_>>>24&240,_=t;for(var S=0;S<w.length;++S){w[S]?(E=E<<2|E>>>26,_=_<<2|_>>>26):(E=E<<1|E>>>27,_=_<<1|_>>>27),E&=-15,_&=-15;var A=r[E>>>28]|n[E>>>24&15]|i[E>>>20&15]|s[E>>>16&15]|o[E>>>12&15]|a[E>>>8&15]|c[E>>>4&15],I=l[_>>>28]|u[_>>>24&15]|h[_>>>20&15]|d[_>>>16&15]|f[_>>>12&15]|p[_>>>8&15]|y[_>>>4&15];t=65535&(I>>>16^A),m[b++]=A^t,m[b++]=I^t<<16}}return m}function p(e,t,r,n){var i,f,p=32===e.length?3:9;i=3===p?n?[30,-2,-2]:[0,32,2]:n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var y=t[0],g=t[1];f=252645135&(y>>>4^g),g^=f,y^=f<<4,f=65535&(y>>>16^g),g^=f,y^=f<<16,f=858993459&(g>>>2^y),y^=f,g^=f<<2,f=16711935&(g>>>8^y),y^=f,g^=f<<8,f=1431655765&(y>>>1^g),g^=f,y^=f<<1,y=y<<1|y>>>31,g=g<<1|g>>>31;for(var m=0;m<p;m+=3){for(var w=i[m+1],b=i[m+2],v=i[m];v!=w;v+=b){var E=g^e[v],_=(g>>>4|g<<28)^e[v+1];f=y,y=g,g=f^(o[E>>>24&63]|c[E>>>16&63]|u[E>>>8&63]|d[63&E]|s[_>>>24&63]|a[_>>>16&63]|l[_>>>8&63]|h[63&_])}f=y,y=g,g=f}y=y>>>1|y<<31,g=g>>>1|g<<31,f=1431655765&(y>>>1^g),g^=f,y^=f<<1,f=16711935&(g>>>8^y),y^=f,g^=f<<8,f=858993459&(g>>>2^y),y^=f,g^=f<<2,f=65535&(y>>>16^g),g^=f,y^=f<<16,f=252645135&(y>>>4^g),g^=f,y^=f<<4,r[0]=y,r[1]=g}function y(e){e=e||{};var t,r=(e.mode||"CBC").toUpperCase(),i="DES-"+r;t=e.decrypt?n.cipher.createDecipher(i,e.key):n.cipher.createCipher(i,e.key);var s=t.start;return t.start=function(e,r){var i=null;r instanceof n.util.ByteBuffer&&(i=r,r={}),r=r||{},r.output=i,r.iv=e,s.call(t,r)},t}},3832:function(e){e.exports={options:{usePureJavaScript:!1}}},6607:function(e,t,r){var n=r(3832);r(8991),r(7116);var i=e.exports=n.hmac=n.hmac||{};i.create=function(){var e=null,t=null,r=null,i=null,s={start:function(s,o){if(null!==s)if("string"===typeof s){if(s=s.toLowerCase(),!(s in n.md.algorithms))throw new Error('Unknown hash algorithm "'+s+'"');t=n.md.algorithms[s].create()}else t=s;if(null===o)o=e;else{if("string"===typeof o)o=n.util.createBuffer(o);else if(n.util.isArray(o)){var a=o;o=n.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var l=o.length();l>t.blockLength&&(t.start(),t.update(o.bytes()),o=t.digest()),r=n.util.createBuffer(),i=n.util.createBuffer(),l=o.length();for(c=0;c<l;++c){a=o.at(c);r.putByte(54^a),i.putByte(92^a)}if(l<t.blockLength)for(a=t.blockLength-l,c=0;c<a;++c)r.putByte(54),i.putByte(92);e=o,r=r.bytes(),i=i.bytes()}t.start(),t.update(r)},update:function(e){t.update(e)},getMac:function(){var e=t.digest().bytes();return t.start(),t.update(i),t.update(e),t.digest()}};return s.digest=s.getMac,s}},5764:function(e,t,r){var n,i=r(3832);e.exports=i.jsbn=i.jsbn||{};var s=0xdeadbeefcafe,o=15715070==(16777215&s);function a(e,t,r){this.data=[],null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function c(){return new a(null)}function l(e,t,r,n,i,s){while(--s>=0){var o=t*this.data[e++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=67108863&o}return i}function u(e,t,r,n,i,s){var o=32767&t,a=t>>15;while(--s>=0){var c=32767&this.data[e],l=this.data[e++]>>15,u=a*c+l*o;c=o*c+((32767&u)<<15)+r.data[n]+(1073741823&i),i=(c>>>30)+(u>>>15)+a*l+(i>>>30),r.data[n++]=1073741823&c}return i}function h(e,t,r,n,i,s){var o=16383&t,a=t>>14;while(--s>=0){var c=16383&this.data[e],l=this.data[e++]>>14,u=a*c+l*o;c=o*c+((16383&u)<<14)+r.data[n]+i,i=(c>>28)+(u>>14)+a*l,r.data[n++]=268435455&c}return i}i.jsbn.BigInteger=a,"undefined"===typeof navigator?(a.prototype.am=h,n=28):o&&"Microsoft Internet Explorer"==navigator.appName?(a.prototype.am=u,n=30):o&&"Netscape"!=navigator.appName?(a.prototype.am=l,n=26):(a.prototype.am=h,n=28),a.prototype.DB=n,a.prototype.DM=(1<<n)-1,a.prototype.DV=1<<n;var d=52;a.prototype.FV=Math.pow(2,d),a.prototype.F1=d-n,a.prototype.F2=2*n-d;var f,p,y="0123456789abcdefghijklmnopqrstuvwxyz",g=new Array;for(f="0".charCodeAt(0),p=0;p<=9;++p)g[f++]=p;for(f="a".charCodeAt(0),p=10;p<36;++p)g[f++]=p;for(f="A".charCodeAt(0),p=10;p<36;++p)g[f++]=p;function m(e){return y.charAt(e)}function w(e,t){var r=g[e.charCodeAt(t)];return null==r?-1:r}function b(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function v(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function E(e){var t=c();return t.fromInt(e),t}function _(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;var n=e.length,i=!1,s=0;while(--n>=0){var o=8==r?255&e[n]:w(e,n);o<0?"-"==e.charAt(n)&&(i=!0):(i=!1,0==s?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&a.ZERO.subTo(this,this)}function S(){var e=this.s&this.DM;while(this.t>0&&this.data[this.t-1]==e)--this.t}function A(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,s="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0){a<this.DB&&(r=this.data[o]>>a)>0&&(i=!0,s=m(r));while(o>=0)a<t?(r=(this.data[o]&(1<<a)-1)<<t-a,r|=this.data[--o]>>(a+=this.DB-t)):(r=this.data[o]>>(a-=t)&n,a<=0&&(a+=this.DB,--o)),r>0&&(i=!0),i&&(s+=m(r))}return i?s:"0"}function I(){var e=c();return a.ZERO.subTo(this,e),e}function C(){return this.s<0?this.negate():this}function k(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(t=r-e.t,0!=t)return this.s<0?-t:t;while(--r>=0)if(0!=(t=this.data[r]-e.data[r]))return t;return 0}function T(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function R(){return this.t<=0?0:this.DB*(this.t-1)+T(this.data[this.t-1]^this.s&this.DM)}function P(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function x(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function D(e,t){var r,n=e%this.DB,i=this.DB-n,s=(1<<i)-1,o=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t.data[r+o+1]=this.data[r]>>i|a,a=(this.data[r]&s)<<n;for(r=o-1;r>=0;--r)t.data[r]=0;t.data[o]=a,t.t=this.t+o+1,t.s=this.s,t.clamp()}function O(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)t.data[o-r-1]|=(this.data[o]&s)<<i,t.data[o-r]=this.data[o]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}}function N(e,t){var r=0,n=0,i=Math.min(e.t,this.t);while(r<i)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){n-=e.s;while(r<this.t)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{n+=this.s;while(r<e.t)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}function L(e,t){var r=this.abs(),n=e.abs(),i=r.t;t.t=i+n.t;while(--i>=0)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&a.ZERO.subTo(t,t)}function B(e){var t=this.abs(),r=e.t=2*t.t;while(--r>=0)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function U(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=c());var s=c(),o=this.s,l=e.s,u=this.DB-T(n.data[n.t-1]);u>0?(n.lShiftTo(u,s),i.lShiftTo(u,r)):(n.copyTo(s),i.copyTo(r));var h=s.t,d=s.data[h-1];if(0!=d){var f=d*(1<<this.F1)+(h>1?s.data[h-2]>>this.F2:0),p=this.FV/f,y=(1<<this.F1)/f,g=1<<this.F2,m=r.t,w=m-h,b=null==t?c():t;s.dlShiftTo(w,b),r.compareTo(b)>=0&&(r.data[r.t++]=1,r.subTo(b,r)),a.ONE.dlShiftTo(h,b),b.subTo(s,s);while(s.t<h)s.data[s.t++]=0;while(--w>=0){var v=r.data[--m]==d?this.DM:Math.floor(r.data[m]*p+(r.data[m-1]+g)*y);if((r.data[m]+=s.am(0,v,r,w,0,h))<v){s.dlShiftTo(w,b),r.subTo(b,r);while(r.data[m]<--v)r.subTo(b,r)}}null!=t&&(r.drShiftTo(h,t),o!=l&&a.ZERO.subTo(t,t)),r.t=h,r.clamp(),u>0&&r.rShiftTo(u,r),o<0&&a.ZERO.subTo(r,r)}}}function M(e){var t=c();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(a.ZERO)>0&&e.subTo(t,t),t}function j(e){this.m=e}function V(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function z(e){return e}function F(e){e.divRemTo(this.m,null,e)}function $(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function K(e,t){e.squareTo(t),this.reduce(t)}function q(){if(this.t<1)return 0;var e=this.data[0];if(0==(1&e))return 0;var t=3&e;return t=t*(2-(15&e)*t)&15,t=t*(2-(255&e)*t)&255,t=t*(2-((65535&e)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function H(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function G(e){var t=c();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(a.ZERO)>0&&this.m.subTo(t,t),t}function W(e){var t=c();return e.copyTo(t),this.reduce(t),t}function Y(e){while(e.t<=this.mt2)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e.data[t],n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);while(e.data[r]>=e.DV)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function J(e,t){e.squareTo(t),this.reduce(t)}function Q(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function X(){return 0==(this.t>0?1&this.data[0]:this.s)}function Z(e,t){if(e>4294967295||e<1)return a.ONE;var r=c(),n=c(),i=t.convert(this),s=T(e)-1;i.copyTo(r);while(--s>=0)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var o=r;r=n,n=o}return t.revert(r)}function ee(e,t){var r;return r=e<256||t.isEven()?new j(t):new H(t),this.exp(e,r)}function te(){var e=c();return this.copyTo(e),e}function re(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function ne(){return 0==this.t?this.s:this.data[0]<<24>>24}function ie(){return 0==this.t?this.s:this.data[0]<<16>>16}function se(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function oe(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1}function ae(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=E(r),i=c(),s=c(),o="";this.divRemTo(n,i,s);while(i.signum()>0)o=(r+s.intValue()).toString(e).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(e)+o}function ce(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,o=0,c=0;c<e.length;++c){var l=w(e,c);l<0?"-"==e.charAt(c)&&0==this.signum()&&(i=!0):(o=t*o+l,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0))}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(o,0)),i&&a.ZERO.subTo(this,this)}function le(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else{this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(a.ONE.shiftLeft(e-1),me,this),this.isEven()&&this.dAddOffset(1,0);while(!this.isProbablePrime(t))this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(a.ONE.shiftLeft(e-1),this)}else{var n=new Array,i=7&e;n.length=1+(e>>3),t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function ue(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0){n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);while(e>=0)n<8?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=this.data[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r)}return t}function he(e){return 0==this.compareTo(e)}function de(e){return this.compareTo(e)<0?this:e}function fe(e){return this.compareTo(e)>0?this:e}function pe(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function ye(e,t){return e&t}function ge(e){var t=c();return this.bitwiseTo(e,ye,t),t}function me(e,t){return e|t}function we(e){var t=c();return this.bitwiseTo(e,me,t),t}function be(e,t){return e^t}function ve(e){var t=c();return this.bitwiseTo(e,be,t),t}function Ee(e,t){return e&~t}function _e(e){var t=c();return this.bitwiseTo(e,Ee,t),t}function Se(){for(var e=c(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function Ae(e){var t=c();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Ie(e){var t=c();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function Ce(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function ke(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+Ce(this.data[e]);return this.s<0?this.t*this.DB:-1}function Te(e){var t=0;while(0!=e)e&=e-1,++t;return t}function Re(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=Te(this.data[r]^t);return e}function Pe(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this.data[t]&1<<e%this.DB)}function xe(e,t){var r=a.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function De(e){return this.changeBit(e,me)}function Oe(e){return this.changeBit(e,Ee)}function Ne(e){return this.changeBit(e,be)}function Le(e,t){var r=0,n=0,i=Math.min(e.t,this.t);while(r<i)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){n+=e.s;while(r<this.t)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{n+=this.s;while(r<e.t)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}function Be(e){var t=c();return this.addTo(e,t),t}function Ue(e){var t=c();return this.subTo(e,t),t}function Me(e){var t=c();return this.multiplyTo(e,t),t}function je(e){var t=c();return this.divRemTo(e,t,null),t}function Ve(e){var t=c();return this.divRemTo(e,null,t),t}function ze(e){var t=c(),r=c();return this.divRemTo(e,t,r),new Array(t,r)}function Fe(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function $e(e,t){if(0!=e){while(this.t<=t)this.data[this.t++]=0;this.data[t]+=e;while(this.data[t]>=this.DV)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Ke(){}function qe(e){return e}function He(e,t,r){e.multiplyTo(t,r)}function Ge(e,t){e.squareTo(t)}function We(e){return this.exp(e,new Ke)}function Ye(e,t,r){var n,i=Math.min(this.t+e.t,t);r.s=0,r.t=i;while(i>0)r.data[--i]=0;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,e.data[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e.data[i],r,i,0,t-i);r.clamp()}function Je(e,t,r){--t;var n=r.t=this.t+e.t-t;r.s=0;while(--n>=0)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function Qe(e){this.r2=c(),this.q3=c(),a.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function Xe(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=c();return e.copyTo(t),this.reduce(t),t}function Ze(e){return e}function et(e){e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(e.compareTo(this.r2)<0)e.dAddOffset(1,this.m.t+1);e.subTo(this.r2,e);while(e.compareTo(this.m)>=0)e.subTo(this.m,e)}function tt(e,t){e.squareTo(t),this.reduce(t)}function rt(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function nt(e,t){var r,n,i=e.bitLength(),s=E(1);if(i<=0)return s;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new j(t):t.isEven()?new Qe(t):new H(t);var o=new Array,a=3,l=r-1,u=(1<<r)-1;if(o[1]=n.convert(this),r>1){var h=c();n.sqrTo(o[1],h);while(a<=u)o[a]=c(),n.mulTo(h,o[a-2],o[a]),a+=2}var d,f,p=e.t-1,y=!0,g=c();i=T(e.data[p])-1;while(p>=0){i>=l?d=e.data[p]>>i-l&u:(d=(e.data[p]&(1<<i+1)-1)<<l-i,p>0&&(d|=e.data[p-1]>>this.DB+i-l)),a=r;while(0==(1&d))d>>=1,--a;if((i-=a)<0&&(i+=this.DB,--p),y)o[d].copyTo(s),y=!1;else{while(a>1)n.sqrTo(s,g),n.sqrTo(g,s),a-=2;a>0?n.sqrTo(s,g):(f=s,s=g,g=f),n.mulTo(g,o[d],s)}while(p>=0&&0==(e.data[p]&1<<i))n.sqrTo(s,g),f=s,s=g,g=f,--i<0&&(i=this.DB-1,--p)}return n.revert(s)}function it(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));while(t.signum()>0)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function st(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}function ot(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return a.ZERO;var r=e.clone(),n=this.clone(),i=E(1),s=E(0),o=E(0),c=E(1);while(0!=r.signum()){while(r.isEven())r.rShiftTo(1,r),t?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);while(n.isEven())n.rShiftTo(1,n),t?(o.isEven()&&c.isEven()||(o.addTo(this,o),c.subTo(e,c)),o.rShiftTo(1,o)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(o,i),s.subTo(c,s)):(n.subTo(r,n),t&&o.subTo(i,o),c.subTo(s,c))}return 0!=n.compareTo(a.ONE)?a.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c}j.prototype.convert=V,j.prototype.revert=z,j.prototype.reduce=F,j.prototype.mulTo=$,j.prototype.sqrTo=K,H.prototype.convert=G,H.prototype.revert=W,H.prototype.reduce=Y,H.prototype.mulTo=Q,H.prototype.sqrTo=J,a.prototype.copyTo=b,a.prototype.fromInt=v,a.prototype.fromString=_,a.prototype.clamp=S,a.prototype.dlShiftTo=P,a.prototype.drShiftTo=x,a.prototype.lShiftTo=D,a.prototype.rShiftTo=O,a.prototype.subTo=N,a.prototype.multiplyTo=L,a.prototype.squareTo=B,a.prototype.divRemTo=U,a.prototype.invDigit=q,a.prototype.isEven=X,a.prototype.exp=Z,a.prototype.toString=A,a.prototype.negate=I,a.prototype.abs=C,a.prototype.compareTo=k,a.prototype.bitLength=R,a.prototype.mod=M,a.prototype.modPowInt=ee,a.ZERO=E(0),a.ONE=E(1),Ke.prototype.convert=qe,Ke.prototype.revert=qe,Ke.prototype.mulTo=He,Ke.prototype.sqrTo=Ge,Qe.prototype.convert=Xe,Qe.prototype.revert=Ze,Qe.prototype.reduce=et,Qe.prototype.mulTo=rt,Qe.prototype.sqrTo=tt;var at=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],ct=(1<<26)/at[at.length-1];function lt(e){var t,r=this.abs();if(1==r.t&&r.data[0]<=at[at.length-1]){for(t=0;t<at.length;++t)if(r.data[0]==at[t])return!0;return!1}if(r.isEven())return!1;t=1;while(t<at.length){var n=at[t],i=t+1;while(i<at.length&&n<ct)n*=at[i++];n=r.modInt(n);while(t<i)if(n%at[t++]==0)return!1}return r.millerRabin(e)}function ut(e){var t=this.subtract(a.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n,i=t.shiftRight(r),s=ht(),o=0;o<e;++o){do{n=new a(this.bitLength(),s)}while(n.compareTo(a.ONE)<=0||n.compareTo(t)>=0);var c=n.modPow(i,this);if(0!=c.compareTo(a.ONE)&&0!=c.compareTo(t)){var l=1;while(l++<r&&0!=c.compareTo(t))if(c=c.modPowInt(2,this),0==c.compareTo(a.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0}function ht(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}}}a.prototype.chunkSize=se,a.prototype.toRadix=ae,a.prototype.fromRadix=ce,a.prototype.fromNumber=le,a.prototype.bitwiseTo=pe,a.prototype.changeBit=xe,a.prototype.addTo=Le,a.prototype.dMultiply=Fe,a.prototype.dAddOffset=$e,a.prototype.multiplyLowerTo=Ye,a.prototype.multiplyUpperTo=Je,a.prototype.modInt=st,a.prototype.millerRabin=ut,a.prototype.clone=te,a.prototype.intValue=re,a.prototype.byteValue=ne,a.prototype.shortValue=ie,a.prototype.signum=oe,a.prototype.toByteArray=ue,a.prototype.equals=he,a.prototype.min=de,a.prototype.max=fe,a.prototype.and=ge,a.prototype.or=we,a.prototype.xor=ve,a.prototype.andNot=_e,a.prototype.not=Se,a.prototype.shiftLeft=Ae,a.prototype.shiftRight=Ie,a.prototype.getLowestSetBit=ke,a.prototype.bitCount=Re,a.prototype.testBit=Pe,a.prototype.setBit=De,a.prototype.clearBit=Oe,a.prototype.flipBit=Ne,a.prototype.add=Be,a.prototype.subtract=Ue,a.prototype.multiply=Me,a.prototype.divide=je,a.prototype.remainder=Ve,a.prototype.divideAndRemainder=ze,a.prototype.modPow=nt,a.prototype.modInverse=ot,a.prototype.pow=We,a.prototype.gcd=it,a.prototype.isProbablePrime=lt},8991:function(e,t,r){var n=r(3832);e.exports=n.md=n.md||{},n.md.algorithms=n.md.algorithms||{}},6971:function(e,t,r){var n=r(3832);r(3453),e.exports=n.mgf=n.mgf||{},n.mgf.mgf1=n.mgf1},3453:function(e,t,r){var n=r(3832);r(7116),n.mgf=n.mgf||{};var i=e.exports=n.mgf.mgf1=n.mgf1=n.mgf1||{};i.create=function(e){var t={generate:function(t,r){for(var i=new n.util.ByteBuffer,s=Math.ceil(r/e.digestLength),o=0;o<s;o++){var a=new n.util.ByteBuffer;a.putInt32(o),e.start(),e.update(t+a.getBytes()),i.putBuffer(e.digest())}return i.truncate(i.length()-r),i.getBytes()}};return t}},6270:function(e,t,r){var n=r(3832);n.pki=n.pki||{};var i=e.exports=n.pki.oids=n.oids=n.oids||{};function s(e,t){i[e]=t,i[t]=e}function o(e,t){i[e]=t}s("1.2.840.113549.1.1.1","rsaEncryption"),s("1.2.840.113549.1.1.4","md5WithRSAEncryption"),s("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),s("1.2.840.113549.1.1.7","RSAES-OAEP"),s("1.2.840.113549.1.1.8","mgf1"),s("1.2.840.113549.1.1.9","pSpecified"),s("1.2.840.113549.1.1.10","RSASSA-PSS"),s("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),s("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),s("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),s("1.3.101.112","EdDSA25519"),s("1.2.840.10040.4.3","dsa-with-sha1"),s("1.3.14.3.2.7","desCBC"),s("1.3.14.3.2.26","sha1"),s("1.3.14.3.2.29","sha1WithRSASignature"),s("2.16.840.1.101.3.4.2.1","sha256"),s("2.16.840.1.101.3.4.2.2","sha384"),s("2.16.840.1.101.3.4.2.3","sha512"),s("2.16.840.1.101.3.4.2.4","sha224"),s("2.16.840.1.101.3.4.2.5","sha512-224"),s("2.16.840.1.101.3.4.2.6","sha512-256"),s("1.2.840.113549.2.2","md2"),s("1.2.840.113549.2.5","md5"),s("1.2.840.113549.1.7.1","data"),s("1.2.840.113549.1.7.2","signedData"),s("1.2.840.113549.1.7.3","envelopedData"),s("1.2.840.113549.1.7.4","signedAndEnvelopedData"),s("1.2.840.113549.1.7.5","digestedData"),s("1.2.840.113549.1.7.6","encryptedData"),s("1.2.840.113549.1.9.1","emailAddress"),s("1.2.840.113549.1.9.2","unstructuredName"),s("1.2.840.113549.1.9.3","contentType"),s("1.2.840.113549.1.9.4","messageDigest"),s("1.2.840.113549.1.9.5","signingTime"),s("1.2.840.113549.1.9.6","counterSignature"),s("1.2.840.113549.1.9.7","challengePassword"),s("1.2.840.113549.1.9.8","unstructuredAddress"),s("1.2.840.113549.1.9.14","extensionRequest"),s("1.2.840.113549.1.9.20","friendlyName"),s("1.2.840.113549.1.9.21","localKeyId"),s("1.2.840.113549.1.9.22.1","x509Certificate"),s("1.2.840.113549.1.12.10.1.1","keyBag"),s("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),s("1.2.840.113549.1.12.10.1.3","certBag"),s("1.2.840.113549.1.12.10.1.4","crlBag"),s("1.2.840.113549.1.12.10.1.5","secretBag"),s("1.2.840.113549.1.12.10.1.6","safeContentsBag"),s("1.2.840.113549.1.5.13","pkcs5PBES2"),s("1.2.840.113549.1.5.12","pkcs5PBKDF2"),s("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),s("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),s("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),s("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),s("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),s("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),s("1.2.840.113549.2.7","hmacWithSHA1"),s("1.2.840.113549.2.8","hmacWithSHA224"),s("1.2.840.113549.2.9","hmacWithSHA256"),s("1.2.840.113549.2.10","hmacWithSHA384"),s("1.2.840.113549.2.11","hmacWithSHA512"),s("1.2.840.113549.3.7","des-EDE3-CBC"),s("2.16.840.1.101.3.4.1.2","aes128-CBC"),s("2.16.840.1.101.3.4.1.22","aes192-CBC"),s("2.16.840.1.101.3.4.1.42","aes256-CBC"),s("2.5.4.3","commonName"),s("2.5.4.4","surname"),s("2.5.4.5","serialNumber"),s("2.5.4.6","countryName"),s("2.5.4.7","localityName"),s("2.5.4.8","stateOrProvinceName"),s("2.5.4.9","streetAddress"),s("2.5.4.10","organizationName"),s("2.5.4.11","organizationalUnitName"),s("2.5.4.12","title"),s("2.5.4.13","description"),s("2.5.4.15","businessCategory"),s("2.5.4.17","postalCode"),s("2.5.4.42","givenName"),s("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),s("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),s("2.16.840.1.113730.1.1","nsCertType"),s("2.16.840.1.113730.1.13","nsComment"),o("2.5.29.1","authorityKeyIdentifier"),o("2.5.29.2","keyAttributes"),o("2.5.29.3","certificatePolicies"),o("2.5.29.4","keyUsageRestriction"),o("2.5.29.5","policyMapping"),o("2.5.29.6","subtreesConstraint"),o("2.5.29.7","subjectAltName"),o("2.5.29.8","issuerAltName"),o("2.5.29.9","subjectDirectoryAttributes"),o("2.5.29.10","basicConstraints"),o("2.5.29.11","nameConstraints"),o("2.5.29.12","policyConstraints"),o("2.5.29.13","basicConstraints"),s("2.5.29.14","subjectKeyIdentifier"),s("2.5.29.15","keyUsage"),o("2.5.29.16","privateKeyUsagePeriod"),s("2.5.29.17","subjectAltName"),s("2.5.29.18","issuerAltName"),s("2.5.29.19","basicConstraints"),o("2.5.29.20","cRLNumber"),o("2.5.29.21","cRLReason"),o("2.5.29.22","expirationDate"),o("2.5.29.23","instructionCode"),o("2.5.29.24","invalidityDate"),o("2.5.29.25","cRLDistributionPoints"),o("2.5.29.26","issuingDistributionPoint"),o("2.5.29.27","deltaCRLIndicator"),o("2.5.29.28","issuingDistributionPoint"),o("2.5.29.29","certificateIssuer"),o("2.5.29.30","nameConstraints"),s("2.5.29.31","cRLDistributionPoints"),s("2.5.29.32","certificatePolicies"),o("2.5.29.33","policyMappings"),o("2.5.29.34","policyConstraints"),s("2.5.29.35","authorityKeyIdentifier"),o("2.5.29.36","policyConstraints"),s("2.5.29.37","extKeyUsage"),o("2.5.29.46","freshestCRL"),o("2.5.29.54","inhibitAnyPolicy"),s("1.3.6.1.4.1.11129.2.4.2","timestampList"),s("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),s("1.3.6.1.5.5.7.3.1","serverAuth"),s("1.3.6.1.5.5.7.3.2","clientAuth"),s("1.3.6.1.5.5.7.3.3","codeSigning"),s("1.3.6.1.5.5.7.3.4","emailProtection"),s("1.3.6.1.5.5.7.3.8","timeStamping")},7450:function(e,t,r){var n=r(3832);if(r(8925),r(3068),r(3480),r(8991),r(6270),r(8960),r(6953),r(9563),r(9372),r(8095),r(7116),"undefined"===typeof i)var i=n.jsbn.BigInteger;var s=n.asn1,o=n.pki=n.pki||{};e.exports=o.pbe=n.pbe=n.pbe||{};var a=o.oids,c={name:"EncryptedPrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},l={name:"PBES2Algorithms",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},u={name:"pkcs-12PbeParams",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"iterations"}]};function h(e,t){return e.start().update(t).digest().getBytes()}function d(e){var t;if(e){if(t=o.oids[s.derToOid(e)],!t){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}}else t="hmacWithSHA1";return f(t)}function f(e){var t=n.md;switch(e){case"hmacWithSHA224":t=n.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function p(e,t,r,i){var a=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,t.getBytes())]);return"hmacWithSHA1"!==i&&a.value.push(s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,n.util.hexToBytes(r.toString(16))),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o.oids[i]).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])),a}o.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var i,c,l,u=n.random.getBytesSync(r.saltSize),h=r.count,d=s.integerToDer(h);if(0===r.algorithm.indexOf("aes")||"des"===r.algorithm){var y,g,m;switch(r.algorithm){case"aes128":i=16,y=16,g=a["aes128-CBC"],m=n.aes.createEncryptionCipher;break;case"aes192":i=24,y=16,g=a["aes192-CBC"],m=n.aes.createEncryptionCipher;break;case"aes256":i=32,y=16,g=a["aes256-CBC"],m=n.aes.createEncryptionCipher;break;case"des":i=8,y=8,g=a["desCBC"],m=n.des.createEncryptionCipher;break;default:var w=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw w.algorithm=r.algorithm,w}var b="hmacWith"+r.prfAlgorithm.toUpperCase(),v=f(b),E=n.pkcs5.pbkdf2(t,u,h,i,v),_=n.random.getBytesSync(y),S=m(E);S.start(_),S.update(s.toDer(e)),S.finish(),l=S.output.getBytes();var A=p(u,d,i,b);c=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(a["pkcs5PBES2"]).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(a["pkcs5PBKDF2"]).getBytes()),A]),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(g).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,_)])])])}else{if("3des"!==r.algorithm){w=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw w.algorithm=r.algorithm,w}i=24;var I=new n.util.ByteBuffer(u);E=o.pbe.generatePkcs12Key(t,I,1,h,i),_=o.pbe.generatePkcs12Key(t,I,2,h,i),S=n.des.createEncryptionCipher(E);S.start(_),S.update(s.toDer(e)),S.finish(),l=S.output.getBytes(),c=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(a["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,u),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,d.getBytes())])])}var C=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[c,s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,l)]);return C},o.decryptPrivateKeyInfo=function(e,t){var r=null,i={},a=[];if(!s.validate(e,c,i,a)){var l=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw l.errors=a,l}var u=s.derToOid(i.encryptionOid),h=o.pbe.getCipher(u,i.encryptionParams,t),d=n.util.createBuffer(i.encryptedData);return h.update(d),h.finish()&&(r=s.fromDer(h.output)),r},o.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:s.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})},o.encryptedPrivateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==t.type){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return s.fromDer(t.body)},o.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var i=o.wrapRsaPrivateKey(o.privateKeyToAsn1(e));return i=o.encryptPrivateKeyInfo(i,t,r),o.encryptedPrivateKeyToPem(i)}var a,c,l,u;switch(r.algorithm){case"aes128":a="AES-128-CBC",l=16,c=n.random.getBytesSync(16),u=n.aes.createEncryptionCipher;break;case"aes192":a="AES-192-CBC",l=24,c=n.random.getBytesSync(16),u=n.aes.createEncryptionCipher;break;case"aes256":a="AES-256-CBC",l=32,c=n.random.getBytesSync(16),u=n.aes.createEncryptionCipher;break;case"3des":a="DES-EDE3-CBC",l=24,c=n.random.getBytesSync(8),u=n.des.createEncryptionCipher;break;case"des":a="DES-CBC",l=8,c=n.random.getBytesSync(8),u=n.des.createEncryptionCipher;break;default:var h=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw h.algorithm=r.algorithm,h}var d=n.pbe.opensslDeriveBytes(t,c.substr(0,8),l),f=u(d);f.start(c),f.update(s.toDer(o.privateKeyToAsn1(e))),f.finish();var p={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:a,parameters:n.util.bytesToHex(c).toUpperCase()},body:f.output.getBytes()};return n.pem.encode(p)},o.decryptRsaPrivateKey=function(e,t){var r=null,i=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==i.type&&"PRIVATE KEY"!==i.type&&"RSA PRIVATE KEY"!==i.type){var a=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw a.headerType=a,a}if(i.procType&&"ENCRYPTED"===i.procType.type){var c,l;switch(i.dekInfo.algorithm){case"DES-CBC":c=8,l=n.des.createDecryptionCipher;break;case"DES-EDE3-CBC":c=24,l=n.des.createDecryptionCipher;break;case"AES-128-CBC":c=16,l=n.aes.createDecryptionCipher;break;case"AES-192-CBC":c=24,l=n.aes.createDecryptionCipher;break;case"AES-256-CBC":c=32,l=n.aes.createDecryptionCipher;break;case"RC2-40-CBC":c=5,l=function(e){return n.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":c=8,l=function(e){return n.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":c=16,l=function(e){return n.rc2.createDecryptionCipher(e,128)};break;default:a=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".');throw a.algorithm=i.dekInfo.algorithm,a}var u=n.util.hexToBytes(i.dekInfo.parameters),h=n.pbe.opensslDeriveBytes(t,u.substr(0,8),c),d=l(h);if(d.start(u),d.update(n.util.createBuffer(i.body)),!d.finish())return r;r=d.output.getBytes()}else r=i.body;return r="ENCRYPTED PRIVATE KEY"===i.type?o.decryptPrivateKeyInfo(s.fromDer(r),t):s.fromDer(r),null!==r&&(r=o.privateKeyFromAsn1(r)),r},o.pbe.generatePkcs12Key=function(e,t,r,i,s,o){var a,c;if("undefined"===typeof o||null===o){if(!("sha1"in n.md))throw new Error('"sha1" hash algorithm unavailable.');o=n.md.sha1.create()}var l=o.digestLength,u=o.blockLength,h=new n.util.ByteBuffer,d=new n.util.ByteBuffer;if(null!==e&&void 0!==e){for(c=0;c<e.length;c++)d.putInt16(e.charCodeAt(c));d.putInt16(0)}var f=d.length(),p=t.length(),y=new n.util.ByteBuffer;y.fillWithByte(r,u);var g=u*Math.ceil(p/u),m=new n.util.ByteBuffer;for(c=0;c<g;c++)m.putByte(t.at(c%p));var w=u*Math.ceil(f/u),b=new n.util.ByteBuffer;for(c=0;c<w;c++)b.putByte(d.at(c%f));var v=m;v.putBuffer(b);for(var E=Math.ceil(s/l),_=1;_<=E;_++){var S=new n.util.ByteBuffer;S.putBytes(y.bytes()),S.putBytes(v.bytes());for(var A=0;A<i;A++)o.start(),o.update(S.getBytes()),S=o.digest();var I=new n.util.ByteBuffer;for(c=0;c<u;c++)I.putByte(S.at(c%l));var C=Math.ceil(p/u)+Math.ceil(f/u),k=new n.util.ByteBuffer;for(a=0;a<C;a++){var T=new n.util.ByteBuffer(v.getBytes(u)),R=511;for(c=I.length()-1;c>=0;c--)R>>=8,R+=I.at(c)+T.at(c),T.setAt(c,255&R);k.putBuffer(T)}v=k,h.putBuffer(S)}return h.truncate(h.length()-s),h},o.pbe.getCipher=function(e,t,r){switch(e){case o.oids["pkcs5PBES2"]:return o.pbe.getCipherForPBES2(e,t,r);case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case o.oids["pbewithSHAAnd40BitRC2-CBC"]:return o.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}},o.pbe.getCipherForPBES2=function(e,t,r){var i={},a=[];if(!s.validate(t,l,i,a)){var c=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw c.errors=a,c}if(e=s.derToOid(i.kdfOid),e!==o.oids["pkcs5PBKDF2"]){c=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw c.oid=e,c.supportedOids=["pkcs5PBKDF2"],c}if(e=s.derToOid(i.encOid),e!==o.oids["aes128-CBC"]&&e!==o.oids["aes192-CBC"]&&e!==o.oids["aes256-CBC"]&&e!==o.oids["des-EDE3-CBC"]&&e!==o.oids["desCBC"]){c=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw c.oid=e,c.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],c}var u,h,f=i.kdfSalt,p=n.util.createBuffer(i.kdfIterationCount);switch(p=p.getInt(p.length()<<3),o.oids[e]){case"aes128-CBC":u=16,h=n.aes.createDecryptionCipher;break;case"aes192-CBC":u=24,h=n.aes.createDecryptionCipher;break;case"aes256-CBC":u=32,h=n.aes.createDecryptionCipher;break;case"des-EDE3-CBC":u=24,h=n.des.createDecryptionCipher;break;case"desCBC":u=8,h=n.des.createDecryptionCipher;break}var y=d(i.prfOid),g=n.pkcs5.pbkdf2(r,f,p,u,y),m=i.encIv,w=h(g);return w.start(m),w},o.pbe.getCipherForPKCS12PBE=function(e,t,r){var i={},a=[];if(!s.validate(t,u,i,a)){var c=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw c.errors=a,c}var l,h,f,p=n.util.createBuffer(i.salt),y=n.util.createBuffer(i.iterations);switch(y=y.getInt(y.length()<<3),e){case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:l=24,h=8,f=n.des.startDecrypting;break;case o.oids["pbewithSHAAnd40BitRC2-CBC"]:l=5,h=8,f=function(e,t){var r=n.rc2.createDecryptionCipher(e,40);return r.start(t,null),r};break;default:c=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw c.oid=e,c}var g=d(i.prfOid),m=o.pbe.generatePkcs12Key(r,p,1,y,l,g);g.start();var w=o.pbe.generatePkcs12Key(r,p,2,y,h,g);return f(m,w)},o.pbe.opensslDeriveBytes=function(e,t,r,i){if("undefined"===typeof i||null===i){if(!("md5"in n.md))throw new Error('"md5" hash algorithm unavailable.');i=n.md.md5.create()}null===t&&(t="");for(var s=[h(i,e+t)],o=16,a=1;o<r;++a,o+=16)s.push(h(i,s[a-1]+e+t));return s.join("").substr(0,r)}},8960:function(e,t,r){var n=r(3832);r(6607),r(8991),r(7116);var i,s=n.pkcs5=n.pkcs5||{};n.util.isNodejs&&!n.options.usePureJavaScript&&(i=r(5819)),e.exports=n.pbkdf2=s.pbkdf2=function(e,t,r,s,o,a){if("function"===typeof o&&(a=o,o=null),n.util.isNodejs&&!n.options.usePureJavaScript&&i.pbkdf2&&(null===o||"object"!==typeof o)&&(i.pbkdf2Sync.length>4||!o||"sha1"===o))return"string"!==typeof o&&(o="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),a?4===i.pbkdf2Sync.length?i.pbkdf2(e,t,r,s,(function(e,t){if(e)return a(e);a(null,t.toString("binary"))})):i.pbkdf2(e,t,r,s,o,(function(e,t){if(e)return a(e);a(null,t.toString("binary"))})):4===i.pbkdf2Sync.length?i.pbkdf2Sync(e,t,r,s).toString("binary"):i.pbkdf2Sync(e,t,r,s,o).toString("binary");if("undefined"!==typeof o&&null!==o||(o="sha1"),"string"===typeof o){if(!(o in n.md.algorithms))throw new Error("Unknown hash algorithm: "+o);o=n.md[o].create()}var c=o.digestLength;if(s>4294967295*c){var l=new Error("Derived key is too long.");if(a)return a(l);throw l}var u=Math.ceil(s/c),h=s-(u-1)*c,d=n.hmac.create();d.start(o,e);var f,p,y,g="";if(!a){for(var m=1;m<=u;++m){d.start(null,null),d.update(t),d.update(n.util.int32ToBytes(m)),f=y=d.digest().getBytes();for(var w=2;w<=r;++w)d.start(null,null),d.update(y),p=d.digest().getBytes(),f=n.util.xorBytes(f,p,c),y=p;g+=m<u?f:f.substr(0,h)}return g}m=1;function b(){if(m>u)return a(null,g);d.start(null,null),d.update(t),d.update(n.util.int32ToBytes(m)),f=y=d.digest().getBytes(),w=2,v()}function v(){if(w<=r)return d.start(null,null),d.update(y),p=d.digest().getBytes(),f=n.util.xorBytes(f,p,c),y=p,++w,n.util.setImmediate(v);g+=m<u?f:f.substr(0,h),++m,b()}b()}},6953:function(e,t,r){var n=r(3832);r(7116);var i=e.exports=n.pem=n.pem||{};function s(e){for(var t=e.name+": ",r=[],n=function(e,t){return" "+t},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+"\r\n";var s=0,o=-1;for(i=0;i<t.length;++i,++s)if(s>65&&-1!==o){var a=t[o];","===a?(++o,t=t.substr(0,o)+"\r\n "+t.substr(o)):t=t.substr(0,o)+"\r\n"+a+t.substr(o+1),s=i-o-1,o=-1,++i}else" "!==t[i]&&"\t"!==t[i]&&","!==t[i]||(o=i);return t}function o(e){return e.replace(/^\s+/,"")}i.encode=function(e,t){t=t||{};var r,i="-----BEGIN "+e.type+"-----\r\n";if(e.procType&&(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},i+=s(r)),e.contentDomain&&(r={name:"Content-Domain",values:[e.contentDomain]},i+=s(r)),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),i+=s(r)),e.headers)for(var o=0;o<e.headers.length;++o)i+=s(e.headers[o]);return e.procType&&(i+="\r\n"),i+=n.util.encode64(e.body,t.maxline||64)+"\r\n",i+="-----END "+e.type+"-----\r\n",i},i.decode=function(e){var t,r=[],i=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,s=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,a=/\r?\n/;while(1){if(t=i.exec(e),!t)break;var c=t[1];"NEW CERTIFICATE REQUEST"===c&&(c="CERTIFICATE REQUEST");var l={type:c,procType:null,contentDomain:null,dekInfo:null,headers:[],body:n.util.decode64(t[3])};if(r.push(l),t[2]){var u=t[2].split(a),h=0;while(t&&h<u.length){for(var d=u[h].replace(/\s+$/,""),f=h+1;f<u.length;++f){var p=u[f];if(!/\s/.test(p[0]))break;d+=p,h=f}if(t=d.match(s),t){for(var y={name:t[1],values:[]},g=t[2].split(","),m=0;m<g.length;++m)y.values.push(o(g[m]));if(l.procType)if(l.contentDomain||"Content-Domain"!==y.name)if(l.dekInfo||"DEK-Info"!==y.name)l.headers.push(y);else{if(0===y.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');l.dekInfo={algorithm:g[0],parameters:g[1]||null}}else l.contentDomain=g[0]||"";else{if("Proc-Type"!==y.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==y.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');l.procType={version:g[0],type:g[1]}}}++h}if("ENCRYPTED"===l.procType&&!l.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===r.length)throw new Error("Invalid PEM formatted message.");return r}},8936:function(e,t,r){var n=r(3832);r(7116),r(9563),r(137);var i=e.exports=n.pkcs1=n.pkcs1||{};function s(e,t,r){r||(r=n.md.sha1.create());for(var i="",s=Math.ceil(t/r.digestLength),o=0;o<s;++o){var a=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,255&o);r.start(),r.update(e+a),i+=r.digest().getBytes()}return i.substring(0,t)}i.encode_rsa_oaep=function(e,t,r){var i,o,a,c;"string"===typeof r?(i=r,o=arguments[3]||void 0,a=arguments[4]||void 0):r&&(i=r.label||void 0,o=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(c=r.mgf1.md)),a?a.start():a=n.md.sha1.create(),c||(c=a);var l=Math.ceil(e.n.bitLength()/8),u=l-2*a.digestLength-2;if(t.length>u){var h=new Error("RSAES-OAEP input message length is too long.");throw h.length=t.length,h.maxLength=u,h}i||(i=""),a.update(i,"raw");for(var d=a.digest(),f="",p=u-t.length,y=0;y<p;y++)f+="\0";var g=d.getBytes()+f+""+t;if(o){if(o.length!==a.digestLength){h=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw h.seedLength=o.length,h.digestLength=a.digestLength,h}}else o=n.random.getBytes(a.digestLength);var m=s(o,l-a.digestLength-1,c),w=n.util.xorBytes(g,m,g.length),b=s(w,a.digestLength,c),v=n.util.xorBytes(o,b,o.length);return"\0"+v+w},i.decode_rsa_oaep=function(e,t,r){var i,o,a;"string"===typeof r?(i=r,o=arguments[3]||void 0):r&&(i=r.label||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var c=Math.ceil(e.n.bitLength()/8);if(t.length!==c){var l=new Error("RSAES-OAEP encoded message length is invalid.");throw l.length=t.length,l.expectedLength=c,l}if(void 0===o?o=n.md.sha1.create():o.start(),a||(a=o),c<2*o.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),o.update(i,"raw");for(var u=o.digest().getBytes(),h=t.charAt(0),d=t.substring(1,o.digestLength+1),f=t.substring(1+o.digestLength),p=s(f,o.digestLength,a),y=n.util.xorBytes(d,p,d.length),g=s(y,c-o.digestLength-1,a),m=n.util.xorBytes(f,g,f.length),w=m.substring(0,o.digestLength),b=(l="\0"!==h,0);b<o.digestLength;++b)l|=u.charAt(b)!==w.charAt(b);for(var v=1,E=o.digestLength,_=o.digestLength;_<m.length;_++){var S=m.charCodeAt(_),A=1&S^1,I=v?65534:0;l|=S&I,v&=A,E+=v}if(l||1!==m.charCodeAt(E))throw new Error("Invalid RSAES-OAEP padding.");return m.substring(E+1)}},9437:function(e,t,r){var n=r(3832);r(8925),r(3068),r(3480),r(6270),r(6953),r(5496),r(9563),r(7116),r(5414);var i=n.asn1,s=e.exports=n.pkcs7=n.pkcs7||{};function o(e){var t={},r=[];if(!i.validate(e,s.asn1.recipientInfoValidator,t,r)){var o=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw o.errors=r,o}return{version:t.version.charCodeAt(0),issuer:n.pki.RDNAttributesAsArray(t.issuer),serialNumber:n.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:i.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:void 0,content:t.encKey}}}function a(e){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:e.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.encryptedContent.algorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.encryptedContent.content)])}function c(e){for(var t=[],r=0;r<e.length;++r)t.push(o(e[r]));return t}function l(e){for(var t=[],r=0;r<e.length;++r)t.push(a(e[r]));return t}function u(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:e.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.digestAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var r=i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[]),s=0;s<e.unauthenticatedAttributes.length;++s){var o=e.unauthenticatedAttributes[s];r.values.push(d(o))}t.value.push(r)}return t}function h(e){for(var t=[],r=0;r<e.length;++r)t.push(u(e[r]));return t}function d(e){var t;if(e.type===n.pki.oids.contentType)t=i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.value).getBytes());else if(e.type===n.pki.oids.messageDigest)t=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===n.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),s=new Date("2050-01-01T00:00:00Z"),o=e.value;if("string"===typeof o){var a=Date.parse(o);o=isNaN(a)?13===o.length?i.utcTimeToDate(o):i.generalizedTimeToDate(o):new Date(a)}t=o>=r&&o<s?i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(o)):i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,!1,i.dateToGeneralizedTime(o))}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[t])])}function f(e){return[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(n.pki.oids.data).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.algorithm).getBytes()),e.parameter?i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.parameter.getBytes()):void 0]),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.content.getBytes())])]}function p(e,t,r){var s={},o=[];if(!i.validate(t,r,s,o)){var a=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw a.errors=a,a}var c=i.derToOid(s.contentType);if(c!==n.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(s.encryptedContent){var l="";if(n.util.isArray(s.encryptedContent))for(var u=0;u<s.encryptedContent.length;++u){if(s.encryptedContent[u].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");l+=s.encryptedContent[u].value}else l=s.encryptedContent;e.encryptedContent={algorithm:i.derToOid(s.encAlgorithm),parameter:n.util.createBuffer(s.encParameter.value),content:n.util.createBuffer(l)}}if(s.content){l="";if(n.util.isArray(s.content))for(u=0;u<s.content.length;++u){if(s.content[u].type!==i.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");l+=s.content[u].value}else l=s.content;e.content=n.util.createBuffer(l)}return e.version=s.version.charCodeAt(0),e.rawCapture=s,s}function y(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case n.pki.oids["aes128-CBC"]:case n.pki.oids["aes192-CBC"]:case n.pki.oids["aes256-CBC"]:t=n.aes.createDecryptionCipher(e.encryptedContent.key);break;case n.pki.oids["desCBC"]:case n.pki.oids["des-EDE3-CBC"]:t=n.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}s.messageFromPem=function(e){var t=n.pem.decode(e)[0];if("PKCS7"!==t.type){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var o=i.fromDer(t.body);return s.messageFromAsn1(o)},s.messageToPem=function(e,t){var r={type:"PKCS7",body:i.toDer(e.toAsn1()).getBytes()};return n.pem.encode(r,{maxline:t})},s.messageFromAsn1=function(e){var t={},r=[];if(!i.validate(e,s.asn1.contentInfoValidator,t,r)){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw o.errors=r,o}var a,c=i.derToOid(t.contentType);switch(c){case n.pki.oids.envelopedData:a=s.createEnvelopedData();break;case n.pki.oids.encryptedData:a=s.createEncryptedData();break;case n.pki.oids.signedData:a=s.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+c+" is not (yet) supported.")}return a.fromAsn1(t.content.value[0]),a},s.createSignedData=function(){var e=null;return e={type:n.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(p(e,t,s.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var r=e.rawCapture.certificates.value,i=0;i<r.length;++i)e.certificates.push(n.pki.certificateFromAsn1(r[i]))},toAsn1:function(){e.contentInfo||e.sign();for(var t=[],r=0;r<e.certificates.length;++r)t.push(n.pki.certificateToAsn1(e.certificates[r]));var s=[],o=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return t.length>0&&o.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,t)),s.length>0&&o.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.signerInfos)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),o])},addSigner:function(t){var r=t.issuer,i=t.serialNumber;if(t.certificate){var s=t.certificate;"string"===typeof s&&(s=n.pki.certificateFromPem(s)),r=s.issuer.attributes,i=s.serialNumber}var o=t.key;if(!o)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"===typeof o&&(o=n.pki.privateKeyFromPem(o));var a=t.digestAlgorithm||n.pki.oids.sha1;switch(a){case n.pki.oids.sha1:case n.pki.oids.sha256:case n.pki.oids.sha384:case n.pki.oids.sha512:case n.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+a)}var c=t.authenticatedAttributes||[];if(c.length>0){for(var l=!1,u=!1,h=0;h<c.length;++h){var d=c[h];if(l||d.type!==n.pki.oids.contentType){if(u||d.type!==n.pki.oids.messageDigest);else if(u=!0,l)break}else if(l=!0,u)break}if(!l||!u)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:o,version:1,issuer:r,serialNumber:i,digestAlgorithm:a,signatureAlgorithm:n.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(s){var o;(s=s||{},"object"!==typeof e.content||null===e.contentInfo)&&(e.contentInfo=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(n.pki.oids.data).getBytes())]),"content"in e&&(e.content instanceof n.util.ByteBuffer?o=e.content.bytes():"string"===typeof e.content&&(o=n.util.encodeUtf8(e.content)),s.detached?e.detachedContent=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,o):e.contentInfo.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,o)]))));if(0!==e.signers.length){var a=t();r(a)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"===typeof t&&(t=n.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}},e;function t(){for(var t={},r=0;r<e.signers.length;++r){var s=e.signers[r],o=s.digestAlgorithm;o in t||(t[o]=n.md[n.pki.oids[o]].create()),0===s.authenticatedAttributes.length?s.md=t[o]:s.md=n.md[n.pki.oids[o]].create()}for(var o in e.digestAlgorithmIdentifiers=[],t)e.digestAlgorithmIdentifiers.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]));return t}function r(t){var r;if(e.detachedContent?r=e.detachedContent:(r=e.contentInfo.value[1],r=r.value[0]),!r)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=i.derToOid(e.contentInfo.value[0].value),o=i.toDer(r);for(var a in o.getByte(),i.getBerValueLength(o),o=o.getBytes(),t)t[a].start().update(o);for(var c=new Date,l=0;l<e.signers.length;++l){var u=e.signers[l];if(0===u.authenticatedAttributes.length){if(s!==n.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{u.authenticatedAttributesAsn1=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[]),p=0;p<u.authenticatedAttributes.length;++p){var y=u.authenticatedAttributes[p];y.type===n.pki.oids.messageDigest?y.value=t[u.digestAlgorithm].digest():y.type===n.pki.oids.signingTime&&(y.value||(y.value=c)),f.value.push(d(y)),u.authenticatedAttributesAsn1.value.push(d(y))}o=i.toDer(f).getBytes(),u.md.start().update(o)}u.signature=u.key.sign(u.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=h(e.signers)}},s.createEncryptedData=function(){var e=null;return e={type:n.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(t){p(e,t,s.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),y(e)}},e},s.createEnvelopedData=function(){var e=null;return e={type:n.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=p(e,t,s.asn1.envelopedDataValidator);e.recipients=c(r.recipientInfos.value)},toAsn1:function(){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,l(e.recipients)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,f(e.encryptedContent))])])])},findRecipient:function(t){for(var r=t.issuer.attributes,n=0;n<e.recipients.length;++n){var i=e.recipients[n],s=i.issuer;if(i.serialNumber===t.serialNumber&&s.length===r.length){for(var o=!0,a=0;a<r.length;++a)if(s[a].type!==r[a].type||s[a].value!==r[a].value){o=!1;break}if(o)return i}}return null},decrypt:function(t,r){if(void 0===e.encryptedContent.key&&void 0!==t&&void 0!==r)switch(t.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:case n.pki.oids.desCBC:var i=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=n.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}y(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:n.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(void 0===e.encryptedContent.content){var i,s,o;switch(r=r||e.encryptedContent.algorithm,t=t||e.encryptedContent.key,r){case n.pki.oids["aes128-CBC"]:i=16,s=16,o=n.aes.createEncryptionCipher;break;case n.pki.oids["aes192-CBC"]:i=24,s=16,o=n.aes.createEncryptionCipher;break;case n.pki.oids["aes256-CBC"]:i=32,s=16,o=n.aes.createEncryptionCipher;break;case n.pki.oids["des-EDE3-CBC"]:i=24,s=8,o=n.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(void 0===t)t=n.util.createBuffer(n.random.getBytes(i));else if(t.length()!=i)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+i+".");e.encryptedContent.algorithm=r,e.encryptedContent.key=t,e.encryptedContent.parameter=n.util.createBuffer(n.random.getBytes(s));var a=o(t);if(a.start(e.encryptedContent.parameter.copy()),a.update(e.content),!a.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=a.output}for(var c=0;c<e.recipients.length;++c){var l=e.recipients[c];if(void 0===l.encryptedContent.content)switch(l.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:l.encryptedContent.content=l.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+l.encryptedContent.algorithm)}}}},e}},5496:function(e,t,r){var n=r(3832);r(3068),r(7116);var i=n.asn1,s=e.exports=n.pkcs7asn1=n.pkcs7asn1||{};n.pkcs7=n.pkcs7||{},n.pkcs7.asn1=s;var o={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};s.contentInfoValidator=o;var a={name:"EncryptedContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};s.envelopedDataValidator={name:"EnvelopedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(a)},s.encryptedDataValidator={name:"EncryptedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"}].concat(a)};var c={name:"SignerInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};s.signedDataValidator={name:"SignedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},o,{name:"SignedData.Certificates",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,capture:"signerInfos",optional:!0,value:[c]}]},s.recipientInfoValidator={name:"RecipientInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},9654:function(e,t,r){var n=r(3832);r(7116),r(5764),r(9563),function(){if(n.prime)e.exports=n.prime;else{var t=e.exports=n.prime=n.prime||{},r=n.jsbn.BigInteger,i=[6,4,2,4,2,4,6,2],s=new r(null);s.fromInt(30);var o=function(e,t){return e|t};t.generateProbablePrime=function(e,t,r){"function"===typeof t&&(r=t,t={}),t=t||{};var i=t.algorithm||"PRIMEINC";"string"===typeof i&&(i={name:i}),i.options=i.options||{};var s=t.prng||n.random,o={nextBytes:function(e){for(var t=s.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}};if("PRIMEINC"===i.name)return a(e,o,i.options,r);throw new Error("Invalid prime generation algorithm: "+i.name)}}function a(e,t,r,n){return"workers"in r?u(e,t,r,n):c(e,t,r,n)}function c(e,t,r,n){var i=h(e,t),s=0,o=d(i.bitLength());"millerRabinTests"in r&&(o=r.millerRabinTests);var a=10;"maxBlockTime"in r&&(a=r.maxBlockTime),l(i,e,t,s,o,a,n)}function l(e,t,r,s,o,a,c){var u=+new Date;do{if(e.bitLength()>t&&(e=h(t,r)),e.isProbablePrime(o))return c(null,e);e.dAddOffset(i[s++%8],0)}while(a<0||+new Date-u<a);n.util.setImmediate((function(){l(e,t,r,s,o,a,c)}))}function u(e,t,i,s){if("undefined"===typeof Worker)return c(e,t,i,s);var o=h(e,t),a=i.workers,l=i.workLoad||100,u=30*l/8,d=i.workerScript||"forge/prime.worker.js";if(-1===a)return n.util.estimateCores((function(e,t){e&&(t=2),a=t-1,f()}));function f(){a=Math.max(1,a);for(var n=[],i=0;i<a;++i)n[i]=new Worker(d);for(i=0;i<a;++i)n[i].addEventListener("message",f);var c=!1;function f(i){if(!c){0;var a=i.data;if(a.found){for(var d=0;d<n.length;++d)n[d].terminate();return c=!0,s(null,new r(a.prime,16))}o.bitLength()>e&&(o=h(e,t));var f=o.toString(16);i.target.postMessage({hex:f,workLoad:l}),o.dAddOffset(u,0)}}}f()}function h(e,t){var n=new r(e,t),i=e-1;return n.testBit(i)||n.bitwiseTo(r.ONE.shiftLeft(i),o,n),n.dAddOffset(31-n.mod(s).byteValue(),0),n}function d(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}}()},4933:function(e,t,r){var n=r(3832);r(7116);var i=null;!n.util.isNodejs||n.options.usePureJavaScript||process.versions["node-webkit"]||(i=r(5819));var s=e.exports=n.prng=n.prng||{};s.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,s=new Array(32),o=0;o<32;++o)s[o]=r.create();function a(e){if(t.pools[0].messageLength>=32)return l(),e();var r=32-t.pools[0].messageLength<<5;t.seedFile(r,(function(r,n){if(r)return e(r);t.collect(n),l(),e()}))}function c(){if(t.pools[0].messageLength>=32)return l();var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e)),l()}function l(){t.reseeds=4294967295===t.reseeds?0:t.reseeds+1;var e=t.plugin.md.create();e.update(t.keyBytes);for(var r=1,n=0;n<32;++n)t.reseeds%r===0&&(e.update(t.pools[n].digest().getBytes()),t.pools[n].start()),r<<=1;t.keyBytes=e.digest().getBytes(),e.start(),e.update(t.keyBytes);var i=e.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(i),t.generated=0}function u(e){var t=null,r=n.util.globalScope,i=r.crypto||r.msCrypto;i&&i.getRandomValues&&(t=function(e){return i.getRandomValues(e)});var s=n.util.createBuffer();if(t)while(s.length()<e){var o=Math.max(1,Math.min(e-s.length(),65536)/4),a=new Uint32Array(Math.floor(o));try{t(a);for(var c=0;c<a.length;++c)s.putInt32(a[c])}catch(f){if(!("undefined"!==typeof QuotaExceededError&&f instanceof QuotaExceededError))throw f}}if(s.length()<e){var l,u,h,d=Math.floor(65536*Math.random());while(s.length()<e){u=16807*(65535&d),l=16807*(d>>16),u+=(32767&l)<<16,u+=l>>15,u=(2147483647&u)+(u>>31),d=4294967295&u;for(c=0;c<3;++c)h=d>>>(c<<3),h^=Math.floor(256*Math.random()),s.putByte(255&h)}}return s.getBytes(e)}return t.pools=s,t.pool=0,t.generate=function(e,r){if(!r)return t.generateSync(e);var i=t.plugin.cipher,s=t.plugin.increment,o=t.plugin.formatKey,c=t.plugin.formatSeed,l=n.util.createBuffer();function u(h){if(h)return r(h);if(l.length()>=e)return r(null,l.getBytes(e));if(t.generated>1048575&&(t.key=null),null===t.key)return n.util.nextTick((function(){a(u)}));var d=i(t.key,t.seed);t.generated+=d.length,l.putBytes(d),t.key=o(i(t.key,s(t.seed))),t.seed=c(i(t.key,t.seed)),n.util.setImmediate(u)}t.key=null,u()},t.generateSync=function(e){var r=t.plugin.cipher,i=t.plugin.increment,s=t.plugin.formatKey,o=t.plugin.formatSeed;t.key=null;var a=n.util.createBuffer();while(a.length()<e){t.generated>1048575&&(t.key=null),null===t.key&&c();var l=r(t.key,t.seed);t.generated+=l.length,a.putBytes(l),t.key=s(r(t.key,i(t.seed))),t.seed=o(r(t.key,t.seed))}return a.getBytes(e)},i?(t.seedFile=function(e,t){i.randomBytes(e,(function(e,r){if(e)return t(e);t(null,r.toString())}))},t.seedFileSync=function(e){return i.randomBytes(e).toString()}):(t.seedFile=function(e,t){try{t(null,u(e))}catch(r){t(r)}},t.seedFileSync=u),t.collect=function(e){for(var r=e.length,n=0;n<r;++n)t.pools[t.pool].update(e.substr(n,1)),t.pool=31===t.pool?0:t.pool+1},t.collectInt=function(e,r){for(var n="",i=0;i<r;i+=8)n+=String.fromCharCode(e>>i&255);t.collect(n)},t.registerWorker=function(e){if(e===self)t.seedFile=function(e,t){function r(e){var n=e.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",r),t(n.forge.prng.err,n.forge.prng.bytes))}self.addEventListener("message",r),self.postMessage({forge:{prng:{needed:e}}})};else{var r=function(r){var n=r.data;n.forge&&n.forge.prng&&t.seedFile(n.forge.prng.needed,(function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})}))};e.addEventListener("message",r)}},t}},6007:function(e,t,r){var n=r(3832);r(9563),r(7116);var i=e.exports=n.pss=n.pss||{};i.create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t,r=e.md,i=e.mgf,s=r.digestLength,o=e.salt||null;if("string"===typeof o&&(o=n.util.createBuffer(o)),"saltLength"in e)t=e.saltLength;else{if(null===o)throw new Error("Salt length not specified or specific salt not given.");t=o.length()}if(null!==o&&o.length()!==t)throw new Error("Given salt length does not match length of given salt.");var a=e.prng||n.random,c={encode:function(e,c){var l,u,h=c-1,d=Math.ceil(h/8),f=e.digest().getBytes();if(d<s+t+2)throw new Error("Message is too long to encrypt.");u=null===o?a.getBytesSync(t):o.bytes();var p=new n.util.ByteBuffer;p.fillWithByte(0,8),p.putBytes(f),p.putBytes(u),r.start(),r.update(p.getBytes());var y=r.digest().getBytes(),g=new n.util.ByteBuffer;g.fillWithByte(0,d-t-s-2),g.putByte(1),g.putBytes(u);var m=g.getBytes(),w=d-s-1,b=i.generate(y,w),v="";for(l=0;l<w;l++)v+=String.fromCharCode(m.charCodeAt(l)^b.charCodeAt(l));var E=65280>>8*d-h&255;return v=String.fromCharCode(v.charCodeAt(0)&~E)+v.substr(1),v+y+String.fromCharCode(188)},verify:function(e,o,a){var c,l=a-1,u=Math.ceil(l/8);if(o=o.substr(-u),u<s+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==o.charCodeAt(u-1))throw new Error("Encoded message does not end in 0xBC.");var h=u-s-1,d=o.substr(0,h),f=o.substr(h,s),p=65280>>8*u-l&255;if(0!==(d.charCodeAt(0)&p))throw new Error("Bits beyond keysize not zero as expected.");var y=i.generate(f,h),g="";for(c=0;c<h;c++)g+=String.fromCharCode(d.charCodeAt(c)^y.charCodeAt(c));g=String.fromCharCode(g.charCodeAt(0)&~p)+g.substr(1);var m=u-s-t-2;for(c=0;c<m;c++)if(0!==g.charCodeAt(c))throw new Error("Leftmost octets not zero as expected");if(1!==g.charCodeAt(m))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var w=g.substr(-t),b=new n.util.ByteBuffer;b.fillWithByte(0,8),b.putBytes(e),b.putBytes(w),r.start(),r.update(b.getBytes());var v=r.digest().getBytes();return f===v}};return c}},9563:function(e,t,r){var n=r(3832);r(8925),r(1668),r(4933),r(7116),function(){n.random&&n.random.getBytes?e.exports=n.random:function(t){var r={},i=new Array(4),s=n.util.createBuffer();function o(){var e=n.prng.create(r);return e.getBytes=function(t,r){return e.generate(t,r)},e.getBytesSync=function(t){return e.generate(t)},e}r.formatKey=function(e){var t=n.util.createBuffer(e);return e=new Array(4),e[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),n.aes._expandKey(e,!1)},r.formatSeed=function(e){var t=n.util.createBuffer(e);return e=new Array(4),e[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},r.cipher=function(e,t){return n.aes._updateBlock(e,t,i,!1),s.putInt32(i[0]),s.putInt32(i[1]),s.putInt32(i[2]),s.putInt32(i[3]),s.getBytes()},r.increment=function(e){return++e[3],e},r.md=n.md.sha256;var a=o(),c=null,l=n.util.globalScope,u=l.crypto||l.msCrypto;if(u&&u.getRandomValues&&(c=function(e){return u.getRandomValues(e)}),n.options.usePureJavaScript||!n.util.isNodejs&&!c){if("undefined"===typeof window||window.document,a.collectInt(+new Date,32),"undefined"!==typeof navigator){var h="";for(var d in navigator)try{"string"==typeof navigator[d]&&(h+=navigator[d])}catch(f){}a.collect(h),h=null}t&&(t().mousemove((function(e){a.collectInt(e.clientX,16),a.collectInt(e.clientY,16)})),t().keypress((function(e){a.collectInt(e.charCode,8)})))}if(n.random)for(var d in a)n.random[d]=a[d];else n.random=a;n.random.createInstance=o,e.exports=n.random}("undefined"!==typeof jQuery?jQuery:null)}()},9372:function(e,t,r){var n=r(3832);r(7116);var i=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],s=[1,2,3,5],o=function(e,t){return e<<t&65535|(65535&e)>>16-t},a=function(e,t){return(65535&e)>>t|e<<16-t&65535};e.exports=n.rc2=n.rc2||{},n.rc2.expandKey=function(e,t){"string"===typeof e&&(e=n.util.createBuffer(e)),t=t||128;var r,s=e,o=e.length(),a=t,c=Math.ceil(a/8),l=255>>(7&a);for(r=o;r<128;r++)s.putByte(i[s.at(r-1)+s.at(r-o)&255]);for(s.setAt(128-c,i[s.at(128-c)&l]),r=127-c;r>=0;r--)s.setAt(r,i[s.at(r+1)^s.at(r+c)]);return s};var c=function(e,t,r){var i,c,l,u,h=!1,d=null,f=null,p=null,y=[];for(e=n.rc2.expandKey(e,t),l=0;l<64;l++)y.push(e.getInt16Le());r?(i=function(e){for(l=0;l<4;l++)e[l]+=y[u]+(e[(l+3)%4]&e[(l+2)%4])+(~e[(l+3)%4]&e[(l+1)%4]),e[l]=o(e[l],s[l]),u++},c=function(e){for(l=0;l<4;l++)e[l]+=y[63&e[(l+3)%4]]}):(i=function(e){for(l=3;l>=0;l--)e[l]=a(e[l],s[l]),e[l]-=y[u]+(e[(l+3)%4]&e[(l+2)%4])+(~e[(l+3)%4]&e[(l+1)%4]),u--},c=function(e){for(l=3;l>=0;l--)e[l]-=y[63&e[(l+3)%4]]});var g=function(e){var t=[];for(l=0;l<4;l++){var n=d.getInt16Le();null!==p&&(r?n^=p.getInt16Le():p.putInt16Le(n)),t.push(65535&n)}u=r?0:63;for(var i=0;i<e.length;i++)for(var s=0;s<e[i][0];s++)e[i][1](t);for(l=0;l<4;l++)null!==p&&(r?p.putInt16Le(t[l]):t[l]^=p.getInt16Le()),f.putInt16Le(t[l])},m=null;return m={start:function(e,t){e&&"string"===typeof e&&(e=n.util.createBuffer(e)),h=!1,d=n.util.createBuffer(),f=t||new n.util.createBuffer,p=e,m.output=f},update:function(e){h||d.putBuffer(e);while(d.length()>=8)g([[5,i],[1,c],[6,i],[1,c],[5,i]])},finish:function(e){var t=!0;if(r)if(e)t=e(8,d,!r);else{var n=8===d.length()?8:8-d.length();d.fillWithByte(n,n)}if(t&&(h=!0,m.update()),!r&&(t=0===d.length(),t))if(e)t=e(8,f,!r);else{var i=f.length(),s=f.at(i-1);s>i?t=!1:f.truncate(s)}return t}},m};n.rc2.startEncrypting=function(e,t,r){var i=n.rc2.createEncryptionCipher(e,128);return i.start(t,r),i},n.rc2.createEncryptionCipher=function(e,t){return c(e,t,!0)},n.rc2.startDecrypting=function(e,t,r){var i=n.rc2.createDecryptionCipher(e,128);return i.start(t,r),i},n.rc2.createDecryptionCipher=function(e,t){return c(e,t,!1)}},8095:function(e,t,r){var n=r(3832);if(r(3068),r(5764),r(6270),r(8936),r(9654),r(9563),r(7116),"undefined"===typeof i)var i=n.jsbn.BigInteger;var s=n.util.isNodejs?r(5819):null,o=n.asn1,a=n.util;n.pki=n.pki||{},e.exports=n.pki.rsa=n.rsa=n.rsa||{};var c=n.pki,l=[6,4,2,4,2,4,6,2],u={name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},h={name:"RSAPrivateKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},d={name:"RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},f=n.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},p={name:"DigestInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:o.Class.UNIVERSAL,type:o.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},y=function(e){var t;if(!(e.algorithm in c.oids)){var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}t=c.oids[e.algorithm];var n=o.oidToDer(t).getBytes(),i=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),s=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);s.value.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,n)),s.value.push(o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,""));var a=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(s),i.value.push(a),o.toDer(i).getBytes()},g=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);var s;t.dP||(t.dP=t.d.mod(t.p.subtract(i.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(i.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));do{s=new i(n.util.bytesToHex(n.random.getBytes(t.n.bitLength()/8)),16)}while(s.compareTo(t.n)>=0||!s.gcd(t.n).equals(i.ONE));e=e.multiply(s.modPow(t.e,t.n)).mod(t.n);var o=e.mod(t.p).modPow(t.dP,t.p),a=e.mod(t.q).modPow(t.dQ,t.q);while(o.compareTo(a)<0)o=o.add(t.p);var c=o.subtract(a).multiply(t.qInv).mod(t.p).multiply(t.q).add(a);return c=c.multiply(s.modInverse(t.n)).mod(t.n),c};function m(e,t,r){var i=n.util.createBuffer(),s=Math.ceil(t.n.bitLength()/8);if(e.length>s-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=e.length,o.max=s-11,o}i.putByte(0),i.putByte(r);var a,c=s-3-e.length;if(0===r||1===r){a=0===r?0:255;for(var l=0;l<c;++l)i.putByte(a)}else while(c>0){var u=0,h=n.random.getBytes(c);for(l=0;l<c;++l)a=h.charCodeAt(l),0===a?++u:i.putByte(a);c=u}return i.putByte(0),i.putBytes(e),i}function w(e,t,r,i){var s=Math.ceil(t.n.bitLength()/8),o=n.util.createBuffer(e),a=o.getByte(),c=o.getByte();if(0!==a||r&&0!==c&&1!==c||!r&&2!=c||r&&0===c&&"undefined"===typeof i)throw new Error("Encryption block is invalid.");var l=0;if(0===c){l=s-3-i;for(var u=0;u<l;++u)if(0!==o.getByte())throw new Error("Encryption block is invalid.")}else if(1===c){l=0;while(o.length()>1){if(255!==o.getByte()){--o.read;break}++l}}else if(2===c){l=0;while(o.length()>1){if(0===o.getByte()){--o.read;break}++l}}var h=o.getByte();if(0!==h||l!==s-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function b(e,t,r){"function"===typeof t&&(r=t,t={}),t=t||{};var s={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};function o(){a(e.pBits,(function(t,n){return t?r(t):(e.p=n,null!==e.q?l(t,e.q):void a(e.qBits,l))}))}function a(e,t){n.prime.generateProbablePrime(e,s,t)}function l(t,n){if(t)return r(t);if(e.q=n,e.p.compareTo(e.q)<0){var s=e.p;e.p=e.q,e.q=s}if(0!==e.p.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.p=null,void o();if(0!==e.q.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.q=null,void a(e.qBits,l);if(e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(i.ONE))return e.p=e.q=null,void o();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void a(e.qBits,l);var u=e.e.modInverse(e.phi);e.keys={privateKey:c.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:c.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}"prng"in t&&(s.prng=t.prng),o()}function v(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=n.util.hexToBytes(t);return r.length>1&&(0===r.charCodeAt(0)&&0===(128&r.charCodeAt(1))||255===r.charCodeAt(0)&&128===(128&r.charCodeAt(1)))?r.substr(1):r}function E(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function _(e){return n.util.isNodejs&&"function"===typeof s[e]}function S(e){return"undefined"!==typeof a.globalScope&&"object"===typeof a.globalScope.crypto&&"object"===typeof a.globalScope.crypto.subtle&&"function"===typeof a.globalScope.crypto.subtle[e]}function A(e){return"undefined"!==typeof a.globalScope&&"object"===typeof a.globalScope.msCrypto&&"object"===typeof a.globalScope.msCrypto.subtle&&"function"===typeof a.globalScope.msCrypto.subtle[e]}function I(e){for(var t=n.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),i=0;i<t.length;++i)r[i]=t.charCodeAt(i);return r}c.rsa.encrypt=function(e,t,r){var s,o=r,a=Math.ceil(t.n.bitLength()/8);!1!==r&&!0!==r?(o=2===r,s=m(e,t,r)):(s=n.util.createBuffer(),s.putBytes(e));var c=new i(s.toHex(),16),l=g(c,t,o),u=l.toString(16),h=n.util.createBuffer(),d=a-Math.ceil(u.length/2);while(d>0)h.putByte(0),--d;return h.putBytes(n.util.hexToBytes(u)),h.getBytes()},c.rsa.decrypt=function(e,t,r,s){var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var a=new Error("Encrypted message length is invalid.");throw a.length=e.length,a.expected=o,a}var c=new i(n.util.createBuffer(e).toHex(),16);if(c.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");var l=g(c,t,r),u=l.toString(16),h=n.util.createBuffer(),d=o-Math.ceil(u.length/2);while(d>0)h.putByte(0),--d;return h.putBytes(n.util.hexToBytes(u)),!1!==s?w(h.getBytes(),t,r):h.getBytes()},c.rsa.createKeyPairGenerationState=function(e,t,r){"string"===typeof e&&(e=parseInt(e,10)),e=e||2048,r=r||{};var s,o=r.prng||n.random,a={nextBytes:function(e){for(var t=o.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}},c=r.algorithm||"PRIMEINC";if("PRIMEINC"!==c)throw new Error("Invalid key generation algorithm: "+c);return s={algorithm:c,state:0,bits:e,rng:a,eInt:t||65537,e:new i(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt),s},c.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new i(null);r.fromInt(30);var n,s=0,o=function(e,t){return e|t},a=+new Date,u=0;while(null===e.keys&&(t<=0||u<t)){if(0===e.state){var h=null===e.p?e.pBits:e.qBits,d=h-1;0===e.pqState?(e.num=new i(h,e.rng),e.num.testBit(d)||e.num.bitwiseTo(i.ONE.shiftLeft(d),o,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),s=0,++e.pqState):1===e.pqState?e.num.bitLength()>h?e.pqState=0:e.num.isProbablePrime(E(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(l[s++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(i.ONE).gcd(e.e).compareTo(i.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(i.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var f=e.e.modInverse(e.phi);e.keys={privateKey:c.rsa.setPrivateKey(e.n,e.e,f,e.p,e.q,f.mod(e.p1),f.mod(e.q1),e.q.modInverse(e.p)),publicKey:c.rsa.setPublicKey(e.n,e.e)}}n=+new Date,u+=n-a,a=n}return null!==e.keys},c.rsa.generateKeyPair=function(e,t,r,i){if(1===arguments.length?"object"===typeof e?(r=e,e=void 0):"function"===typeof e&&(i=e,e=void 0):2===arguments.length?"number"===typeof e?"function"===typeof t?(i=t,t=void 0):"number"!==typeof t&&(r=t,t=void 0):(r=e,i=t,e=void 0,t=void 0):3===arguments.length&&("number"===typeof t?"function"===typeof r&&(i=r,r=void 0):(i=r,r=t,t=void 0)),r=r||{},void 0===e&&(e=r.bits||2048),void 0===t&&(t=r.e||65537),!n.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(65537===t||3===t))if(i){if(_("generateKeyPair"))return s.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},(function(e,t,r){if(e)return i(e);i(null,{privateKey:c.privateKeyFromPem(r),publicKey:c.publicKeyFromPem(t)})}));if(S("generateKey")&&S("exportKey"))return a.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:I(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then((function(e){return a.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)})).then(void 0,(function(e){i(e)})).then((function(e){if(e){var t=c.privateKeyFromAsn1(o.fromDer(n.util.createBuffer(e)));i(null,{privateKey:t,publicKey:c.setRsaPublicKey(t.n,t.e)})}}));if(A("generateKey")&&A("exportKey")){var l=a.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:I(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);return l.oncomplete=function(e){var t=e.target.result,r=a.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);r.oncomplete=function(e){var t=e.target.result,r=c.privateKeyFromAsn1(o.fromDer(n.util.createBuffer(t)));i(null,{privateKey:r,publicKey:c.setRsaPublicKey(r.n,r.e)})},r.onerror=function(e){i(e)}},void(l.onerror=function(e){i(e)})}}else if(_("generateKeyPairSync")){var u=s.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:c.privateKeyFromPem(u.privateKey),publicKey:c.publicKeyFromPem(u.publicKey)}}var h=c.rsa.createKeyPairGenerationState(e,t,r);if(!i)return c.rsa.stepKeyPairGenerationState(h,0),h.keys;b(h,r,i)},c.setRsaPublicKey=c.rsa.setPublicKey=function(e,t){var r={n:e,e:t,encrypt:function(e,t,i){if("string"===typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,r){return m(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return n.pkcs1.encode_rsa_oaep(t,e,i)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(t))t={encode:function(e){return e}};else if("string"===typeof t)throw new Error('Unsupported encryption scheme: "'+t+'".');var s=t.encode(e,r,!0);return c.rsa.encrypt(s,r,!0)},verify:function(e,t,i,s){"string"===typeof i?i=i.toUpperCase():void 0===i&&(i="RSASSA-PKCS1-V1_5"),void 0===s&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),"RSASSA-PKCS1-V1_5"===i?i={verify:function(e,t){t=w(t,r,!0);var i=o.fromDer(t,{parseAllBytes:s._parseAllDigestBytes}),a={},c=[];if(!o.validate(i,p,a,c)){var l=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw l.errors=c,l}var u=o.derToOid(a.algorithmIdentifier);if(u!==n.oids.md2&&u!==n.oids.md5&&u!==n.oids.sha1&&u!==n.oids.sha224&&u!==n.oids.sha256&&u!==n.oids.sha384&&u!==n.oids.sha512&&u!==n.oids["sha512-224"]&&u!==n.oids["sha512-256"]){l=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw l.oid=u,l}if((u===n.oids.md2||u===n.oids.md5)&&!("parameters"in a))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return e===a.digest}}:"NONE"!==i&&"NULL"!==i&&null!==i||(i={verify:function(e,t){return t=w(t,r,!0),e===t}});var a=c.rsa.decrypt(t,r,!0,!1);return i.verify(e,a,r.n.bitLength())}};return r},c.setRsaPrivateKey=c.rsa.setPrivateKey=function(e,t,r,i,s,o,a,l){var u={n:e,e:t,d:r,p:i,q:s,dP:o,dQ:a,qInv:l,decrypt:function(e,t,r){"string"===typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var i=c.rsa.decrypt(e,u,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:w};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return n.pkcs1.decode_rsa_oaep(t,e,r)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(t))throw new Error('Unsupported encryption scheme: "'+t+'".');t={decode:function(e){return e}}}return t.decode(i,u,!1)},sign:function(e,t){var r=!1;"string"===typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:y},r=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},r=1);var n=t.encode(e,u.n.bitLength());return c.rsa.encrypt(n,u,r)}};return u},c.wrapRsaPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(e).getBytes())])},c.privateKeyFromAsn1=function(e){var t,r,s,a,l,d,f,p,y={},g=[];if(o.validate(e,u,y,g)&&(e=o.fromDer(n.util.createBuffer(y.privateKey))),y={},g=[],!o.validate(e,h,y,g)){var m=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw m.errors=g,m}return t=n.util.createBuffer(y.privateKeyModulus).toHex(),r=n.util.createBuffer(y.privateKeyPublicExponent).toHex(),s=n.util.createBuffer(y.privateKeyPrivateExponent).toHex(),a=n.util.createBuffer(y.privateKeyPrime1).toHex(),l=n.util.createBuffer(y.privateKeyPrime2).toHex(),d=n.util.createBuffer(y.privateKeyExponent1).toHex(),f=n.util.createBuffer(y.privateKeyExponent2).toHex(),p=n.util.createBuffer(y.privateKeyCoefficient).toHex(),c.setRsaPrivateKey(new i(t,16),new i(r,16),new i(s,16),new i(a,16),new i(l,16),new i(d,16),new i(f,16),new i(p,16))},c.privateKeyToAsn1=c.privateKeyToRSAPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.e)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.d)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.p)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.q)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.dP)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.dQ)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.qInv))])},c.publicKeyFromAsn1=function(e){var t={},r=[];if(o.validate(e,f,t,r)){var s=o.derToOid(t.publicKeyOid);if(s!==c.oids.rsaEncryption){var a=new Error("Cannot read public key. Unknown OID.");throw a.oid=s,a}e=t.rsaPublicKey}if(r=[],!o.validate(e,d,t,r)){a=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw a.errors=r,a}var l=n.util.createBuffer(t.publicKeyModulus).toHex(),u=n.util.createBuffer(t.publicKeyExponent).toHex();return c.setRsaPublicKey(new i(l,16),new i(u,16))},c.publicKeyToAsn1=c.publicKeyToSubjectPublicKeyInfo=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,[c.publicKeyToRSAPublicKey(e)])])},c.publicKeyToRSAPublicKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.e))])}},137:function(e,t,r){var n=r(3832);r(8991),r(7116);var i=e.exports=n.sha1=n.sha1||{};n.md.sha1=n.md.algorithms.sha1=i,i.create=function(){o||a();var e=null,t=n.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,s=0;s<r;++s)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i}};return i.start(),i.update=function(s,o){"utf8"===o&&(s=n.util.encodeUtf8(s));var a=s.length;i.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var l=i.fullMessageLength.length-1;l>=0;--l)i.fullMessageLength[l]+=a[1],a[1]=a[0]+(i.fullMessageLength[l]/4294967296>>>0),i.fullMessageLength[l]=i.fullMessageLength[l]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(s),c(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var o=n.util.createBuffer();o.putBytes(t.bytes());var a,l,u=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,h=u&i.blockLength-1;o.putBytes(s.substr(0,i.blockLength-h));for(var d=8*i.fullMessageLength[0],f=0;f<i.fullMessageLength.length-1;++f)a=8*i.fullMessageLength[f+1],l=a/4294967296>>>0,d+=l,o.putInt32(d>>>0),d=a>>>0;o.putInt32(d);var p={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};c(p,r,o);var y=n.util.createBuffer();return y.putInt32(p.h0),y.putInt32(p.h1),y.putInt32(p.h2),y.putInt32(p.h3),y.putInt32(p.h4),y},i};var s=null,o=!1;function a(){s=String.fromCharCode(128),s+=n.util.fillString(String.fromCharCode(0),64),o=!0}function c(e,t,r){var n,i,s,o,a,c,l,u,h=r.length();while(h>=64){for(i=e.h0,s=e.h1,o=e.h2,a=e.h3,c=e.h4,u=0;u<16;++u)n=r.getInt32(),t[u]=n,l=a^s&(o^a),n=(i<<5|i>>>27)+l+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<20;++u)n=t[u-3]^t[u-8]^t[u-14]^t[u-16],n=n<<1|n>>>31,t[u]=n,l=a^s&(o^a),n=(i<<5|i>>>27)+l+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<32;++u)n=t[u-3]^t[u-8]^t[u-14]^t[u-16],n=n<<1|n>>>31,t[u]=n,l=s^o^a,n=(i<<5|i>>>27)+l+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<40;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,l=s^o^a,n=(i<<5|i>>>27)+l+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<60;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,l=s&o|a&(s^o),n=(i<<5|i>>>27)+l+c+2400959708+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<80;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,l=s^o^a,n=(i<<5|i>>>27)+l+c+3395469782+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+o|0,e.h3=e.h3+a|0,e.h4=e.h4+c|0,h-=64}}},1668:function(e,t,r){var n=r(3832);r(8991),r(7116);var i=e.exports=n.sha256=n.sha256||{};n.md.sha256=n.md.algorithms.sha256=i,i.create=function(){o||c();var e=null,t=n.util.createBuffer(),r=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,s=0;s<r;++s)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i}};return i.start(),i.update=function(s,o){"utf8"===o&&(s=n.util.encodeUtf8(s));var a=s.length;i.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=i.fullMessageLength.length-1;c>=0;--c)i.fullMessageLength[c]+=a[1],a[1]=a[0]+(i.fullMessageLength[c]/4294967296>>>0),i.fullMessageLength[c]=i.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(s),l(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var o=n.util.createBuffer();o.putBytes(t.bytes());var a,c,u=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,h=u&i.blockLength-1;o.putBytes(s.substr(0,i.blockLength-h));for(var d=8*i.fullMessageLength[0],f=0;f<i.fullMessageLength.length-1;++f)a=8*i.fullMessageLength[f+1],c=a/4294967296>>>0,d+=c,o.putInt32(d>>>0),d=a>>>0;o.putInt32(d);var p={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};l(p,r,o);var y=n.util.createBuffer();return y.putInt32(p.h0),y.putInt32(p.h1),y.putInt32(p.h2),y.putInt32(p.h3),y.putInt32(p.h4),y.putInt32(p.h5),y.putInt32(p.h6),y.putInt32(p.h7),y},i};var s=null,o=!1,a=null;function c(){s=String.fromCharCode(128),s+=n.util.fillString(String.fromCharCode(0),64),a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=!0}function l(e,t,r){var n,i,s,o,c,l,u,h,d,f,p,y,g,m,w,b=r.length();while(b>=64){for(u=0;u<16;++u)t[u]=r.getInt32();for(;u<64;++u)n=t[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=t[u-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[u]=n+t[u-7]+i+t[u-16]|0;for(h=e.h0,d=e.h1,f=e.h2,p=e.h3,y=e.h4,g=e.h5,m=e.h6,w=e.h7,u=0;u<64;++u)o=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),c=m^y&(g^m),s=(h>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),l=h&d|f&(h^d),n=w+o+c+a[u]+t[u],i=s+l,w=m,m=g,g=y,y=p+n>>>0,p=f,f=d,d=h,h=n+i>>>0;e.h0=e.h0+h|0,e.h1=e.h1+d|0,e.h2=e.h2+f|0,e.h3=e.h3+p|0,e.h4=e.h4+y|0,e.h5=e.h5+g|0,e.h6=e.h6+m|0,e.h7=e.h7+w|0,b-=64}}},3219:function(e,t,r){var n=r(3832);r(8991),r(7116);var i=e.exports=n.sha512=n.sha512||{};n.md.sha512=n.md.algorithms.sha512=i;var s=n.sha384=n.sha512.sha384=n.sha512.sha384||{};s.create=function(){return i.create("SHA-384")},n.md.sha384=n.md.algorithms.sha384=s,n.sha512.sha256=n.sha512.sha256||{create:function(){return i.create("SHA-512/256")}},n.md["sha512/256"]=n.md.algorithms["sha512/256"]=n.sha512.sha256,n.sha512.sha224=n.sha512.sha224||{create:function(){return i.create("SHA-512/224")}},n.md["sha512/224"]=n.md.algorithms["sha512/224"]=n.sha512.sha224,i.create=function(e){if(a||u(),"undefined"===typeof e&&(e="SHA-512"),!(e in l))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=l[e],r=null,i=n.util.createBuffer(),s=new Array(80),c=0;c<80;++c)s[c]=new Array(2);var d=64;switch(e){case"SHA-384":d=48;break;case"SHA-512/256":d=32;break;case"SHA-512/224":d=28;break}var f={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:d,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){f.messageLength=0,f.fullMessageLength=f.messageLength128=[];for(var e=f.messageLengthSize/4,s=0;s<e;++s)f.fullMessageLength.push(0);i=n.util.createBuffer(),r=new Array(t.length);for(s=0;s<t.length;++s)r[s]=t[s].slice(0);return f}};return f.start(),f.update=function(e,t){"utf8"===t&&(e=n.util.encodeUtf8(e));var o=e.length;f.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=f.fullMessageLength.length-1;a>=0;--a)f.fullMessageLength[a]+=o[1],o[1]=o[0]+(f.fullMessageLength[a]/4294967296>>>0),f.fullMessageLength[a]=f.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return i.putBytes(e),h(r,s,i),(i.read>2048||0===i.length())&&i.compact(),f},f.digest=function(){var t=n.util.createBuffer();t.putBytes(i.bytes());var a,c,l=f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize,u=l&f.blockLength-1;t.putBytes(o.substr(0,f.blockLength-u));for(var d=8*f.fullMessageLength[0],p=0;p<f.fullMessageLength.length-1;++p)a=8*f.fullMessageLength[p+1],c=a/4294967296>>>0,d+=c,t.putInt32(d>>>0),d=a>>>0;t.putInt32(d);var y=new Array(r.length);for(p=0;p<r.length;++p)y[p]=r[p].slice(0);h(y,s,t);var g,m=n.util.createBuffer();g="SHA-512"===e?y.length:"SHA-384"===e?y.length-2:y.length-4;for(p=0;p<g;++p)m.putInt32(y[p][0]),p===g-1&&"SHA-512/224"===e||m.putInt32(y[p][1]);return m},f};var o=null,a=!1,c=null,l=null;function u(){o=String.fromCharCode(128),o+=n.util.fillString(String.fromCharCode(0),128),c=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],l={},l["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],l["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],l["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],l["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],a=!0}function h(e,t,r){var n,i,s,o,a,l,u,h,d,f,p,y,g,m,w,b,v,E,_,S,A,I,C,k,T,R,P,x,D,O,N,L,B,U,M,j=r.length();while(j>=128){for(D=0;D<16;++D)t[D][0]=r.getInt32()>>>0,t[D][1]=r.getInt32()>>>0;for(;D<80;++D)L=t[D-2],O=L[0],N=L[1],n=((O>>>19|N<<13)^(N>>>29|O<<3)^O>>>6)>>>0,i=((O<<13|N>>>19)^(N<<3|O>>>29)^(O<<26|N>>>6))>>>0,U=t[D-15],O=U[0],N=U[1],s=((O>>>1|N<<31)^(O>>>8|N<<24)^O>>>7)>>>0,o=((O<<31|N>>>1)^(O<<24|N>>>8)^(O<<25|N>>>7))>>>0,B=t[D-7],M=t[D-16],N=i+B[1]+o+M[1],t[D][0]=n+B[0]+s+M[0]+(N/4294967296>>>0)>>>0,t[D][1]=N>>>0;for(g=e[0][0],m=e[0][1],w=e[1][0],b=e[1][1],v=e[2][0],E=e[2][1],_=e[3][0],S=e[3][1],A=e[4][0],I=e[4][1],C=e[5][0],k=e[5][1],T=e[6][0],R=e[6][1],P=e[7][0],x=e[7][1],D=0;D<80;++D)u=((A>>>14|I<<18)^(A>>>18|I<<14)^(I>>>9|A<<23))>>>0,h=((A<<18|I>>>14)^(A<<14|I>>>18)^(I<<23|A>>>9))>>>0,d=(T^A&(C^T))>>>0,f=(R^I&(k^R))>>>0,a=((g>>>28|m<<4)^(m>>>2|g<<30)^(m>>>7|g<<25))>>>0,l=((g<<4|m>>>28)^(m<<30|g>>>2)^(m<<25|g>>>7))>>>0,p=(g&w|v&(g^w))>>>0,y=(m&b|E&(m^b))>>>0,N=x+h+f+c[D][1]+t[D][1],n=P+u+d+c[D][0]+t[D][0]+(N/4294967296>>>0)>>>0,i=N>>>0,N=l+y,s=a+p+(N/4294967296>>>0)>>>0,o=N>>>0,P=T,x=R,T=C,R=k,C=A,k=I,N=S+i,A=_+n+(N/4294967296>>>0)>>>0,I=N>>>0,_=v,S=E,v=w,E=b,w=g,b=m,N=i+o,g=n+s+(N/4294967296>>>0)>>>0,m=N>>>0;N=e[0][1]+m,e[0][0]=e[0][0]+g+(N/4294967296>>>0)>>>0,e[0][1]=N>>>0,N=e[1][1]+b,e[1][0]=e[1][0]+w+(N/4294967296>>>0)>>>0,e[1][1]=N>>>0,N=e[2][1]+E,e[2][0]=e[2][0]+v+(N/4294967296>>>0)>>>0,e[2][1]=N>>>0,N=e[3][1]+S,e[3][0]=e[3][0]+_+(N/4294967296>>>0)>>>0,e[3][1]=N>>>0,N=e[4][1]+I,e[4][0]=e[4][0]+A+(N/4294967296>>>0)>>>0,e[4][1]=N>>>0,N=e[5][1]+k,e[5][0]=e[5][0]+C+(N/4294967296>>>0)>>>0,e[5][1]=N>>>0,N=e[6][1]+R,e[6][0]=e[6][0]+T+(N/4294967296>>>0)>>>0,e[6][1]=N>>>0,N=e[7][1]+x,e[7][0]=e[7][0]+P+(N/4294967296>>>0)>>>0,e[7][1]=N>>>0,j-=128}}},7116:function(e,t,r){var n=r(3832),i=r(8807),s=e.exports=n.util=n.util||{};function o(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function a(e){if(this.data="",this.read=0,"string"===typeof e)this.data=e;else if(s.isArrayBuffer(e)||s.isArrayBufferView(e))if("undefined"!==typeof Buffer&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(n){for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof a||"object"===typeof e&&"string"===typeof e.data&&"number"===typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}(function(){if("undefined"!==typeof process&&process.nextTick&&!process.browser)return s.nextTick=process.nextTick,void("function"===typeof setImmediate?s.setImmediate=setImmediate:s.setImmediate=s.nextTick);if("function"===typeof setImmediate)return s.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(s.nextTick=function(e){return setImmediate(e)});if(s.setImmediate=function(e){setTimeout(e,0)},"undefined"!==typeof window&&"function"===typeof window.postMessage){var e="forge.setImmediate",t=[];function r(r){if(r.source===window&&r.data===e){r.stopPropagation();var n=t.slice();t.length=0,n.forEach((function(e){e()}))}}s.setImmediate=function(r){t.push(r),1===t.length&&window.postMessage(e,"*")},window.addEventListener("message",r,!0)}if("undefined"!==typeof MutationObserver){var n=Date.now(),i=!0,o=document.createElement("div");t=[];new MutationObserver((function(){var e=t.slice();t.length=0,e.forEach((function(e){e()}))})).observe(o,{attributes:!0});var a=s.setImmediate;s.setImmediate=function(e){Date.now()-n>15?(n=Date.now(),a(e)):(t.push(e),1===t.length&&o.setAttribute("a",i=!i))}}s.nextTick=s.setImmediate})(),s.isNodejs="undefined"!==typeof process&&process.versions&&process.versions.node,s.globalScope=function(){return s.isNodejs?r.g:"undefined"===typeof self?window:self}(),s.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s.isArrayBuffer=function(e){return"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer},s.isArrayBufferView=function(e){return e&&s.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},s.ByteBuffer=a,s.ByteStringBuffer=a;var c=4096;function l(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=s.isArrayBuffer(e),n=s.isArrayBufferView(e);if(r||n)return this.data=r?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==e&&void 0!==e&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}s.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>c&&(this.data.substr(0,1),this._constructedStringLength=0)},s.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},s.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},s.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},s.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);var r=this.data;while(t>0)1&t&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this},s.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},s.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(s.encodeUtf8(e))},s.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},s.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},s.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},s.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},s.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},s.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},s.ByteStringBuffer.prototype.putInt=function(e,t){o(t);var r="";do{t-=8,r+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(r)},s.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},s.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},s.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},s.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},s.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},s.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},s.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},s.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},s.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},s.ByteStringBuffer.prototype.getInt=function(e){o(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},s.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},s.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},s.ByteStringBuffer.prototype.bytes=function(e){return"undefined"===typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},s.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},s.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},s.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},s.ByteStringBuffer.prototype.copy=function(){var e=s.createBuffer(this.data);return e.read=this.read,e},s.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},s.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},s.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},s.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e},s.ByteStringBuffer.prototype.toString=function(){return s.decodeUtf8(this.bytes())},s.DataBuffer=l,s.DataBuffer.prototype.length=function(){return this.write-this.read},s.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},s.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this},s.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},s.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this},s.DataBuffer.prototype.putBytes=function(e,t){if(s.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(s.isArrayBuffer(e)){r=new Uint8Array(e);this.accommodate(r.byteLength);i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof s.DataBuffer||"object"===typeof e&&"number"===typeof e.read&&"number"===typeof e.write&&s.isArrayBufferView(e.data)){r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);i=new Uint8Array(e.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(e instanceof s.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"===typeof e){var o;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),o=new Uint8Array(this.data.buffer,this.write),this.write+=s.binary.hex.decode(e,o,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),o=new Uint8Array(this.data.buffer,this.write),this.write+=s.binary.base64.decode(e,o,this.write),this;if("utf8"===t&&(e=s.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),o=new Uint8Array(this.data.buffer,this.write),this.write+=s.binary.raw.decode(o),this;if("utf16"===t)return this.accommodate(2*e.length),o=new Uint16Array(this.data.buffer,this.write),this.write+=s.text.utf16.encode(o),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},s.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},s.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},s.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},s.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},s.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},s.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},s.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},s.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},s.DataBuffer.prototype.putInt=function(e,t){o(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},s.DataBuffer.prototype.putSignedInt=function(e,t){return o(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},s.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},s.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},s.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},s.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},s.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},s.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},s.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},s.DataBuffer.prototype.getInt=function(e){o(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},s.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},s.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},s.DataBuffer.prototype.bytes=function(e){return"undefined"===typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},s.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},s.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},s.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},s.DataBuffer.prototype.copy=function(){return new s.DataBuffer(this)},s.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},s.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},s.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},s.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e},s.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8","binary"===e||"raw"===e)return s.binary.raw.encode(t);if("hex"===e)return s.binary.hex.encode(t);if("base64"===e)return s.binary.base64.encode(t);if("utf8"===e)return s.text.utf8.decode(t);if("utf16"===e)return s.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},s.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=s.encodeUtf8(e)),new s.ByteBuffer(e)},s.fillString=function(e,t){var r="";while(t>0)1&t&&(r+=e),t>>>=1,t>0&&(e+=e);return r},s.xorBytes=function(e,t,r){for(var n="",i="",s="",o=0,a=0;r>0;--r,++o)i=e.charCodeAt(o)^t.charCodeAt(o),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(i),++a;return n+=s,n},s.hexToBytes=function(e){var t="",r=0;for(!0&e.length&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},s.bytesToHex=function(e){return s.createBuffer(e).toHex()},s.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],d="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";s.encode64=function(e,t){var r,n,i,s="",o="",a=0;while(a<e.length)r=e.charCodeAt(a++),n=e.charCodeAt(a++),i=e.charCodeAt(a++),s+=u.charAt(r>>2),s+=u.charAt((3&r)<<4|n>>4),isNaN(n)?s+="==":(s+=u.charAt((15&n)<<2|i>>6),s+=isNaN(i)?"=":u.charAt(63&i)),t&&s.length>t&&(o+=s.substr(0,t)+"\r\n",s=s.substr(t));return o+=s,o},s.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");var t,r,n,i,s="",o=0;while(o<e.length)t=h[e.charCodeAt(o++)-43],r=h[e.charCodeAt(o++)-43],n=h[e.charCodeAt(o++)-43],i=h[e.charCodeAt(o++)-43],s+=String.fromCharCode(t<<2|r>>4),64!==n&&(s+=String.fromCharCode((15&r)<<4|n>>2),64!==i&&(s+=String.fromCharCode((3&n)<<6|i)));return s},s.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},s.decodeUtf8=function(e){return decodeURIComponent(escape(e))},s.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:i.encode,decode:i.decode}},s.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},s.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n},s.binary.hex.encode=s.bytesToHex,s.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var i=0,s=r;for(1&e.length&&(i=1,n[s++]=parseInt(e[0],16));i<e.length;i+=2)n[s++]=parseInt(e.substr(i,2),16);return t?s-r:n},s.binary.base64.encode=function(e,t){var r,n,i,s="",o="",a=0;while(a<e.byteLength)r=e[a++],n=e[a++],i=e[a++],s+=u.charAt(r>>2),s+=u.charAt((3&r)<<4|n>>4),isNaN(n)?s+="==":(s+=u.charAt((15&n)<<2|i>>6),s+=isNaN(i)?"=":u.charAt(63&i)),t&&s.length>t&&(o+=s.substr(0,t)+"\r\n",s=s.substr(t));return o+=s,o},s.binary.base64.decode=function(e,t,r){var n,i,s,o,a=t;a||(a=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;var c=0,l=r;while(c<e.length)n=h[e.charCodeAt(c++)-43],i=h[e.charCodeAt(c++)-43],s=h[e.charCodeAt(c++)-43],o=h[e.charCodeAt(c++)-43],a[l++]=n<<2|i>>4,64!==s&&(a[l++]=(15&i)<<4|s>>2,64!==o&&(a[l++]=(3&s)<<6|o));return t?l-r:a.subarray(0,l)},s.binary.base58.encode=function(e,t){return s.binary.baseN.encode(e,d,t)},s.binary.base58.decode=function(e,t){return s.binary.baseN.decode(e,d,t)},s.text={utf8:{},utf16:{}},s.text.utf8.encode=function(e,t,r){e=s.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,o=0;o<e.length;++o)n[i++]=e.charCodeAt(o);return t?i-r:n},s.text.utf8.decode=function(e){return s.decodeUtf8(String.fromCharCode.apply(null,e))},s.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(2*e.length));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,a=0;a<e.length;++a)i[o++]=e.charCodeAt(a),s+=2;return t?s-r:n},s.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},s.deflate=function(e,t,r){if(t=s.decode64(e.deflate(s.encode64(t)).rval),r){var n=2,i=t.charCodeAt(1);32&i&&(n=6),t=t.substring(n,t.length-4)}return t},s.inflate=function(e,t,r){var n=e.inflate(s.encode64(t)).rval;return null===n?null:s.decode64(n)};var f=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(null===r?n=e.removeItem(t):(r=s.encode64(JSON.stringify(r)),n=e.setItem(t,r)),"undefined"!==typeof n&&!0!==n.rval){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},p=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(null===r.rval){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return null!==r&&(r=JSON.parse(s.decode64(r))),r},y=function(e,t,r,n){var i=p(e,t);null===i&&(i={}),i[r]=n,f(e,t,i)},g=function(e,t,r){var n=p(e,t);return null!==n&&(n=r in n?n[r]:null),n},m=function(e,t,r){var n=p(e,t);if(null!==n&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),f(e,t,n)}},w=function(e,t){f(e,t,null)},b=function(e,t,r){var n,i=null;"undefined"===typeof r&&(r=["web","flash"]);var s=!1,o=null;for(var a in r){n=r[a];try{if("flash"===n||"both"===n){if(null===t[0])throw new Error("Flash local storage not available.");i=e.apply(this,t),s="flash"===n}"web"!==n&&"both"!==n||(t[0]=localStorage,i=e.apply(this,t),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return i};s.setItem=function(e,t,r,n,i){b(y,arguments,i)},s.getItem=function(e,t,r,n){return b(g,arguments,n)},s.removeItem=function(e,t,r,n){b(m,arguments,n)},s.clearItems=function(e,t,r){b(w,arguments,r)},s.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},s.format=function(e){var t,r,n=/%./g,i=0,s=[],o=0;while(t=n.exec(e)){r=e.substring(o,n.lastIndex-2),r.length>0&&s.push(r),o=n.lastIndex;var a=t[0][1];switch(a){case"s":case"o":i<arguments.length?s.push(arguments[1+i++]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(e.substring(o)),s.join("")},s.formatNumber=function(e,t,r,n){var i=e,s=isNaN(t=Math.abs(t))?2:t,o=void 0===r?",":r,a=void 0===n?".":n,c=i<0?"-":"",l=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",u=l.length>3?l.length%3:0;return c+(u?l.substr(0,u)+a:"")+l.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(i-l).toFixed(s).slice(2):"")},s.formatSize=function(e){return e=e>=1073741824?s.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?s.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?s.formatNumber(e/1024,0)+" KiB":s.formatNumber(e,0)+" bytes",e},s.bytesFromIP=function(e){return-1!==e.indexOf(".")?s.bytesFromIPv4(e):-1!==e.indexOf(":")?s.bytesFromIPv6(e):null},s.bytesFromIPv4=function(e){if(e=e.split("."),4!==e.length)return null;for(var t=s.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()},s.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter((function(e){return 0===e.length&&++t,!0}));for(var r=2*(8-e.length+t),n=s.createBuffer(),i=0;i<8;++i)if(e[i]&&0!==e[i].length){var o=s.hexToBytes(e[i]);o.length<2&&n.putByte(0),n.putBytes(o)}else n.fillWithByte(0,r),r=0;return n.getBytes()},s.bytesToIP=function(e){return 4===e.length?s.bytesToIPv4(e):16===e.length?s.bytesToIPv6(e):null},s.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},s.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){var o=s.bytesToHex(e[i]+e[i+1]);while("0"===o[0]&&"0"!==o)o=o.substr(1);if("0"===o){var a=r[r.length-1],c=t.length;a&&c===a.end+1?(a.end=c,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1)):r.push({start:c,end:c})}t.push(o)}if(r.length>0){var l=r[n];l.end-l.start>0&&(t.splice(l.start,l.end-l.start+1,""),0===l.start&&t.unshift(""),7===l.end&&t.push(""))}return t.join(":")},s.estimateCores=function(e,t){if("function"===typeof e&&(t=e,e={}),e=e||{},"cores"in s&&!e.update)return t(null,s.cores);if("undefined"!==typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return s.cores=navigator.hardwareConcurrency,t(null,s.cores);if("undefined"===typeof Worker)return s.cores=1,t(null,s.cores);if("undefined"===typeof Blob)return s.cores=2,t(null,s.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",(function(e){var t=Date.now(),r=t+4;while(Date.now()<r);self.postMessage({st:t,et:r})}))}.toString(),")()"],{type:"application/javascript"}));function n(e,a,c){if(0===a){var l=Math.floor(e.reduce((function(e,t){return e+t}),0)/e.length);return s.cores=Math.max(1,l),URL.revokeObjectURL(r),t(null,s.cores)}i(c,(function(t,r){e.push(o(c,r)),n(e,a-1,c)}))}function i(e,t){for(var n=[],i=[],s=0;s<e;++s){var o=new Worker(r);o.addEventListener("message",(function(r){if(i.push(r.data),i.length===e){for(var s=0;s<e;++s)n[s].terminate();t(null,i)}})),n.push(o)}for(s=0;s<e;++s)n[s].postMessage(s)}function o(e,t){for(var r=[],n=0;n<e;++n)for(var i=t[n],s=r[n]=[],o=0;o<e;++o)if(n!==o){var a=t[o];(i.st>a.st&&i.st<a.et||a.st>i.st&&a.st<i.et)&&s.push(o)}return r.reduce((function(e,t){return Math.max(e,t.length)}),0)}n([],5,16)}},5414:function(e,t,r){var n=r(3832);r(8925),r(3068),r(3480),r(8991),r(6971),r(6270),r(6953),r(6007),r(8095),r(7116);var i=n.asn1,s=e.exports=n.pki=n.pki||{},o=s.oids,a={};a["CN"]=o["commonName"],a["commonName"]="CN",a["C"]=o["countryName"],a["countryName"]="C",a["L"]=o["localityName"],a["localityName"]="L",a["ST"]=o["stateOrProvinceName"],a["stateOrProvinceName"]="ST",a["O"]=o["organizationName"],a["organizationName"]="O",a["OU"]=o["organizationalUnitName"],a["organizationalUnitName"]="OU",a["E"]=o["emailAddress"],a["emailAddress"]="E";var c=n.pki.rsa.publicKeyValidator,l={name:"Certificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},c,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},u={name:"rsapss",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},h={name:"CertificationRequestInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},c,{name:"CertificationRequestInfo.attributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0}]}]}]},d={name:"CertificationRequest",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[h,{name:"CertificationRequest.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function f(e,t){"string"===typeof t&&(t={shortName:t});for(var r,n=null,i=0;null===n&&i<e.attributes.length;++i)r=e.attributes[i],(t.type&&t.type===r.type||t.name&&t.name===r.name||t.shortName&&t.shortName===r.shortName)&&(n=r);return n}s.RDNAttributesAsArray=function(e,t){for(var r,n,s,c=[],l=0;l<e.value.length;++l){r=e.value[l];for(var u=0;u<r.value.length;++u)s={},n=r.value[u],s.type=i.derToOid(n.value[0].value),s.value=n.value[1].value,s.valueTagClass=n.value[1].type,s.type in o&&(s.name=o[s.type],s.name in a&&(s.shortName=a[s.name])),t&&(t.update(s.type),t.update(s.value)),c.push(s)}return c},s.CRIAttributesAsArray=function(e){for(var t=[],r=0;r<e.length;++r)for(var n=e[r],c=i.derToOid(n.value[0].value),l=n.value[1].value,u=0;u<l.length;++u){var h={};if(h.type=c,h.value=l[u].value,h.valueTagClass=l[u].type,h.type in o&&(h.name=o[h.type],h.name in a&&(h.shortName=a[h.name])),h.type===o.extensionRequest){h.extensions=[];for(var d=0;d<h.value.length;++d)h.extensions.push(s.certificateExtensionFromAsn1(h.value[d]))}t.push(h)}return t};var p=function(e,t,r){var n={};if(e!==o["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:o["sha1"]},mgf:{algorithmOid:o["mgf1"],hash:{algorithmOid:o["sha1"]}},saltLength:20});var s={},a=[];if(!i.validate(t,u,s,a)){var c=new Error("Cannot read RSASSA-PSS parameter block.");throw c.errors=a,c}return void 0!==s.hashOid&&(n.hash=n.hash||{},n.hash.algorithmOid=i.derToOid(s.hashOid)),void 0!==s.maskGenOid&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=i.derToOid(s.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=i.derToOid(s.maskGenHashOid)),void 0!==s.saltLength&&(n.saltLength=s.saltLength.charCodeAt(0)),n},y=function(e){switch(o[e.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return n.md.sha1.create();case"md5WithRSAEncryption":return n.md.md5.create();case"sha256WithRSAEncryption":return n.md.sha256.create();case"sha384WithRSAEncryption":return n.md.sha384.create();case"sha512WithRSAEncryption":return n.md.sha512.create();case"RSASSA-PSS":return n.md.sha256.create();default:var t=new Error("Could not compute "+e.type+" digest. Unknown signature OID.");throw t.signatureOid=e.signatureOid,t}},g=function(e){var t,r=e.certificate;switch(r.signatureOid){case o.sha1WithRSAEncryption:case o.sha1WithRSASignature:break;case o["RSASSA-PSS"]:var i,s;if(i=o[r.signatureParameters.mgf.hash.algorithmOid],void 0===i||void 0===n.md[i]){var a=new Error("Unsupported MGF hash function.");throw a.oid=r.signatureParameters.mgf.hash.algorithmOid,a.name=i,a}if(s=o[r.signatureParameters.mgf.algorithmOid],void 0===s||void 0===n.mgf[s]){a=new Error("Unsupported MGF function.");throw a.oid=r.signatureParameters.mgf.algorithmOid,a.name=s,a}if(s=n.mgf[s].create(n.md[i].create()),i=o[r.signatureParameters.hash.algorithmOid],void 0===i||void 0===n.md[i]){a=new Error("Unsupported RSASSA-PSS hash function.");throw a.oid=r.signatureParameters.hash.algorithmOid,a.name=i,a}t=n.pss.create(n.md[i].create(),s,r.signatureParameters.saltLength);break}return r.publicKey.verify(e.md.digest().getBytes(),e.signature,t)};function m(e){for(var t,r,s=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),o=e.attributes,a=0;a<o.length;++a){t=o[a];var c=t.value,l=i.Type.PRINTABLESTRING;"valueTagClass"in t&&(l=t.valueTagClass,l===i.Type.UTF8&&(c=n.util.encodeUtf8(c))),r=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.type).getBytes()),i.create(i.Class.UNIVERSAL,l,!1,c)])]),s.value.push(r)}return s}function w(e){for(var t,r=0;r<e.length;++r){if(t=e[r],"undefined"===typeof t.name&&(t.type&&t.type in s.oids?t.name=s.oids[t.type]:t.shortName&&t.shortName in a&&(t.name=s.oids[a[t.shortName]])),"undefined"===typeof t.type){if(!t.name||!(t.name in s.oids)){var n=new Error("Attribute type not specified.");throw n.attribute=t,n}t.type=s.oids[t.name]}if("undefined"===typeof t.shortName&&t.name&&t.name in a&&(t.shortName=a[t.name]),t.type===o.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=i.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var c=0;c<t.extensions.length;++c)t.value.push(s.certificateExtensionToAsn1(b(t.extensions[c])))}if("undefined"===typeof t.value){n=new Error("Attribute value not specified.");throw n.attribute=t,n}}}function b(e,t){if(t=t||{},"undefined"===typeof e.name&&e.id&&e.id in s.oids&&(e.name=s.oids[e.id]),"undefined"===typeof e.id){if(!e.name||!(e.name in s.oids)){var r=new Error("Extension ID not specified.");throw r.extension=e,r}e.id=s.oids[e.name]}if("undefined"!==typeof e.value)return e;if("keyUsage"===e.name){var a=0,c=0,l=0;e.digitalSignature&&(c|=128,a=7),e.nonRepudiation&&(c|=64,a=6),e.keyEncipherment&&(c|=32,a=5),e.dataEncipherment&&(c|=16,a=4),e.keyAgreement&&(c|=8,a=3),e.keyCertSign&&(c|=4,a=2),e.cRLSign&&(c|=2,a=1),e.encipherOnly&&(c|=1,a=0),e.decipherOnly&&(l|=128,a=7);var u=String.fromCharCode(a);0!==l?u+=String.fromCharCode(c)+String.fromCharCode(l):0!==c&&(u+=String.fromCharCode(c)),e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,u)}else if("basicConstraints"===e.name)e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.pathLenConstraint).getBytes()));else if("extKeyUsage"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);var h=e.value.value;for(var d in e)!0===e[d]&&(d in o?h.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o[d]).getBytes())):-1!==d.indexOf(".")&&h.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(d).getBytes())))}else if("nsCertType"===e.name){a=0,c=0;e.client&&(c|=128,a=7),e.server&&(c|=64,a=6),e.email&&(c|=32,a=5),e.objsign&&(c|=16,a=4),e.reserved&&(c|=8,a=3),e.sslCA&&(c|=4,a=2),e.emailCA&&(c|=2,a=1),e.objCA&&(c|=1,a=0);u=String.fromCharCode(a);0!==c&&(u+=String.fromCharCode(c)),e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,u)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);for(var f=0;f<e.altNames.length;++f){b=e.altNames[f];u=b.value;if(7===b.type&&b.ip){if(u=n.util.bytesFromIP(b.ip),null===u){r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=e,r}}else 8===b.type&&(u=b.oid?i.oidToDer(i.oidToDer(b.oid)):i.oidToDer(u));e.value.value.push(i.create(i.Class.CONTEXT_SPECIFIC,b.type,!1,u))}}else if("nsComment"===e.name&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=i.create(i.Class.UNIVERSAL,i.Type.IA5STRING,!1,e.comment)}else if("subjectKeyIdentifier"===e.name&&t.cert){var p=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=p.toHex(),e.value=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,p.getBytes())}else if("authorityKeyIdentifier"===e.name&&t.cert){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);h=e.value.value;if(e.keyIdentifier){var y=!0===e.keyIdentifier?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;h.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!1,y))}if(e.authorityCertIssuer){var g=[i.create(i.Class.CONTEXT_SPECIFIC,4,!0,[m(!0===e.authorityCertIssuer?t.cert.issuer:e.authorityCertIssuer)])];h.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,g))}if(e.serialNumber){var w=n.util.hexToBytes(!0===e.serialNumber?t.cert.serialNumber:e.serialNumber);h.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!1,w))}}else if("cRLDistributionPoints"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);h=e.value.value;var b,v=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),E=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(f=0;f<e.altNames.length;++f){b=e.altNames[f];u=b.value;if(7===b.type&&b.ip){if(u=n.util.bytesFromIP(b.ip),null===u){r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=e,r}}else 8===b.type&&(u=b.oid?i.oidToDer(i.oidToDer(b.oid)):i.oidToDer(u));E.value.push(i.create(i.Class.CONTEXT_SPECIFIC,b.type,!1,u))}v.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[E])),h.push(v)}if("undefined"===typeof e.value){r=new Error("Extension value not specified.");throw r.extension=e,r}return e}function v(e,t){switch(e){case o["RSASSA-PSS"]:var r=[];return void 0!==t.hash.algorithmOid&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])),void 0!==t.mgf.algorithmOid&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.mgf.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.mgf.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])])),void 0!==t.saltLength&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(t.saltLength).getBytes())])),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,r);default:return i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")}}function E(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===e.attributes.length)return t;for(var r=e.attributes,s=0;s<r.length;++s){var o=r[s],a=o.value,c=i.Type.UTF8;"valueTagClass"in o&&(c=o.valueTagClass),c===i.Type.UTF8&&(a=n.util.encodeUtf8(a));var l=!1;"valueConstructed"in o&&(l=o.valueConstructed);var u=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,c,l,a)])]);t.value.push(u)}return t}s.certificateFromPem=function(e,t,r){var o=n.pem.decode(e)[0];if("CERTIFICATE"!==o.type&&"X509 CERTIFICATE"!==o.type&&"TRUSTED CERTIFICATE"!==o.type){var a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw a.headerType=o.type,a}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var c=i.fromDer(o.body,r);return s.certificateFromAsn1(c,t)},s.certificateToPem=function(e,t){var r={type:"CERTIFICATE",body:i.toDer(s.certificateToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},s.publicKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("PUBLIC KEY"!==t.type&&"RSA PUBLIC KEY"!==t.type){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var o=i.fromDer(t.body);return s.publicKeyFromAsn1(o)},s.publicKeyToPem=function(e,t){var r={type:"PUBLIC KEY",body:i.toDer(s.publicKeyToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},s.publicKeyToRSAPublicKeyPem=function(e,t){var r={type:"RSA PUBLIC KEY",body:i.toDer(s.publicKeyToRSAPublicKey(e)).getBytes()};return n.pem.encode(r,{maxline:t})},s.getPublicKeyFingerprint=function(e,t){t=t||{};var r,o=t.md||n.md.sha1.create(),a=t.type||"RSAPublicKey";switch(a){case"RSAPublicKey":r=i.toDer(s.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":r=i.toDer(s.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}o.start(),o.update(r);var c=o.digest();if("hex"===t.encoding){var l=c.toHex();return t.delimiter?l.match(/.{2}/g).join(t.delimiter):l}if("binary"===t.encoding)return c.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return c},s.certificationRequestFromPem=function(e,t,r){var o=n.pem.decode(e)[0];if("CERTIFICATE REQUEST"!==o.type){var a=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw a.headerType=o.type,a}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var c=i.fromDer(o.body,r);return s.certificationRequestFromAsn1(c,t)},s.certificationRequestToPem=function(e,t){var r={type:"CERTIFICATE REQUEST",body:i.toDer(s.certificationRequestToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},s.createCertificate=function(){var e={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return f(e.issuer,t)},e.issuer.addField=function(t){w([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return f(e.subject,t)},e.subject.addField=function(t){w([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,r){w(t),e.subject.attributes=t,delete e.subject.uniqueId,r&&(e.subject.uniqueId=r),e.subject.hash=null},e.setIssuer=function(t,r){w(t),e.issuer.attributes=t,delete e.issuer.uniqueId,r&&(e.issuer.uniqueId=r),e.issuer.hash=null},e.setExtensions=function(t){for(var r=0;r<t.length;++r)b(t[r],{cert:e});e.extensions=t},e.getExtension=function(t){"string"===typeof t&&(t={name:t});for(var r,n=null,i=0;null===n&&i<e.extensions.length;++i)r=e.extensions[i],(t.id&&r.id===t.id||t.name&&r.name===t.name)&&(n=r);return n},e.sign=function(t,r){e.md=r||n.md.sha1.create();var a=o[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.tbsCertificate=s.getTBSCertificate(e);var l=i.toDer(e.tbsCertificate);e.md.update(l.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var r=!1;if(!e.issued(t)){var n=t.issuer,o=e.subject,a=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw a.expectedIssuer=o.attributes,a.actualIssuer=n.attributes,a}var c=t.md;if(null===c){c=y({signatureOid:t.signatureOid,type:"certificate"});var l=t.tbsCertificate||s.getTBSCertificate(t),u=i.toDer(l);c.update(u.getBytes())}return null!==c&&(r=g({certificate:e,md:c,signature:t.signature})),r},e.isIssuer=function(t){var r=!1,n=e.issuer,i=t.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){var s,o;r=!0;for(var a=0;r&&a<n.attributes.length;++a)s=n.attributes[a],o=i.attributes[a],s.type===o.type&&s.value===o.value||(r=!1)}return r},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return s.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=o["subjectKeyIdentifier"],r=0;r<e.extensions.length;++r){var i=e.extensions[r];if(i.id===t){var s=e.generateSubjectKeyIdentifier().getBytes();return n.util.hexToBytes(i.subjectKeyIdentifier)===s}}return!1},e},s.certificateFromAsn1=function(e,t){var r={},o=[];if(!i.validate(e,l,r,o)){var a=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw a.errors=o,a}var c=i.derToOid(r.publicKeyOid);if(c!==s.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var u=s.createCertificate();u.version=r.certVersion?r.certVersion.charCodeAt(0):0;var h=n.util.createBuffer(r.certSerialNumber);u.serialNumber=h.toHex(),u.signatureOid=n.asn1.derToOid(r.certSignatureOid),u.signatureParameters=p(u.signatureOid,r.certSignatureParams,!0),u.siginfo.algorithmOid=n.asn1.derToOid(r.certinfoSignatureOid),u.siginfo.parameters=p(u.siginfo.algorithmOid,r.certinfoSignatureParams,!1),u.signature=r.certSignature;var d=[];if(void 0!==r.certValidity1UTCTime&&d.push(i.utcTimeToDate(r.certValidity1UTCTime)),void 0!==r.certValidity2GeneralizedTime&&d.push(i.generalizedTimeToDate(r.certValidity2GeneralizedTime)),void 0!==r.certValidity3UTCTime&&d.push(i.utcTimeToDate(r.certValidity3UTCTime)),void 0!==r.certValidity4GeneralizedTime&&d.push(i.generalizedTimeToDate(r.certValidity4GeneralizedTime)),d.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(d.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(u.validity.notBefore=d[0],u.validity.notAfter=d[1],u.tbsCertificate=r.tbsCertificate,t){u.md=y({signatureOid:u.signatureOid,type:"certificate"});var g=i.toDer(u.tbsCertificate);u.md.update(g.getBytes())}var m=n.md.sha1.create(),b=i.toDer(r.certIssuer);m.update(b.getBytes()),u.issuer.getField=function(e){return f(u.issuer,e)},u.issuer.addField=function(e){w([e]),u.issuer.attributes.push(e)},u.issuer.attributes=s.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(u.issuer.uniqueId=r.certIssuerUniqueId),u.issuer.hash=m.digest().toHex();var v=n.md.sha1.create(),E=i.toDer(r.certSubject);return v.update(E.getBytes()),u.subject.getField=function(e){return f(u.subject,e)},u.subject.addField=function(e){w([e]),u.subject.attributes.push(e)},u.subject.attributes=s.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(u.subject.uniqueId=r.certSubjectUniqueId),u.subject.hash=v.digest().toHex(),r.certExtensions?u.extensions=s.certificateExtensionsFromAsn1(r.certExtensions):u.extensions=[],u.publicKey=s.publicKeyFromAsn1(r.subjectPublicKeyInfo),u},s.certificateExtensionsFromAsn1=function(e){for(var t=[],r=0;r<e.value.length;++r)for(var n=e.value[r],i=0;i<n.value.length;++i)t.push(s.certificateExtensionFromAsn1(n.value[i]));return t},s.certificateExtensionFromAsn1=function(e){var t={};if(t.id=i.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===i.Type.BOOLEAN?(t.critical=0!==e.value[1].value.charCodeAt(0),t.value=e.value[2].value):t.value=e.value[1].value,t.id in o)if(t.name=o[t.id],"keyUsage"===t.name){var r=i.fromDer(t.value),s=0,a=0;r.value.length>1&&(s=r.value.charCodeAt(1),a=r.value.length>2?r.value.charCodeAt(2):0),t.digitalSignature=128===(128&s),t.nonRepudiation=64===(64&s),t.keyEncipherment=32===(32&s),t.dataEncipherment=16===(16&s),t.keyAgreement=8===(8&s),t.keyCertSign=4===(4&s),t.cRLSign=2===(2&s),t.encipherOnly=1===(1&s),t.decipherOnly=128===(128&a)}else if("basicConstraints"===t.name){r=i.fromDer(t.value);r.value.length>0&&r.value[0].type===i.Type.BOOLEAN?t.cA=0!==r.value[0].value.charCodeAt(0):t.cA=!1;var c=null;r.value.length>0&&r.value[0].type===i.Type.INTEGER?c=r.value[0].value:r.value.length>1&&(c=r.value[1].value),null!==c&&(t.pathLenConstraint=i.derToInteger(c))}else if("extKeyUsage"===t.name){r=i.fromDer(t.value);for(var l=0;l<r.value.length;++l){var u=i.derToOid(r.value[l].value);u in o?t[o[u]]=!0:t[u]=!0}}else if("nsCertType"===t.name){r=i.fromDer(t.value),s=0;r.value.length>1&&(s=r.value.charCodeAt(1)),t.client=128===(128&s),t.server=64===(64&s),t.email=32===(32&s),t.objsign=16===(16&s),t.reserved=8===(8&s),t.sslCA=4===(4&s),t.emailCA=2===(2&s),t.objCA=1===(1&s)}else if("subjectAltName"===t.name||"issuerAltName"===t.name){var h;t.altNames=[];r=i.fromDer(t.value);for(var d=0;d<r.value.length;++d){h=r.value[d];var f={type:h.type,value:h.value};switch(t.altNames.push(f),h.type){case 1:case 2:case 6:break;case 7:f.ip=n.util.bytesToIP(h.value);break;case 8:f.oid=i.derToOid(h.value);break;default:}}}else if("subjectKeyIdentifier"===t.name){r=i.fromDer(t.value);t.subjectKeyIdentifier=n.util.bytesToHex(r.value)}return t},s.certificationRequestFromAsn1=function(e,t){var r={},o=[];if(!i.validate(e,d,r,o)){var a=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw a.errors=o,a}var c=i.derToOid(r.publicKeyOid);if(c!==s.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var l=s.createCertificationRequest();if(l.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,l.signatureOid=n.asn1.derToOid(r.csrSignatureOid),l.signatureParameters=p(l.signatureOid,r.csrSignatureParams,!0),l.siginfo.algorithmOid=n.asn1.derToOid(r.csrSignatureOid),l.siginfo.parameters=p(l.siginfo.algorithmOid,r.csrSignatureParams,!1),l.signature=r.csrSignature,l.certificationRequestInfo=r.certificationRequestInfo,t){l.md=y({signatureOid:l.signatureOid,type:"certification request"});var u=i.toDer(l.certificationRequestInfo);l.md.update(u.getBytes())}var h=n.md.sha1.create();return l.subject.getField=function(e){return f(l.subject,e)},l.subject.addField=function(e){w([e]),l.subject.attributes.push(e)},l.subject.attributes=s.RDNAttributesAsArray(r.certificationRequestInfoSubject,h),l.subject.hash=h.digest().toHex(),l.publicKey=s.publicKeyFromAsn1(r.subjectPublicKeyInfo),l.getAttribute=function(e){return f(l,e)},l.addAttribute=function(e){w([e]),l.attributes.push(e)},l.attributes=s.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),l},s.createCertificationRequest=function(){var e={version:0,signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return f(e.subject,t)},e.subject.addField=function(t){w([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return f(e,t)},e.addAttribute=function(t){w([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){w(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){w(t),e.attributes=t},e.sign=function(t,r){e.md=r||n.md.sha1.create();var a=o[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.certificationRequestInfo=s.getCertificationRequestInfo(e);var l=i.toDer(e.certificationRequestInfo);e.md.update(l.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,r=e.md;if(null===r){r=y({signatureOid:e.signatureOid,type:"certification request"});var n=e.certificationRequestInfo||s.getCertificationRequestInfo(e),o=i.toDer(n);r.update(o.getBytes())}return null!==r&&(t=g({certificate:e,md:r,signature:e.signature})),t},e};var _=new Date("1950-01-01T00:00:00Z"),S=new Date("2050-01-01T00:00:00Z");function A(e){return e>=_&&e<S?i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(e)):i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,!1,i.dateToGeneralizedTime(e))}s.getTBSCertificate=function(e){var t=A(e.validity.notBefore),r=A(e.validity.notAfter),o=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.siginfo.algorithmOid).getBytes()),v(e.siginfo.algorithmOid,e.siginfo.parameters)]),m(e.issuer),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,r]),m(e.subject),s.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&o.value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&o.value.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&o.value.push(s.certificateExtensionsToAsn1(e.extensions)),o},s.getCertificationRequestInfo=function(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),m(e.subject),s.publicKeyToAsn1(e.publicKey),E(e)]);return t},s.distinguishedNameToAsn1=function(e){return m(e)},s.certificateToAsn1=function(e){var t=e.tbsCertificate||s.getTBSCertificate(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureOid).getBytes()),v(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},s.certificateExtensionsToAsn1=function(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,3,!0,[]),r=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);t.value.push(r);for(var n=0;n<e.length;++n)r.value.push(s.certificateExtensionToAsn1(e[n]));return t},s.certificateExtensionToAsn1=function(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.id).getBytes())),e.critical&&t.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=e.value;return"string"!==typeof e.value&&(r=i.toDer(r).getBytes()),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,r)),t},s.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||s.getCertificationRequestInfo(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureOid).getBytes()),v(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},s.createCaStore=function(e){var t={certs:{}};function r(e){return o(e),t.certs[e.hash]||null}function o(e){if(!e.hash){var t=n.md.sha1.create();e.attributes=s.RDNAttributesAsArray(m(e),t),e.hash=t.digest().toHex()}}if(t.getIssuer=function(e){var t=r(e.issuer);return t},t.addCertificate=function(e){if("string"===typeof e&&(e=n.pki.certificateFromPem(e)),o(e.subject),!t.hasCertificate(e))if(e.subject.hash in t.certs){var r=t.certs[e.subject.hash];n.util.isArray(r)||(r=[r]),r.push(e),t.certs[e.subject.hash]=r}else t.certs[e.subject.hash]=e},t.hasCertificate=function(e){"string"===typeof e&&(e=n.pki.certificateFromPem(e));var t=r(e.subject);if(!t)return!1;n.util.isArray(t)||(t=[t]);for(var o=i.toDer(s.certificateToAsn1(e)).getBytes(),a=0;a<t.length;++a){var c=i.toDer(s.certificateToAsn1(t[a])).getBytes();if(o===c)return!0}return!1},t.listAllCertificates=function(){var e=[];for(var r in t.certs)if(t.certs.hasOwnProperty(r)){var i=t.certs[r];if(n.util.isArray(i))for(var s=0;s<i.length;++s)e.push(i[s]);else e.push(i)}return e},t.removeCertificate=function(e){var a;if("string"===typeof e&&(e=n.pki.certificateFromPem(e)),o(e.subject),!t.hasCertificate(e))return null;var c=r(e.subject);if(!n.util.isArray(c))return a=t.certs[e.subject.hash],delete t.certs[e.subject.hash],a;for(var l=i.toDer(s.certificateToAsn1(e)).getBytes(),u=0;u<c.length;++u){var h=i.toDer(s.certificateToAsn1(c[u])).getBytes();l===h&&(a=c[u],c.splice(u,1))}return 0===c.length&&delete t.certs[e.subject.hash],a},e)for(var a=0;a<e.length;++a){var c=e[a];t.addCertificate(c)}return t},s.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},s.verifyCertificateChain=function(e,t,r){"function"===typeof r&&(r={verify:r}),r=r||{},t=t.slice(0);var i=t.slice(0),o=r.validityCheckDate;"undefined"===typeof o&&(o=new Date);var a=!0,c=null,l=0;do{var u=t.shift(),h=null,d=!1;if(o&&(o<u.validity.notBefore||o>u.validity.notAfter)&&(c={message:"Certificate is not valid yet or has expired.",error:s.certificateError.certificate_expired,notBefore:u.validity.notBefore,notAfter:u.validity.notAfter,now:o}),null===c){if(h=t[0]||e.getIssuer(u),null===h&&u.isIssuer(u)&&(d=!0,h=u),h){var f=h;n.util.isArray(f)||(f=[f]);var p=!1;while(!p&&f.length>0){h=f.shift();try{p=h.verify(u)}catch(S){}}p||(c={message:"Certificate signature is invalid.",error:s.certificateError.bad_certificate})}null!==c||h&&!d||e.hasCertificate(u)||(c={message:"Certificate is not trusted.",error:s.certificateError.unknown_ca})}if(null===c&&h&&!u.isIssuer(h)&&(c={message:"Certificate issuer is invalid.",error:s.certificateError.bad_certificate}),null===c)for(var y={keyUsage:!0,basicConstraints:!0},g=0;null===c&&g<u.extensions.length;++g){var m=u.extensions[g];m.critical&&!(m.name in y)&&(c={message:"Certificate has an unsupported critical extension.",error:s.certificateError.unsupported_certificate})}if(null===c&&(!a||0===t.length&&(!h||d))){var w=u.getExtension("basicConstraints"),b=u.getExtension("keyUsage");if(null!==b&&(b.keyCertSign&&null!==w||(c={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:s.certificateError.bad_certificate})),null!==c||null===w||w.cA||(c={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:s.certificateError.bad_certificate}),null===c&&null!==b&&"pathLenConstraint"in w){var v=l-1;v>w.pathLenConstraint&&(c={message:"Certificate basicConstraints pathLenConstraint violated.",error:s.certificateError.bad_certificate})}}var E=null===c||c.error,_=r.verify?r.verify(E,l,i):E;if(!0!==_)throw!0===E&&(c={message:"The application rejected the certificate.",error:s.certificateError.bad_certificate}),(_||0===_)&&("object"!==typeof _||n.util.isArray(_)?"string"===typeof _&&(c.error=_):(_.message&&(c.message=_.message),_.error&&(c.error=_.error))),c;c=null,a=!1,++l}while(t.length>0);return!0}},5103:function(e,t,r){const n=r(1607),i=r(603);e.exports=class{constructor(){this._buffer=new n,this._waitingConsumers=new n}push(e){const{promise:t,resolve:r}=i();return this._buffer.push({chunk:e,resolve:r}),this._consume(),t}_consume(){while(!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty()){const e=this._waitingConsumers.shift(),t=this._buffer.shift();e.resolve(t.chunk),t.resolve()}}shift(){const{promise:e,resolve:t}=i();return this._waitingConsumers.push({resolve:t}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}},603:function(e){"use strict";const t=()=>{const e={};return e.promise=new Promise(((t,r)=>{e.resolve=t,e.reject=r})),e};e.exports=t},290:function(e,t,r){"use strict";e.exports=r(6114)["default"]},6114:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(8951),s=n(r(1476)),o=n(r(5003)),a=r(6512),c=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],l=c.map((e=>new i.Netmask(e)));function u(e){for(let t of l)if(t.contains(e))return!0;return!1}function h(e){return/^::$/.test(e)||/^::1$/.test(e)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(e)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(e)||/^ff([0-9a-fA-F]{2,2}):/i.test(e)}t["default"]=e=>{if((0,a.isValid)(e)){const t=(0,a.parse)(e);if("ipv4"===t.kind())return u(t.toNormalizedString());if("ipv6"===t.kind())return h(e)}else if((0,o.default)(e)&&s.default.v6().test(e))return h(e)}},3281:function(e,t,r){"use strict";e.exports=r(9050)},2100:function(e,t,r){"use strict";e.exports=r(9482)},2967:function(e){"use strict";e.exports=n;var t,r=/\/|\./;function n(e,t){r.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),n[e]=t}n("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),n("duration",{Duration:t={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),n("timestamp",{Timestamp:t}),n("empty",{Empty:{fields:{}}}),n("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),n("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),n("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),n.get=function(e){return n[e]||null}},3996:function(e,t,r){"use strict";var n=t,i=r(7025),s=r(9935);function o(e,t,r,n){var s=!1;if(t.resolvedType)if(t.resolvedType instanceof i){e("switch(d%s){",n);for(var o=t.resolvedType.values,a=Object.keys(o),c=0;c<a.length;++c)o[a[c]]!==t.typeDefault||s||(e("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',n,n,n),t.repeated||e("break"),s=!0),e("case%j:",a[c])("case %i:",o[a[c]])("m%s=%j",n,o[a[c]])("break");e("}")}else e('if(typeof d%s!=="object")',n)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",n,r,n);else{var l=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",n,n);break;case"uint64":l=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,l)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,l?"true":"");break;case"bytes":e('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length >= 0)",n)("m%s=d%s",n,n);break;case"string":e("m%s=String(d%s)",n,n);break;case"bool":e("m%s=Boolean(d%s)",n,n);break}}return e}function a(e,t,r,n){if(t.resolvedType)t.resolvedType instanceof i?e("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",n,r,n,n,r,n,n):e("d%s=types[%i].toObject(m%s,o)",n,r,n);else{var s=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",n,n,n,n);break;case"uint64":s=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,s?"true":"",n);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:e("d%s=m%s",n,n);break}}return e}n.fromObject=function(e){var t=e.fieldsArray,r=s.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return r("return new this.ctor");r("var m=new this.ctor");for(var n=0;n<t.length;++n){var a=t[n].resolve(),c=s.safeProp(a.name);a.map?(r("if(d%s){",c)('if(typeof d%s!=="object")',c)("throw TypeError(%j)",a.fullName+": object expected")("m%s={}",c)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",c),o(r,a,n,c+"[ks[i]]")("}")("}")):a.repeated?(r("if(d%s){",c)("if(!Array.isArray(d%s))",c)("throw TypeError(%j)",a.fullName+": array expected")("m%s=[]",c)("for(var i=0;i<d%s.length;++i){",c),o(r,a,n,c+"[i]")("}")("}")):(a.resolvedType instanceof i||r("if(d%s!=null){",c),o(r,a,n,c),a.resolvedType instanceof i||r("}"))}return r("return m")},n.toObject=function(e){var t=e.fieldsArray.slice().sort(s.compareFieldsById);if(!t.length)return s.codegen()("return {}");for(var r=s.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),n=[],o=[],c=[],l=0;l<t.length;++l)t[l].partOf||(t[l].resolve().repeated?n:t[l].map?o:c).push(t[l]);if(n.length){for(r("if(o.arrays||o.defaults){"),l=0;l<n.length;++l)r("d%s=[]",s.safeProp(n[l].name));r("}")}if(o.length){for(r("if(o.objects||o.defaults){"),l=0;l<o.length;++l)r("d%s={}",s.safeProp(o[l].name));r("}")}if(c.length){for(r("if(o.defaults){"),l=0;l<c.length;++l){var u=c[l],h=s.safeProp(u.name);if(u.resolvedType instanceof i)r("d%s=o.enums===String?%j:%j",h,u.resolvedType.valuesById[u.typeDefault],u.typeDefault);else if(u.long)r("if(util.Long){")("var n=new util.Long(%i,%i,%j)",u.typeDefault.low,u.typeDefault.high,u.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",h)("}else")("d%s=o.longs===String?%j:%i",h,u.typeDefault.toString(),u.typeDefault.toNumber());else if(u.bytes){var d="["+Array.prototype.slice.call(u.typeDefault).join(",")+"]";r("if(o.bytes===String)d%s=%j",h,String.fromCharCode.apply(String,u.typeDefault))("else{")("d%s=%s",h,d)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",h,h)("}")}else r("d%s=%j",h,u.typeDefault)}r("}")}var f=!1;for(l=0;l<t.length;++l){u=t[l];var p=e._fieldsArray.indexOf(u);h=s.safeProp(u.name);u.map?(f||(f=!0,r("var ks2")),r("if(m%s&&(ks2=Object.keys(m%s)).length){",h,h)("d%s={}",h)("for(var j=0;j<ks2.length;++j){"),a(r,u,p,h+"[ks2[j]]")("}")):u.repeated?(r("if(m%s&&m%s.length){",h,h)("d%s=[]",h)("for(var j=0;j<m%s.length;++j){",h),a(r,u,p,h+"[j]")("}")):(r("if(m%s!=null&&m.hasOwnProperty(%j)){",h,u.name),a(r,u,p,h),u.partOf&&r("if(o.oneofs)")("d%s=%j",s.safeProp(u.partOf.name),u.name)),r("}")}return r("return d")}},5305:function(e,t,r){"use strict";e.exports=a;var n=r(7025),i=r(7063),s=r(9935);function o(e){return"missing required '"+e.name+"'"}function a(e){var t=s.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break"),t("switch(t>>>3){");for(var r=0;r<e.fieldsArray.length;++r){var a=e._fieldsArray[r].resolve(),c=a.resolvedType instanceof n?"int32":a.type,l="m"+s.safeProp(a.name);t("case %i: {",a.id),a.map?(t("if(%s===util.emptyObject)",l)("%s={}",l)("var c2 = r.uint32()+r.pos"),void 0!==i.defaults[a.keyType]?t("k=%j",i.defaults[a.keyType]):t("k=null"),void 0!==i.defaults[c]?t("value=%j",i.defaults[c]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",a.keyType)("case 2:"),void 0===i.basic[c]?t("value=types[%i].decode(r,r.uint32())",r):t("value=r.%s()",c),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),void 0!==i.long[a.keyType]?t('%s[typeof k==="object"?util.longToHash(k):k]=value',l):t("%s[k]=value",l)):a.repeated?(t("if(!(%s&&%s.length))",l,l)("%s=[]",l),void 0!==i.packed[c]&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",l,c)("}else"),void 0===i.basic[c]?t(a.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",l,r):t("%s.push(r.%s())",l,c)):void 0===i.basic[c]?t(a.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",l,r):t("%s=r.%s()",l,c),t("break")("}")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),r=0;r<e._fieldsArray.length;++r){var u=e._fieldsArray[r];u.required&&t("if(!m.hasOwnProperty(%j))",u.name)("throw util.ProtocolError(%j,{instance:m})",o(u))}return t("return m")}},4928:function(e,t,r){"use strict";e.exports=a;var n=r(7025),i=r(7063),s=r(9935);function o(e,t,r,n){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",r,n,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",r,n,(t.id<<3|2)>>>0)}function a(e){for(var t,r=s.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),a=e.fieldsArray.slice().sort(s.compareFieldsById),c=0;c<a.length;++c){var l=a[c].resolve(),u=e._fieldsArray.indexOf(l),h=l.resolvedType instanceof n?"int32":l.type,d=i.basic[h];t="m"+s.safeProp(l.name),l.map?(r("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",t,l.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(l.id<<3|2)>>>0,8|i.mapKey[l.keyType],l.keyType),void 0===d?r("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",u,t):r(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|d,h,t),r("}")("}")):l.repeated?(r("if(%s!=null&&%s.length){",t,t),l.packed&&void 0!==i.packed[h]?r("w.uint32(%i).fork()",(l.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",h,t)("w.ldelim()"):(r("for(var i=0;i<%s.length;++i)",t),void 0===d?o(r,l,u,t+"[i]"):r("w.uint32(%i).%s(%s[i])",(l.id<<3|d)>>>0,h,t)),r("}")):(l.optional&&r("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",t,l.name),void 0===d?o(r,l,u,t):r("w.uint32(%i).%s(%s)",(l.id<<3|d)>>>0,h,t))}return r("return w")}},7025:function(e,t,r){"use strict";e.exports=o;var n=r(3243);((o.prototype=Object.create(n.prototype)).constructor=o).className="Enum";var i=r(9313),s=r(9935);function o(e,t,r,i,s,o){if(n.call(this,e,r),t&&"object"!==typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=i,this.comments=s||{},this.valuesOptions=o,this.reserved=void 0,t)for(var a=Object.keys(t),c=0;c<a.length;++c)"number"===typeof t[a[c]]&&(this.valuesById[this.values[a[c]]=t[a[c]]]=a[c])}o.fromJSON=function(e,t){var r=new o(e,t.values,t.options,t.comment,t.comments);return r.reserved=t.reserved,r},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},o.prototype.add=function(e,t,r,n){if(!s.isString(e))throw TypeError("name must be a string");if(!s.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return n&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[e]=n||null),this.comments[e]=r||null,this},o.prototype.remove=function(e){if(!s.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this},o.prototype.isReservedId=function(e){return i.isReservedId(this.reserved,e)},o.prototype.isReservedName=function(e){return i.isReservedName(this.reserved,e)}},3548:function(e,t,r){"use strict";e.exports=l;var n=r(3243);((l.prototype=Object.create(n.prototype)).constructor=l).className="Field";var i,s=r(7025),o=r(7063),a=r(9935),c=/^required|optional|repeated$/;function l(e,t,r,i,s,l,u){if(a.isObject(i)?(u=s,l=i,i=s=void 0):a.isObject(s)&&(u=l,l=s,s=void 0),n.call(this,e,l),!a.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!a.isString(r))throw TypeError("type must be a string");if(void 0!==i&&!c.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==s&&!a.isString(s))throw TypeError("extend must be a string");"proto3_optional"===i&&(i="optional"),this.rule=i&&"optional"!==i?i:void 0,this.type=r,this.id=t,this.extend=s||void 0,this.required="required"===i,this.optional=!this.required,this.repeated="repeated"===i,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!a.Long&&void 0!==o.long[r],this.bytes="bytes"===r,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=u}l.fromJSON=function(e,t){return new l(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(l.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),l.prototype.setOption=function(e,t,r){return"packed"===e&&(this._packed=null),n.prototype.setOption.call(this,e,t,r)},l.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return a.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},l.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=o.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof i?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options["default"]&&(this.typeDefault=this.options["default"],this.resolvedType instanceof s&&"string"===typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof s)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=a.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"===typeof this.typeDefault){var e;a.base64.test(this.typeDefault)?a.base64.decode(this.typeDefault,e=a.newBuffer(a.base64.length(this.typeDefault)),0):a.utf8.write(this.typeDefault,e=a.newBuffer(a.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=a.emptyObject:this.repeated?this.defaultValue=a.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof i&&(this.parent.ctor.prototype[this.name]=this.defaultValue),n.prototype.resolve.call(this)},l.d=function(e,t,r,n){return"function"===typeof t?t=a.decorateType(t).name:t&&"object"===typeof t&&(t=a.decorateEnum(t).name),function(i,s){a.decorateType(i.constructor).add(new l(s,e,t,r,{default:n}))}},l._configure=function(e){i=e}},8836:function(e,t,r){"use strict";var n=e.exports=r(9482);function i(e,t,r){return"function"===typeof t?(r=t,t=new n.Root):t||(t=new n.Root),t.load(e,r)}function s(e,t){return t||(t=new n.Root),t.loadSync(e)}n.build="light",n.load=i,n.loadSync=s,n.encoder=r(4928),n.decoder=r(5305),n.verifier=r(4497),n.converter=r(3996),n.ReflectionObject=r(3243),n.Namespace=r(9313),n.Root=r(9424),n.Enum=r(7025),n.Type=r(7645),n.Field=r(3548),n.OneOf=r(7598),n.MapField=r(6039),n.Service=r(7513),n.Method=r(4429),n.Message=r(8368),n.wrappers=r(1667),n.types=r(7063),n.util=r(9935),n.ReflectionObject._configure(n.Root),n.Namespace._configure(n.Type,n.Service,n.Enum),n.Root._configure(n.Type),n.Field._configure(n.Type)},9482:function(e,t,r){"use strict";var n=t;function i(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(1173),n.BufferWriter=r(3155),n.Reader=r(1408),n.BufferReader=r(593),n.util=r(9693),n.rpc=r(5994),n.roots=r(5054),n.configure=i,i()},9050:function(e,t,r){"use strict";var n=e.exports=r(8836);n.build="full",n.tokenize=r(626),n.parse=r(2228),n.common=r(2967),n.Root._configure(n.Type,n.parse,n.common)},6039:function(e,t,r){"use strict";e.exports=o;var n=r(3548);((o.prototype=Object.create(n.prototype)).constructor=o).className="MapField";var i=r(7063),s=r(9935);function o(e,t,r,i,o,a){if(n.call(this,e,t,i,void 0,void 0,o,a),!s.isString(r))throw TypeError("keyType must be a string");this.keyType=r,this.resolvedKeyType=null,this.map=!0}o.fromJSON=function(e,t){return new o(e,t.id,t.keyType,t.type,t.options,t.comment)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},o.prototype.resolve=function(){if(this.resolved)return this;if(void 0===i.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return n.prototype.resolve.call(this)},o.d=function(e,t,r){return"function"===typeof r?r=s.decorateType(r).name:r&&"object"===typeof r&&(r=s.decorateEnum(r).name),function(n,i){s.decorateType(n.constructor).add(new o(i,e,t,r))}}},8368:function(e,t,r){"use strict";e.exports=i;var n=r(9693);function i(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}i.create=function(e){return this.$type.create(e)},i.encode=function(e,t){return this.$type.encode(e,t)},i.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},i.decode=function(e){return this.$type.decode(e)},i.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},i.verify=function(e){return this.$type.verify(e)},i.fromObject=function(e){return this.$type.fromObject(e)},i.toObject=function(e,t){return this.$type.toObject(e,t)},i.prototype.toJSON=function(){return this.$type.toObject(this,n.toJSONOptions)}},4429:function(e,t,r){"use strict";e.exports=s;var n=r(3243);((s.prototype=Object.create(n.prototype)).constructor=s).className="Method";var i=r(9935);function s(e,t,r,s,o,a,c,l,u){if(i.isObject(o)?(c=o,o=a=void 0):i.isObject(a)&&(c=a,a=void 0),void 0!==t&&!i.isString(t))throw TypeError("type must be a string");if(!i.isString(r))throw TypeError("requestType must be a string");if(!i.isString(s))throw TypeError("responseType must be a string");n.call(this,e,c),this.type=t||"rpc",this.requestType=r,this.requestStream=!!o||void 0,this.responseType=s,this.responseStream=!!a||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=l,this.parsedOptions=u}s.fromJSON=function(e,t){return new s(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)},s.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return i.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])},s.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),n.prototype.resolve.call(this))}},9313:function(e,t,r){"use strict";e.exports=h;var n=r(3243);((h.prototype=Object.create(n.prototype)).constructor=h).className="Namespace";var i,s,o,a=r(3548),c=r(9935),l=r(7598);function u(e,t){if(e&&e.length){for(var r={},n=0;n<e.length;++n)r[e[n].name]=e[n].toJSON(t);return r}}function h(e,t){n.call(this,e,t),this.nested=void 0,this._nestedArray=null}function d(e){return e._nestedArray=null,e}h.fromJSON=function(e,t){return new h(e,t.options).addJSON(t.nested)},h.arrayToJSON=u,h.isReservedId=function(e,t){if(e)for(var r=0;r<e.length;++r)if("string"!==typeof e[r]&&e[r][0]<=t&&e[r][1]>t)return!0;return!1},h.isReservedName=function(e,t){if(e)for(var r=0;r<e.length;++r)if(e[r]===t)return!0;return!1},Object.defineProperty(h.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=c.toArray(this.nested))}}),h.prototype.toJSON=function(e){return c.toObject(["options",this.options,"nested",u(this.nestedArray,e)])},h.prototype.addJSON=function(e){var t=this;if(e)for(var r,n=Object.keys(e),c=0;c<n.length;++c)r=e[n[c]],t.add((void 0!==r.fields?i.fromJSON:void 0!==r.values?o.fromJSON:void 0!==r.methods?s.fromJSON:void 0!==r.id?a.fromJSON:h.fromJSON)(n[c],r));return this},h.prototype.get=function(e){return this.nested&&this.nested[e]||null},h.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof o)return this.nested[e].values;throw Error("no such enum: "+e)},h.prototype.add=function(e){if(!(e instanceof a&&void 0!==e.extend||e instanceof i||e instanceof l||e instanceof o||e instanceof s||e instanceof h))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof h&&e instanceof h)||t instanceof i||t instanceof s)throw Error("duplicate name '"+e.name+"' in "+this);for(var r=t.nestedArray,n=0;n<r.length;++n)e.add(r[n]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),d(this)},h.prototype.remove=function(e){if(!(e instanceof n))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),d(this)},h.prototype.define=function(e,t){if(c.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");var r=this;while(e.length>0){var n=e.shift();if(r.nested&&r.nested[n]){if(r=r.nested[n],!(r instanceof h))throw Error("path conflicts with non-namespace objects")}else r.add(r=new h(n))}return t&&r.addJSON(t),r},h.prototype.resolveAll=function(){var e=this.nestedArray,t=0;while(t<e.length)e[t]instanceof h?e[t++].resolveAll():e[t++].resolve();return this.resolve()},h.prototype.lookup=function(e,t,r){if("boolean"===typeof t?(r=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),c.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var n=this.get(e[0]);if(n){if(1===e.length){if(!t||t.indexOf(n.constructor)>-1)return n}else if(n instanceof h&&(n=n.lookup(e.slice(1),t,!0)))return n}else for(var i=0;i<this.nestedArray.length;++i)if(this._nestedArray[i]instanceof h&&(n=this._nestedArray[i].lookup(e,t,!0)))return n;return null===this.parent||r?null:this.parent.lookup(e,t)},h.prototype.lookupType=function(e){var t=this.lookup(e,[i]);if(!t)throw Error("no such type: "+e);return t},h.prototype.lookupEnum=function(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},h.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[i,o]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},h.prototype.lookupService=function(e){var t=this.lookup(e,[s]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},h._configure=function(e,t,r){i=e,s=t,o=r}},3243:function(e,t,r){"use strict";e.exports=s,s.className="ReflectionObject";var n,i=r(9935);function s(e,t){if(!i.isString(e))throw TypeError("name must be a string");if(t&&!i.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(s.prototype,{root:{get:function(){var e=this;while(null!==e.parent)e=e.parent;return e}},fullName:{get:function(){var e=[this.name],t=this.parent;while(t)e.unshift(t.name),t=t.parent;return e.join(".")}}}),s.prototype.toJSON=function(){throw Error()},s.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof n&&t._handleAdd(this)},s.prototype.onRemove=function(e){var t=e.root;t instanceof n&&t._handleRemove(this),this.parent=null,this.resolved=!1},s.prototype.resolve=function(){return this.resolved||this.root instanceof n&&(this.resolved=!0),this},s.prototype.getOption=function(e){if(this.options)return this.options[e]},s.prototype.setOption=function(e,t,r){return r&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},s.prototype.setParsedOption=function(e,t,r){this.parsedOptions||(this.parsedOptions=[]);var n=this.parsedOptions;if(r){var s=n.find((function(t){return Object.prototype.hasOwnProperty.call(t,e)}));if(s){var o=s[e];i.setProperty(o,r,t)}else s={},s[e]=i.setProperty({},r,t),n.push(s)}else{var a={};a[e]=t,n.push(a)}return this},s.prototype.setOptions=function(e,t){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)this.setOption(r[n],e[r[n]],t);return this},s.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},s._configure=function(e){n=e}},7598:function(e,t,r){"use strict";e.exports=o;var n=r(3243);((o.prototype=Object.create(n.prototype)).constructor=o).className="OneOf";var i=r(3548),s=r(9935);function o(e,t,r,i){if(Array.isArray(t)||(r=t,t=void 0),n.call(this,e,r),void 0!==t&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=i}function a(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}o.fromJSON=function(e,t){return new o(e,t.oneof,t.options,t.comment)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},o.prototype.add=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,a(this),this},o.prototype.remove=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),t=this.oneof.indexOf(e.name),t>-1&&this.oneof.splice(t,1),e.partOf=null,this},o.prototype.onAdd=function(e){n.prototype.onAdd.call(this,e);for(var t=this,r=0;r<this.oneof.length;++r){var i=e.get(this.oneof[r]);i&&!i.partOf&&(i.partOf=t,t.fieldsArray.push(i))}a(this)},o.prototype.onRemove=function(e){for(var t,r=0;r<this.fieldsArray.length;++r)(t=this.fieldsArray[r]).parent&&t.parent.remove(t);n.prototype.onRemove.call(this,e)},o.d=function(){var e=new Array(arguments.length),t=0;while(t<arguments.length)e[t]=arguments[t++];return function(t,r){s.decorateType(t.constructor).add(new o(r,e)),Object.defineProperty(t,r,{get:s.oneOfGetter(e),set:s.oneOfSetter(e)})}}},2228:function(e,t,r){"use strict";e.exports=A,A.filename=null,A.defaults={keepCase:!1};var n=r(626),i=r(9424),s=r(7645),o=r(3548),a=r(6039),c=r(7598),l=r(7025),u=r(7513),h=r(4429),d=r(7063),f=r(9935),p=/^[1-9][0-9]*$/,y=/^-?[1-9][0-9]*$/,g=/^0[x][0-9a-fA-F]+$/,m=/^-?0[x][0-9a-fA-F]+$/,w=/^0[0-7]+$/,b=/^-?0[0-7]+$/,v=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,E=/^[a-zA-Z_][a-zA-Z_0-9]*$/,_=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,S=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function A(e,t,r){t instanceof i||(r=t,t=new i),r||(r=A.defaults);var I,C,k,T,R,P=r.preferTrailingComment||!1,x=n(e,r.alternateCommentMode||!1),D=x.next,O=x.push,N=x.peek,L=x.skip,B=x.cmnt,U=!0,M=!1,j=t,V=r.keepCase?function(e){return e}:f.camelCase;function z(e,t,r){var n=A.filename;return r||(A.filename=null),Error("illegal "+(t||"token")+" '"+e+"' ("+(n?n+", ":"")+"line "+x.line+")")}function F(){var e,t=[];do{if('"'!==(e=D())&&"'"!==e)throw z(e);t.push(D()),L(e),e=N()}while('"'===e||"'"===e);return t.join("")}function $(e){var t=D();switch(t){case"'":case'"':return O(t),F();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return q(t,!0)}catch(r){if(e&&_.test(t))return t;throw z(t,"value")}}function K(e,t){var r,n;do{!t||'"'!==(r=N())&&"'"!==r?e.push([n=H(D()),L("to",!0)?H(D()):n]):e.push(F())}while(L(",",!0));L(";")}function q(e,t){var r=1;switch("-"===e.charAt(0)&&(r=-1,e=e.substring(1)),e){case"inf":case"INF":case"Inf":return r*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(p.test(e))return r*parseInt(e,10);if(g.test(e))return r*parseInt(e,16);if(w.test(e))return r*parseInt(e,8);if(v.test(e))return r*parseFloat(e);throw z(e,"number",t)}function H(e,t){switch(e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!t&&"-"===e.charAt(0))throw z(e,"id");if(y.test(e))return parseInt(e,10);if(m.test(e))return parseInt(e,16);if(b.test(e))return parseInt(e,8);throw z(e,"id")}function G(){if(void 0!==I)throw z("package");if(I=D(),!_.test(I))throw z(I,"name");j=j.define(I),L(";")}function W(){var e,t=N();switch(t){case"weak":e=k||(k=[]),D();break;case"public":D();default:e=C||(C=[]);break}t=F(),L(";"),e.push(t)}function Y(){if(L("="),T=F(),M="proto3"===T,!M&&"proto2"!==T)throw z(T,"syntax");L(";")}function J(e,t){switch(t){case"option":return se(e,t),L(";"),!0;case"message":return X(e,t),!0;case"enum":return ne(e,t),!0;case"service":return ue(e,t),!0;case"extend":return de(e,t),!0}return!1}function Q(e,t,r){var n=x.line;if(e&&("string"!==typeof e.comment&&(e.comment=B()),e.filename=A.filename),L("{",!0)){var i;while("}"!==(i=D()))t(i);L(";",!0)}else r&&r(),L(";"),e&&("string"!==typeof e.comment||P)&&(e.comment=B(n)||e.comment)}function X(e,t){if(!E.test(t=D()))throw z(t,"type name");var r=new s(t);Q(r,(function(e){if(!J(r,e))switch(e){case"map":te(r,e);break;case"required":case"repeated":Z(r,e);break;case"optional":Z(r,M?"proto3_optional":"optional");break;case"oneof":re(r,e);break;case"extensions":K(r.extensions||(r.extensions=[]));break;case"reserved":K(r.reserved||(r.reserved=[]),!0);break;default:if(!M||!_.test(e))throw z(e);O(e),Z(r,"optional");break}})),e.add(r)}function Z(e,t,r){var n=D();if("group"!==n){if(!_.test(n))throw z(n,"type");var i=D();if(!E.test(i))throw z(i,"name");i=V(i),L("=");var s=new o(i,H(D()),n,t,r);if(Q(s,(function(e){if("option"!==e)throw z(e);se(s,e),L(";")}),(function(){le(s)})),"proto3_optional"===t){var a=new c("_"+i);s.setOption("proto3_optional",!0),a.add(s),e.add(a)}else e.add(s);M||!s.repeated||void 0===d.packed[n]&&void 0!==d.basic[n]||s.setOption("packed",!1,!0)}else ee(e,t)}function ee(e,t){var r=D();if(!E.test(r))throw z(r,"name");var n=f.lcFirst(r);r===n&&(r=f.ucFirst(r)),L("=");var i=H(D()),a=new s(r);a.group=!0;var c=new o(n,i,r,t);c.filename=A.filename,Q(a,(function(e){switch(e){case"option":se(a,e),L(";");break;case"required":case"repeated":Z(a,e);break;case"optional":Z(a,M?"proto3_optional":"optional");break;case"message":X(a,e);break;case"enum":ne(a,e);break;default:throw z(e)}})),e.add(a).add(c)}function te(e){L("<");var t=D();if(void 0===d.mapKey[t])throw z(t,"type");L(",");var r=D();if(!_.test(r))throw z(r,"type");L(">");var n=D();if(!E.test(n))throw z(n,"name");L("=");var i=new a(V(n),H(D()),t,r);Q(i,(function(e){if("option"!==e)throw z(e);se(i,e),L(";")}),(function(){le(i)})),e.add(i)}function re(e,t){if(!E.test(t=D()))throw z(t,"name");var r=new c(V(t));Q(r,(function(e){"option"===e?(se(r,e),L(";")):(O(e),Z(r,"optional"))})),e.add(r)}function ne(e,t){if(!E.test(t=D()))throw z(t,"name");var r=new l(t);Q(r,(function(e){switch(e){case"option":se(r,e),L(";");break;case"reserved":K(r.reserved||(r.reserved=[]),!0);break;default:ie(r,e)}})),e.add(r)}function ie(e,t){if(!E.test(t))throw z(t,"name");L("=");var r=H(D(),!0),n={options:void 0,setOption:function(e,t){void 0===this.options&&(this.options={}),this.options[e]=t}};Q(n,(function(e){if("option"!==e)throw z(e);se(n,e),L(";")}),(function(){le(n)})),e.add(t,r,n.comment,n.options)}function se(e,t){var r=L("(",!0);if(!_.test(t=D()))throw z(t,"name");var n,i=t,s=i;r&&(L(")"),i="("+i+")",s=i,t=N(),S.test(t)&&(n=t.slice(1),i+=t,D())),L("=");var o=oe(e,i);ce(e,s,o,n)}function oe(e,t){if(L("{",!0)){var r={};while(!L("}",!0)){if(!E.test(R=D()))throw z(R,"name");var n,i=R;if(L(":",!0),"{"===N())n=oe(e,t+"."+R);else if("["===N()){var s;if(n=[],L("[",!0)){do{s=$(!0),n.push(s)}while(L(",",!0));L("]"),"undefined"!==typeof s&&ae(e,t+"."+R,s)}}else n=$(!0),ae(e,t+"."+R,n);var o=r[i];o&&(n=[].concat(o).concat(n)),r[i]=n,L(",",!0),L(";",!0)}return r}var a=$(!0);return ae(e,t,a),a}function ae(e,t,r){e.setOption&&e.setOption(t,r)}function ce(e,t,r,n){e.setParsedOption&&e.setParsedOption(t,r,n)}function le(e){if(L("[",!0)){do{se(e,"option")}while(L(",",!0));L("]")}return e}function ue(e,t){if(!E.test(t=D()))throw z(t,"service name");var r=new u(t);Q(r,(function(e){if(!J(r,e)){if("rpc"!==e)throw z(e);he(r,e)}})),e.add(r)}function he(e,t){var r=B(),n=t;if(!E.test(t=D()))throw z(t,"name");var i,s,o,a,c=t;if(L("("),L("stream",!0)&&(s=!0),!_.test(t=D()))throw z(t);if(i=t,L(")"),L("returns"),L("("),L("stream",!0)&&(a=!0),!_.test(t=D()))throw z(t);o=t,L(")");var l=new h(c,n,i,o,s,a);l.comment=r,Q(l,(function(e){if("option"!==e)throw z(e);se(l,e),L(";")})),e.add(l)}function de(e,t){if(!_.test(t=D()))throw z(t,"reference");var r=t;Q(null,(function(t){switch(t){case"required":case"repeated":Z(e,t,r);break;case"optional":Z(e,M?"proto3_optional":"optional",r);break;default:if(!M||!_.test(t))throw z(t);O(t),Z(e,"optional",r);break}}))}while(null!==(R=D()))switch(R){case"package":if(!U)throw z(R);G();break;case"import":if(!U)throw z(R);W();break;case"syntax":if(!U)throw z(R);Y();break;case"option":se(j,R),L(";");break;default:if(J(j,R)){U=!1;continue}throw z(R)}return A.filename=null,{package:I,imports:C,weakImports:k,syntax:T,root:t}}},1408:function(e,t,r){"use strict";e.exports=c;var n,i=r(9693),s=i.LongBits,o=i.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var l="undefined"!==typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},u=function(){return i.Buffer?function(e){return(c.create=function(e){return i.Buffer.isBuffer(e)?new n(e):l(e)})(e)}:l};function h(){var e=new s(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new s(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}c.create=u(),c.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,c.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return e}}(),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return d(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|d(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},c.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},c.prototype.skip=function(e){if("number"===typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:while(4!==(e=7&this.uint32()))this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){n=e,c.create=u(),n._configure();var t=i.Long?"toLong":"toNumber";i.merge(c.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},593:function(e,t,r){"use strict";e.exports=s;var n=r(1408);(s.prototype=Object.create(n.prototype)).constructor=s;var i=r(9693);function s(e){n.call(this,e)}s._configure=function(){i.Buffer&&(s.prototype._slice=i.Buffer.prototype.slice)},s.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},s._configure()},9424:function(e,t,r){"use strict";e.exports=h;var n=r(9313);((h.prototype=Object.create(n.prototype)).constructor=h).className="Root";var i,s,o,a=r(3548),c=r(7025),l=r(7598),u=r(9935);function h(e){n.call(this,"",e),this.deferred=[],this.files=[]}function d(){}h.fromJSON=function(e,t){return t||(t=new h),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},h.prototype.resolvePath=u.path.resolve,h.prototype.fetch=u.fetch,h.prototype.load=function e(t,r,n){"function"===typeof r&&(n=r,r=void 0);var i=this;if(!n)return u.asPromise(e,i,t,r);var a=n===d;function c(e,t){if(n){var r=n;if(n=null,a)throw e;r(e,t)}}function l(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var r=e.substring(t);if(r in o)return r}return null}function h(e,t){try{if(u.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),u.isString(t)){s.filename=e;var n,o=s(t,i,r),h=0;if(o.imports)for(;h<o.imports.length;++h)(n=l(o.imports[h])||i.resolvePath(e,o.imports[h]))&&f(n);if(o.weakImports)for(h=0;h<o.weakImports.length;++h)(n=l(o.weakImports[h])||i.resolvePath(e,o.weakImports[h]))&&f(n,!0)}else i.setOptions(t.options).addJSON(t.nested)}catch(d){c(d)}a||p||c(null,i)}function f(e,t){if(!(i.files.indexOf(e)>-1))if(i.files.push(e),e in o)a?h(e,o[e]):(++p,setTimeout((function(){--p,h(e,o[e])})));else if(a){var r;try{r=u.fs.readFileSync(e).toString("utf8")}catch(s){return void(t||c(s))}h(e,r)}else++p,i.fetch(e,(function(r,s){--p,n&&(r?t?p||c(null,i):c(r):h(e,s))}))}var p=0;u.isString(t)&&(t=[t]);for(var y,g=0;g<t.length;++g)(y=i.resolvePath("",t[g]))&&f(y);if(a)return i;p||c(null,i)},h.prototype.loadSync=function(e,t){if(!u.isNode)throw Error("not supported");return this.load(e,t,d)},h.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return n.prototype.resolveAll.call(this)};var f=/^[A-Z]/;function p(e,t){var r=t.parent.lookup(t.extend);if(r){var n=new a(t.fullName,t.id,t.type,t.rule,void 0,t.options);return n.declaringField=t,t.extensionField=n,r.add(n),!0}return!1}h.prototype._handleAdd=function(e){if(e instanceof a)void 0===e.extend||e.extensionField||p(this,e)||this.deferred.push(e);else if(e instanceof c)f.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof l)){if(e instanceof i)for(var t=0;t<this.deferred.length;)p(this,this.deferred[t])?this.deferred.splice(t,1):++t;for(var r=0;r<e.nestedArray.length;++r)this._handleAdd(e._nestedArray[r]);f.test(e.name)&&(e.parent[e.name]=e)}},h.prototype._handleRemove=function(e){if(e instanceof a){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof c)f.test(e.name)&&delete e.parent[e.name];else if(e instanceof n){for(var r=0;r<e.nestedArray.length;++r)this._handleRemove(e._nestedArray[r]);f.test(e.name)&&delete e.parent[e.name]}},h._configure=function(e,t,r){i=e,s=t,o=r}},5054:function(e){"use strict";e.exports={}},5994:function(e,t,r){"use strict";var n=t;n.Service=r(7948)},7948:function(e,t,r){"use strict";e.exports=i;var n=r(9693);function i(e,t,r){if("function"!==typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(i.prototype=Object.create(n.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,r,i,s,o){if(!s)throw TypeError("request must be specified");var a=this;if(!o)return n.asPromise(e,a,t,r,i,s);if(a.rpcImpl)try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](s).finish(),(function(e,r){if(e)return a.emit("error",e,t),o(e);if(null!==r){if(!(r instanceof i))try{r=i[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",r,t),o(null,r)}a.end(!0)}))}catch(c){return a.emit("error",c,t),void setTimeout((function(){o(c)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},7513:function(e,t,r){"use strict";e.exports=a;var n=r(9313);((a.prototype=Object.create(n.prototype)).constructor=a).className="Service";var i=r(4429),s=r(9935),o=r(5994);function a(e,t){n.call(this,e,t),this.methods={},this._methodsArray=null}function c(e){return e._methodsArray=null,e}a.fromJSON=function(e,t){var r=new a(e,t.options);if(t.methods)for(var n=Object.keys(t.methods),s=0;s<n.length;++s)r.add(i.fromJSON(n[s],t.methods[n[s]]));return t.nested&&r.addJSON(t.nested),r.comment=t.comment,r},a.prototype.toJSON=function(e){var t=n.prototype.toJSON.call(this,e),r=!!e&&Boolean(e.keepComments);return s.toObject(["options",t&&t.options||void 0,"methods",n.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])},Object.defineProperty(a.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=s.toArray(this.methods))}}),a.prototype.get=function(e){return this.methods[e]||n.prototype.get.call(this,e)},a.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return n.prototype.resolve.call(this)},a.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof i?(this.methods[e.name]=e,e.parent=this,c(this)):n.prototype.add.call(this,e)},a.prototype.remove=function(e){if(e instanceof i){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,c(this)}return n.prototype.remove.call(this,e)},a.prototype.create=function(e,t,r){for(var n,i=new o.Service(e,t,r),a=0;a<this.methodsArray.length;++a){var c=s.lcFirst((n=this._methodsArray[a]).resolve().name).replace(/[^$\w_]/g,"");i[c]=s.codegen(["r","c"],s.isReserved(c)?c+"_":c)("return this.rpcCall(m,q,s,r,c)")({m:n,q:n.resolvedRequestType.ctor,s:n.resolvedResponseType.ctor})}return i}},626:function(e){"use strict";e.exports=h;var t=/[\s{}=;:[\],'"()<>]/g,r=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,n=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,i=/^ *[*/]+ */,s=/^\s*\*?\/*/,o=/\n/g,a=/\s/,c=/\\(.?)/g,l={0:"\0",r:"\r",n:"\n",t:"\t"};function u(e){return e.replace(c,(function(e,t){switch(t){case"\\":case"":return t;default:return l[t]||""}}))}function h(e,c){e=e.toString();var l=0,h=e.length,d=1,f=0,p={},y=[],g=null;function m(e){return Error("illegal "+e+" (line "+d+")")}function w(){var t="'"===g?n:r;t.lastIndex=l-1;var i=t.exec(e);if(!i)throw m("string");return l=t.lastIndex,A(g),g=null,u(i[1])}function b(t){return e.charAt(t)}function v(t,r,n){var a,l={type:e.charAt(t++),lineEmpty:!1,leading:n};a=c?2:3;var u,h=t-a;do{if(--h<0||"\n"===(u=e.charAt(h))){l.lineEmpty=!0;break}}while(" "===u||"\t"===u);for(var y=e.substring(t,r).split(o),g=0;g<y.length;++g)y[g]=y[g].replace(c?s:i,"").trim();l.text=y.join("\n").trim(),p[d]=l,f=d}function E(t){var r=_(t),n=e.substring(t,r),i=/^\s*\/{1,2}/.test(n);return i}function _(e){var t=e;while(t<h&&"\n"!==b(t))t++;return t}function S(){if(y.length>0)return y.shift();if(g)return w();var r,n,i,s,o,u=0===l;do{if(l===h)return null;r=!1;while(a.test(i=b(l)))if("\n"===i&&(u=!0,++d),++l===h)return null;if("/"===b(l)){if(++l===h)throw m("comment");if("/"===b(l))if(c){if(s=l,o=!1,E(l)){o=!0;do{if(l=_(l),l===h)break;if(l++,!u)break}while(E(l))}else l=Math.min(h,_(l)+1);o&&(v(s,l,u),u=!0),d++,r=!0}else{o="/"===b(s=l+1);while("\n"!==b(++l))if(l===h)return null;++l,o&&(v(s,l-1,u),u=!0),++d,r=!0}else{if("*"!==(i=b(l)))return"/";s=l+1,o=c||"*"===b(s);do{if("\n"===i&&++d,++l===h)throw m("comment");n=i,i=b(l)}while("*"!==n||"/"!==i);++l,o&&(v(s,l-2,u),u=!0),r=!0}}}while(r);var f=l;t.lastIndex=0;var p=t.test(b(f++));if(!p)while(f<h&&!t.test(b(f)))++f;var S=e.substring(l,l=f);return'"'!==S&&"'"!==S||(g=S),S}function A(e){y.push(e)}function I(){if(!y.length){var e=S();if(null===e)return null;A(e)}return y[0]}function C(e,t){var r=I(),n=r===e;if(n)return S(),!0;if(!t)throw m("token '"+r+"', '"+e+"' expected");return!1}function k(e){var t,r=null;return void 0===e?(t=p[d-1],delete p[d-1],t&&(c||"*"===t.type||t.lineEmpty)&&(r=t.leading?t.text:null)):(f<e&&I(),t=p[e],delete p[e],!t||t.lineEmpty||!c&&"/"!==t.type||(r=t.leading?null:t.text)),r}return Object.defineProperty({next:S,peek:I,push:A,skip:C,cmnt:k},"line",{get:function(){return d}})}h.unescape=u},7645:function(e,t,r){"use strict";e.exports=w;var n=r(9313);((w.prototype=Object.create(n.prototype)).constructor=w).className="Type";var i=r(7025),s=r(7598),o=r(3548),a=r(6039),c=r(7513),l=r(8368),u=r(1408),h=r(1173),d=r(9935),f=r(4928),p=r(5305),y=r(4497),g=r(3996),m=r(1667);function w(e,t){n.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function b(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(w.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var r=this.fields[e[t]],n=r.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=r}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=d.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=d.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=w.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof l||((e.prototype=new l).constructor=e,d.merge(e.prototype,t)),e.$type=e.prototype.$type=this,d.merge(e,l,!0),this._ctor=e;for(var r=0;r<this.fieldsArray.length;++r)this._fieldsArray[r].resolve();var n={};for(r=0;r<this.oneofsArray.length;++r)n[this._oneofsArray[r].resolve().name]={get:d.oneOfGetter(this._oneofsArray[r].oneof),set:d.oneOfSetter(this._oneofsArray[r].oneof)};r&&Object.defineProperties(e.prototype,n)}}}),w.generateConstructor=function(e){for(var t,r=d.codegen(["p"],e.name),n=0;n<e.fieldsArray.length;++n)(t=e._fieldsArray[n]).map?r("this%s={}",d.safeProp(t.name)):t.repeated&&r("this%s=[]",d.safeProp(t.name));return r("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},w.fromJSON=function(e,t){var r=new w(e,t.options);r.extensions=t.extensions,r.reserved=t.reserved;for(var l=Object.keys(t.fields),u=0;u<l.length;++u)r.add(("undefined"!==typeof t.fields[l[u]].keyType?a.fromJSON:o.fromJSON)(l[u],t.fields[l[u]]));if(t.oneofs)for(l=Object.keys(t.oneofs),u=0;u<l.length;++u)r.add(s.fromJSON(l[u],t.oneofs[l[u]]));if(t.nested)for(l=Object.keys(t.nested),u=0;u<l.length;++u){var h=t.nested[l[u]];r.add((void 0!==h.id?o.fromJSON:void 0!==h.fields?w.fromJSON:void 0!==h.values?i.fromJSON:void 0!==h.methods?c.fromJSON:n.fromJSON)(l[u],h))}return t.extensions&&t.extensions.length&&(r.extensions=t.extensions),t.reserved&&t.reserved.length&&(r.reserved=t.reserved),t.group&&(r.group=!0),t.comment&&(r.comment=t.comment),r},w.prototype.toJSON=function(e){var t=n.prototype.toJSON.call(this,e),r=!!e&&Boolean(e.keepComments);return d.toObject(["options",t&&t.options||void 0,"oneofs",n.arrayToJSON(this.oneofsArray,e),"fields",n.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])},w.prototype.resolveAll=function(){var e=this.fieldsArray,t=0;while(t<e.length)e[t++].resolve();var r=this.oneofsArray;t=0;while(t<r.length)r[t++].resolve();return n.prototype.resolveAll.call(this)},w.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},w.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof o&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),b(this)}return e instanceof s?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),b(this)):n.prototype.add.call(this,e)},w.prototype.remove=function(e){if(e instanceof o&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),b(this)}if(e instanceof s){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),b(this)}return n.prototype.remove.call(this,e)},w.prototype.isReservedId=function(e){return n.isReservedId(this.reserved,e)},w.prototype.isReservedName=function(e){return n.isReservedName(this.reserved,e)},w.prototype.create=function(e){return new this.ctor(e)},w.prototype.setup=function(){for(var e=this.fullName,t=[],r=0;r<this.fieldsArray.length;++r)t.push(this._fieldsArray[r].resolve().resolvedType);this.encode=f(this)({Writer:h,types:t,util:d}),this.decode=p(this)({Reader:u,types:t,util:d}),this.verify=y(this)({types:t,util:d}),this.fromObject=g.fromObject(this)({types:t,util:d}),this.toObject=g.toObject(this)({types:t,util:d});var n=m[e];if(n){var i=Object.create(this);i.fromObject=this.fromObject,this.fromObject=n.fromObject.bind(i),i.toObject=this.toObject,this.toObject=n.toObject.bind(i)}return this},w.prototype.encode=function(e,t){return this.setup().encode(e,t)},w.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},w.prototype.decode=function(e,t){return this.setup().decode(e,t)},w.prototype.decodeDelimited=function(e){return e instanceof u||(e=u.create(e)),this.decode(e,e.uint32())},w.prototype.verify=function(e){return this.setup().verify(e)},w.prototype.fromObject=function(e){return this.setup().fromObject(e)},w.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},w.d=function(e){return function(t){d.decorateType(t,e)}}},7063:function(e,t,r){"use strict";var n=t,i=r(9935),s=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function o(e,t){var r=0,n={};t|=0;while(r<e.length)n[s[r+t]]=e[r++];return n}n.basic=o([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),n.defaults=o([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",i.emptyArray,null]),n.long=o([0,0,0,1,1],7),n.mapKey=o([0,0,0,5,5,0,0,0,1,1,0,2],2),n.packed=o([1,5,0,0,0,5,5,0,0,0,1,1,0])},9935:function(e,t,r){"use strict";var n,i,s=e.exports=r(9693),o=r(5054);s.codegen=r(5124),s.fetch=r(9054),s.path=r(8626),s.fs=s.inquire("fs"),s.toArray=function(e){if(e){var t=Object.keys(e),r=new Array(t.length),n=0;while(n<t.length)r[n]=e[t[n++]];return r}return[]},s.toObject=function(e){var t={},r=0;while(r<e.length){var n=e[r++],i=e[r++];void 0!==i&&(t[n]=i)}return t};var a=/\\/g,c=/"/g;s.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},s.safeProp=function(e){return!/^[$\w_]+$/.test(e)||s.isReserved(e)?'["'+e.replace(a,"\\\\").replace(c,'\\"')+'"]':"."+e},s.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var l=/_([a-z])/g;s.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(l,(function(e,t){return t.toUpperCase()}))},s.compareFieldsById=function(e,t){return e.id-t.id},s.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(s.decorateRoot.remove(e.$type),e.$type.name=t,s.decorateRoot.add(e.$type)),e.$type;n||(n=r(7645));var i=new n(t||e.name);return s.decorateRoot.add(i),i.ctor=e,Object.defineProperty(e,"$type",{value:i,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:i,enumerable:!1}),i};var u=0;s.decorateEnum=function(e){if(e.$type)return e.$type;i||(i=r(7025));var t=new i("Enum"+u++,e);return s.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t},s.setProperty=function(e,t,r){function n(e,t,r){var i=t.shift();if("__proto__"===i)return e;if(t.length>0)e[i]=n(e[i]||{},t,r);else{var s=e[i];s&&(r=[].concat(s).concat(r)),e[i]=r}return e}if("object"!==typeof e)throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return t=t.split("."),n(e,t,r)},Object.defineProperty(s,"decorateRoot",{get:function(){return o["decorated"]||(o["decorated"]=new(r(9424)))}})},1945:function(e,t,r){"use strict";e.exports=i;var n=r(9693);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var s=i.zero=new i(0,0);s.toNumber=function(){return 0},s.zzEncode=s.zzDecode=function(){return this},s.length=function(){return 1};var o=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return s;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new i(r,n)},i.from=function(e){if("number"===typeof e)return i.fromNumber(e);if(n.isString(e)){if(!n.Long)return i.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):s},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;i.fromHash=function(e){return e===o?s:new i((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},9693:function(e,t,r){"use strict";var n=t;function i(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)void 0!==e[n[i]]&&r||(e[n[i]]=t[n[i]]);return e}function s(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&i(this,r)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}n.asPromise=r(4537),n.base64=r(7419),n.EventEmitter=r(9211),n.float=r(945),n.inquire=r(7199),n.utf8=r(4997),n.pool=r(6662),n.LongBits=r(1945),n.isNode=Boolean("undefined"!==typeof r.g&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),n.global=n.isNode&&r.g||"undefined"!==typeof window&&window||"undefined"!==typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"===typeof e||e instanceof String},n.isObject=function(e){return e&&"object"===typeof e},n.isset=n.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!==typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(t){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"===typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"===typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!==typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=i,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=s,n.ProtocolError=s("ProtocolError"),n.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},n.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},4497:function(e,t,r){"use strict";e.exports=c;var n=r(7025),i=r(9935);function s(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function o(e,t,r,i){if(t.resolvedType)if(t.resolvedType instanceof n){e("switch(%s){",i)("default:")("return%j",s(t,"enum value"));for(var o=Object.keys(t.resolvedType.values),a=0;a<o.length;++a)e("case %i:",t.resolvedType.values[o[a]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",r,i)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",i)("return%j",s(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",i,i,i,i)("return%j",s(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',i)("return%j",s(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',i)("return%j",s(t,"boolean"));break;case"string":e("if(!util.isString(%s))",i)("return%j",s(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',i,i,i)("return%j",s(t,"buffer"));break}return e}function a(e,t,r){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",r)("return%j",s(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",r)("return%j",s(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",r)("return%j",s(t,"boolean key"));break}return e}function c(e){var t=i.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),r=e.oneofsArray,n={};r.length&&t("var p={}");for(var c=0;c<e.fieldsArray.length;++c){var l=e._fieldsArray[c].resolve(),u="m"+i.safeProp(l.name);if(l.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",u,l.name),l.map)t("if(!util.isObject(%s))",u)("return%j",s(l,"object"))("var k=Object.keys(%s)",u)("for(var i=0;i<k.length;++i){"),a(t,l,"k[i]"),o(t,l,c,u+"[k[i]]")("}");else if(l.repeated)t("if(!Array.isArray(%s))",u)("return%j",s(l,"array"))("for(var i=0;i<%s.length;++i){",u),o(t,l,c,u+"[i]")("}");else{if(l.partOf){var h=i.safeProp(l.partOf.name);1===n[l.partOf.name]&&t("if(p%s===1)",h)("return%j",l.partOf.name+": multiple values"),n[l.partOf.name]=1,t("p%s=1",h)}o(t,l,c,u)}l.optional&&t("}")}return t("return null")}},1667:function(e,t,r){"use strict";var n=t,i=r(8368);n[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1),r=this.lookup(t);if(r){var n="."===e["@type"].charAt(0)?e["@type"].slice(1):e["@type"];return-1===n.indexOf("/")&&(n="/"+n),this.create({type_url:n,value:r.encode(r.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var r="type.googleapis.com/",n="",s="";if(t&&t.json&&e.type_url&&e.value){s=e.type_url.substring(e.type_url.lastIndexOf("/")+1),n=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var o=this.lookup(s);o&&(e=o.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof i){var a=e.$type.toObject(e,t),c="."===e.$type.fullName[0]?e.$type.fullName.slice(1):e.$type.fullName;return""===n&&(n=r),s=n+c,a["@type"]=s,a}return this.toObject(e,t)}}},1173:function(e,t,r){"use strict";e.exports=h;var n,i=r(9693),s=i.LongBits,o=i.base64,a=i.utf8;function c(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function l(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}var d=function(){return i.Buffer?function(){return(h.create=function(){return new n})()}:function(){return new h}};function f(e,t,r){t[r]=255&e}function p(e,t,r){while(e>127)t[r++]=127&e|128,e>>>=7;t[r]=e}function y(e,t){this.len=e,this.next=void 0,this.val=t}function g(e,t,r){while(e.hi)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;while(e.lo>127)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function m(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}h.create=d(),h.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(h.alloc=i.pool(h.alloc,i.Array.prototype.subarray)),h.prototype._push=function(e,t,r){return this.tail=this.tail.next=new c(e,t,r),this.len+=t,this},y.prototype=Object.create(c.prototype),y.prototype.fn=p,h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new y((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(g,10,s.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=s.from(e);return this._push(g,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=s.from(e).zzEncode();return this._push(g,t.length(),t)},h.prototype.bool=function(e){return this._push(f,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(m,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=s.from(e);return this._push(m,4,t.lo)._push(m,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var w=i.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(i.isString(e)){var r=h.alloc(t=o.length(e));o.decode(e,r,0),e=r}return this.uint32(t)._push(w,t,e)},h.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},h.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new c(l,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},h.prototype.finish=function(){var e=this.head.next,t=this.constructor.alloc(this.len),r=0;while(e)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},h._configure=function(e){n=e,h.create=d(),n._configure()}},3155:function(e,t,r){"use strict";e.exports=s;var n=r(1173);(s.prototype=Object.create(n.prototype)).constructor=s;var i=r(9693);function s(){n.call(this)}function o(e,t,r){e.length<40?i.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}s._configure=function(){s.alloc=i._Buffer_allocUnsafe,s.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},s.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(s.writeBytesBuffer,t,e),this},s.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},s._configure()},4375:function(e,t,r){
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
let n;e.exports="function"===typeof queueMicrotask?queueMicrotask.bind("undefined"!==typeof window?window:r.g):e=>(n||(n=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))},3286:function(e,t,r){const{instantiate:n}=r(9824);function i(e={}){if(!i.supported)return null;var t=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return n(new Response(new Blob([t],{type:"application/wasm"})),e)}i.supported="undefined"!==typeof WebAssembly,e.exports=i},3060:function(e,t,r){const n=r(7118),i=r(3286),s=async(e,t,r,s,o)=>{const a=await i();return new n(a,e,t,r,s,o)};e.exports={Rabin:n,create:s}},7118:function(e){class t{constructor(e,t=12,r=8192,n=32768,i=64,s){this.bits=t,this.min=r,this.max=n,this.asModule=e,this.rabin=new e.Rabin(t,r,n,i,s),this.polynomial=s}fingerprint(e){const{__retain:t,__release:r,__allocArray:n,__getInt32Array:i,Int32Array_ID:s,Uint8Array_ID:o}=this.asModule,a=new Int32Array(Math.ceil(e.length/this.min)),c=t(n(s,a)),l=t(n(o,e)),u=this.rabin.fingerprint(l,c),h=i(u);r(l),r(c);const d=h.indexOf(0);return d>=0?h.subarray(0,d):h}}e.exports=t},1798:function(e,t,r){"use strict";var n=65536,i=4294967295;function s(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}var o=r(9509).Buffer,a=r.g.crypto||r.g.msCrypto;function c(e,t){if(e>i)throw new RangeError("requested too many random bytes");var r=o.allocUnsafe(e);if(e>0)if(e>n)for(var s=0;s<e;s+=n)a.getRandomValues(r.slice(s,s+n));else a.getRandomValues(r);return"function"===typeof t?process.nextTick((function(){t(null,r)})):r}a&&a.getRandomValues?e.exports=c:e.exports=s},8558:function(e,t,r){const n=r(4636),i=r(1391),s=r(4156),o=r(4832),{RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:c,RateLimiterCluster:l}=r(1713),u=r(2288),h=r(5105),d=r(911),f=r(3766),p=r(8686),y=r(3328),g=r(5155);e.exports={RateLimiterRedis:n,RateLimiterMongo:i,RateLimiterMySQL:s,RateLimiterPostgres:o,RateLimiterMemory:u,RateLimiterMemcache:h,RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:c,RateLimiterCluster:l,RLWrapperBlackAndWhite:d,RateLimiterUnion:f,RateLimiterQueue:p,BurstyRateLimiter:y,RateLimiterRes:g}},3328:function(e,t,r){const n=r(5155);e.exports=class{constructor(e,t){this._rateLimiter=e,this._burstLimiter=t}_combineRes(e,t){return new n(e.remainingPoints,Math.min(e.msBeforeNext,t.msBeforeNext),e.consumedPoints,e.isFirstInDuration)}consume(e,t=1,r={}){return this._rateLimiter.consume(e,t,r).catch((i=>i instanceof n?this._burstLimiter.consume(e,t,r).then((e=>Promise.resolve(this._combineRes(i,e)))).catch((e=>e instanceof n?Promise.reject(this._combineRes(i,e)):Promise.reject(e))):Promise.reject(i)))}get(e){return Promise.all([this._rateLimiter.get(e),this._burstLimiter.get(e)]).then((([e,t])=>this._combineRes(e,t)))}get points(){return this._rateLimiter.points}}},911:function(e,t,r){const n=r(5155);e.exports=class{constructor(e={}){this.limiter=e.limiter,this.blackList=e.blackList,this.whiteList=e.whiteList,this.isBlackListed=e.isBlackListed,this.isWhiteListed=e.isWhiteListed,this.runActionAnyway=e.runActionAnyway}get limiter(){return this._limiter}set limiter(e){if("undefined"===typeof e)throw new Error("limiter is not set");this._limiter=e}get runActionAnyway(){return this._runActionAnyway}set runActionAnyway(e){this._runActionAnyway="undefined"!==typeof e&&e}get blackList(){return this._blackList}set blackList(e){this._blackList=Array.isArray(e)?e:[]}get isBlackListed(){return this._isBlackListed}set isBlackListed(e){if("undefined"===typeof e&&(e=()=>!1),"function"!==typeof e)throw new Error("isBlackListed must be function");this._isBlackListed=e}get whiteList(){return this._whiteList}set whiteList(e){this._whiteList=Array.isArray(e)?e:[]}get isWhiteListed(){return this._isWhiteListed}set isWhiteListed(e){if("undefined"===typeof e&&(e=()=>!1),"function"!==typeof e)throw new Error("isWhiteListed must be function");this._isWhiteListed=e}isBlackListedSomewhere(e){return this.blackList.indexOf(e)>=0||this.isBlackListed(e)}isWhiteListedSomewhere(e){return this.whiteList.indexOf(e)>=0||this.isWhiteListed(e)}getBlackRes(){return new n(0,Number.MAX_SAFE_INTEGER,0,!1)}getWhiteRes(){return new n(Number.MAX_SAFE_INTEGER,0,0,!1)}rejectBlack(){return Promise.reject(this.getBlackRes())}resolveBlack(){return Promise.resolve(this.getBlackRes())}resolveWhite(){return Promise.resolve(this.getWhiteRes())}consume(e,t=1){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.rejectBlack()),"undefined"===typeof r?this.limiter.consume(e,t):(this.runActionAnyway&&this.limiter.consume(e,t).catch((()=>{})),r)}block(e,t){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),"undefined"===typeof r?this.limiter.block(e,t):(this.runActionAnyway&&this.limiter.block(e,t).catch((()=>{})),r)}penalty(e,t){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),"undefined"===typeof r?this.limiter.penalty(e,t):(this.runActionAnyway&&this.limiter.penalty(e,t).catch((()=>{})),r)}reward(e,t){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),"undefined"===typeof r?this.limiter.reward(e,t):(this.runActionAnyway&&this.limiter.reward(e,t).catch((()=>{})),r)}get(e){let t;return this.isWhiteListedSomewhere(e)?t=this.resolveWhite():this.isBlackListedSomewhere(e)&&(t=this.resolveBlack()),"undefined"===typeof t||this.runActionAnyway?this.limiter.get(e):t}delete(e){return this.limiter.delete(e)}}},1352:function(e){e.exports=class{constructor(e={}){this.points=e.points,this.duration=e.duration,this.blockDuration=e.blockDuration,this.execEvenly=e.execEvenly,this.execEvenlyMinDelayMs=e.execEvenlyMinDelayMs,this.keyPrefix=e.keyPrefix}get points(){return this._points}set points(e){this._points=e>=0?e:4}get duration(){return this._duration}set duration(e){this._duration="undefined"===typeof e?1:e}get msDuration(){return 1e3*this.duration}get blockDuration(){return this._blockDuration}set blockDuration(e){this._blockDuration="undefined"===typeof e?0:e}get msBlockDuration(){return 1e3*this.blockDuration}get execEvenly(){return this._execEvenly}set execEvenly(e){this._execEvenly="undefined"!==typeof e&&Boolean(e)}get execEvenlyMinDelayMs(){return this._execEvenlyMinDelayMs}set execEvenlyMinDelayMs(e){this._execEvenlyMinDelayMs="undefined"===typeof e?Math.ceil(this.msDuration/this.points):e}get keyPrefix(){return this._keyPrefix}set keyPrefix(e){if("undefined"===typeof e&&(e="rlflx"),"string"!==typeof e)throw new Error("keyPrefix must be string");this._keyPrefix=e}_getKeySecDuration(e={}){return e&&e.customDuration>=0?e.customDuration:this.duration}getKey(e){return this.keyPrefix.length>0?`${this.keyPrefix}:${e}`:e}parseKey(e){return e.substring(this.keyPrefix.length)}consume(){throw new Error("You have to implement the method 'consume'!")}penalty(){throw new Error("You have to implement the method 'penalty'!")}reward(){throw new Error("You have to implement the method 'reward'!")}get(){throw new Error("You have to implement the method 'get'!")}set(){throw new Error("You have to implement the method 'set'!")}block(){throw new Error("You have to implement the method 'block'!")}delete(){throw new Error("You have to implement the method 'delete'!")}}},1713:function(e,t,r){const n=r(1265),i=r(5539),s=r(1352),o=r(2288),a=r(5155),c="rate_limiter_flexible";let l=null;const u=function(e,t,r,n){let i;i=null===n||!0===n||!1===n?n:{remainingPoints:n.remainingPoints,msBeforeNext:n.msBeforeNext,consumedPoints:n.consumedPoints,isFirstInDuration:n.isFirstInDuration},e.send({channel:c,keyPrefix:t.keyPrefix,promiseId:t.promiseId,type:r,data:i})},h=function(e){setTimeout((()=>{this._initiated?process.send(e):"undefined"!==typeof this._promises[e.promiseId]&&h.call(this,e)}),30)},d=function(e,t,r,n,i){const s={channel:c,keyPrefix:this.keyPrefix,func:e,promiseId:t,data:{key:r,arg:n,opts:i}};this._initiated?process.send(s):h.call(this,s)},f=function(e,t){if(!t||t.channel!==c||"undefined"===typeof this._rateLimiters[t.keyPrefix])return!1;let r;switch(t.func){case"consume":r=this._rateLimiters[t.keyPrefix].consume(t.data.key,t.data.arg,t.data.opts);break;case"penalty":r=this._rateLimiters[t.keyPrefix].penalty(t.data.key,t.data.arg,t.data.opts);break;case"reward":r=this._rateLimiters[t.keyPrefix].reward(t.data.key,t.data.arg,t.data.opts);break;case"block":r=this._rateLimiters[t.keyPrefix].block(t.data.key,t.data.arg,t.data.opts);break;case"get":r=this._rateLimiters[t.keyPrefix].get(t.data.key,t.data.opts);break;case"delete":r=this._rateLimiters[t.keyPrefix].delete(t.data.key,t.data.opts);break;default:return!1}r&&r.then((r=>{u(e,t,"resolve",r)})).catch((r=>{u(e,t,"reject",r)}))},p=function(e){if(!e||e.channel!==c||e.keyPrefix!==this.keyPrefix)return!1;if(this._promises[e.promiseId]){let t;switch(clearTimeout(this._promises[e.promiseId].timeoutId),t=null===e.data||!0===e.data||!1===e.data?e.data:new a(e.data.remainingPoints,e.data.msBeforeNext,e.data.consumedPoints,e.data.isFirstInDuration),e.type){case"resolve":this._promises[e.promiseId].resolve(t);break;case"reject":this._promises[e.promiseId].reject(t);break;default:throw new Error(`RateLimiterCluster: no such message type '${e.type}'`)}delete this._promises[e.promiseId]}},y=function(){return{points:this.points,duration:this.duration,blockDuration:this.blockDuration,execEvenly:this.execEvenly,execEvenlyMinDelayMs:this.execEvenlyMinDelayMs,keyPrefix:this.keyPrefix}},g=function(e,t){const r=process.hrtime();let n=r[0].toString()+r[1].toString();return"undefined"!==typeof this._promises[n]&&(n+=i.randomBytes(12).toString("base64")),this._promises[n]={resolve:e,reject:t,timeoutId:setTimeout((()=>{delete this._promises[n],t(new Error("RateLimiterCluster timeout: no answer from master in time"))}),this.timeoutMs)},n};class m{constructor(){if(l)return l;this._rateLimiters={},n.setMaxListeners(0),n.on("message",((e,t)=>{t&&t.channel===c&&"init"===t.type?("undefined"===typeof this._rateLimiters[t.opts.keyPrefix]&&(this._rateLimiters[t.opts.keyPrefix]=new o(t.opts)),e.send({channel:c,type:"init",keyPrefix:t.opts.keyPrefix})):f.call(this,e,t)})),l=this}}class w{constructor(e){if(l)return l;this._rateLimiters={},e.launchBus(((t,r)=>{r.on("process:msg",(t=>{const r=t.raw;if(r&&r.channel===c&&"init"===r.type)"undefined"===typeof this._rateLimiters[r.opts.keyPrefix]&&(this._rateLimiters[r.opts.keyPrefix]=new o(r.opts)),e.sendDataToProcessId(t.process.pm_id,{data:{},topic:c,channel:c,type:"init",keyPrefix:r.opts.keyPrefix},((e,t)=>{e&&console.log(e,t)}));else{const n={send:r=>{const n=r;n.topic=c,"undefined"===typeof n.data&&(n.data={}),e.sendDataToProcessId(t.process.pm_id,n,((e,t)=>{e&&console.log(e,t)}))}};f.call(this,n,r)}}))})),l=this}}class b extends s{get timeoutMs(){return this._timeoutMs}set timeoutMs(e){this._timeoutMs="undefined"===typeof e?5e3:Math.abs(parseInt(e))}constructor(e={}){super(e),process.setMaxListeners(0),this.timeoutMs=e.timeoutMs,this._initiated=!1,process.on("message",(e=>{e&&e.channel===c&&"init"===e.type&&e.keyPrefix===this.keyPrefix?this._initiated=!0:p.call(this,e)})),process.send({channel:c,type:"init",opts:y.call(this)}),this._promises={}}consume(e,t=1,r={}){return new Promise(((n,i)=>{const s=g.call(this,n,i);d.call(this,"consume",s,e,t,r)}))}penalty(e,t=1,r={}){return new Promise(((n,i)=>{const s=g.call(this,n,i);d.call(this,"penalty",s,e,t,r)}))}reward(e,t=1,r={}){return new Promise(((n,i)=>{const s=g.call(this,n,i);d.call(this,"reward",s,e,t,r)}))}block(e,t,r={}){return new Promise(((n,i)=>{const s=g.call(this,n,i);d.call(this,"block",s,e,t,r)}))}get(e,t={}){return new Promise(((r,n)=>{const i=g.call(this,r,n);d.call(this,"get",i,e,t)}))}delete(e,t={}){return new Promise(((r,n)=>{const i=g.call(this,r,n);d.call(this,"delete",i,e,t)}))}}e.exports={RateLimiterClusterMaster:m,RateLimiterClusterMasterPM2:w,RateLimiterCluster:b}},5105:function(e,t,r){const n=r(1090),i=r(5155);class s extends n{constructor(e){super(e),this.client=e.storeClient}_getRateLimiterRes(e,t,r){const n=new i;return n.consumedPoints=parseInt(r.consumedPoints),n.isFirstInDuration=r.consumedPoints===t,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=r.msBeforeNext,n}_upsert(e,t,r,n=!1,i={}){return new Promise(((s,o)=>{const a=Date.now(),c=Math.floor(r/1e3);n?this.client.set(e,t,c,(r=>{r?o(r):this.client.set(`${e}_expire`,c>0?a+1e3*c:-1,c,(()=>{const e={consumedPoints:t,msBeforeNext:c>0?1e3*c:-1};s(e)}))})):this.client.incr(e,t,((l,u)=>{l||!1===u?this.client.add(e,t,c,((l,u)=>{if(l||!u)if("undefined"===typeof i.attemptNumber||i.attemptNumber<3){const a=Object.assign({},i);a.attemptNumber=a.attemptNumber?a.attemptNumber+1:1,this._upsert(e,t,r,n,a).then((e=>s(e))).catch((e=>o(e)))}else o(new Error("Can not add key"));else this.client.add(`${e}_expire`,c>0?a+1e3*c:-1,c,(()=>{const e={consumedPoints:t,msBeforeNext:c>0?1e3*c:-1};s(e)}))})):this.client.get(`${e}_expire`,((e,t)=>{if(e)o(e);else{const e=!1===t?0:t,r={consumedPoints:u,msBeforeNext:e>=0?Math.max(e-a,0):-1};s(r)}}))}))}))}_get(e){return new Promise(((t,r)=>{const n=Date.now();this.client.get(e,((i,s)=>{s?this.client.get(`${e}_expire`,((e,i)=>{if(e)r(e);else{const e=!1===i?0:i,r={consumedPoints:s,msBeforeNext:e>=0?Math.max(e-n,0):-1};t(r)}})):t(null)}))}))}_delete(e){return new Promise(((t,r)=>{this.client.del(e,((n,i)=>{n?r(n):!1===i?t(i):this.client.del(`${e}_expire`,(e=>{e?r(e):t(i)}))}))}))}}e.exports=s},2288:function(e,t,r){const n=r(1352),i=r(8425),s=r(5155);class o extends n{constructor(e={}){super(e),this._memoryStorage=new i}consume(e,t=1,r={}){return new Promise(((n,i)=>{const s=this.getKey(e),o=this._getKeySecDuration(r);let a=this._memoryStorage.incrby(s,t,o);if(a.remainingPoints=Math.max(this.points-a.consumedPoints,0),a.consumedPoints>this.points)this.blockDuration>0&&a.consumedPoints<=this.points+t&&(a=this._memoryStorage.set(s,a.consumedPoints,this.blockDuration)),i(a);else if(this.execEvenly&&a.msBeforeNext>0&&!a.isFirstInDuration){let e=Math.ceil(a.msBeforeNext/(a.remainingPoints+2));e<this.execEvenlyMinDelayMs&&(e=a.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(n,e,a)}else n(a)}))}penalty(e,t=1,r={}){const n=this.getKey(e);return new Promise((e=>{const i=this._getKeySecDuration(r),s=this._memoryStorage.incrby(n,t,i);s.remainingPoints=Math.max(this.points-s.consumedPoints,0),e(s)}))}reward(e,t=1,r={}){const n=this.getKey(e);return new Promise((e=>{const i=this._getKeySecDuration(r),s=this._memoryStorage.incrby(n,-t,i);s.remainingPoints=Math.max(this.points-s.consumedPoints,0),e(s)}))}block(e,t){const r=1e3*t,n=this.points+1;return this._memoryStorage.set(this.getKey(e),n,t),Promise.resolve(new s(0,0===r?-1:r,n))}set(e,t,r){const n=1e3*(r>=0?r:this.duration);return this._memoryStorage.set(this.getKey(e),t,r),Promise.resolve(new s(0,0===n?-1:n,t))}get(e){const t=this._memoryStorage.get(this.getKey(e));return null!==t&&(t.remainingPoints=Math.max(this.points-t.consumedPoints,0)),Promise.resolve(t)}delete(e){return Promise.resolve(this._memoryStorage.delete(this.getKey(e)))}}e.exports=o},1391:function(e,t,r){const n=r(1090),i=r(5155);function s(e){try{const t=e.client?e.client:e,{version:r}=t.topology.s.options.metadata.driver,n=r.split(".").map((e=>parseInt(e)));return{major:n[0],feature:n[1],patch:n[2]}}catch(t){return{major:0,feature:0,patch:0}}}class o extends n{constructor(e){super(e),this.dbName=e.dbName,this.tableName=e.tableName,this.indexKeyPrefix=e.indexKeyPrefix,e.mongo?this.client=e.mongo:this.client=e.storeClient,"function"===typeof this.client.then?this.client.then((e=>{this.client=e,this._initCollection(),this._driverVersion=s(this.client)})):(this._initCollection(),this._driverVersion=s(this.client))}get dbName(){return this._dbName}set dbName(e){this._dbName="undefined"===typeof e?o.getDbName():e}static getDbName(){return"node-rate-limiter-flexible"}get tableName(){return this._tableName}set tableName(e){this._tableName="undefined"===typeof e?this.keyPrefix:e}get client(){return this._client}set client(e){if("undefined"===typeof e)throw new Error("mongo is not set");this._client=e}get indexKeyPrefix(){return this._indexKeyPrefix}set indexKeyPrefix(e){this._indexKeyPrefix=e||{}}_initCollection(){const e="function"===typeof this.client.db?this.client.db(this.dbName):this.client,t=e.collection(this.tableName);t.createIndex({expire:-1},{expireAfterSeconds:0}),t.createIndex(Object.assign({},this.indexKeyPrefix,{key:1}),{unique:!0}),this._collection=t}_getRateLimiterRes(e,t,r){const n=new i;let s;return s="undefined"===typeof r.value?r:r.value,n.isFirstInDuration=s.points===t,n.consumedPoints=s.points,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=null!==s.expire?Math.max(new Date(s.expire).getTime()-Date.now(),0):-1,n}_upsert(e,t,r,n=!1,i={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const s=i.attrs||{};let o,a;n?(o={key:e},o=Object.assign(o,s),a={$set:{key:e,points:t,expire:r>0?new Date(Date.now()+r):null}},a.$set=Object.assign(a.$set,s)):(o={$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}],key:e},o=Object.assign(o,s),a={$setOnInsert:{key:e,expire:r>0?new Date(Date.now()+r):null},$inc:{points:t}},a.$setOnInsert=Object.assign(a.$setOnInsert,s));const c={upsert:!0};return this._driverVersion.major>=4||3===this._driverVersion.major&&this._driverVersion.feature>=7||this._driverVersion.feature>=6&&this._driverVersion.patch>=7?c.returnDocument="after":c.returnOriginal=!1,new Promise(((i,l)=>{this._collection.findOneAndUpdate(o,a,c).then((e=>{i(e)})).catch((o=>{if(o&&11e3===o.code){const o=Object.assign({$or:[{expire:{$lte:new Date}},{expire:{$eq:null}}],key:e},s),a={$set:Object.assign({key:e,points:t,expire:r>0?new Date(Date.now()+r):null},s)};this._collection.findOneAndUpdate(o,a,c).then((e=>{i(e)})).catch((s=>{s&&11e3===s.code?this._upsert(e,t,r,n).then((e=>i(e))).catch((e=>l(e))):l(s)}))}else l(o)}))}))}_get(e,t={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const r=t.attrs||{},n=Object.assign({key:e,$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}]},r);return this._collection.findOne(n)}_delete(e,t={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const r=t.attrs||{},n=Object.assign({key:e},r);return this._collection.deleteOne(n).then((e=>e.deletedCount>0))}}e.exports=o},4156:function(e,t,r){const n=r(1090),i=r(5155);class s extends n{constructor(e,t=null){super(e),this.client=e.storeClient,this.clientType=e.storeType,this.dbName=e.dbName,this.tableName=e.tableName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?(this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"===typeof t&&t()):this._createDbAndTable().then((()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"===typeof t&&t()})).catch((e=>{if("function"!==typeof t)throw e;t(e)}))}clearExpired(e){return new Promise((t=>{this._getConnection().then((r=>{r.query("DELETE FROM ??.?? WHERE expire < ?",[this.dbName,this.tableName,e],(()=>{this._releaseConnection(r),t()}))})).catch((()=>{t()}))}))}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((()=>{this.clearExpired(Date.now()-36e5).then((()=>{this._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return new Promise(((e,t)=>{this.client.getConnection(((r,n)=>{if(r)return t(r);e(n)}))}));case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();default:return Promise.resolve(this.client)}}_releaseConnection(e){switch(this.clientType){case"pool":return e.release();case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e);default:return!0}}_createDbAndTable(){return new Promise(((e,t)=>{this._getConnection().then((r=>{r.query(`CREATE DATABASE IF NOT EXISTS \`${this.dbName}\`;`,(n=>{if(n)return this._releaseConnection(r),t(n);r.query(this._getCreateTableStmt(),(n=>{if(n)return this._releaseConnection(r),t(n);this._releaseConnection(r),e()}))}))})).catch((e=>{t(e)}))}))}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS \`${this.dbName}\`.\`${this.tableName}\` (\`key\` VARCHAR(255) CHARACTER SET utf8 NOT NULL,\`points\` INT(9) NOT NULL default 0,\`expire\` BIGINT UNSIGNED,PRIMARY KEY (\`key\`)) ENGINE = INNODB;`}get clientType(){return this._clientType}set clientType(e){if("undefined"===typeof e)if("Connection"===this.client.constructor.name)e="connection";else if("Pool"===this.client.constructor.name)e="pool";else{if("Sequelize"!==this.client.constructor.name)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}get dbName(){return this._dbName}set dbName(e){this._dbName="undefined"===typeof e?"rtlmtrflx":e}get tableName(){return this._tableName}set tableName(e){this._tableName="undefined"===typeof e?this.keyPrefix:e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated="undefined"!==typeof e&&!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout="undefined"===typeof e||Boolean(e)}_getRateLimiterRes(e,t,r){const n=new i,[s]=r;return n.isFirstInDuration=t===s.points,n.consumedPoints=n.isFirstInDuration?t:s.points,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=s.expire?Math.max(s.expire-Date.now(),0):-1,n}_upsertTransaction(e,t,r,n,i){return new Promise(((s,o)=>{e.query("BEGIN",(a=>{if(a)return e.rollback(),o(a);const c=Date.now(),l=n>0?c+n:null;let u,h;i?(u="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = ?, \n            expire = ?;",h=[this.dbName,this.tableName,t,r,l,r,l]):(u="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = IF(expire <= ?, ?, points + (?)), \n            expire = IF(expire <= ?, ?, expire);",h=[this.dbName,this.tableName,t,r,l,c,r,r,c,l]),e.query(u,h,(r=>{if(r)return e.rollback(),o(r);e.query("SELECT points, expire FROM ??.?? WHERE `key` = ?;",[this.dbName,this.tableName,t],((t,r)=>{if(t)return e.rollback(),o(t);e.query("COMMIT",(t=>{if(t)return e.rollback(),o(t);s(r)}))}))}))}))}))}_upsert(e,t,r,n=!1){return this.tableCreated?new Promise(((i,s)=>{this._getConnection().then((o=>{this._upsertTransaction(o,e,t,r,n).then((e=>{i(e),this._releaseConnection(o)})).catch((e=>{s(e),this._releaseConnection(o)}))})).catch((e=>{s(e)}))})):Promise.reject(Error("Table is not created yet"))}_get(e){return this.tableCreated?new Promise(((t,r)=>{this._getConnection().then((n=>{n.query("SELECT points, expire FROM ??.?? WHERE `key` = ? AND (`expire` > ? OR `expire` IS NULL)",[this.dbName,this.tableName,e,Date.now()],((e,i)=>{e?r(e):0===i.length?t(null):t(i),this._releaseConnection(n)}))})).catch((e=>{r(e)}))})):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?new Promise(((t,r)=>{this._getConnection().then((n=>{n.query("DELETE FROM ??.?? WHERE `key` = ?",[this.dbName,this.tableName,e],((e,i)=>{e?r(e):t(i.affectedRows>0),this._releaseConnection(n)}))})).catch((e=>{r(e)}))})):Promise.reject(Error("Table is not created yet"))}}e.exports=s},4832:function(e,t,r){const n=r(1090),i=r(5155);class s extends n{constructor(e,t=null){super(e),this.client=e.storeClient,this.clientType=e.storeType,this.tableName=e.tableName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?"function"===typeof t&&t():this._createTable().then((()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"===typeof t&&t()})).catch((e=>{if("function"!==typeof t)throw e;t(e)}))}clearExpired(e){return new Promise((t=>{const r={name:"rlflx-clear-expired",text:`DELETE FROM ${this.tableName} WHERE expire < $1`,values:[e]};this._query(r).then((()=>{t()})).catch((()=>{t()}))}))}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((()=>{this.clearExpired(Date.now()-36e5).then((()=>{this._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return Promise.resolve(this.client);case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();case"typeorm":return Promise.resolve(this.client.driver.master);default:return Promise.resolve(this.client)}}_releaseConnection(e){switch(this.clientType){case"pool":return!0;case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e);case"typeorm":return!0;default:return!0}}_createTable(){return new Promise(((e,t)=>{this._query({text:this._getCreateTableStmt()}).then((()=>{e()})).catch((r=>{"23505"===r.code?e():t(r)}))}))}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS ${this.tableName} ( \n      key varchar(255) PRIMARY KEY,\n      points integer NOT NULL DEFAULT 0,\n      expire bigint\n    );`}get clientType(){return this._clientType}set clientType(e){const t=this.client.constructor.name;if("undefined"===typeof e)if("Client"===t)e="client";else if("Pool"===t||"BoundPool"===t)e="pool";else{if("Sequelize"!==t)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}get tableName(){return this._tableName}set tableName(e){this._tableName="undefined"===typeof e?this.keyPrefix:e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated="undefined"!==typeof e&&!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout="undefined"===typeof e||Boolean(e)}_getRateLimiterRes(e,t,r){const n=new i,s=r.rows[0];return n.isFirstInDuration=t===s.points,n.consumedPoints=n.isFirstInDuration?t:s.points,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=s.expire?Math.max(s.expire-Date.now(),0):-1,n}_query(e){const t=this.tableName.toLowerCase(),r={name:`${t}:${e.name}`,text:e.text,values:e.values};return new Promise(((e,t)=>{this._getConnection().then((n=>{n.query(r).then((t=>{e(t),this._releaseConnection(n)})).catch((e=>{t(e),this._releaseConnection(n)}))})).catch((e=>{t(e)}))}))}_upsert(e,t,r,n=!1){if(!this.tableCreated)return Promise.reject(Error("Table is not created yet"));const i=r>0?Date.now()+r:null,s=n?" $3 ":` CASE\n             WHEN ${this.tableName}.expire <= $4 THEN $3\n             ELSE ${this.tableName}.expire\n            END `;return this._query({name:n?"rlflx-upsert-force":"rlflx-upsert",text:`\n            INSERT INTO ${this.tableName} VALUES ($1, $2, $3)\n              ON CONFLICT(key) DO UPDATE SET\n                points = CASE\n                          WHEN (${this.tableName}.expire <= $4 OR 1=${n?1:0}) THEN $2\n                          ELSE ${this.tableName}.points + ($2)\n                         END,\n                expire = ${s}\n            RETURNING points, expire;`,values:[e,t,i,Date.now()]})}_get(e){return this.tableCreated?new Promise(((t,r)=>{this._query({name:"rlflx-get",text:`\n            SELECT points, expire FROM ${this.tableName} WHERE key = $1 AND (expire > $2 OR expire IS NULL);`,values:[e,Date.now()]}).then((e=>{0===e.rowCount&&(e=null),t(e)})).catch((e=>{r(e)}))})):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?this._query({name:"rlflx-delete",text:`DELETE FROM ${this.tableName} WHERE key = $1`,values:[e]}).then((e=>e.rowCount>0)):Promise.reject(Error("Table is not created yet"))}}e.exports=s},8686:function(e,t,r){const n=r(5255),i=4294967295,s="limiter";e.exports=class{constructor(e,t={maxQueueSize:i}){this._queueLimiters={KEY_DEFAULT:new o(e,t)},this._limiterFlexible=e,this._maxQueueSize=t.maxQueueSize}getTokensRemaining(e=s){return this._queueLimiters[e]?this._queueLimiters[e].getTokensRemaining():Promise.resolve(this._limiterFlexible.points)}removeTokens(e,t=s){return this._queueLimiters[t]||(this._queueLimiters[t]=new o(this._limiterFlexible,{key:t,maxQueueSize:this._maxQueueSize})),this._queueLimiters[t].removeTokens(e)}};class o{constructor(e,t={maxQueueSize:i,key:s}){this._key=t.key,this._waitTimeout=null,this._queue=[],this._limiterFlexible=e,this._maxQueueSize=t.maxQueueSize}getTokensRemaining(){return this._limiterFlexible.get(this._key).then((e=>null!==e?e.remainingPoints:this._limiterFlexible.points))}removeTokens(e){const t=this;return new Promise(((r,i)=>{e>t._limiterFlexible.points?i(new n(`Requested tokens ${e} exceeds maximum ${t._limiterFlexible.points} tokens per interval`)):t._queue.length>0?t._queueRequest.call(t,r,i,e):t._limiterFlexible.consume(t._key,e).then((e=>{r(e.remainingPoints)})).catch((n=>{n instanceof Error?i(n):(t._queueRequest.call(t,r,i,e),null===t._waitTimeout&&(t._waitTimeout=setTimeout(t._processFIFO.bind(t),n.msBeforeNext)))}))}))}_queueRequest(e,t,r){const i=this;i._queue.length<i._maxQueueSize?i._queue.push({resolve:e,reject:t,tokens:r}):t(new n(`Number of requests reached it's maximum ${i._maxQueueSize}`))}_processFIFO(){const e=this;if(null!==e._waitTimeout&&(clearTimeout(e._waitTimeout),e._waitTimeout=null),0===e._queue.length)return;const t=e._queue.shift();e._limiterFlexible.consume(e._key,t.tokens).then((r=>{t.resolve(r.remainingPoints),e._processFIFO.call(e)})).catch((r=>{r instanceof Error?(t.reject(r),e._processFIFO.call(e)):(e._queue.unshift(t),null===e._waitTimeout&&(e._waitTimeout=setTimeout(e._processFIFO.bind(e),r.msBeforeNext)))}))}}},4636:function(e,t,r){const n=r(1090),i=r(5155),s="redis.call('set', KEYS[1], 0, 'EX', ARGV[2], 'NX') local consumed = redis.call('incrby', KEYS[1], ARGV[1]) local ttl = redis.call('pttl', KEYS[1]) if ttl == -1 then   redis.call('expire', KEYS[1], ARGV[2])   ttl = 1000 * ARGV[2] end return {consumed, ttl} ";class o extends n{constructor(e){super(e),e.redis?this.client=e.redis:this.client=e.storeClient,this._rejectIfRedisNotReady=!!e.rejectIfRedisNotReady,"function"===typeof this.client.defineCommand&&this.client.defineCommand("rlflxIncr",{numberOfKeys:1,lua:s})}_isRedisReady(){return!this._rejectIfRedisNotReady||(!this.client.status||"ready"===this.client.status)&&!("function"===typeof this.client.isReady&&!this.client.isReady())}_getRateLimiterRes(e,t,r){let[n,s]=r;Array.isArray(n)&&([,n]=n,[,s]=s);const o=new i;return o.consumedPoints=parseInt(n),o.isFirstInDuration=o.consumedPoints===t,o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o.msBeforeNext=s,o}_upsert(e,t,r,n=!1){return new Promise(((i,o)=>{if(!this._isRedisReady())return o(new Error("Redis connection is not ready"));const a=Math.floor(r/1e3),c=this.client.multi();if(n)a>0?c.set(e,t,"EX",a):c.set(e,t),c.pttl(e).exec(((e,t)=>e?o(e):i(t)));else if(a>0){const r=function(e,t){return e?o(e):i(t)};"function"===typeof this.client.rlflxIncr?this.client.rlflxIncr(e,t,a,r):this.client.eval(s,1,e,t,a,r)}else c.incrby(e,t).pttl(e).exec(((e,t)=>e?o(e):i(t)))}))}_get(e){return new Promise(((t,r)=>{if(!this._isRedisReady())return r(new Error("Redis connection is not ready"));this.client.multi().get(e).pttl(e).exec(((e,n)=>{if(e)r(e);else{const[e]=n;if(null===e)return t(null);t(n)}}))}))}_delete(e){return new Promise(((t,r)=>{this.client.del(e,((e,n)=>{e?r(e):t(n>0)}))}))}}e.exports=o},5155:function(e){e.exports=class{constructor(e,t,r,n){this.remainingPoints="undefined"===typeof e?0:e,this.msBeforeNext="undefined"===typeof t?0:t,this.consumedPoints="undefined"===typeof r?0:r,this.isFirstInDuration="undefined"!==typeof n&&n}get msBeforeNext(){return this._msBeforeNext}set msBeforeNext(e){return this._msBeforeNext=e,this}get remainingPoints(){return this._remainingPoints}set remainingPoints(e){return this._remainingPoints=e,this}get consumedPoints(){return this._consumedPoints}set consumedPoints(e){return this._consumedPoints=e,this}get isFirstInDuration(){return this._isFirstInDuration}set isFirstInDuration(e){this._isFirstInDuration=Boolean(e)}_getDecoratedProperties(){return{remainingPoints:this.remainingPoints,msBeforeNext:this.msBeforeNext,consumedPoints:this.consumedPoints,isFirstInDuration:this.isFirstInDuration}}[Symbol.for("nodejs.util.inspect.custom")](){return this._getDecoratedProperties()}toString(){return JSON.stringify(this._getDecoratedProperties())}toJSON(){return this._getDecoratedProperties()}}},1090:function(e,t,r){const n=r(1352),i=r(2423),s=r(5155);e.exports=class extends n{constructor(e={}){super(e),this.inMemoryBlockOnConsumed=e.inMemoryBlockOnConsumed||e.inmemoryBlockOnConsumed,this.inMemoryBlockDuration=e.inMemoryBlockDuration||e.inmemoryBlockDuration,this.insuranceLimiter=e.insuranceLimiter,this._inMemoryBlockedKeys=new i}get client(){return this._client}set client(e){if("undefined"===typeof e)throw new Error("storeClient is not set");this._client=e}_afterConsume(e,t,r,n,i,s={}){const o=this._getRateLimiterRes(r,n,i);if(this.inMemoryBlockOnConsumed>0&&!(this.inMemoryBlockDuration>0)&&o.consumedPoints>=this.inMemoryBlockOnConsumed)return this._inMemoryBlockedKeys.addMs(r,o.msBeforeNext),o.consumedPoints>this.points?t(o):e(o);if(o.consumedPoints>this.points){let e=Promise.resolve();this.blockDuration>0&&o.consumedPoints<=this.points+n&&(o.msBeforeNext=this.msBlockDuration,e=this._block(r,o.consumedPoints,this.msBlockDuration,s)),this.inMemoryBlockOnConsumed>0&&o.consumedPoints>=this.inMemoryBlockOnConsumed&&(this._inMemoryBlockedKeys.add(r,this.inMemoryBlockDuration),o.msBeforeNext=this.msInMemoryBlockDuration),e.then((()=>{t(o)})).catch((e=>{t(e)}))}else if(this.execEvenly&&o.msBeforeNext>0&&!o.isFirstInDuration){let t=Math.ceil(o.msBeforeNext/(o.remainingPoints+2));t<this.execEvenlyMinDelayMs&&(t=o.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(e,t,o)}else e(o)}_handleError(e,t,r,i,s,o=!1,a={}){this.insuranceLimiter instanceof n?this.insuranceLimiter[t](s,o,a).then((e=>{r(e)})).catch((e=>{i(e)})):i(e)}get _inmemoryBlockedKeys(){return this._inMemoryBlockedKeys}getInmemoryBlockMsBeforeExpire(e){return this.getInMemoryBlockMsBeforeExpire(e)}get inmemoryBlockOnConsumed(){return this.inMemoryBlockOnConsumed}set inmemoryBlockOnConsumed(e){this.inMemoryBlockOnConsumed=e}get inmemoryBlockDuration(){return this.inMemoryBlockDuration}set inmemoryBlockDuration(e){this.inMemoryBlockDuration=e}get msInmemoryBlockDuration(){return 1e3*this.inMemoryBlockDuration}getInMemoryBlockMsBeforeExpire(e){return this.inMemoryBlockOnConsumed>0?this._inMemoryBlockedKeys.msBeforeExpire(e):0}get inMemoryBlockOnConsumed(){return this._inMemoryBlockOnConsumed}set inMemoryBlockOnConsumed(e){if(this._inMemoryBlockOnConsumed=e?parseInt(e):0,this.inMemoryBlockOnConsumed>0&&this.points>this.inMemoryBlockOnConsumed)throw new Error('inMemoryBlockOnConsumed option must be greater or equal "points" option')}get inMemoryBlockDuration(){return this._inMemoryBlockDuration}set inMemoryBlockDuration(e){if(this._inMemoryBlockDuration=e?parseInt(e):0,this.inMemoryBlockDuration>0&&0===this.inMemoryBlockOnConsumed)throw new Error("inMemoryBlockOnConsumed option must be set up")}get msInMemoryBlockDuration(){return 1e3*this._inMemoryBlockDuration}get insuranceLimiter(){return this._insuranceLimiter}set insuranceLimiter(e){if("undefined"!==typeof e&&!(e instanceof n))throw new Error("insuranceLimiter must be instance of RateLimiterAbstract");this._insuranceLimiter=e,this._insuranceLimiter&&(this._insuranceLimiter.blockDuration=this.blockDuration,this._insuranceLimiter.execEvenly=this.execEvenly)}block(e,t,r={}){const n=1e3*t;return this._block(this.getKey(e),this.points+1,n,r)}set(e,t,r,n={}){const i=1e3*(r>=0?r:this.duration);return this._block(this.getKey(e),t,i,n)}consume(e,t=1,r={}){return new Promise(((n,i)=>{const o=this.getKey(e),a=this.getInMemoryBlockMsBeforeExpire(o);if(a>0)return i(new s(0,a));this._upsert(o,t,1e3*this._getKeySecDuration(r),!1,r).then((e=>{this._afterConsume(n,i,o,t,e)})).catch((s=>{this._handleError(s,"consume",n,i,e,t,r)}))}))}penalty(e,t=1,r={}){const n=this.getKey(e);return new Promise(((i,s)=>{this._upsert(n,t,1e3*this._getKeySecDuration(r),!1,r).then((e=>{i(this._getRateLimiterRes(n,t,e))})).catch((n=>{this._handleError(n,"penalty",i,s,e,t,r)}))}))}reward(e,t=1,r={}){const n=this.getKey(e);return new Promise(((i,s)=>{this._upsert(n,-t,1e3*this._getKeySecDuration(r),!1,r).then((e=>{i(this._getRateLimiterRes(n,-t,e))})).catch((n=>{this._handleError(n,"reward",i,s,e,t,r)}))}))}get(e,t={}){const r=this.getKey(e);return new Promise(((n,i)=>{this._get(r,t).then((e=>{n(null===e||"undefined"===typeof e?null:this._getRateLimiterRes(r,0,e))})).catch((r=>{this._handleError(r,"get",n,i,e,t)}))}))}delete(e,t={}){const r=this.getKey(e);return new Promise(((n,i)=>{this._delete(r,t).then((e=>{this._inMemoryBlockedKeys.delete(r),n(e)})).catch((r=>{this._handleError(r,"delete",n,i,e,t)}))}))}deleteInMemoryBlockedAll(){this._inMemoryBlockedKeys.delete()}_getRateLimiterRes(e,t,r){throw new Error("You have to implement the method '_getRateLimiterRes'!")}_block(e,t,r,n={}){return new Promise(((i,o)=>{this._upsert(e,t,r,!0,n).then((()=>{i(new s(0,r>0?r:-1,t))})).catch((t=>{this._handleError(t,"block",i,o,this.parseKey(e),r/1e3,n)}))}))}_get(e,t={}){throw new Error("You have to implement the method '_get'!")}_delete(e,t={}){throw new Error("You have to implement the method '_delete'!")}_upsert(e,t,r,n=!1,i={}){throw new Error("You have to implement the method '_upsert'!")}}},3766:function(e,t,r){const n=r(1352);e.exports=class{constructor(...e){if(e.length<1)throw new Error("RateLimiterUnion: at least one limiter have to be passed");e.forEach((e=>{if(!(e instanceof n))throw new Error("RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract")})),this._limiters=e}consume(e,t=1){return new Promise(((r,n)=>{const i=[];this._limiters.forEach((r=>{i.push(r.consume(e,t).catch((e=>({rejected:!0,rej:e}))))})),Promise.all(i).then((e=>{const t={};let i=!1;e.forEach((e=>{!0===e.rejected&&(i=!0)}));for(let r=0;r<e.length;r++)i&&!0===e[r].rejected?t[this._limiters[r].keyPrefix]=e[r].rej:i||(t[this._limiters[r].keyPrefix]=e[r]);i?n(t):r(t)}))}))}}},8894:function(e){e.exports=class{constructor(){this._keys={},this._addedKeysAmount=0}collectExpired(){const e=Date.now();Object.keys(this._keys).forEach((t=>{this._keys[t]<=e&&delete this._keys[t]})),this._addedKeysAmount=Object.keys(this._keys).length}add(e,t){this.addMs(e,1e3*t)}addMs(e,t){this._keys[e]=Date.now()+t,this._addedKeysAmount++,this._addedKeysAmount>999&&this.collectExpired()}msBeforeExpire(e){const t=this._keys[e];if(t&&t>=Date.now()){this.collectExpired();const e=Date.now();return t>=e?t-e:0}return 0}delete(e){e?delete this._keys[e]:Object.keys(this._keys).forEach((e=>{delete this._keys[e]}))}}},2423:function(e,t,r){const n=r(8894);e.exports=n},8425:function(e,t,r){const n=r(9250),i=r(5155);e.exports=class{constructor(){this._storage={}}incrby(e,t,r){if(this._storage[e]){const n=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return 0!==n?(this._storage[e].value=this._storage[e].value+t,new i(0,n,this._storage[e].value,!1)):this.set(e,t,r)}return this.set(e,t,r)}set(e,t,r){const s=1e3*r;return this._storage[e]&&this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),this._storage[e]=new n(t,s>0?new Date(Date.now()+s):null),s>0&&(this._storage[e].timeoutId=setTimeout((()=>{delete this._storage[e]}),s),this._storage[e].timeoutId.unref&&this._storage[e].timeoutId.unref()),new i(0,0===s?-1:s,this._storage[e].value,!0)}get(e){if(this._storage[e]){const t=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return new i(0,t,this._storage[e].value,!1)}return null}delete(e){return!!this._storage[e]&&(this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),delete this._storage[e],!0)}}},9250:function(e){e.exports=class{constructor(e,t,r=null){this.value=e,this.expiresAt=t,this.timeoutId=r}get value(){return this._value}set value(e){this._value=parseInt(e)}get expiresAt(){return this._expiresAt}set expiresAt(e){e instanceof Date||!Number.isInteger(e)||(e=new Date(e)),this._expiresAt=e}get timeoutId(){return this._timeoutId}set timeoutId(e){this._timeoutId=e}}},5255:function(e){e.exports=class extends Error{constructor(e,t){super(),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="CustomError",this.message=e,t&&(this.extra=t)}}},3692:function(e,t,r){"use strict";e.exports=a;var n=r(7824),i=a.prototype,s=new Date%1e9;function o(){return(1e9*Math.random()>>>0)+s++}function a(e){e=e||{},this.id=e.id||o(),this.max=e.max||1/0,this.items=e.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(e.lastModified||new Date);for(var t,r,n=this.items.length;n--;)t=this.items[n],r=new Date(t.expires)-new Date,this._lookup[t.key]=t,r>0?this.expire(t.key,r):r<=0&&this.delete(t.key)}i.has=function(e){return e in this._lookup},i.get=function(e){if(!this.has(e))return null;var t=this._lookup[e];return t.refresh&&this.expire(e,t.refresh),this.items.splice(this.items.indexOf(t),1),this.items.push(t),t.value},i.meta=function(e){if(!this.has(e))return null;var t=this._lookup[e];return"meta"in t?t.meta:null},i.set=function(e,t,r){var n=this._lookup[e],i=this._lookup[e]={key:e,value:t};return this.lastModified=new Date,n?(clearTimeout(n.timeout),this.items.splice(this.items.indexOf(n),1,i)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(i),this.size++),r&&("ttl"in r&&this.expire(e,r.ttl),"meta"in r&&(i.meta=r.meta),r.refresh&&(i.refresh=r.ttl)),this},i.delete=function(e){var t=this._lookup[e];return!!t&&(this.lastModified=new Date,this.items.splice(this.items.indexOf(t),1),clearTimeout(t.timeout),delete this._lookup[e],this.size--,this)},i.expire=function(e,t){var r=t||0,i=this._lookup[e];if(!i)return this;if("string"===typeof r&&(r=n(t)),"number"!==typeof r)throw new TypeError("Expiration time must be a string or number.");return clearTimeout(i.timeout),i.timeout=setTimeout(this.delete.bind(this,i.key),r),i.expires=Number(new Date)+r,this},i.clear=function(){for(var e=this.items.length;e--;)this.delete(this.items[e].key);return this},i.toJSON=function(){for(var e,t=new Array(this.items.length),r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}},2916:function(e,t,r){"use strict";const n=r(1807);class i{constructor(e,t,r){const i=this;this._started=n(),this._rescheduled=0,this._scheduled=t,this._args=r,this._triggered=!1,this._timerWrapper=()=>{i._rescheduled>0?(i._scheduled=i._rescheduled-(n()-i._started),i._schedule(i._scheduled)):(i._triggered=!0,e.apply(null,i._args))},this._timer=setTimeout(this._timerWrapper,t)}reschedule(e){e||(e=this._scheduled);const t=n();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=n(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}}function s(){if("function"!==typeof arguments[0])throw new Error("callback needed");if("number"!==typeof arguments[1])throw new Error("timeout needed");let e;if(arguments.length>0){e=new Array(arguments.length-2);for(var t=0;t<e.length;t++)e[t]=arguments[t+2]}return new i(arguments[0],arguments[1],e)}e.exports=s},1807:function(e){"use strict";e.exports=function(){return Date.now()}},9967:function(e,t,r){
/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.exports=i;const n=r(4375);function i(e,t,r){if("number"!==typeof t)throw new Error("second argument must be a Number");let i,s,o,a,c,l,u=!0;function h(e){function t(){r&&r(e,i),r=null}u?n(t):t()}function d(t,r,n){if(i[t]=n,r&&(c=!0),0===--o||r)h(r);else if(!c&&l<s){let t;a?(t=a[l],l+=1,e[t]((function(e,r){d(t,e,r)}))):(t=l,l+=1,e[t]((function(e,r){d(t,e,r)})))}}Array.isArray(e)?(i=[],o=s=e.length):(a=Object.keys(e),i={},o=s=a.length),l=t,o?a?a.some((function(r,n){return e[r]((function(e,t){d(r,e,t)})),n===t-1})):e.some((function(e,r){return e((function(e,t){d(r,e,t)})),r===t-1})):h(null),u=!1}},9509:function(e,t,r){
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var n=r(8764),i=n.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=o),o.prototype=Object.create(i.prototype),s(i,o),o.from=function(e,t,r){if("number"===typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},o.alloc=function(e,t,r){if("number"!==typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"===typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!==typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!==typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},202:function(e,t,r){"use strict";var n=r(3700),i=/[\/\?<>\\:\*\|"]/g,s=/[\x00-\x1f\x80-\x9f]/g,o=/^\.+$/,a=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,c=/[\. ]+$/;function l(e,t){if("string"!==typeof e)throw new Error("Input must be string");var r=e.replace(i,t).replace(s,t).replace(o,t).replace(a,t).replace(c,t);return n(r,255)}e.exports=function(e,t){var r=t&&t.replacement||"",n=l(e,r);return""===r?n:l(n,"")}},7695:function(e){"use strict";const t=new Map,r=()=>`${Date.now()}:${Math.floor(1e6*Math.random())}`;async function n(e,r,n){while(t.get(n)){try{await e()}catch(i){setTimeout((()=>{throw i}),1);break}if(!t.get(n))break;await new Promise((e=>{const i=setTimeout(e,r);t.set(n,i)}))}}function i(e,i,s){s=s||i;const o=r(),a=setTimeout((()=>{n(e,i,o)}),s);return t.set(o,a),o}function s(e){const r=t.get(e);r&&(clearTimeout(r),t.delete(e))}e.exports={setDelayedInterval:i,clearDelayedInterval:s}},544:function(e){"use strict";const t=7;function r(e,t){return e+n(t)}function n(e){let t=e;return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),16843009*(t+(t>>4)&252645135)>>24}function i(e,t){return e[0]-t[0]}function s(e){return e[1]}e.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,t){let r=this._internalPositionFor(e,!1);if(void 0===t)-1!==r&&(this._unsetInternalPos(r),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let n=!1;-1===r?(r=this._data.length,this._setBit(e),this._changedData=!0):n=!0,this._setInternalPos(r,e,t,n),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();const t=this._internalPositionFor(e,!0);if(-1!==t)return this._data[t][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){const e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let t=0;while(t<this.length)e(this.get(t),t,this),t++}map(e){let t=0,r=new Array(this.length);while(t<this.length)r[t]=e(this.get(t),t,this),t++;return r}reduce(e,t){let r=0,n=t;while(r<this.length){const t=this.get(r);n=e(n,t,r),r++}return n}find(e){let t,r,n=0;while(n<this.length&&!t)r=this.get(n),t=e(r),n++;return t?r:void 0}_internalPositionFor(e,i){const s=this._bytePosFor(e,i);if(s>=this._bitArrays.length)return-1;const o=this._bitArrays[s],a=e-s*t,c=(o&1<<a)>0;if(!c)return-1;const l=this._bitArrays.slice(0,s).reduce(r,0),u=~(4294967295<<a+1),h=n(o&u),d=l+h-1;return d}_bytePosFor(e,r){const n=Math.floor(e/t),i=n+1;while(!r&&this._bitArrays.length<i)this._bitArrays.push(0);return n}_setBit(e){const r=this._bytePosFor(e,!1);this._bitArrays[r]|=1<<e-r*t}_unsetBit(e){const r=this._bytePosFor(e,!1);this._bitArrays[r]&=~(1<<e-r*t)}_setInternalPos(e,t,r,n){const i=this._data,s=[t,r];if(n)this._sortData(),i[e]=s;else{if(i.length)if(i[i.length-1][0]>=t)i.push(s);else if(i[0][0]<=t)i.unshift(s);else{const e=Math.round(i.length/2);this._data=i.slice(0,e).concat(s).concat(i.slice(e))}else this._data.push(s);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(i),this._changedData=!1}bitField(){const e=[];let t,r=8,n=0,i=0;const s=this._bitArrays.slice();while(s.length||n){0===n&&(t=s.shift(),n=7);const o=Math.min(n,r),a=~(255<<o),c=t&a;i|=c<<8-r,t>>>=o,n-=o,r-=o,r&&(n||s.length)||(e.push(i),i=0,r=8)}for(var o=e.length-1;o>0;o--){const t=e[o];if(0!==t)break;e.pop()}return e}compactArray(){return this._sortData(),this._data.map(s)}}},590:function(e){e.exports=e=>{if(e[Symbol.asyncIterator])return e;if(e.getReader)return async function*(){const t=e.getReader();try{while(1){const{done:e,value:r}=await t.read();if(e)return;yield r}}finally{t.releaseLock()}}();throw new Error("unknown stream")}},715:function(e,t,r){"use strict";const{AbortController:n}=globalThis,i=r(2916);class s extends n{constructor(e){super(),this._ms=e,this._timer=i((()=>this.abort()),e),Object.setPrototypeOf(this,s.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=i((()=>this.abort()),this._ms)}}e.exports={TimeoutController:s}},4957:function(e){
/**
 * Timestamp for 64-bit time_t, nanosecond precision and strftime
 *
 * @author Yusuke Kawasaki
 * @license MIT
 * @see https://github.com/kawanet/timestamp-nano
 */
(function(){e.exports=w;var t=86400,r=3200,n=146097*r/400,i=t*n,s=1e3*i,o=1e11*t,a=16777216,c=4294967296,l=1e6,u=1e9,h="000000000",d=Math.trunc||L,f=w.prototype;w.fromDate=C,w.fromInt64BE=O(0,1,2,3,0,4),w.fromInt64LE=O(3,2,1,0,4,0),w.fromString=I,w.fromTimeT=k,f.year=0,f.time=0,f.nano=0,f.addNano=S,f.getNano=A,f.getTimeT=R,f.getYear=b,f.toDate=E,f.toJSON=P,f.toString=x,f.writeInt64BE=D(0,1,2,3,0,4),f.writeInt64LE=D(3,2,1,0,4,0);var p="%Y-%m-%dT%H:%M:%S.%NZ",y=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],m={"%":"%",F:"%Y-%m-%d",n:"\n",R:"%H:%M",T:"%H:%M:%S",t:"\t",X:"%T",Z:"GMT",z:"+0000"};return w;function w(e,t,r){var n=this;if(!(n instanceof w))return new w(e,t,r);n.time=+e||0,n.nano=+t||0,n.year=+r||0,v(n)}function b(){var e=this.toDate().getUTCFullYear();return e+this.year}function v(e){var t,n,i=e.year,a=e.time,c=e.nano;if(c<0||l<=c){var u=Math.floor(c/l);c-=u*l,a+=u,t=1}var h=i%r;if(a<-o||o<a||h){n=d(a/s),n&&(i+=n*r,a-=n*s);var f=_(a);f.setUTCFullYear(h+f.getUTCFullYear()),i-=h,a=+f,n=d(i/r);var p=a+n*s;n&&-o<=p&&p<=o&&(i-=n*r,a=p),t=1}return t&&(e.year=i,e.time=a,e.nano=c),e}function E(){var e=v(this);return _(e.time)}function _(e){var t=new Date(0);return t.setTime(e),t}function S(e){return this.nano+=+e||0,this}function A(){var e=v(this);return(e.time%1e3*l+ +e.nano+u)%u}function I(e){var t,r=new w;e+="";var n=e.replace(/^\s*[+\-]?\d+/,(function(e){var t=+e,n=1970+(t-1970)%400;return r.year=t-n,n})).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,(function(e,r,n){return r<0&&(n*=-1),t=6e4*(60*+r+ +n),""})).replace(/\.\d+$/,(function(e){return r.nano=+(e+h).substr(1,9),""})).split(/\D+/);if(n.length>1?n[1]--:n[1]=0,r.time=t=Date.UTC.apply(Date,n)-(t||0),isNaN(t))throw new TypeError("Invalid Date");return v(r)}function C(e){return new w(+e)}function k(e){return T(e,0)}function T(e,t){t|=0,t*=c,e=+e||0;var n=d(t/i)+d(e/i),s=t%i+e%i,o=d(s/i);return o&&(n+=o,s-=o*i),new w(1e3*s,0,n*r)}function R(){var e=v(this),i=Math.floor(e.time/1e3),s=e.year;return s&&(i+=s*n*t/r),i}function P(){return this.toString().replace(/0{1,6}Z$/,"Z")}function x(e){var t=this,r=t.toDate(),n={H:l,L:d,M:u,N:f,S:h,Y:s,a:w,b:b,d:a,e:c,m:o};return i(e||p);function i(e){return e.replace(/%./g,(function(e){var t=e[1],r=m[t],s=n[t];return r?i(r):s?s():e}))}function s(){var e=t.getYear();return e>999999?"+"+e:e>9999?"+"+M(e,6):e>=0?M(e,4):e>=-999999?"-"+M(-e,6):e}function o(){return U(r.getUTCMonth()+1)}function a(){return U(r.getUTCDate())}function c(){return B(r.getUTCDate())}function l(){return U(r.getUTCHours())}function u(){return U(r.getUTCMinutes())}function h(){return U(r.getUTCSeconds())}function d(){return M(r.getUTCMilliseconds(),3)}function f(){return M(t.getNano(),9)}function w(){return g[r.getUTCDay()]}function b(){return y[r.getUTCMonth()]}}function D(e,i,s,o,a,l){return u;function u(e,i){var s=v(this);e||(e=new Array(8)),N(e,i|=0);var o=Math.floor(s.time/1e3),u=s.year*(n*t/r),f=d(u/c)+d(o/c),p=u%c+o%c,y=Math.floor(p/c);return y&&(f+=y,p-=y*c),h(e,i+a,f),h(e,i+l,p),e}function h(t,r,n){t[r+e]=n>>24&255,t[r+i]=n>>16&255,t[r+s]=n>>8&255,t[r+o]=255&n}}function O(e,t,r,n,i,s){return o;function o(e,t){N(e,t|=0);var r=c(e,t+i),n=c(e,t+s);return T(n,r)}function c(i,s){return i[s+e]*a+(i[s+t]<<16|i[s+r]<<8|i[s+n])}}function N(e,t){var r=e&&e.length;if(null==r)throw new TypeError("Invalid Buffer");if(r<t+8)throw new RangeError("Out of range")}function L(e){var t=e-e%1;return 0===t&&(e<0||0===e&&1/e!==1/0)?-0:t}function B(e){return(e>9?"":" ")+(0|e)}function U(e){return(e>9?"":"0")+(0|e)}function M(e,t){return(h+(0|e)).substr(-t)}})()},3700:function(e,t,r){"use strict";var n=r(1156),i=r(793);e.exports=n.bind(null,i)},1156:function(e){"use strict";function t(e){return e>=55296&&e<=56319}function r(e){return e>=56320&&e<=57343}e.exports=function(e,n,i){if("string"!==typeof n)throw new Error("Input must be string");for(var s,o,a=n.length,c=0,l=0;l<a;l+=1){if(s=n.charCodeAt(l),o=n[l],t(s)&&r(n.charCodeAt(l+1))&&(l+=1,o+=n[l]),c+=e(o),c===i)return n.slice(0,l+1);if(c>i)return n.slice(0,l-o.length+1)}return n}},793:function(e){"use strict";function t(e){return e>=55296&&e<=56319}function r(e){return e>=56320&&e<=57343}e.exports=function(e){if("string"!==typeof e)throw new Error("Input must be string");for(var n=e.length,i=0,s=null,o=null,a=0;a<n;a++)s=e.charCodeAt(a),r(s)?null!=o&&t(o)?i+=1:i+=3:s<=127?i+=1:s>=128&&s<=2047?i+=2:s>=2048&&s<=65535&&(i+=3),o=s;return i}},3209:function(e){e.exports=n;var t=128,r=127;function n(e,i){var s,o=0,a=(i=i||0,0),c=i,l=e.length;do{if(c>=l)throw n.bytes=0,new RangeError("Could not decode varint");s=e[c++],o+=a<28?(s&r)<<a:(s&r)*Math.pow(2,a),a+=7}while(s>=t);return n.bytes=c-i,o}},7089:function(e){e.exports=s;var t=128,r=127,n=~r,i=Math.pow(2,31);function s(e,r,o){r=r||[],o=o||0;var a=o;while(e>=i)r[o++]=255&e|t,e/=128;while(e&n)r[o++]=255&e|t,e>>>=7;return r[o]=0|e,s.bytes=o-a+1,r}},3924:function(e,t,r){e.exports={encode:r(7089),decode:r(3209),encodingLength:r(4146)}},4146:function(e){var t=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),i=Math.pow(2,28),s=Math.pow(2,35),o=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),l=Math.pow(2,63);e.exports=function(e){return e<t?1:e<r?2:e<n?3:e<i?4:e<s?5:e<o?6:e<a?7:e<c?8:e<l?9:10}},2838:function(e,t,r){"use strict";const n=r(3924);e.exports=e=>{if(!(e instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");const t=[];while(e.length>0){const r=n.decode(e);t.push(r),e=e.slice(n.decode.bytes)}return t}},6988:function(e){e.exports=n;var t=128,r=127;function n(e,i){var s,o=0,a=(i=i||0,0),c=i,l=e.length;do{if(c>=l||a>49)throw n.bytes=0,new RangeError("Could not decode varint");s=e[c++],o+=a<28?(s&r)<<a:(s&r)*Math.pow(2,a),a+=7}while(s>=t);return n.bytes=c-i,o}},1312:function(e){e.exports=s;var t=128,r=127,n=~r,i=Math.pow(2,31);function s(e,r,o){if(Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw s.bytes=0,new RangeError("Could not encode varint");r=r||[],o=o||0;var a=o;while(e>=i)r[o++]=255&e|t,e/=128;while(e&n)r[o++]=255&e|t,e>>>=7;return r[o]=0|e,s.bytes=o-a+1,r}},4676:function(e,t,r){e.exports={encode:r(1312),decode:r(6988),encodingLength:r(82)}},82:function(e){var t=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),i=Math.pow(2,28),s=Math.pow(2,35),o=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),l=Math.pow(2,63);e.exports=function(e){return e<t?1:e<r?2:e<n?3:e<i?4:e<s?5:e<o?6:e<a?7:e<c?8:e<l?9:10}},3744:function(e,t){"use strict";t.Z=(e,t)=>{const r=e.__vccOpts||e;for(const[n,i]of t)r[n]=i;return r}},3907:function(e,t,r){"use strict";r.d(t,{MT:function(){return ee}});var n=r(6252),i=r(2262);function s(){return o().__VUE_DEVTOOLS_GLOBAL_HOOK__}function o(){return"undefined"!==typeof navigator&&"undefined"!==typeof window?window:"undefined"!==typeof r.g?r.g:{}}const a="function"===typeof Proxy,c="devtools-plugin:setup",l="plugin:settings:set";let u,h;function d(){var e;return void 0!==u||("undefined"!==typeof window&&window.performance?(u=!0,h=window.performance):"undefined"!==typeof r.g&&(null===(e=r.g.perf_hooks)||void 0===e?void 0:e.performance)?(u=!0,h=r.g.perf_hooks.performance):u=!1),u}function f(){return d()?h.now():Date.now()}class p{constructor(e,t){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=t;const r={};if(e.settings)for(const o in e.settings){const t=e.settings[o];r[o]=t.defaultValue}const n=`__vue-devtools-plugin-settings__${e.id}`;let i=Object.assign({},r);try{const e=localStorage.getItem(n),t=JSON.parse(e);Object.assign(i,t)}catch(s){}this.fallbacks={getSettings(){return i},setSettings(e){try{localStorage.setItem(n,JSON.stringify(e))}catch(s){}i=e},now(){return f()}},t&&t.on(l,((e,t)=>{e===this.plugin.id&&this.fallbacks.setSettings(t)})),this.proxiedOn=new Proxy({},{get:(e,t)=>this.target?this.target.on[t]:(...e)=>{this.onQueue.push({method:t,args:e})}}),this.proxiedTarget=new Proxy({},{get:(e,t)=>this.target?this.target[t]:"on"===t?this.proxiedOn:Object.keys(this.fallbacks).includes(t)?(...e)=>(this.targetQueue.push({method:t,args:e,resolve:()=>{}}),this.fallbacks[t](...e)):(...e)=>new Promise((r=>{this.targetQueue.push({method:t,args:e,resolve:r})}))})}async setRealTarget(e){this.target=e;for(const t of this.onQueue)this.target.on[t.method](...t.args);for(const t of this.targetQueue)t.resolve(await this.target[t.method](...t.args))}}function y(e,t){const r=e,n=o(),i=s(),l=a&&r.enableEarlyProxy;if(!i||!n.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__&&l){const e=l?new p(r,i):null,s=n.__VUE_DEVTOOLS_PLUGINS__=n.__VUE_DEVTOOLS_PLUGINS__||[];s.push({pluginDescriptor:r,setupFn:t,proxy:e}),e&&t(e.proxiedTarget)}else i.emit(c,e,t)}
/*!
 * vuex v4.0.2
 * (c) 2021 Evan You
 * @license MIT
 */
var g="store";function m(e,t){Object.keys(e).forEach((function(r){return t(e[r],r)}))}function w(e){return null!==e&&"object"===typeof e}function b(e){return e&&"function"===typeof e.then}function v(e,t){return function(){return e(t)}}function E(e,t,r){return t.indexOf(e)<0&&(r&&r.prepend?t.unshift(e):t.push(e)),function(){var r=t.indexOf(e);r>-1&&t.splice(r,1)}}function _(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var r=e.state;A(e,r,[],e._modules.root,!0),S(e,r,t)}function S(e,t,r){var n=e._state;e.getters={},e._makeLocalGettersCache=Object.create(null);var s=e._wrappedGetters,o={};m(s,(function(t,r){o[r]=v(t,e),Object.defineProperty(e.getters,r,{get:function(){return o[r]()},enumerable:!0})})),e._state=(0,i.qj)({data:t}),e.strict&&P(e),n&&r&&e._withCommit((function(){n.data=null}))}function A(e,t,r,n,i){var s=!r.length,o=e._modules.getNamespace(r);if(n.namespaced&&(e._modulesNamespaceMap[o],e._modulesNamespaceMap[o]=n),!s&&!i){var a=x(t,r.slice(0,-1)),c=r[r.length-1];e._withCommit((function(){a[c]=n.state}))}var l=n.context=I(e,o,r);n.forEachMutation((function(t,r){var n=o+r;k(e,n,t,l)})),n.forEachAction((function(t,r){var n=t.root?r:o+r,i=t.handler||t;T(e,n,i,l)})),n.forEachGetter((function(t,r){var n=o+r;R(e,n,t,l)})),n.forEachChild((function(n,s){A(e,t,r.concat(s),n,i)}))}function I(e,t,r){var n=""===t,i={dispatch:n?e.dispatch:function(r,n,i){var s=D(r,n,i),o=s.payload,a=s.options,c=s.type;return a&&a.root||(c=t+c),e.dispatch(c,o)},commit:n?e.commit:function(r,n,i){var s=D(r,n,i),o=s.payload,a=s.options,c=s.type;a&&a.root||(c=t+c),e.commit(c,o,a)}};return Object.defineProperties(i,{getters:{get:n?function(){return e.getters}:function(){return C(e,t)}},state:{get:function(){return x(e.state,r)}}}),i}function C(e,t){if(!e._makeLocalGettersCache[t]){var r={},n=t.length;Object.keys(e.getters).forEach((function(i){if(i.slice(0,n)===t){var s=i.slice(n);Object.defineProperty(r,s,{get:function(){return e.getters[i]},enumerable:!0})}})),e._makeLocalGettersCache[t]=r}return e._makeLocalGettersCache[t]}function k(e,t,r,n){var i=e._mutations[t]||(e._mutations[t]=[]);i.push((function(t){r.call(e,n.state,t)}))}function T(e,t,r,n){var i=e._actions[t]||(e._actions[t]=[]);i.push((function(t){var i=r.call(e,{dispatch:n.dispatch,commit:n.commit,getters:n.getters,state:n.state,rootGetters:e.getters,rootState:e.state},t);return b(i)||(i=Promise.resolve(i)),e._devtoolHook?i.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):i}))}function R(e,t,r,n){e._wrappedGetters[t]||(e._wrappedGetters[t]=function(e){return r(n.state,n.getters,e.state,e.getters)})}function P(e){(0,n.YP)((function(){return e._state.data}),(function(){0}),{deep:!0,flush:"sync"})}function x(e,t){return t.reduce((function(e,t){return e[t]}),e)}function D(e,t,r){return w(e)&&e.type&&(r=t,t=e,e=e.type),{type:e,payload:t,options:r}}var O="vuex bindings",N="vuex:mutations",L="vuex:actions",B="vuex",U=0;function M(e,t){y({id:"org.vuejs.vuex",app:e,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[O]},(function(r){r.addTimelineLayer({id:N,label:"Vuex Mutations",color:j}),r.addTimelineLayer({id:L,label:"Vuex Actions",color:j}),r.addInspector({id:B,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),r.on.getInspectorTree((function(r){if(r.app===e&&r.inspectorId===B)if(r.filter){var n=[];q(n,t._modules.root,r.filter,""),r.rootNodes=n}else r.rootNodes=[K(t._modules.root,"")]})),r.on.getInspectorState((function(r){if(r.app===e&&r.inspectorId===B){var n=r.nodeId;C(t,n),r.state=H(W(t._modules,n),"root"===n?t.getters:t._makeLocalGettersCache,n)}})),r.on.editInspectorState((function(r){if(r.app===e&&r.inspectorId===B){var n=r.nodeId,i=r.path;"root"!==n&&(i=n.split("/").filter(Boolean).concat(i)),t._withCommit((function(){r.set(t._state.data,i,r.state.value)}))}})),t.subscribe((function(e,t){var n={};e.payload&&(n.payload=e.payload),n.state=t,r.notifyComponentUpdate(),r.sendInspectorTree(B),r.sendInspectorState(B),r.addTimelineEvent({layerId:N,event:{time:Date.now(),title:e.type,data:n}})})),t.subscribeAction({before:function(e,t){var n={};e.payload&&(n.payload=e.payload),e._id=U++,e._time=Date.now(),n.state=t,r.addTimelineEvent({layerId:L,event:{time:e._time,title:e.type,groupId:e._id,subtitle:"start",data:n}})},after:function(e,t){var n={},i=Date.now()-e._time;n.duration={_custom:{type:"duration",display:i+"ms",tooltip:"Action duration",value:i}},e.payload&&(n.payload=e.payload),n.state=t,r.addTimelineEvent({layerId:L,event:{time:Date.now(),title:e.type,groupId:e._id,subtitle:"end",data:n}})}})}))}var j=8702998,V=6710886,z=16777215,F={label:"namespaced",textColor:z,backgroundColor:V};function $(e){return e&&"root"!==e?e.split("/").slice(-2,-1)[0]:"Root"}function K(e,t){return{id:t||"root",label:$(t),tags:e.namespaced?[F]:[],children:Object.keys(e._children).map((function(r){return K(e._children[r],t+r+"/")}))}}function q(e,t,r,n){n.includes(r)&&e.push({id:n||"root",label:n.endsWith("/")?n.slice(0,n.length-1):n||"Root",tags:t.namespaced?[F]:[]}),Object.keys(t._children).forEach((function(i){q(e,t._children[i],r,n+i+"/")}))}function H(e,t,r){t="root"===r?t:t[r];var n=Object.keys(t),i={state:Object.keys(e.state).map((function(t){return{key:t,editable:!0,value:e.state[t]}}))};if(n.length){var s=G(t);i.getters=Object.keys(s).map((function(e){return{key:e.endsWith("/")?$(e):e,editable:!1,value:Y((function(){return s[e]}))}}))}return i}function G(e){var t={};return Object.keys(e).forEach((function(r){var n=r.split("/");if(n.length>1){var i=t,s=n.pop();n.forEach((function(e){i[e]||(i[e]={_custom:{value:{},display:e,tooltip:"Module",abstract:!0}}),i=i[e]._custom.value})),i[s]=Y((function(){return e[r]}))}else t[r]=Y((function(){return e[r]}))})),t}function W(e,t){var r=t.split("/").filter((function(e){return e}));return r.reduce((function(e,n,i){var s=e[n];if(!s)throw new Error('Missing module "'+n+'" for path "'+t+'".');return i===r.length-1?s:s._children}),"root"===t?e:e.root._children)}function Y(e){try{return e()}catch(t){return t}}var J=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var r=e.state;this.state=("function"===typeof r?r():r)||{}},Q={namespaced:{configurable:!0}};Q.namespaced.get=function(){return!!this._rawModule.namespaced},J.prototype.addChild=function(e,t){this._children[e]=t},J.prototype.removeChild=function(e){delete this._children[e]},J.prototype.getChild=function(e){return this._children[e]},J.prototype.hasChild=function(e){return e in this._children},J.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},J.prototype.forEachChild=function(e){m(this._children,e)},J.prototype.forEachGetter=function(e){this._rawModule.getters&&m(this._rawModule.getters,e)},J.prototype.forEachAction=function(e){this._rawModule.actions&&m(this._rawModule.actions,e)},J.prototype.forEachMutation=function(e){this._rawModule.mutations&&m(this._rawModule.mutations,e)},Object.defineProperties(J.prototype,Q);var X=function(e){this.register([],e,!1)};function Z(e,t,r){if(t.update(r),r.modules)for(var n in r.modules){if(!t.getChild(n))return void 0;Z(e.concat(n),t.getChild(n),r.modules[n])}}X.prototype.get=function(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},X.prototype.getNamespace=function(e){var t=this.root;return e.reduce((function(e,r){return t=t.getChild(r),e+(t.namespaced?r+"/":"")}),"")},X.prototype.update=function(e){Z([],this.root,e)},X.prototype.register=function(e,t,r){var n=this;void 0===r&&(r=!0);var i=new J(t,r);if(0===e.length)this.root=i;else{var s=this.get(e.slice(0,-1));s.addChild(e[e.length-1],i)}t.modules&&m(t.modules,(function(t,i){n.register(e.concat(i),t,r)}))},X.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),r=e[e.length-1],n=t.getChild(r);n&&n.runtime&&t.removeChild(r)},X.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),r=e[e.length-1];return!!t&&t.hasChild(r)};function ee(e){return new te(e)}var te=function(e){var t=this;void 0===e&&(e={});var r=e.plugins;void 0===r&&(r=[]);var n=e.strict;void 0===n&&(n=!1);var i=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new X(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._devtools=i;var s=this,o=this,a=o.dispatch,c=o.commit;this.dispatch=function(e,t){return a.call(s,e,t)},this.commit=function(e,t,r){return c.call(s,e,t,r)},this.strict=n;var l=this._modules.root.state;A(this,l,[],this._modules.root),S(this,l),r.forEach((function(e){return e(t)}))},re={state:{configurable:!0}};te.prototype.install=function(e,t){e.provide(t||g,this),e.config.globalProperties.$store=this;var r=void 0!==this._devtools&&this._devtools;r&&M(e,this)},re.state.get=function(){return this._state.data},re.state.set=function(e){0},te.prototype.commit=function(e,t,r){var n=this,i=D(e,t,r),s=i.type,o=i.payload,a=(i.options,{type:s,payload:o}),c=this._mutations[s];c&&(this._withCommit((function(){c.forEach((function(e){e(o)}))})),this._subscribers.slice().forEach((function(e){return e(a,n.state)})))},te.prototype.dispatch=function(e,t){var r=this,n=D(e,t),i=n.type,s=n.payload,o={type:i,payload:s},a=this._actions[i];if(a){try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(o,r.state)}))}catch(l){0}var c=a.length>1?Promise.all(a.map((function(e){return e(s)}))):a[0](s);return new Promise((function(e,t){c.then((function(t){try{r._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(o,r.state)}))}catch(l){0}e(t)}),(function(e){try{r._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(o,r.state,e)}))}catch(l){0}t(e)}))}))}},te.prototype.subscribe=function(e,t){return E(e,this._subscribers,t)},te.prototype.subscribeAction=function(e,t){var r="function"===typeof e?{before:e}:e;return E(r,this._actionSubscribers,t)},te.prototype.watch=function(e,t,r){var i=this;return(0,n.YP)((function(){return e(i.state,i.getters)}),t,Object.assign({},r))},te.prototype.replaceState=function(e){var t=this;this._withCommit((function(){t._state.data=e}))},te.prototype.registerModule=function(e,t,r){void 0===r&&(r={}),"string"===typeof e&&(e=[e]),this._modules.register(e,t),A(this,this.state,e,this._modules.get(e),r.preserveState),S(this,this.state)},te.prototype.unregisterModule=function(e){var t=this;"string"===typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit((function(){var r=x(t.state,e.slice(0,-1));delete r[e[e.length-1]]})),_(this)},te.prototype.hasModule=function(e){return"string"===typeof e&&(e=[e]),this._modules.isRegistered(e)},te.prototype.hotUpdate=function(e){this._modules.update(e),_(this,!0)},te.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(te.prototype,re);se((function(e,t){var r={};return ne(t).forEach((function(t){var n=t.key,i=t.val;r[n]=function(){var t=this.$store.state,r=this.$store.getters;if(e){var n=oe(this.$store,"mapState",e);if(!n)return;t=n.context.state,r=n.context.getters}return"function"===typeof i?i.call(this,t,r):t[i]},r[n].vuex=!0})),r})),se((function(e,t){var r={};return ne(t).forEach((function(t){var n=t.key,i=t.val;r[n]=function(){var t=[],r=arguments.length;while(r--)t[r]=arguments[r];var n=this.$store.commit;if(e){var s=oe(this.$store,"mapMutations",e);if(!s)return;n=s.context.commit}return"function"===typeof i?i.apply(this,[n].concat(t)):n.apply(this.$store,[i].concat(t))}})),r})),se((function(e,t){var r={};return ne(t).forEach((function(t){var n=t.key,i=t.val;i=e+i,r[n]=function(){if(!e||oe(this.$store,"mapGetters",e))return this.$store.getters[i]},r[n].vuex=!0})),r})),se((function(e,t){var r={};return ne(t).forEach((function(t){var n=t.key,i=t.val;r[n]=function(){var t=[],r=arguments.length;while(r--)t[r]=arguments[r];var n=this.$store.dispatch;if(e){var s=oe(this.$store,"mapActions",e);if(!s)return;n=s.context.dispatch}return"function"===typeof i?i.apply(this,[n].concat(t)):n.apply(this.$store,[i].concat(t))}})),r}));function ne(e){return ie(e)?Array.isArray(e)?e.map((function(e){return{key:e,val:e}})):Object.keys(e).map((function(t){return{key:t,val:e[t]}})):[]}function ie(e){return Array.isArray(e)||w(e)}function se(e){return function(t,r){return"string"!==typeof t?(r=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,r)}}function oe(e,t,r){var n=e._modulesNamespaceMap[r];return n}},4482:function(e,t,r){"use strict";var n,i,s;(function(o,a){i=[r(2450)],n=a,s="function"===typeof n?n.apply(t,i):n,void 0===s||(e.exports=s)})(0,(function(e){var t=e.Reader,r=e.Writer,n=e.util,i=e.roots["default"]||(e.roots["default"]={});return i.RPC=function(){function s(e){if(this.subscriptions=[],this.messages=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return s.prototype.subscriptions=n.emptyArray,s.prototype.messages=n.emptyArray,s.prototype.control=null,Object.defineProperty(s.prototype,"_control",{get:n.oneOfGetter(o=["control"]),set:n.oneOfSetter(o)}),s.encode=function(e,t){if(t||(t=r.create()),null!=e.subscriptions&&e.subscriptions.length)for(var n=0;n<e.subscriptions.length;++n)i.RPC.SubOpts.encode(e.subscriptions[n],t.uint32(10).fork()).ldelim();if(null!=e.messages&&e.messages.length)for(n=0;n<e.messages.length;++n)i.RPC.Message.encode(e.messages[n],t.uint32(18).fork()).ldelim();return null!=e.control&&Object.hasOwnProperty.call(e,"control")&&i.RPC.ControlMessage.encode(e.control,t.uint32(26).fork()).ldelim(),t},s.decode=function(e,r){e instanceof t||(e=t.create(e));var n=void 0===r?e.len:e.pos+r,s=new i.RPC;while(e.pos<n){var o=e.uint32();switch(o>>>3){case 1:s.subscriptions&&s.subscriptions.length||(s.subscriptions=[]),s.subscriptions.push(i.RPC.SubOpts.decode(e,e.uint32()));break;case 2:s.messages&&s.messages.length||(s.messages=[]),s.messages.push(i.RPC.Message.decode(e,e.uint32()));break;case 3:s.control=i.RPC.ControlMessage.decode(e,e.uint32());break;default:e.skipType(7&o);break}}return s},s.fromObject=function(e){if(e instanceof i.RPC)return e;var t=new i.RPC;if(e.subscriptions){if(!Array.isArray(e.subscriptions))throw TypeError(".RPC.subscriptions: array expected");t.subscriptions=[];for(var r=0;r<e.subscriptions.length;++r){if("object"!==typeof e.subscriptions[r])throw TypeError(".RPC.subscriptions: object expected");t.subscriptions[r]=i.RPC.SubOpts.fromObject(e.subscriptions[r])}}if(e.messages){if(!Array.isArray(e.messages))throw TypeError(".RPC.messages: array expected");t.messages=[];for(r=0;r<e.messages.length;++r){if("object"!==typeof e.messages[r])throw TypeError(".RPC.messages: object expected");t.messages[r]=i.RPC.Message.fromObject(e.messages[r])}}if(null!=e.control){if("object"!==typeof e.control)throw TypeError(".RPC.control: object expected");t.control=i.RPC.ControlMessage.fromObject(e.control)}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.subscriptions=[],r.messages=[]),e.subscriptions&&e.subscriptions.length){r.subscriptions=[];for(var n=0;n<e.subscriptions.length;++n)r.subscriptions[n]=i.RPC.SubOpts.toObject(e.subscriptions[n],t)}if(e.messages&&e.messages.length){r.messages=[];for(n=0;n<e.messages.length;++n)r.messages[n]=i.RPC.Message.toObject(e.messages[n],t)}return null!=e.control&&e.hasOwnProperty("control")&&(r.control=i.RPC.ControlMessage.toObject(e.control,t),t.oneofs&&(r._control="control")),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s.SubOpts=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return s.prototype.subscribe=null,s.prototype.topic=null,Object.defineProperty(s.prototype,"_subscribe",{get:n.oneOfGetter(o=["subscribe"]),set:n.oneOfSetter(o)}),Object.defineProperty(s.prototype,"_topic",{get:n.oneOfGetter(o=["topic"]),set:n.oneOfSetter(o)}),s.encode=function(e,t){return t||(t=r.create()),null!=e.subscribe&&Object.hasOwnProperty.call(e,"subscribe")&&t.uint32(8).bool(e.subscribe),null!=e.topic&&Object.hasOwnProperty.call(e,"topic")&&t.uint32(18).string(e.topic),t},s.decode=function(e,r){e instanceof t||(e=t.create(e));var n=void 0===r?e.len:e.pos+r,s=new i.RPC.SubOpts;while(e.pos<n){var o=e.uint32();switch(o>>>3){case 1:s.subscribe=e.bool();break;case 2:s.topic=e.string();break;default:e.skipType(7&o);break}}return s},s.fromObject=function(e){if(e instanceof i.RPC.SubOpts)return e;var t=new i.RPC.SubOpts;return null!=e.subscribe&&(t.subscribe=Boolean(e.subscribe)),null!=e.topic&&(t.topic=String(e.topic)),t},s.toObject=function(e,t){t||(t={});var r={};return null!=e.subscribe&&e.hasOwnProperty("subscribe")&&(r.subscribe=e.subscribe,t.oneofs&&(r._subscribe="subscribe")),null!=e.topic&&e.hasOwnProperty("topic")&&(r.topic=e.topic,t.oneofs&&(r._topic="topic")),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s.Message=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return s.prototype.from=null,s.prototype.data=null,s.prototype.seqno=null,s.prototype.topic="",s.prototype.signature=null,s.prototype.key=null,Object.defineProperty(s.prototype,"_from",{get:n.oneOfGetter(o=["from"]),set:n.oneOfSetter(o)}),Object.defineProperty(s.prototype,"_data",{get:n.oneOfGetter(o=["data"]),set:n.oneOfSetter(o)}),Object.defineProperty(s.prototype,"_seqno",{get:n.oneOfGetter(o=["seqno"]),set:n.oneOfSetter(o)}),Object.defineProperty(s.prototype,"_signature",{get:n.oneOfGetter(o=["signature"]),set:n.oneOfSetter(o)}),Object.defineProperty(s.prototype,"_key",{get:n.oneOfGetter(o=["key"]),set:n.oneOfSetter(o)}),s.encode=function(e,t){return t||(t=r.create()),null!=e.from&&Object.hasOwnProperty.call(e,"from")&&t.uint32(10).bytes(e.from),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),null!=e.seqno&&Object.hasOwnProperty.call(e,"seqno")&&t.uint32(26).bytes(e.seqno),t.uint32(34).string(e.topic),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(42).bytes(e.signature),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(50).bytes(e.key),t},s.decode=function(e,r){e instanceof t||(e=t.create(e));var s=void 0===r?e.len:e.pos+r,o=new i.RPC.Message;while(e.pos<s){var a=e.uint32();switch(a>>>3){case 1:o.from=e.bytes();break;case 2:o.data=e.bytes();break;case 3:o.seqno=e.bytes();break;case 4:o.topic=e.string();break;case 5:o.signature=e.bytes();break;case 6:o.key=e.bytes();break;default:e.skipType(7&a);break}}if(!o.hasOwnProperty("topic"))throw n.ProtocolError("missing required 'topic'",{instance:o});return o},s.fromObject=function(e){if(e instanceof i.RPC.Message)return e;var t=new i.RPC.Message;return null!=e.from&&("string"===typeof e.from?n.base64.decode(e.from,t.from=n.newBuffer(n.base64.length(e.from)),0):e.from.length&&(t.from=e.from)),null!=e.data&&("string"===typeof e.data?n.base64.decode(e.data,t.data=n.newBuffer(n.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),null!=e.seqno&&("string"===typeof e.seqno?n.base64.decode(e.seqno,t.seqno=n.newBuffer(n.base64.length(e.seqno)),0):e.seqno.length&&(t.seqno=e.seqno)),null!=e.topic&&(t.topic=String(e.topic)),null!=e.signature&&("string"===typeof e.signature?n.base64.decode(e.signature,t.signature=n.newBuffer(n.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),null!=e.key&&("string"===typeof e.key?n.base64.decode(e.key,t.key=n.newBuffer(n.base64.length(e.key)),0):e.key.length&&(t.key=e.key)),t},s.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.topic=""),null!=e.from&&e.hasOwnProperty("from")&&(r.from=t.bytes===String?n.base64.encode(e.from,0,e.from.length):t.bytes===Array?Array.prototype.slice.call(e.from):e.from,t.oneofs&&(r._from="from")),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?n.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data,t.oneofs&&(r._data="data")),null!=e.seqno&&e.hasOwnProperty("seqno")&&(r.seqno=t.bytes===String?n.base64.encode(e.seqno,0,e.seqno.length):t.bytes===Array?Array.prototype.slice.call(e.seqno):e.seqno,t.oneofs&&(r._seqno="seqno")),null!=e.topic&&e.hasOwnProperty("topic")&&(r.topic=e.topic),null!=e.signature&&e.hasOwnProperty("signature")&&(r.signature=t.bytes===String?n.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature,t.oneofs&&(r._signature="signature")),null!=e.key&&e.hasOwnProperty("key")&&(r.key=t.bytes===String?n.base64.encode(e.key,0,e.key.length):t.bytes===Array?Array.prototype.slice.call(e.key):e.key,t.oneofs&&(r._key="key")),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s.ControlMessage=function(){function s(e){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.ihave=n.emptyArray,s.prototype.iwant=n.emptyArray,s.prototype.graft=n.emptyArray,s.prototype.prune=n.emptyArray,s.encode=function(e,t){if(t||(t=r.create()),null!=e.ihave&&e.ihave.length)for(var n=0;n<e.ihave.length;++n)i.RPC.ControlIHave.encode(e.ihave[n],t.uint32(10).fork()).ldelim();if(null!=e.iwant&&e.iwant.length)for(n=0;n<e.iwant.length;++n)i.RPC.ControlIWant.encode(e.iwant[n],t.uint32(18).fork()).ldelim();if(null!=e.graft&&e.graft.length)for(n=0;n<e.graft.length;++n)i.RPC.ControlGraft.encode(e.graft[n],t.uint32(26).fork()).ldelim();if(null!=e.prune&&e.prune.length)for(n=0;n<e.prune.length;++n)i.RPC.ControlPrune.encode(e.prune[n],t.uint32(34).fork()).ldelim();return t},s.decode=function(e,r){e instanceof t||(e=t.create(e));var n=void 0===r?e.len:e.pos+r,s=new i.RPC.ControlMessage;while(e.pos<n){var o=e.uint32();switch(o>>>3){case 1:s.ihave&&s.ihave.length||(s.ihave=[]),s.ihave.push(i.RPC.ControlIHave.decode(e,e.uint32()));break;case 2:s.iwant&&s.iwant.length||(s.iwant=[]),s.iwant.push(i.RPC.ControlIWant.decode(e,e.uint32()));break;case 3:s.graft&&s.graft.length||(s.graft=[]),s.graft.push(i.RPC.ControlGraft.decode(e,e.uint32()));break;case 4:s.prune&&s.prune.length||(s.prune=[]),s.prune.push(i.RPC.ControlPrune.decode(e,e.uint32()));break;default:e.skipType(7&o);break}}return s},s.fromObject=function(e){if(e instanceof i.RPC.ControlMessage)return e;var t=new i.RPC.ControlMessage;if(e.ihave){if(!Array.isArray(e.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");t.ihave=[];for(var r=0;r<e.ihave.length;++r){if("object"!==typeof e.ihave[r])throw TypeError(".RPC.ControlMessage.ihave: object expected");t.ihave[r]=i.RPC.ControlIHave.fromObject(e.ihave[r])}}if(e.iwant){if(!Array.isArray(e.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");t.iwant=[];for(r=0;r<e.iwant.length;++r){if("object"!==typeof e.iwant[r])throw TypeError(".RPC.ControlMessage.iwant: object expected");t.iwant[r]=i.RPC.ControlIWant.fromObject(e.iwant[r])}}if(e.graft){if(!Array.isArray(e.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");t.graft=[];for(r=0;r<e.graft.length;++r){if("object"!==typeof e.graft[r])throw TypeError(".RPC.ControlMessage.graft: object expected");t.graft[r]=i.RPC.ControlGraft.fromObject(e.graft[r])}}if(e.prune){if(!Array.isArray(e.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");t.prune=[];for(r=0;r<e.prune.length;++r){if("object"!==typeof e.prune[r])throw TypeError(".RPC.ControlMessage.prune: object expected");t.prune[r]=i.RPC.ControlPrune.fromObject(e.prune[r])}}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.ihave=[],r.iwant=[],r.graft=[],r.prune=[]),e.ihave&&e.ihave.length){r.ihave=[];for(var n=0;n<e.ihave.length;++n)r.ihave[n]=i.RPC.ControlIHave.toObject(e.ihave[n],t)}if(e.iwant&&e.iwant.length){r.iwant=[];for(n=0;n<e.iwant.length;++n)r.iwant[n]=i.RPC.ControlIWant.toObject(e.iwant[n],t)}if(e.graft&&e.graft.length){r.graft=[];for(n=0;n<e.graft.length;++n)r.graft[n]=i.RPC.ControlGraft.toObject(e.graft[n],t)}if(e.prune&&e.prune.length){r.prune=[];for(n=0;n<e.prune.length;++n)r.prune[n]=i.RPC.ControlPrune.toObject(e.prune[n],t)}return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s.ControlIHave=function(){function s(e){if(this.messageIDs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return s.prototype.topicID=null,s.prototype.messageIDs=n.emptyArray,Object.defineProperty(s.prototype,"_topicID",{get:n.oneOfGetter(o=["topicID"]),set:n.oneOfSetter(o)}),s.encode=function(e,t){if(t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),null!=e.messageIDs&&e.messageIDs.length)for(var n=0;n<e.messageIDs.length;++n)t.uint32(18).bytes(e.messageIDs[n]);return t},s.decode=function(e,r){e instanceof t||(e=t.create(e));var n=void 0===r?e.len:e.pos+r,s=new i.RPC.ControlIHave;while(e.pos<n){var o=e.uint32();switch(o>>>3){case 1:s.topicID=e.string();break;case 2:s.messageIDs&&s.messageIDs.length||(s.messageIDs=[]),s.messageIDs.push(e.bytes());break;default:e.skipType(7&o);break}}return s},s.fromObject=function(e){if(e instanceof i.RPC.ControlIHave)return e;var t=new i.RPC.ControlIHave;if(null!=e.topicID&&(t.topicID=String(e.topicID)),e.messageIDs){if(!Array.isArray(e.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");t.messageIDs=[];for(var r=0;r<e.messageIDs.length;++r)"string"===typeof e.messageIDs[r]?n.base64.decode(e.messageIDs[r],t.messageIDs[r]=n.newBuffer(n.base64.length(e.messageIDs[r])),0):e.messageIDs[r].length&&(t.messageIDs[r]=e.messageIDs[r])}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.messageIDs=[]),null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),e.messageIDs&&e.messageIDs.length){r.messageIDs=[];for(var i=0;i<e.messageIDs.length;++i)r.messageIDs[i]=t.bytes===String?n.base64.encode(e.messageIDs[i],0,e.messageIDs[i].length):t.bytes===Array?Array.prototype.slice.call(e.messageIDs[i]):e.messageIDs[i]}return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s.ControlIWant=function(){function s(e){if(this.messageIDs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return s.prototype.messageIDs=n.emptyArray,s.encode=function(e,t){if(t||(t=r.create()),null!=e.messageIDs&&e.messageIDs.length)for(var n=0;n<e.messageIDs.length;++n)t.uint32(10).bytes(e.messageIDs[n]);return t},s.decode=function(e,r){e instanceof t||(e=t.create(e));var n=void 0===r?e.len:e.pos+r,s=new i.RPC.ControlIWant;while(e.pos<n){var o=e.uint32();switch(o>>>3){case 1:s.messageIDs&&s.messageIDs.length||(s.messageIDs=[]),s.messageIDs.push(e.bytes());break;default:e.skipType(7&o);break}}return s},s.fromObject=function(e){if(e instanceof i.RPC.ControlIWant)return e;var t=new i.RPC.ControlIWant;if(e.messageIDs){if(!Array.isArray(e.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");t.messageIDs=[];for(var r=0;r<e.messageIDs.length;++r)"string"===typeof e.messageIDs[r]?n.base64.decode(e.messageIDs[r],t.messageIDs[r]=n.newBuffer(n.base64.length(e.messageIDs[r])),0):e.messageIDs[r].length&&(t.messageIDs[r]=e.messageIDs[r])}return t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.messageIDs=[]),e.messageIDs&&e.messageIDs.length){r.messageIDs=[];for(var i=0;i<e.messageIDs.length;++i)r.messageIDs[i]=t.bytes===String?n.base64.encode(e.messageIDs[i],0,e.messageIDs[i].length):t.bytes===Array?Array.prototype.slice.call(e.messageIDs[i]):e.messageIDs[i]}return r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s.ControlGraft=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return s.prototype.topicID=null,Object.defineProperty(s.prototype,"_topicID",{get:n.oneOfGetter(o=["topicID"]),set:n.oneOfSetter(o)}),s.encode=function(e,t){return t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),t},s.decode=function(e,r){e instanceof t||(e=t.create(e));var n=void 0===r?e.len:e.pos+r,s=new i.RPC.ControlGraft;while(e.pos<n){var o=e.uint32();switch(o>>>3){case 1:s.topicID=e.string();break;default:e.skipType(7&o);break}}return s},s.fromObject=function(e){if(e instanceof i.RPC.ControlGraft)return e;var t=new i.RPC.ControlGraft;return null!=e.topicID&&(t.topicID=String(e.topicID)),t},s.toObject=function(e,t){t||(t={});var r={};return null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s.ControlPrune=function(){function s(e){if(this.peers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return s.prototype.topicID=null,s.prototype.peers=n.emptyArray,s.prototype.backoff=null,Object.defineProperty(s.prototype,"_topicID",{get:n.oneOfGetter(o=["topicID"]),set:n.oneOfSetter(o)}),Object.defineProperty(s.prototype,"_backoff",{get:n.oneOfGetter(o=["backoff"]),set:n.oneOfSetter(o)}),s.encode=function(e,t){if(t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),null!=e.peers&&e.peers.length)for(var n=0;n<e.peers.length;++n)i.RPC.PeerInfo.encode(e.peers[n],t.uint32(18).fork()).ldelim();return null!=e.backoff&&Object.hasOwnProperty.call(e,"backoff")&&t.uint32(24).uint64(e.backoff),t},s.decode=function(e,r){e instanceof t||(e=t.create(e));var n=void 0===r?e.len:e.pos+r,s=new i.RPC.ControlPrune;while(e.pos<n){var o=e.uint32();switch(o>>>3){case 1:s.topicID=e.string();break;case 2:s.peers&&s.peers.length||(s.peers=[]),s.peers.push(i.RPC.PeerInfo.decode(e,e.uint32()));break;case 3:s.backoff=e.uint64();break;default:e.skipType(7&o);break}}return s},s.fromObject=function(e){if(e instanceof i.RPC.ControlPrune)return e;var t=new i.RPC.ControlPrune;if(null!=e.topicID&&(t.topicID=String(e.topicID)),e.peers){if(!Array.isArray(e.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");t.peers=[];for(var r=0;r<e.peers.length;++r){if("object"!==typeof e.peers[r])throw TypeError(".RPC.ControlPrune.peers: object expected");t.peers[r]=i.RPC.PeerInfo.fromObject(e.peers[r])}}return null!=e.backoff&&(n.Long?(t.backoff=n.Long.fromValue(e.backoff)).unsigned=!0:"string"===typeof e.backoff?t.backoff=parseInt(e.backoff,10):"number"===typeof e.backoff?t.backoff=e.backoff:"object"===typeof e.backoff&&(t.backoff=new n.LongBits(e.backoff.low>>>0,e.backoff.high>>>0).toNumber(!0))),t},s.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.peers=[]),null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),e.peers&&e.peers.length){r.peers=[];for(var s=0;s<e.peers.length;++s)r.peers[s]=i.RPC.PeerInfo.toObject(e.peers[s],t)}return null!=e.backoff&&e.hasOwnProperty("backoff")&&("number"===typeof e.backoff?r.backoff=t.longs===String?String(e.backoff):e.backoff:r.backoff=t.longs===String?n.Long.prototype.toString.call(e.backoff):t.longs===Number?new n.LongBits(e.backoff.low>>>0,e.backoff.high>>>0).toNumber(!0):e.backoff,t.oneofs&&(r._backoff="backoff")),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s.PeerInfo=function(){function s(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return s.prototype.peerID=null,s.prototype.signedPeerRecord=null,Object.defineProperty(s.prototype,"_peerID",{get:n.oneOfGetter(o=["peerID"]),set:n.oneOfSetter(o)}),Object.defineProperty(s.prototype,"_signedPeerRecord",{get:n.oneOfGetter(o=["signedPeerRecord"]),set:n.oneOfSetter(o)}),s.encode=function(e,t){return t||(t=r.create()),null!=e.peerID&&Object.hasOwnProperty.call(e,"peerID")&&t.uint32(10).bytes(e.peerID),null!=e.signedPeerRecord&&Object.hasOwnProperty.call(e,"signedPeerRecord")&&t.uint32(18).bytes(e.signedPeerRecord),t},s.decode=function(e,r){e instanceof t||(e=t.create(e));var n=void 0===r?e.len:e.pos+r,s=new i.RPC.PeerInfo;while(e.pos<n){var o=e.uint32();switch(o>>>3){case 1:s.peerID=e.bytes();break;case 2:s.signedPeerRecord=e.bytes();break;default:e.skipType(7&o);break}}return s},s.fromObject=function(e){if(e instanceof i.RPC.PeerInfo)return e;var t=new i.RPC.PeerInfo;return null!=e.peerID&&("string"===typeof e.peerID?n.base64.decode(e.peerID,t.peerID=n.newBuffer(n.base64.length(e.peerID)),0):e.peerID.length&&(t.peerID=e.peerID)),null!=e.signedPeerRecord&&("string"===typeof e.signedPeerRecord?n.base64.decode(e.signedPeerRecord,t.signedPeerRecord=n.newBuffer(n.base64.length(e.signedPeerRecord)),0):e.signedPeerRecord.length&&(t.signedPeerRecord=e.signedPeerRecord)),t},s.toObject=function(e,t){t||(t={});var r={};return null!=e.peerID&&e.hasOwnProperty("peerID")&&(r.peerID=t.bytes===String?n.base64.encode(e.peerID,0,e.peerID.length):t.bytes===Array?Array.prototype.slice.call(e.peerID):e.peerID,t.oneofs&&(r._peerID="peerID")),null!=e.signedPeerRecord&&e.hasOwnProperty("signedPeerRecord")&&(r.signedPeerRecord=t.bytes===String?n.base64.encode(e.signedPeerRecord,0,e.signedPeerRecord.length):t.bytes===Array?Array.prototype.slice.call(e.signedPeerRecord):e.signedPeerRecord,t.oneofs&&(r._signedPeerRecord="signedPeerRecord")),r},s.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},s}(),s}(),i}))},8251:function(e,t,r){"use strict";r.r(t),r.d(t,{create:function(){return Wbe},globSource:function(){return Ybe},urlSource:function(){return Jbe}});var n={};r.r(n),r.d(n,{base58btc:function(){return Ti},base58flickr:function(){return Ri}});var i={};r.r(i),r.d(i,{base32:function(){return Pi},base32hex:function(){return Ni},base32hexpad:function(){return Bi},base32hexpadupper:function(){return Ui},base32hexupper:function(){return Li},base32pad:function(){return Di},base32padupper:function(){return Oi},base32upper:function(){return xi},base32z:function(){return Mi}});var s={};r.r(s),r.d(s,{code:function(){return Cs},createLink:function(){return As},createNode:function(){return Ss},decode:function(){return Ts},encode:function(){return ks},name:function(){return Is},prepare:function(){return Es},validate:function(){return _s}});var o={};r.r(o),r.d(o,{code:function(){return ac},decode:function(){return lc},encode:function(){return cc},name:function(){return oc}});var a={};r.r(a),r.d(a,{base64:function(){return dc},base64pad:function(){return fc},base64url:function(){return pc},base64urlpad:function(){return yc}});var c={};r.r(c),r.d(c,{code:function(){return Pc},decode:function(){return Dc},encode:function(){return xc},name:function(){return Rc}});var l={};r.r(l),r.d(l,{code:function(){return Hc},decode:function(){return Zc},encode:function(){return Xc},name:function(){return qc},toGeneral:function(){return Qc}});var u={};r.r(u),r.d(u,{identity:function(){return il}});var h={};r.r(h),r.d(h,{identity:function(){return sl}});var d={};r.r(d),r.d(d,{base2:function(){return ol}});var f={};r.r(f),r.d(f,{base8:function(){return al}});var p={};r.r(p),r.d(p,{base10:function(){return cl}});var y={};r.r(y),r.d(y,{base16:function(){return ll},base16upper:function(){return ul}});var g={};r.r(g),r.d(g,{base36:function(){return hl},base36upper:function(){return dl}});var m={};r.r(m),r.d(m,{base256emoji:function(){return wl}});var w={};r.r(w),r.d(w,{sha256:function(){return vl},sha512:function(){return El}});var b={};r.r(b),r.d(b,{code:function(){return Sl},decode:function(){return Il},encode:function(){return Al},name:function(){return _l}});var v={};r.r(v),r.d(v,{code:function(){return Rl},decode:function(){return xl},encode:function(){return Pl},name:function(){return Tl}});var E={};r.r(E),r.d(E,{base58btc:function(){return gu},base58flickr:function(){return mu}});var _={};r.r(_),r.d(_,{base32:function(){return wu},base32hex:function(){return _u},base32hexpad:function(){return Au},base32hexpadupper:function(){return Iu},base32hexupper:function(){return Su},base32pad:function(){return vu},base32padupper:function(){return Eu},base32upper:function(){return bu},base32z:function(){return Cu}});var S={};r.r(S),r.d(S,{identity:function(){return xh}});var A={};r.r(A),r.d(A,{base2:function(){return Dh}});var I={};r.r(I),r.d(I,{base8:function(){return Oh}});var C={};r.r(C),r.d(C,{base10:function(){return Nh}});var k={};r.r(k),r.d(k,{base16:function(){return Lh},base16upper:function(){return Bh}});var T={};r.r(T),r.d(T,{base32:function(){return Uh},base32hex:function(){return zh},base32hexpad:function(){return $h},base32hexpadupper:function(){return Kh},base32hexupper:function(){return Fh},base32pad:function(){return jh},base32padupper:function(){return Vh},base32upper:function(){return Mh},base32z:function(){return qh}});var R={};r.r(R),r.d(R,{base36:function(){return Hh},base36upper:function(){return Gh}});var P={};r.r(P),r.d(P,{base58btc:function(){return Wh},base58flickr:function(){return Yh}});var x={};r.r(x),r.d(x,{base64:function(){return Jh},base64pad:function(){return Qh},base64url:function(){return Xh},base64urlpad:function(){return Zh}});var D={};r.r(D),r.d(D,{base256emoji:function(){return sd}});var O={};r.r(O),r.d(O,{sha256:function(){return jd},sha512:function(){return Vd}});var N={};r.r(N),r.d(N,{identity:function(){return qd}});var L={};r.r(L),r.d(L,{code:function(){return Gd},decode:function(){return Yd},encode:function(){return Wd},name:function(){return Hd}});var B={};r.r(B),r.d(B,{code:function(){return Zd},decode:function(){return tf},encode:function(){return ef},name:function(){return Xd}});var U={};r.r(U),r.d(U,{identity:function(){return yy}});var M={};r.r(M),r.d(M,{base2:function(){return gy}});var j={};r.r(j),r.d(j,{base8:function(){return my}});var V={};r.r(V),r.d(V,{base10:function(){return wy}});var z={};r.r(z),r.d(z,{base16:function(){return by},base16upper:function(){return vy}});var F={};r.r(F),r.d(F,{base36:function(){return Ey},base36upper:function(){return _y}});var $={};r.r($),r.d($,{base64:function(){return Sy},base64pad:function(){return Ay},base64url:function(){return Iy},base64urlpad:function(){return Cy}});var K={};r.r(K),r.d(K,{base256emoji:function(){return Dy}});var q={};r.r(q),r.d(q,{sha256:function(){return By},sha512:function(){return Uy}});var H={};r.r(H),r.d(H,{identity:function(){return Fy}});var G={};r.r(G),r.d(G,{code:function(){return Ky},decode:function(){return Hy},encode:function(){return qy},name:function(){return $y}});var W={};r.r(W),r.d(W,{code:function(){return Jy},decode:function(){return Xy},encode:function(){return Qy},name:function(){return Yy}});var Y={};r.r(Y),r.d(Y,{identity:function(){return jg}});var J={};r.r(J),r.d(J,{base2:function(){return Vg}});var Q={};r.r(Q),r.d(Q,{base8:function(){return zg}});var X={};r.r(X),r.d(X,{base10:function(){return Fg}});var Z={};r.r(Z),r.d(Z,{base16:function(){return $g},base16upper:function(){return Kg}});var ee={};r.r(ee),r.d(ee,{base32:function(){return qg},base32hex:function(){return Yg},base32hexpad:function(){return Qg},base32hexpadupper:function(){return Xg},base32hexupper:function(){return Jg},base32pad:function(){return Gg},base32padupper:function(){return Wg},base32upper:function(){return Hg},base32z:function(){return Zg}});var te={};r.r(te),r.d(te,{base36:function(){return em},base36upper:function(){return tm}});var re={};r.r(re),r.d(re,{base58btc:function(){return rm},base58flickr:function(){return nm}});var ne={};r.r(ne),r.d(ne,{base64:function(){return im},base64pad:function(){return sm},base64url:function(){return om},base64urlpad:function(){return am}});var ie={};r.r(ie),r.d(ie,{base256emoji:function(){return fm}});var se={};r.r(se),r.d(se,{sha256:function(){return Km},sha512:function(){return qm}});var oe={};r.r(oe),r.d(oe,{identity:function(){return Jm}});var ae={};r.r(ae),r.d(ae,{code:function(){return Xm},decode:function(){return ew},encode:function(){return Zm},name:function(){return Qm}});var ce={};r.r(ce),r.d(ce,{code:function(){return iw},decode:function(){return ow},encode:function(){return sw},name:function(){return nw}});var le={};r.r(le),r.d(le,{base58btc:function(){return Vv},base58flickr:function(){return zv}});var ue={};r.r(ue),r.d(ue,{base32:function(){return Fv},base32hex:function(){return Hv},base32hexpad:function(){return Wv},base32hexpadupper:function(){return Yv},base32hexupper:function(){return Gv},base32pad:function(){return Kv},base32padupper:function(){return qv},base32upper:function(){return $v},base32z:function(){return Jv}});var he={};r.r(he),r.d(he,{identity:function(){return cE}});var de={};r.r(de),r.d(de,{base2:function(){return lE}});var fe={};r.r(fe),r.d(fe,{base8:function(){return uE}});var pe={};r.r(pe),r.d(pe,{base10:function(){return hE}});var ye={};r.r(ye),r.d(ye,{base16:function(){return dE},base16upper:function(){return fE}});var ge={};r.r(ge),r.d(ge,{base36:function(){return pE},base36upper:function(){return yE}});var me={};r.r(me),r.d(me,{base64:function(){return gE},base64pad:function(){return mE},base64url:function(){return wE},base64urlpad:function(){return bE}});var we={};r.r(we),r.d(we,{base256emoji:function(){return IE}});var be={};r.r(be),r.d(be,{sha256:function(){return RE},sha512:function(){return PE}});var ve={};r.r(ve),r.d(ve,{identity:function(){return LE}});var Ee={};r.r(Ee),r.d(Ee,{code:function(){return UE},decode:function(){return jE},encode:function(){return ME},name:function(){return BE}});var _e={};r.r(_e),r.d(_e,{code:function(){return $E},decode:function(){return qE},encode:function(){return KE},name:function(){return FE}});var Se={};r.r(Se),r.d(Se,{identity:function(){return pS}});var Ae={};r.r(Ae),r.d(Ae,{base2:function(){return yS}});var Ie={};r.r(Ie),r.d(Ie,{base8:function(){return gS}});var Ce={};r.r(Ce),r.d(Ce,{base10:function(){return mS}});var ke={};r.r(ke),r.d(ke,{base16:function(){return wS},base16upper:function(){return bS}});var Te={};r.r(Te),r.d(Te,{base32:function(){return vS},base32hex:function(){return AS},base32hexpad:function(){return CS},base32hexpadupper:function(){return kS},base32hexupper:function(){return IS},base32pad:function(){return _S},base32padupper:function(){return SS},base32upper:function(){return ES},base32z:function(){return TS}});var Re={};r.r(Re),r.d(Re,{base36:function(){return RS},base36upper:function(){return PS}});var Pe={};r.r(Pe),r.d(Pe,{base58btc:function(){return xS},base58flickr:function(){return DS}});var xe={};r.r(xe),r.d(xe,{base64:function(){return OS},base64pad:function(){return NS},base64url:function(){return LS},base64urlpad:function(){return BS}});var De={};r.r(De),r.d(De,{base256emoji:function(){return FS}});var Oe={};r.r(Oe),r.d(Oe,{sha256:function(){return bA},sha512:function(){return vA}});var Ne={};r.r(Ne),r.d(Ne,{identity:function(){return IA}});var Le={};r.r(Le),r.d(Le,{code:function(){return kA},decode:function(){return RA},encode:function(){return TA},name:function(){return CA}});var Be={};r.r(Be),r.d(Be,{code:function(){return OA},decode:function(){return LA},encode:function(){return NA},name:function(){return DA}});var Ue={};r.r(Ue),r.d(Ue,{RsaPrivateKey:function(){return RC},RsaPublicKey:function(){return TC},fromJwk:function(){return DC},generateKeyPair:function(){return OC},unmarshalRsaPrivateKey:function(){return PC},unmarshalRsaPublicKey:function(){return xC}});var Me={};r.r(Me),r.d(Me,{Ed25519PrivateKey:function(){return $k},Ed25519PublicKey:function(){return Fk},generateKeyPair:function(){return Hk},generateKeyPairFromSeed:function(){return Gk},unmarshalEd25519PrivateKey:function(){return Kk},unmarshalEd25519PublicKey:function(){return qk}});var je={};r.r(je),r.d(je,{Secp256k1PrivateKey:function(){return nT},Secp256k1PublicKey:function(){return rT},generateKeyPair:function(){return oT},unmarshalSecp256k1PrivateKey:function(){return iT},unmarshalSecp256k1PublicKey:function(){return sT}});var Ve={};r.r(Ve),r.d(Ve,{identity:function(){return $D}});var ze={};r.r(ze),r.d(ze,{base2:function(){return KD}});var Fe={};r.r(Fe),r.d(Fe,{base8:function(){return qD}});var $e={};r.r($e),r.d($e,{base10:function(){return HD}});var Ke={};r.r(Ke),r.d(Ke,{base16:function(){return GD},base16upper:function(){return WD}});var qe={};r.r(qe),r.d(qe,{base32:function(){return YD},base32hex:function(){return ZD},base32hexpad:function(){return tO},base32hexpadupper:function(){return rO},base32hexupper:function(){return eO},base32pad:function(){return QD},base32padupper:function(){return XD},base32upper:function(){return JD},base32z:function(){return nO}});var He={};r.r(He),r.d(He,{base36:function(){return iO},base36upper:function(){return sO}});var Ge={};r.r(Ge),r.d(Ge,{base58btc:function(){return oO},base58flickr:function(){return aO}});var We={};r.r(We),r.d(We,{base64:function(){return cO},base64pad:function(){return lO},base64url:function(){return uO},base64urlpad:function(){return hO}});var Ye={};r.r(Ye),r.d(Ye,{base256emoji:function(){return mO}});var Je={};r.r(Je),r.d(Je,{sha256:function(){return WO},sha512:function(){return YO}});var Qe={};r.r(Qe),r.d(Qe,{identity:function(){return eN}});var Xe={};r.r(Xe),r.d(Xe,{code:function(){return rN},decode:function(){return iN},encode:function(){return nN},name:function(){return tN}});var Ze={};r.r(Ze),r.d(Ze,{code:function(){return cN},decode:function(){return uN},encode:function(){return lN},name:function(){return aN}});var et={};r.r(et),r.d(et,{identity:function(){return gB}});var tt={};r.r(tt),r.d(tt,{base2:function(){return mB}});var rt={};r.r(rt),r.d(rt,{base8:function(){return wB}});var nt={};r.r(nt),r.d(nt,{base10:function(){return bB}});var it={};r.r(it),r.d(it,{base16:function(){return vB},base16upper:function(){return EB}});var st={};r.r(st),r.d(st,{base32:function(){return _B},base32hex:function(){return CB},base32hexpad:function(){return TB},base32hexpadupper:function(){return RB},base32hexupper:function(){return kB},base32pad:function(){return AB},base32padupper:function(){return IB},base32upper:function(){return SB},base32z:function(){return PB}});var ot={};r.r(ot),r.d(ot,{base36:function(){return xB},base36upper:function(){return DB}});var at={};r.r(at),r.d(at,{base58btc:function(){return OB},base58flickr:function(){return NB}});var ct={};r.r(ct),r.d(ct,{base64:function(){return LB},base64pad:function(){return BB},base64url:function(){return UB},base64urlpad:function(){return MB}});var lt={};r.r(lt),r.d(lt,{base256emoji:function(){return KB}});var ut={};r.r(ut),r.d(ut,{sha256:function(){return EU},sha512:function(){return _U}});var ht={};r.r(ht),r.d(ht,{identity:function(){return kU}});var dt={};r.r(dt),r.d(dt,{code:function(){return RU},decode:function(){return xU},encode:function(){return PU},name:function(){return TU}});var ft={};r.r(ft),r.d(ft,{code:function(){return LU},decode:function(){return UU},encode:function(){return BU},name:function(){return NU}});var pt={};r.r(pt),r.d(pt,{InvalidValueError:function(){return $J},MissingRepoOptionsError:function(){return KJ},NonReversibleMigrationError:function(){return VJ},NotInitializedRepoError:function(){return zJ},RequiredParameterError:function(){return FJ}});var yt={};r.r(yt),r.d(yt,{identity:function(){return jX}});var gt={};r.r(gt),r.d(gt,{base2:function(){return VX}});var mt={};r.r(mt),r.d(mt,{base8:function(){return zX}});var wt={};r.r(wt),r.d(wt,{base10:function(){return FX}});var bt={};r.r(bt),r.d(bt,{base16:function(){return $X},base16upper:function(){return KX}});var vt={};r.r(vt),r.d(vt,{base32:function(){return qX},base32hex:function(){return YX},base32hexpad:function(){return QX},base32hexpadupper:function(){return XX},base32hexupper:function(){return JX},base32pad:function(){return GX},base32padupper:function(){return WX},base32upper:function(){return HX},base32z:function(){return ZX}});var Et={};r.r(Et),r.d(Et,{base36:function(){return eZ},base36upper:function(){return tZ}});var _t={};r.r(_t),r.d(_t,{base58btc:function(){return rZ},base58flickr:function(){return nZ}});var St={};r.r(St),r.d(St,{base64:function(){return iZ},base64pad:function(){return sZ},base64url:function(){return oZ},base64urlpad:function(){return aZ}});var At={};r.r(At),r.d(At,{base256emoji:function(){return fZ}});var It={};r.r(It),r.d(It,{sha256:function(){return KZ},sha512:function(){return qZ}});var Ct={};r.r(Ct),r.d(Ct,{identity:function(){return JZ}});var kt={};r.r(kt),r.d(kt,{code:function(){return XZ},decode:function(){return e1},encode:function(){return ZZ},name:function(){return QZ}});var Tt={};r.r(Tt),r.d(Tt,{code:function(){return i1},decode:function(){return o1},encode:function(){return s1},name:function(){return n1}});var Rt={};r.r(Rt),r.d(Rt,{Decoder:function(){return z7},Encoder:function(){return V7},PacketType:function(){return j7},protocol:function(){return M7}});var Pt={};r.r(Pt),r.d(Pt,{identity:function(){return p9}});var xt={};r.r(xt),r.d(xt,{base2:function(){return y9}});var Dt={};r.r(Dt),r.d(Dt,{base8:function(){return g9}});var Ot={};r.r(Ot),r.d(Ot,{base10:function(){return m9}});var Nt={};r.r(Nt),r.d(Nt,{base16:function(){return w9},base16upper:function(){return b9}});var Lt={};r.r(Lt),r.d(Lt,{base32:function(){return v9},base32hex:function(){return A9},base32hexpad:function(){return C9},base32hexpadupper:function(){return k9},base32hexupper:function(){return I9},base32pad:function(){return _9},base32padupper:function(){return S9},base32upper:function(){return E9},base32z:function(){return T9}});var Bt={};r.r(Bt),r.d(Bt,{base36:function(){return R9},base36upper:function(){return P9}});var Ut={};r.r(Ut),r.d(Ut,{base58btc:function(){return x9},base58flickr:function(){return D9}});var Mt={};r.r(Mt),r.d(Mt,{base64:function(){return O9},base64pad:function(){return N9},base64url:function(){return L9},base64urlpad:function(){return B9}});var jt={};r.r(jt),r.d(jt,{base256emoji:function(){return F9}});var Vt={};r.r(Vt),r.d(Vt,{sha256:function(){return bee},sha512:function(){return vee}});var zt={};r.r(zt),r.d(zt,{identity:function(){return Iee}});var Ft={};r.r(Ft),r.d(Ft,{code:function(){return kee},decode:function(){return Ree},encode:function(){return Tee},name:function(){return Cee}});var $t={};r.r($t),r.d($t,{code:function(){return Oee},decode:function(){return Lee},encode:function(){return Nee},name:function(){return Dee}});var Kt={};r.r(Kt),r.d(Kt,{identity:function(){return eie}});var qt={};r.r(qt),r.d(qt,{base2:function(){return tie}});var Ht={};r.r(Ht),r.d(Ht,{base8:function(){return rie}});var Gt={};r.r(Gt),r.d(Gt,{base10:function(){return nie}});var Wt={};r.r(Wt),r.d(Wt,{base16:function(){return iie},base16upper:function(){return sie}});var Yt={};r.r(Yt),r.d(Yt,{base32:function(){return oie},base32hex:function(){return uie},base32hexpad:function(){return die},base32hexpadupper:function(){return fie},base32hexupper:function(){return hie},base32pad:function(){return cie},base32padupper:function(){return lie},base32upper:function(){return aie},base32z:function(){return pie}});var Jt={};r.r(Jt),r.d(Jt,{base36:function(){return yie},base36upper:function(){return gie}});var Qt={};r.r(Qt),r.d(Qt,{base58btc:function(){return mie},base58flickr:function(){return wie}});var Xt={};r.r(Xt),r.d(Xt,{base64:function(){return bie},base64pad:function(){return vie},base64url:function(){return Eie},base64urlpad:function(){return _ie}});var Zt={};r.r(Zt),r.d(Zt,{base256emoji:function(){return Tie}});var er={};r.r(er),r.d(er,{sha256:function(){return sse},sha512:function(){return ose}});var tr={};r.r(tr),r.d(tr,{identity:function(){return hse}});var rr={};r.r(rr),r.d(rr,{code:function(){return fse},decode:function(){return yse},encode:function(){return pse},name:function(){return dse}});var nr={};r.r(nr),r.d(nr,{code:function(){return bse},decode:function(){return Ese},encode:function(){return vse},name:function(){return wse}});var ir={};r.r(ir),r.d(ir,{identity:function(){return Jae}});var sr={};r.r(sr),r.d(sr,{base2:function(){return Qae}});var or={};r.r(or),r.d(or,{base8:function(){return Xae}});var ar={};r.r(ar),r.d(ar,{base10:function(){return Zae}});var cr={};r.r(cr),r.d(cr,{base16:function(){return ece},base16upper:function(){return tce}});var lr={};r.r(lr),r.d(lr,{base32:function(){return rce},base32hex:function(){return oce},base32hexpad:function(){return cce},base32hexpadupper:function(){return lce},base32hexupper:function(){return ace},base32pad:function(){return ice},base32padupper:function(){return sce},base32upper:function(){return nce},base32z:function(){return uce}});var ur={};r.r(ur),r.d(ur,{base36:function(){return hce},base36upper:function(){return dce}});var hr={};r.r(hr),r.d(hr,{base58btc:function(){return fce},base58flickr:function(){return pce}});var dr={};r.r(dr),r.d(dr,{base64:function(){return yce},base64pad:function(){return gce},base64url:function(){return mce},base64urlpad:function(){return wce}});var fr={};r.r(fr),r.d(fr,{base256emoji:function(){return Ace}});var pr={};r.r(pr),r.d(pr,{sha256:function(){return tle},sha512:function(){return rle}});var yr={};r.r(yr),r.d(yr,{identity:function(){return ale}});var gr={};r.r(gr),r.d(gr,{code:function(){return lle},decode:function(){return hle},encode:function(){return ule},name:function(){return cle}});var mr={};r.r(mr),r.d(mr,{code:function(){return yle},decode:function(){return mle},encode:function(){return gle},name:function(){return ple}});var wr={};r.r(wr),r.d(wr,{identity:function(){return Ahe}});var br={};r.r(br),r.d(br,{base2:function(){return Ihe}});var vr={};r.r(vr),r.d(vr,{base8:function(){return Che}});var Er={};r.r(Er),r.d(Er,{base10:function(){return khe}});var _r={};r.r(_r),r.d(_r,{base16:function(){return The},base16upper:function(){return Rhe}});var Sr={};r.r(Sr),r.d(Sr,{base32:function(){return Phe},base32hex:function(){return Nhe},base32hexpad:function(){return Bhe},base32hexpadupper:function(){return Uhe},base32hexupper:function(){return Lhe},base32pad:function(){return Dhe},base32padupper:function(){return Ohe},base32upper:function(){return xhe},base32z:function(){return Mhe}});var Ar={};r.r(Ar),r.d(Ar,{base36:function(){return jhe},base36upper:function(){return Vhe}});var Ir={};r.r(Ir),r.d(Ir,{base58btc:function(){return zhe},base58flickr:function(){return Fhe}});var Cr={};r.r(Cr),r.d(Cr,{base64:function(){return $he},base64pad:function(){return Khe},base64url:function(){return qhe},base64urlpad:function(){return Hhe}});var kr={};r.r(kr),r.d(kr,{base256emoji:function(){return Xhe}});var Tr={};r.r(Tr),r.d(Tr,{sha256:function(){return Rde},sha512:function(){return Pde}});var Rr={};r.r(Rr),r.d(Rr,{identity:function(){return Lde}});var Pr={};r.r(Pr),r.d(Pr,{code:function(){return Ude},decode:function(){return jde},encode:function(){return Mde},name:function(){return Bde}});var xr={};r.r(xr),r.d(xr,{code:function(){return $de},decode:function(){return qde},encode:function(){return Kde},name:function(){return Fde}});var Dr={};r.r(Dr),r.d(Dr,{identity:function(){return dpe}});var Or={};r.r(Or),r.d(Or,{base2:function(){return fpe}});var Nr={};r.r(Nr),r.d(Nr,{base8:function(){return ppe}});var Lr={};r.r(Lr),r.d(Lr,{base10:function(){return ype}});var Br={};r.r(Br),r.d(Br,{base16:function(){return gpe},base16upper:function(){return mpe}});var Ur={};r.r(Ur),r.d(Ur,{base32:function(){return wpe},base32hex:function(){return _pe},base32hexpad:function(){return Ape},base32hexpadupper:function(){return Ipe},base32hexupper:function(){return Spe},base32pad:function(){return vpe},base32padupper:function(){return Epe},base32upper:function(){return bpe},base32z:function(){return Cpe}});var Mr={};r.r(Mr),r.d(Mr,{base36:function(){return kpe},base36upper:function(){return Tpe}});var jr={};r.r(jr),r.d(jr,{base58btc:function(){return Rpe},base58flickr:function(){return Ppe}});var Vr={};r.r(Vr),r.d(Vr,{base64:function(){return xpe},base64pad:function(){return Dpe},base64url:function(){return Ope},base64urlpad:function(){return Npe}});var zr={};r.r(zr),r.d(zr,{base256emoji:function(){return Vpe}});var Fr={};r.r(Fr),r.d(Fr,{sha256:function(){return mye},sha512:function(){return wye}});var $r={};r.r($r),r.d($r,{identity:function(){return Sye}});var Kr={};r.r(Kr),r.d(Kr,{code:function(){return Iye},decode:function(){return kye},encode:function(){return Cye},name:function(){return Aye}});var qr={};r.r(qr),r.d(qr,{code:function(){return xye},decode:function(){return Oye},encode:function(){return Dye},name:function(){return Pye}});var Hr={};r.r(Hr),r.d(Hr,{abortedError:function(){return sbe},notFoundError:function(){return ibe}});var Gr=r(942),Wr=Gr,Yr=r(106),Jr=r(1227);function Qr(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var Xr=Qr,Zr=Xr,en=Zr;new Uint8Array(0);const tn=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class rn{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class nn{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return on(this,e)}}class sn{constructor(e){this.decoders=e}or(e){return on(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const on=(e,t)=>new sn({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class an{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new rn(e,t,r),this.decoder=new nn(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const cn=({name:e,prefix:t,encode:r,decode:n})=>new an(e,t,r,n),ln=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=en(r,t);return cn({prefix:e,name:t,encode:n,decode:e=>tn(i(e))})},un=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},hn=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},dn=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>cn({prefix:t,name:e,encode(e){return hn(e,n,r)},decode(t){return un(t,n,r,e)}}),fn=ln({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),pn=(ln({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),dn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),yn=(dn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),dn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),dn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),dn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),dn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),dn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),dn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),dn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),dn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}));dn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),dn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),dn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function gn(e){return Object.assign(Jr(e),{error:Jr(`${e}:error`),trace:Jr(`${e}:trace`)})}Jr.formatters.b=e=>null==e?"undefined":fn.baseEncode(e),Jr.formatters.t=e=>null==e?"undefined":pn.baseEncode(e),Jr.formatters.m=e=>null==e?"undefined":yn.baseEncode(e),Jr.formatters.p=e=>null==e?"undefined":e.toString(),Jr.formatters.c=e=>null==e?"undefined":e.toString(),Jr.formatters.k=e=>null==e?"undefined":e.toString();var mn=r(2114),wn=r(2100);const bn=wn.Reader,vn=wn.Writer,En=wn.util,_n=wn.roots["ipfs-unixfs"]||(wn.roots["ipfs-unixfs"]={}),Sn=_n.Data=(()=>{function e(e){if(this.blocksizes=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Type=0,e.prototype.Data=En.newBuffer([]),e.prototype.filesize=En.Long?En.Long.fromBits(0,0,!0):0,e.prototype.blocksizes=En.emptyArray,e.prototype.hashType=En.Long?En.Long.fromBits(0,0,!0):0,e.prototype.fanout=En.Long?En.Long.fromBits(0,0,!0):0,e.prototype.mode=0,e.prototype.mtime=null,e.encode=function(e,t){if(t||(t=vn.create()),t.uint32(8).int32(e.Type),null!=e.Data&&Object.hasOwnProperty.call(e,"Data")&&t.uint32(18).bytes(e.Data),null!=e.filesize&&Object.hasOwnProperty.call(e,"filesize")&&t.uint32(24).uint64(e.filesize),null!=e.blocksizes&&e.blocksizes.length)for(var r=0;r<e.blocksizes.length;++r)t.uint32(32).uint64(e.blocksizes[r]);return null!=e.hashType&&Object.hasOwnProperty.call(e,"hashType")&&t.uint32(40).uint64(e.hashType),null!=e.fanout&&Object.hasOwnProperty.call(e,"fanout")&&t.uint32(48).uint64(e.fanout),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(56).uint32(e.mode),null!=e.mtime&&Object.hasOwnProperty.call(e,"mtime")&&_n.UnixTime.encode(e.mtime,t.uint32(66).fork()).ldelim(),t},e.decode=function(e,t){e instanceof bn||(e=bn.create(e));var r=void 0===t?e.len:e.pos+t,n=new _n.Data;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.Type=e.int32();break;case 2:n.Data=e.bytes();break;case 3:n.filesize=e.uint64();break;case 4:if(n.blocksizes&&n.blocksizes.length||(n.blocksizes=[]),2===(7&i)){var s=e.uint32()+e.pos;while(e.pos<s)n.blocksizes.push(e.uint64())}else n.blocksizes.push(e.uint64());break;case 5:n.hashType=e.uint64();break;case 6:n.fanout=e.uint64();break;case 7:n.mode=e.uint32();break;case 8:n.mtime=_n.UnixTime.decode(e,e.uint32());break;default:e.skipType(7&i);break}}if(!n.hasOwnProperty("Type"))throw En.ProtocolError("missing required 'Type'",{instance:n});return n},e.fromObject=function(e){if(e instanceof _n.Data)return e;var t=new _n.Data;switch(e.Type){case"Raw":case 0:t.Type=0;break;case"Directory":case 1:t.Type=1;break;case"File":case 2:t.Type=2;break;case"Metadata":case 3:t.Type=3;break;case"Symlink":case 4:t.Type=4;break;case"HAMTShard":case 5:t.Type=5;break}if(null!=e.Data&&("string"===typeof e.Data?En.base64.decode(e.Data,t.Data=En.newBuffer(En.base64.length(e.Data)),0):e.Data.length&&(t.Data=e.Data)),null!=e.filesize&&(En.Long?(t.filesize=En.Long.fromValue(e.filesize)).unsigned=!0:"string"===typeof e.filesize?t.filesize=parseInt(e.filesize,10):"number"===typeof e.filesize?t.filesize=e.filesize:"object"===typeof e.filesize&&(t.filesize=new En.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0))),e.blocksizes){if(!Array.isArray(e.blocksizes))throw TypeError(".Data.blocksizes: array expected");t.blocksizes=[];for(var r=0;r<e.blocksizes.length;++r)En.Long?(t.blocksizes[r]=En.Long.fromValue(e.blocksizes[r])).unsigned=!0:"string"===typeof e.blocksizes[r]?t.blocksizes[r]=parseInt(e.blocksizes[r],10):"number"===typeof e.blocksizes[r]?t.blocksizes[r]=e.blocksizes[r]:"object"===typeof e.blocksizes[r]&&(t.blocksizes[r]=new En.LongBits(e.blocksizes[r].low>>>0,e.blocksizes[r].high>>>0).toNumber(!0))}if(null!=e.hashType&&(En.Long?(t.hashType=En.Long.fromValue(e.hashType)).unsigned=!0:"string"===typeof e.hashType?t.hashType=parseInt(e.hashType,10):"number"===typeof e.hashType?t.hashType=e.hashType:"object"===typeof e.hashType&&(t.hashType=new En.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0))),null!=e.fanout&&(En.Long?(t.fanout=En.Long.fromValue(e.fanout)).unsigned=!0:"string"===typeof e.fanout?t.fanout=parseInt(e.fanout,10):"number"===typeof e.fanout?t.fanout=e.fanout:"object"===typeof e.fanout&&(t.fanout=new En.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0))),null!=e.mode&&(t.mode=e.mode>>>0),null!=e.mtime){if("object"!==typeof e.mtime)throw TypeError(".Data.mtime: object expected");t.mtime=_n.UnixTime.fromObject(e.mtime)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.blocksizes=[]),t.defaults){if(r.Type=t.enums===String?"Raw":0,t.bytes===String?r.Data="":(r.Data=[],t.bytes!==Array&&(r.Data=En.newBuffer(r.Data))),En.Long){var n=new En.Long(0,0,!0);r.filesize=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.filesize=t.longs===String?"0":0;if(En.Long){n=new En.Long(0,0,!0);r.hashType=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.hashType=t.longs===String?"0":0;if(En.Long){n=new En.Long(0,0,!0);r.fanout=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.fanout=t.longs===String?"0":0;r.mode=0,r.mtime=null}if(null!=e.Type&&e.hasOwnProperty("Type")&&(r.Type=t.enums===String?_n.Data.DataType[e.Type]:e.Type),null!=e.Data&&e.hasOwnProperty("Data")&&(r.Data=t.bytes===String?En.base64.encode(e.Data,0,e.Data.length):t.bytes===Array?Array.prototype.slice.call(e.Data):e.Data),null!=e.filesize&&e.hasOwnProperty("filesize")&&("number"===typeof e.filesize?r.filesize=t.longs===String?String(e.filesize):e.filesize:r.filesize=t.longs===String?En.Long.prototype.toString.call(e.filesize):t.longs===Number?new En.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0):e.filesize),e.blocksizes&&e.blocksizes.length){r.blocksizes=[];for(var i=0;i<e.blocksizes.length;++i)"number"===typeof e.blocksizes[i]?r.blocksizes[i]=t.longs===String?String(e.blocksizes[i]):e.blocksizes[i]:r.blocksizes[i]=t.longs===String?En.Long.prototype.toString.call(e.blocksizes[i]):t.longs===Number?new En.LongBits(e.blocksizes[i].low>>>0,e.blocksizes[i].high>>>0).toNumber(!0):e.blocksizes[i]}return null!=e.hashType&&e.hasOwnProperty("hashType")&&("number"===typeof e.hashType?r.hashType=t.longs===String?String(e.hashType):e.hashType:r.hashType=t.longs===String?En.Long.prototype.toString.call(e.hashType):t.longs===Number?new En.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0):e.hashType),null!=e.fanout&&e.hasOwnProperty("fanout")&&("number"===typeof e.fanout?r.fanout=t.longs===String?String(e.fanout):e.fanout:r.fanout=t.longs===String?En.Long.prototype.toString.call(e.fanout):t.longs===Number?new En.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0):e.fanout),null!=e.mode&&e.hasOwnProperty("mode")&&(r.mode=e.mode),null!=e.mtime&&e.hasOwnProperty("mtime")&&(r.mtime=_n.UnixTime.toObject(e.mtime,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e.DataType=function(){const e={},t=Object.create(e);return t[e[0]="Raw"]=0,t[e[1]="Directory"]=1,t[e[2]="File"]=2,t[e[3]="Metadata"]=3,t[e[4]="Symlink"]=4,t[e[5]="HAMTShard"]=5,t}(),e})(),An=(_n.UnixTime=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Seconds=En.Long?En.Long.fromBits(0,0,!1):0,e.prototype.FractionalNanoseconds=0,e.encode=function(e,t){return t||(t=vn.create()),t.uint32(8).int64(e.Seconds),null!=e.FractionalNanoseconds&&Object.hasOwnProperty.call(e,"FractionalNanoseconds")&&t.uint32(21).fixed32(e.FractionalNanoseconds),t},e.decode=function(e,t){e instanceof bn||(e=bn.create(e));var r=void 0===t?e.len:e.pos+t,n=new _n.UnixTime;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.Seconds=e.int64();break;case 2:n.FractionalNanoseconds=e.fixed32();break;default:e.skipType(7&i);break}}if(!n.hasOwnProperty("Seconds"))throw En.ProtocolError("missing required 'Seconds'",{instance:n});return n},e.fromObject=function(e){if(e instanceof _n.UnixTime)return e;var t=new _n.UnixTime;return null!=e.Seconds&&(En.Long?(t.Seconds=En.Long.fromValue(e.Seconds)).unsigned=!1:"string"===typeof e.Seconds?t.Seconds=parseInt(e.Seconds,10):"number"===typeof e.Seconds?t.Seconds=e.Seconds:"object"===typeof e.Seconds&&(t.Seconds=new En.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber())),null!=e.FractionalNanoseconds&&(t.FractionalNanoseconds=e.FractionalNanoseconds>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(En.Long){var n=new En.Long(0,0,!1);r.Seconds=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.Seconds=t.longs===String?"0":0;r.FractionalNanoseconds=0}return null!=e.Seconds&&e.hasOwnProperty("Seconds")&&("number"===typeof e.Seconds?r.Seconds=t.longs===String?String(e.Seconds):e.Seconds:r.Seconds=t.longs===String?En.Long.prototype.toString.call(e.Seconds):t.longs===Number?new En.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber():e.Seconds),null!=e.FractionalNanoseconds&&e.hasOwnProperty("FractionalNanoseconds")&&(r.FractionalNanoseconds=e.FractionalNanoseconds),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e})(),_n.Metadata=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.MimeType="",e.encode=function(e,t){return t||(t=vn.create()),null!=e.MimeType&&Object.hasOwnProperty.call(e,"MimeType")&&t.uint32(10).string(e.MimeType),t},e.decode=function(e,t){e instanceof bn||(e=bn.create(e));var r=void 0===t?e.len:e.pos+t,n=new _n.Metadata;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.MimeType=e.string();break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof _n.Metadata)return e;var t=new _n.Metadata;return null!=e.MimeType&&(t.MimeType=String(e.MimeType)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.MimeType=""),null!=e.MimeType&&e.hasOwnProperty("MimeType")&&(r.MimeType=e.MimeType),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e})(),Sn),In=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],Cn=["directory","hamt-sharded-directory"],kn=parseInt("0644",8),Tn=parseInt("0755",8);function Rn(e){if(null!=e)return"number"===typeof e?4095&e:(e=e.toString(),"0"===e.substring(0,1)?4095&parseInt(e,8):4095&parseInt(e,10))}function Pn(e){if(null==e)return;let t;if(null!=e.secs&&(t={secs:e.secs,nsecs:e.nsecs}),null!=e.Seconds&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const r=e.getTime(),n=Math.floor(r/1e3);t={secs:n,nsecs:1e3*(r-1e3*n)}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(null!=t&&null!=t.nsecs&&(t.nsecs<0||t.nsecs>999999999))throw mn(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}class xn{static unmarshal(e){const t=An.decode(e),r=An.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}),n=new xn({type:In[r.Type],data:r.Data,blockSizes:r.blocksizes,mode:r.mode,mtime:r.mtime?{secs:r.mtime.Seconds,nsecs:r.mtime.FractionalNanoseconds}:void 0});return n._originalMode=r.mode||0,n}constructor(e={type:"file"}){const{type:t,data:r,blockSizes:n,hashType:i,fanout:s,mtime:o,mode:a}=e;if(t&&!In.includes(t))throw mn(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=t||"file",this.data=r,this.hashType=i,this.fanout=s,this.blockSizes=n||[],this._originalMode=0,this.mode=Rn(a),o&&(this.mtime=Pn(o),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?Tn:kn;const t=Rn(e);void 0!==t&&(this._mode=t)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&Cn.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach((t=>{e+=t})),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=An.DataType.Raw;break;case"directory":e=An.DataType.Directory;break;case"file":e=An.DataType.File;break;case"metadata":e=An.DataType.Metadata;break;case"symlink":e=An.DataType.Symlink;break;case"hamt-sharded-directory":e=An.DataType.HAMTShard;break;default:throw mn(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let t,r,n=this.data;if(this.data&&this.data.length||(n=void 0),null!=this.mode&&(t=4294963200&this._originalMode|(Rn(this.mode)||0),t!==kn||this.isDirectory()||(t=void 0),t===Tn&&this.isDirectory()&&(t=void 0)),null!=this.mtime){const e=Pn(this.mtime);e&&(r={Seconds:e.secs,FractionalNanoseconds:e.nsecs},0===r.FractionalNanoseconds&&delete r.FractionalNanoseconds)}const i={Type:e,Data:n,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:t,mtime:r};return An.encode(i).finish()}}var Dn=Un,On=128,Nn=127,Ln=~Nn,Bn=Math.pow(2,31);function Un(e,t,r){t=t||[],r=r||0;var n=r;while(e>=Bn)t[r++]=255&e|On,e/=128;while(e&Ln)t[r++]=255&e|On,e>>>=7;return t[r]=0|e,Un.bytes=r-n+1,t}var Mn=zn,jn=128,Vn=127;function zn(e,t){var r,n=0,i=(t=t||0,0),s=t,o=e.length;do{if(s>=o)throw zn.bytes=0,new RangeError("Could not decode varint");r=e[s++],n+=i<28?(r&Vn)<<i:(r&Vn)*Math.pow(2,i),i+=7}while(r>=jn);return zn.bytes=s-t,n}var Fn=Math.pow(2,7),$n=Math.pow(2,14),Kn=Math.pow(2,21),qn=Math.pow(2,28),Hn=Math.pow(2,35),Gn=Math.pow(2,42),Wn=Math.pow(2,49),Yn=Math.pow(2,56),Jn=Math.pow(2,63),Qn=function(e){return e<Fn?1:e<$n?2:e<Kn?3:e<qn?4:e<Hn?5:e<Gn?6:e<Wn?7:e<Yn?8:e<Jn?9:10},Xn={encode:Dn,decode:Mn,encodingLength:Qn},Zn=Xn,ei=Zn;const ti=(e,t=0)=>{const r=ei.decode(e,t);return[r,ei.decode.bytes]},ri=(e,t,r=0)=>(ei.encode(e,t,r),t),ni=e=>ei.encodingLength(e),ii=new Uint8Array(0),si=e=>{const t=e.match(/../g);return t?new Uint8Array(t.map((e=>parseInt(e,16)))):ii},oi=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},ai=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},ci=e=>(new TextEncoder).encode(e),li=e=>(new TextDecoder).decode(e),ui=(e,t)=>{const r=t.byteLength,n=ni(e),i=n+ni(r),s=new Uint8Array(i+r);return ri(e,s,0),ri(r,s,n),s.set(t,i),new fi(e,r,t,s)},hi=e=>{const t=ai(e),[r,n]=ti(t),[i,s]=ti(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new fi(r,i,o,t)},di=(e,t)=>e===t||e.code===t.code&&e.size===t.size&&oi(e.bytes,t.bytes);class fi{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}function pi(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var yi=pi,gi=yi,mi=gi;class wi{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class bi{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Ei(this,e)}}class vi{constructor(e){this.decoders=e}or(e){return Ei(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ei=(e,t)=>new vi({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class _i{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new wi(e,t,r),this.decoder=new bi(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Si=({name:e,prefix:t,encode:r,decode:n})=>new _i(e,t,r,n),Ai=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=mi(r,t);return Si({prefix:e,name:t,encode:n,decode:e=>ai(i(e))})},Ii=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Ci=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},ki=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Si({prefix:t,name:e,encode(e){return Ci(e,n,r)},decode(t){return Ii(t,n,r,e)}}),Ti=Ai({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ri=Ai({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Pi=ki({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),xi=ki({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Di=ki({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Oi=ki({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ni=ki({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Li=ki({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Bi=ki({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ui=ki({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Mi=ki({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});class ji{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this.byteOffset=n.byteOffset,this.byteLength=n.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Wi,byteLength:Wi,code:Gi,version:Gi,multihash:Gi,bytes:Gi,_baseCache:Wi,asCID:Wi})}toV0(){switch(this.version){case 0:return this;default:{const{code:e,multihash:t}=this;if(e!==$i)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Ki)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ji.createV0(t)}}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=ui(e,t);return ji.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&di(this.multihash,e.multihash)}toString(e){const{bytes:t,version:r,_baseCache:n}=this;switch(r){case 0:return zi(t,n,e||Ti.encoder);default:return Fi(t,n,e||Pi.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return Ji(/^0\.0/,Qi),!(!e||!e[Hi]&&e.asCID!==e)}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof ji)return e;if(null!=e&&e.asCID===e){const{version:t,code:r,multihash:n,bytes:i}=e;return new ji(t,r,n,i||qi(t,r,n.bytes))}if(null!=e&&!0===e[Hi]){const{version:t,multihash:r,code:n}=e,i=hi(r);return ji.create(t,n,i)}return null}static create(e,t,r){if("number"!==typeof t)throw new Error("String codecs are no longer supported");switch(e){case 0:if(t!==$i)throw new Error(`Version 0 CID must use dag-pb (code: ${$i}) block encoding`);return new ji(e,t,r,r.bytes);case 1:{const n=qi(e,t,r.bytes);return new ji(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return ji.create(0,$i,e)}static createV1(e,t){return ji.create(1,e,t)}static decode(e){const[t,r]=ji.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=ji.inspectBytes(e),r=t.size-t.multihashSize,n=ai(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new fi(t.multihashCode,t.digestSize,i,n),o=0===t.version?ji.createV0(s):ji.createV1(t.codec,s);return[o,e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=ti(e.subarray(t));return t+=n,r};let n=r(),i=$i;if(18===n?(n=0,t=0):1===n&&(i=r()),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a,l=c-s;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:l,size:c}}static parse(e,t){const[r,n]=Vi(e,t),i=ji.decode(n);return i._baseCache.set(r,e),i}}const Vi=(e,t)=>{switch(e[0]){case"Q":{const r=t||Ti;return[Ti.prefix,r.decode(`${Ti.prefix}${e}`)]}case Ti.prefix:{const r=t||Ti;return[Ti.prefix,r.decode(e)]}case Pi.prefix:{const r=t||Pi;return[Pi.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},zi=(e,t,r)=>{const{prefix:n}=r;if(n!==Ti.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i},Fi=(e,t,r)=>{const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i},$i=112,Ki=18,qi=(e,t,r)=>{const n=ni(e),i=n+ni(t),s=new Uint8Array(i+r.byteLength);return ri(e,s,0),ri(t,s,n),s.set(r,i),s},Hi=Symbol.for("@ipld/js-cid/CID"),Gi={writable:!1,configurable:!1,enumerable:!0},Wi={writable:!1,enumerable:!1,configurable:!1},Yi="0.0.0-dev",Ji=(e,t)=>{if(!e.test(Yi))throw new Error(t);console.warn(t)},Qi="CID.isCID(v) is deprecated and will be removed in the next major release.\nFollowing code pattern:\n\nif (CID.isCID(value)) {\n  doSomethingWithCID(value)\n}\n\nIs replaced with:\n\nconst cid = CID.asCID(value)\nif (cid) {\n  // Make sure to use cid instead of value\n  doSomethingWithCID(cid)\n}\n",Xi=new TextDecoder;function Zi(e,t){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");const i=e[t++];if(r+=n<28?(127&i)<<n:(127&i)*2**n,i<128)break}return[r,t]}function es(e,t){let r;[r,t]=Zi(e,t);const n=t+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,n),n]}function ts(e,t){let r;return[r,t]=Zi(e,t),[7&r,r>>3,t]}function rs(e){const t={},r=e.length;let n=0;while(n<r){let r,i;if([r,i,n]=ts(e,n),1===i){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Hash`);if(void 0!==t.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,n]=es(e,n)}else if(2===i){if(void 0!==t.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Name`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let i;[i,n]=es(e,n),t.Name=Xi.decode(i)}else{if(3!==i)throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${i}`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Tsize`);[t.Tsize,n]=Zi(e,n)}}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return t}function ns(e){const t=e.length;let r,n,i=0,s=!1;while(i<t){let t,o;if([t,o,i]=ts(e,i),2!==t)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${t}`);if(1===o){if(n)throw new Error("protobuf: (PBNode) duplicate Data section");[n,i]=es(e,i),r&&(s=!0)}else{if(2!==o)throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${o}`);{if(s)throw new Error("protobuf: (PBNode) duplicate Links section");let t;r||(r=[]),[t,i]=es(e,i),r.push(rs(t))}}}if(i>t)throw new Error("protobuf: (PBNode) unexpected end of data");const o={};return n&&(o.Data=n),o.Links=r||[],o}const is=new TextEncoder,ss=2**32,os=2**31;function as(e,t){let r=t.length;if("number"===typeof e.Tsize){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");r=hs(t,r,e.Tsize)-1,t[r]=24}if("string"===typeof e.Name){const n=is.encode(e.Name);r-=n.length,t.set(n,r),r=hs(t,r,n.length)-1,t[r]=18}return e.Hash&&(r-=e.Hash.length,t.set(e.Hash,r),r=hs(t,r,e.Hash.length)-1,t[r]=10),t.length-r}function cs(e){const t=us(e),r=new Uint8Array(t);let n=t;if(e.Data&&(n-=e.Data.length,r.set(e.Data,n),n=hs(r,n,e.Data.length)-1,r[n]=10),e.Links)for(let i=e.Links.length-1;i>=0;i--){const t=as(e.Links[i],r.subarray(0,n));n-=t,n=hs(r,n,t)-1,r[n]=18}return r}function ls(e){let t=0;if(e.Hash){const r=e.Hash.length;t+=1+r+ds(r)}if("string"===typeof e.Name){const r=is.encode(e.Name).length;t+=1+r+ds(r)}return"number"===typeof e.Tsize&&(t+=1+ds(e.Tsize)),t}function us(e){let t=0;if(e.Data){const r=e.Data.length;t+=1+r+ds(r)}if(e.Links)for(const r of e.Links){const e=ls(r);t+=1+e+ds(e)}return t}function hs(e,t,r){t-=ds(r);const n=t;while(r>=os)e[t++]=127&r|128,r/=128;while(r>=128)e[t++]=127&r|128,r>>>=7;return e[t]=r,n}function ds(e){return e%2===0&&e++,Math.floor((fs(e)+6)/7)}function fs(e){let t=0;return e>=ss&&(e=Math.floor(e/ss),t=32),e>=65536&&(e>>>=16,t+=16),e>=256&&(e>>>=8,t+=8),t+ps[e]}const ps=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],ys=["Data","Links"],gs=["Hash","Name","Tsize"],ms=new TextEncoder;function ws(e,t){if(e===t)return 0;const r=e.Name?ms.encode(e.Name):[],n=t.Name?ms.encode(t.Name):[];let i=r.length,s=n.length;for(let o=0,a=Math.min(i,s);o<a;++o)if(r[o]!==n[o]){i=r[o],s=n[o];break}return i<s?-1:s<i?1:0}function bs(e,t){return!Object.keys(e).some((e=>!t.includes(e)))}function vs(e){if("object"===typeof e.asCID){const t=ji.asCID(e);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if("object"!==typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(e.Hash){let n=ji.asCID(e.Hash);try{n||("string"===typeof e.Hash?n=ji.parse(e.Hash):e.Hash instanceof Uint8Array&&(n=ji.decode(e.Hash)))}catch(r){throw new TypeError(`Invalid DAG-PB form: ${r.message}`)}n&&(t.Hash=n)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return"string"===typeof e.Name&&(t.Name=e.Name),"number"===typeof e.Tsize&&(t.Tsize=e.Tsize),t}function Es(e){if((e instanceof Uint8Array||"string"===typeof e)&&(e={Data:e}),"object"!==typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(void 0!==e.Data)if("string"===typeof e.Data)t.Data=ms.encode(e.Data);else{if(!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form");t.Data=e.Data}if(void 0!==e.Links){if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form");t.Links=e.Links.map(vs),t.Links.sort(ws)}else t.Links=[];return t}function _s(e){if(!e||"object"!==typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");if(!bs(e,ys))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==e.Data&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let t=0;t<e.Links.length;t++){const r=e.Links[t];if(!r||"object"!==typeof r||Array.isArray(r))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!bs(r,gs))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(r.Hash.asCID!==r.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==r.Name&&"string"!==typeof r.Name)throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==r.Tsize&&("number"!==typeof r.Tsize||r.Tsize%1!==0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(t>0&&-1===ws(r,e.Links[t-1]))throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function Ss(e,t=[]){return Es({Data:e,Links:t})}function As(e,t,r){return vs({Hash:r,Name:e,Tsize:t})}const Is="dag-pb",Cs=112;function ks(e){_s(e);const t={};return e.Links&&(t.Links=e.Links.map((e=>{const t={};return e.Hash&&(t.Hash=e.Hash.bytes),void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),e.Data&&(t.Data=e.Data),cs(t)}function Ts(e){const t=ns(e),r={};return t.Data&&(r.Data=t.Data),t.Links&&(r.Links=t.Links.map((e=>{const t={};try{t.Hash=ji.decode(e.Hash)}catch(r){}if(!t.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),r}const Rs=["string","number","bigint","symbol"],Ps=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function xs(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(Rs.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(Ds(e))return"Buffer";const r=Os(e);return r||"Object"}function Ds(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function Os(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(Ps.includes(t))return t}class Ns{constructor(e,t,r){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}Ns.uint=new Ns(0,"uint",!0),Ns.negint=new Ns(1,"negint",!0),Ns.bytes=new Ns(2,"bytes",!0),Ns.string=new Ns(3,"string",!0),Ns.array=new Ns(4,"array",!1),Ns.map=new Ns(5,"map",!1),Ns.tag=new Ns(6,"tag",!1),Ns.float=new Ns(7,"float",!0),Ns.false=new Ns(7,"false",!0),Ns.true=new Ns(7,"true",!0),Ns.null=new Ns(7,"null",!0),Ns.undefined=new Ns(7,"undefined",!0),Ns.break=new Ns(7,"break",!0);class Ls{constructor(e,t,r){this.type=e,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const Bs=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"===typeof globalThis.Buffer.isBuffer,Us=new TextDecoder,Ms=new TextEncoder;function js(e){return Bs&&globalThis.Buffer.isBuffer(e)}function Vs(e){return e instanceof Uint8Array?js(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const zs=Bs?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):Ys(e,t,r):(e,t,r)=>r-t>64?Us.decode(e.subarray(t,r)):Ys(e,t,r),Fs=Bs?e=>e.length>64?globalThis.Buffer.from(e):Ws(e):e=>e.length>64?Ms.encode(e):Ws(e),$s=e=>Uint8Array.from(e),Ks=Bs?(e,t,r)=>js(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),qs=Bs?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),Vs(globalThis.Buffer.concat(e,t))):(e,t)=>{const r=new Uint8Array(t);let n=0;for(let i of e)n+i.length>r.length&&(i=i.subarray(0,r.length-n)),r.set(i,n),n+=i.length;return r},Hs=Bs?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Gs(e,t){if(js(e)&&js(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function Ws(e,t=1/0){let r;const n=e.length;let i=null;const s=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function Ys(e,t,r){const n=[];while(t<r){const i=e[t];let s=null,o=i>239?4:i>223?3:i>191?2:1;if(t+o<=r){let r,n,a,c;switch(o){case 1:i<128&&(s=i);break;case 2:r=e[t+1],128===(192&r)&&(c=(31&i)<<6|63&r,c>127&&(s=c));break;case 3:r=e[t+1],n=e[t+2],128===(192&r)&&128===(192&n)&&(c=(15&i)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:r=e[t+1],n=e[t+2],a=e[t+3],128===(192&r)&&128===(192&n)&&128===(192&a)&&(c=(15&i)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),t+=o}return Qs(n)}const Js=4096;function Qs(e){const t=e.length;if(t<=Js)return String.fromCharCode.apply(String,e);let r="",n=0;while(n<t)r+=String.fromCharCode.apply(String,e.slice(n,n+=Js));return r}const Xs=256;class Zs{constructor(e=Xs){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];const r=this.cursor+e.length;if(r<=this.maxCursor+1){const r=t.length-(this.maxCursor-this.cursor)-1;t.set(e,r)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=Hs(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(1===this.chunks.length){const r=this.chunks[0];e&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=Ks(r,0,this.cursor)}else t=qs(this.chunks,this.cursor);return e&&this.reset(),t}}const eo="CBOR decode error:",to="CBOR encode error:",ro=[];function no(e,t,r){if(e.length-t<r)throw new Error(`${eo} not enough data for type`)}ro[23]=1,ro[24]=2,ro[25]=3,ro[26]=5,ro[27]=9;const io=[24,256,65536,4294967296,BigInt("18446744073709551616")];function so(e,t,r){no(e,t,1);const n=e[t];if(!0===r.strict&&n<io[0])throw new Error(`${eo} integer encoded in more bytes than necessary (strict decode)`);return n}function oo(e,t,r){no(e,t,2);const n=e[t]<<8|e[t+1];if(!0===r.strict&&n<io[1])throw new Error(`${eo} integer encoded in more bytes than necessary (strict decode)`);return n}function ao(e,t,r){no(e,t,4);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===r.strict&&n<io[2])throw new Error(`${eo} integer encoded in more bytes than necessary (strict decode)`);return n}function co(e,t,r){no(e,t,8);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],i=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],s=(BigInt(n)<<BigInt(32))+BigInt(i);if(!0===r.strict&&s<io[3])throw new Error(`${eo} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(!0===r.allowBigInt)return s;throw new Error(`${eo} integers outside of the safe integer range are not supported`)}function lo(e,t,r,n){return new Ls(Ns.uint,so(e,t+1,n),2)}function uo(e,t,r,n){return new Ls(Ns.uint,oo(e,t+1,n),3)}function ho(e,t,r,n){return new Ls(Ns.uint,ao(e,t+1,n),5)}function fo(e,t,r,n){return new Ls(Ns.uint,co(e,t+1,n),9)}function po(e,t){return yo(e,0,t.value)}function yo(e,t,r){if(r<io[0]){const n=Number(r);e.push([t|n])}else if(r<io[1]){const n=Number(r);e.push([24|t,n])}else if(r<io[2]){const n=Number(r);e.push([25|t,n>>>8,255&n])}else if(r<io[3]){const n=Number(r);e.push([26|t,n>>>24&255,n>>>16&255,n>>>8&255,255&n])}else{const n=BigInt(r);if(!(n<io[4]))throw new Error(`${eo} encountered BigInt larger than allowable range`);{const r=[27|t,0,0,0,0,0,0,0];let i=Number(n&BigInt(4294967295)),s=Number(n>>BigInt(32)&BigInt(4294967295));r[8]=255&i,i>>=8,r[7]=255&i,i>>=8,r[6]=255&i,i>>=8,r[5]=255&i,r[4]=255&s,s>>=8,r[3]=255&s,s>>=8,r[2]=255&s,s>>=8,r[1]=255&s,e.push(r)}}}function go(e,t,r,n){return new Ls(Ns.negint,-1-so(e,t+1,n),2)}function mo(e,t,r,n){return new Ls(Ns.negint,-1-oo(e,t+1,n),3)}function wo(e,t,r,n){return new Ls(Ns.negint,-1-ao(e,t+1,n),5)}po.encodedSize=function(e){return yo.encodedSize(e.value)},yo.encodedSize=function(e){return e<io[0]?1:e<io[1]?2:e<io[2]?3:e<io[3]?5:9},po.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};const bo=BigInt(-1),vo=BigInt(1);function Eo(e,t,r,n){const i=co(e,t+1,n);if("bigint"!==typeof i){const e=-1-i;if(e>=Number.MIN_SAFE_INTEGER)return new Ls(Ns.negint,e,9)}if(!0!==n.allowBigInt)throw new Error(`${eo} integers outside of the safe integer range are not supported`);return new Ls(Ns.negint,bo-BigInt(i),9)}function _o(e,t){const r=t.value,n="bigint"===typeof r?r*bo-vo:-1*r-1;yo(e,t.type.majorEncoded,n)}function So(e,t,r,n){no(e,t,r+n);const i=Ks(e,t+r,t+r+n);return new Ls(Ns.bytes,i,r+n)}function Ao(e,t,r,n){return So(e,t,1,r)}function Io(e,t,r,n){return So(e,t,2,so(e,t+1,n))}function Co(e,t,r,n){return So(e,t,3,oo(e,t+1,n))}function ko(e,t,r,n){return So(e,t,5,ao(e,t+1,n))}function To(e,t,r,n){const i=co(e,t+1,n);if("bigint"===typeof i)throw new Error(`${eo} 64-bit integer bytes lengths not supported`);return So(e,t,9,i)}function Ro(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===Ns.string?Fs(e.value):e.value),e.encodedBytes}function Po(e,t){const r=Ro(t);yo(e,t.type.majorEncoded,r.length),e.push(r)}function xo(e,t){return e.length<t.length?-1:e.length>t.length?1:Gs(e,t)}function Do(e,t,r,n,i){const s=r+n;no(e,t,s);const o=new Ls(Ns.string,zs(e,t+r,t+s),s);return!0===i.retainStringBytes&&(o.byteValue=Ks(e,t+r,t+s)),o}function Oo(e,t,r,n){return Do(e,t,1,r,n)}function No(e,t,r,n){return Do(e,t,2,so(e,t+1,n),n)}function Lo(e,t,r,n){return Do(e,t,3,oo(e,t+1,n),n)}function Bo(e,t,r,n){return Do(e,t,5,ao(e,t+1,n),n)}function Uo(e,t,r,n){const i=co(e,t+1,n);if("bigint"===typeof i)throw new Error(`${eo} 64-bit integer string lengths not supported`);return Do(e,t,9,i,n)}_o.encodedSize=function(e){const t=e.value,r="bigint"===typeof t?t*bo-vo:-1*t-1;return r<io[0]?1:r<io[1]?2:r<io[2]?3:r<io[3]?5:9},_o.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},Po.encodedSize=function(e){const t=Ro(e);return yo.encodedSize(t.length)+t.length},Po.compareTokens=function(e,t){return xo(Ro(e),Ro(t))};const Mo=Po;function jo(e,t,r,n){return new Ls(Ns.array,n,r)}function Vo(e,t,r,n){return jo(e,t,1,r)}function zo(e,t,r,n){return jo(e,t,2,so(e,t+1,n))}function Fo(e,t,r,n){return jo(e,t,3,oo(e,t+1,n))}function $o(e,t,r,n){return jo(e,t,5,ao(e,t+1,n))}function Ko(e,t,r,n){const i=co(e,t+1,n);if("bigint"===typeof i)throw new Error(`${eo} 64-bit integer array lengths not supported`);return jo(e,t,9,i)}function qo(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${eo} indefinite length items not allowed`);return jo(e,t,1,1/0)}function Ho(e,t){yo(e,Ns.array.majorEncoded,t.value)}function Go(e,t,r,n){return new Ls(Ns.map,n,r)}function Wo(e,t,r,n){return Go(e,t,1,r)}function Yo(e,t,r,n){return Go(e,t,2,so(e,t+1,n))}function Jo(e,t,r,n){return Go(e,t,3,oo(e,t+1,n))}function Qo(e,t,r,n){return Go(e,t,5,ao(e,t+1,n))}function Xo(e,t,r,n){const i=co(e,t+1,n);if("bigint"===typeof i)throw new Error(`${eo} 64-bit integer map lengths not supported`);return Go(e,t,9,i)}function Zo(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${eo} indefinite length items not allowed`);return Go(e,t,1,1/0)}function ea(e,t){yo(e,Ns.map.majorEncoded,t.value)}function ta(e,t,r,n){return new Ls(Ns.tag,r,1)}function ra(e,t,r,n){return new Ls(Ns.tag,so(e,t+1,n),2)}function na(e,t,r,n){return new Ls(Ns.tag,oo(e,t+1,n),3)}function ia(e,t,r,n){return new Ls(Ns.tag,ao(e,t+1,n),5)}function sa(e,t,r,n){return new Ls(Ns.tag,co(e,t+1,n),9)}function oa(e,t){yo(e,Ns.tag.majorEncoded,t.value)}Ho.compareTokens=po.compareTokens,Ho.encodedSize=function(e){return yo.encodedSize(e.value)},ea.compareTokens=po.compareTokens,ea.encodedSize=function(e){return yo.encodedSize(e.value)},oa.compareTokens=po.compareTokens,oa.encodedSize=function(e){return yo.encodedSize(e.value)};const aa=20,ca=21,la=22,ua=23;function ha(e,t,r,n){if(!1===n.allowUndefined)throw new Error(`${eo} undefined values are not supported`);return!0===n.coerceUndefinedToNull?new Ls(Ns["null"],null,1):new Ls(Ns.undefined,void 0,1)}function da(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${eo} indefinite length items not allowed`);return new Ls(Ns["break"],void 0,1)}function fa(e,t,r){if(r){if(!1===r.allowNaN&&Number.isNaN(e))throw new Error(`${eo} NaN values are not supported`);if(!1===r.allowInfinity&&(e===1/0||e===-1/0))throw new Error(`${eo} Infinity values are not supported`)}return new Ls(Ns.float,e,t)}function pa(e,t,r,n){return fa(_a(e,t+1),3,n)}function ya(e,t,r,n){return fa(Aa(e,t+1),5,n)}function ga(e,t,r,n){return fa(Ca(e,t+1),9,n)}function ma(e,t,r){const n=t.value;if(!1===n)e.push([Ns.float.majorEncoded|aa]);else if(!0===n)e.push([Ns.float.majorEncoded|ca]);else if(null===n)e.push([Ns.float.majorEncoded|la]);else if(void 0===n)e.push([Ns.float.majorEncoded|ua]);else{let t,i=!1;r&&!0===r.float64||(Ea(n),t=_a(va,1),n===t||Number.isNaN(n)?(va[0]=249,e.push(va.slice(0,3)),i=!0):(Sa(n),t=Aa(va,1),n===t&&(va[0]=250,e.push(va.slice(0,5)),i=!0))),i||(Ia(n),t=Ca(va,1),va[0]=251,e.push(va.slice(0,9)))}}ma.encodedSize=function(e,t){const r=e.value;if(!1===r||!0===r||null===r||void 0===r)return 1;if(!t||!0!==t.float64){Ea(r);let e=_a(va,1);if(r===e||Number.isNaN(r))return 3;if(Sa(r),e=Aa(va,1),r===e)return 5}return 9};const wa=new ArrayBuffer(9),ba=new DataView(wa,1),va=new Uint8Array(wa,0);function Ea(e){if(e===1/0)ba.setUint16(0,31744,!1);else if(e===-1/0)ba.setUint16(0,64512,!1);else if(Number.isNaN(e))ba.setUint16(0,32256,!1);else{ba.setFloat32(0,e);const t=ba.getUint32(0),r=(2139095040&t)>>23,n=8388607&t;if(255===r)ba.setUint16(0,31744,!1);else if(0===r)ba.setUint16(0,(2147483648&e)>>16|n>>13,!1);else{const e=r-127;e<-24?ba.setUint16(0,0):e<-14?ba.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):ba.setUint16(0,(2147483648&t)>>16|e+15<<10|n>>13,!1)}}}function _a(e,t){if(e.length-t<2)throw new Error(`${eo} not enough data for float16`);const r=(e[t]<<8)+e[t+1];if(31744===r)return 1/0;if(64512===r)return-1/0;if(32256===r)return NaN;const n=r>>10&31,i=1023&r;let s;return s=0===n?i*2**-24:31!==n?(i+1024)*2**(n-25):0===i?1/0:NaN,32768&r?-s:s}function Sa(e){ba.setFloat32(0,e,!1)}function Aa(e,t){if(e.length-t<4)throw new Error(`${eo} not enough data for float32`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function Ia(e){ba.setFloat64(0,e,!1)}function Ca(e,t){if(e.length-t<8)throw new Error(`${eo} not enough data for float64`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}function ka(e,t,r){throw new Error(`${eo} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function Ta(e){return()=>{throw new Error(`${eo} ${e}`)}}ma.compareTokens=po.compareTokens;const Ra=[];for(let Xbe=0;Xbe<=23;Xbe++)Ra[Xbe]=ka;Ra[24]=lo,Ra[25]=uo,Ra[26]=ho,Ra[27]=fo,Ra[28]=ka,Ra[29]=ka,Ra[30]=ka,Ra[31]=ka;for(let Xbe=32;Xbe<=55;Xbe++)Ra[Xbe]=ka;Ra[56]=go,Ra[57]=mo,Ra[58]=wo,Ra[59]=Eo,Ra[60]=ka,Ra[61]=ka,Ra[62]=ka,Ra[63]=ka;for(let Xbe=64;Xbe<=87;Xbe++)Ra[Xbe]=Ao;Ra[88]=Io,Ra[89]=Co,Ra[90]=ko,Ra[91]=To,Ra[92]=ka,Ra[93]=ka,Ra[94]=ka,Ra[95]=Ta("indefinite length bytes/strings are not supported");for(let Xbe=96;Xbe<=119;Xbe++)Ra[Xbe]=Oo;Ra[120]=No,Ra[121]=Lo,Ra[122]=Bo,Ra[123]=Uo,Ra[124]=ka,Ra[125]=ka,Ra[126]=ka,Ra[127]=Ta("indefinite length bytes/strings are not supported");for(let Xbe=128;Xbe<=151;Xbe++)Ra[Xbe]=Vo;Ra[152]=zo,Ra[153]=Fo,Ra[154]=$o,Ra[155]=Ko,Ra[156]=ka,Ra[157]=ka,Ra[158]=ka,Ra[159]=qo;for(let Xbe=160;Xbe<=183;Xbe++)Ra[Xbe]=Wo;Ra[184]=Yo,Ra[185]=Jo,Ra[186]=Qo,Ra[187]=Xo,Ra[188]=ka,Ra[189]=ka,Ra[190]=ka,Ra[191]=Zo;for(let Xbe=192;Xbe<=215;Xbe++)Ra[Xbe]=ta;Ra[216]=ra,Ra[217]=na,Ra[218]=ia,Ra[219]=sa,Ra[220]=ka,Ra[221]=ka,Ra[222]=ka,Ra[223]=ka;for(let Xbe=224;Xbe<=243;Xbe++)Ra[Xbe]=Ta("simple values are not supported");Ra[244]=ka,Ra[245]=ka,Ra[246]=ka,Ra[247]=ha,Ra[248]=Ta("simple values are not supported"),Ra[249]=pa,Ra[250]=ya,Ra[251]=ga,Ra[252]=ka,Ra[253]=ka,Ra[254]=ka,Ra[255]=da;const Pa=[];for(let Xbe=0;Xbe<24;Xbe++)Pa[Xbe]=new Ls(Ns.uint,Xbe,1);for(let Xbe=-1;Xbe>=-24;Xbe--)Pa[31-Xbe]=new Ls(Ns.negint,Xbe,1);function xa(e){switch(e.type){case Ns["false"]:return $s([244]);case Ns["true"]:return $s([245]);case Ns["null"]:return $s([246]);case Ns.bytes:return e.value.length?void 0:$s([64]);case Ns.string:return""===e.value?$s([96]):void 0;case Ns.array:return 0===e.value?$s([128]):void 0;case Ns.map:return 0===e.value?$s([160]):void 0;case Ns.uint:return e.value<24?$s([Number(e.value)]):void 0;case Ns.negint:if(e.value>=-24)return $s([31-Number(e.value)])}}Pa[64]=new Ls(Ns.bytes,new Uint8Array(0),1),Pa[96]=new Ls(Ns.string,"",1),Pa[128]=new Ls(Ns.array,0,1),Pa[160]=new Ls(Ns.map,0,1),Pa[244]=new Ls(Ns["false"],!1,1),Pa[245]=new Ls(Ns["true"],!0,1),Pa[246]=new Ls(Ns["null"],null,1);const Da={float64:!1,mapSorter:za,quickEncodeToken:xa};function Oa(){const e=[];return e[Ns.uint.major]=po,e[Ns.negint.major]=_o,e[Ns.bytes.major]=Po,e[Ns.string.major]=Mo,e[Ns.array.major]=Ho,e[Ns.map.major]=ea,e[Ns.tag.major]=oa,e[Ns.float.major]=ma,e}const Na=Oa(),La=new Zs;class Ba{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${to} object contains circular references`);return new Ba(t,e)}}const Ua={null:new Ls(Ns["null"],null),undefined:new Ls(Ns.undefined,void 0),true:new Ls(Ns["true"],!0),false:new Ls(Ns["false"],!1),emptyArray:new Ls(Ns.array,0),emptyMap:new Ls(Ns.map,0)},Ma={number(e,t,r,n){return Number.isInteger(e)&&Number.isSafeInteger(e)?new Ls(e>=0?Ns.uint:Ns.negint,e):new Ls(Ns.float,e)},bigint(e,t,r,n){return e>=BigInt(0)?new Ls(Ns.uint,e):new Ls(Ns.negint,e)},Uint8Array(e,t,r,n){return new Ls(Ns.bytes,e)},string(e,t,r,n){return new Ls(Ns.string,e)},boolean(e,t,r,n){return e?Ua.true:Ua.false},null(e,t,r,n){return Ua.null},undefined(e,t,r,n){return Ua.undefined},ArrayBuffer(e,t,r,n){return new Ls(Ns.bytes,new Uint8Array(e))},DataView(e,t,r,n){return new Ls(Ns.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,r,n){if(!e.length)return!0===r.addBreakTokens?[Ua.emptyArray,new Ls(Ns["break"])]:Ua.emptyArray;n=Ba.createCheck(n,e);const i=[];let s=0;for(const o of e)i[s++]=ja(o,r,n);return r.addBreakTokens?[new Ls(Ns.array,e.length),i,new Ls(Ns["break"])]:[new Ls(Ns.array,e.length),i]},Object(e,t,r,n){const i="Object"!==t,s=i?e.keys():Object.keys(e),o=i?e.size:s.length;if(!o)return!0===r.addBreakTokens?[Ua.emptyMap,new Ls(Ns["break"])]:Ua.emptyMap;n=Ba.createCheck(n,e);const a=[];let c=0;for(const l of s)a[c++]=[ja(l,r,n),ja(i?e.get(l):e[l],r,n)];return Va(a,r),r.addBreakTokens?[new Ls(Ns.map,o),a,new Ls(Ns["break"])]:[new Ls(Ns.map,o),a]}};Ma.Map=Ma.Object,Ma.Buffer=Ma.Uint8Array;for(const Xbe of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Ma[`${Xbe}Array`]=Ma.DataView;function ja(e,t={},r){const n=xs(e),i=t&&t.typeEncoders&&t.typeEncoders[n]||Ma[n];if("function"===typeof i){const s=i(e,n,t,r);if(null!=s)return s}const s=Ma[n];if(!s)throw new Error(`${to} unsupported type: ${n}`);return s(e,n,t,r)}function Va(e,t){t.mapSorter&&e.sort(t.mapSorter)}function za(e,t){const r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);const i=r.type.major,s=Na[i].compareTokens(r,n);return 0===s&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function Fa(e,t,r,n){if(Array.isArray(t))for(const i of t)Fa(e,i,r,n);else r[t.type.major](e,t,n)}function $a(e,t,r){const n=ja(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){const e=r.quickEncodeToken(n);if(e)return e;const i=t[n.type.major];if(i.encodedSize){const e=i.encodedSize(n,r),t=new Zs(e);if(i(t,n,r),1!==t.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Vs(t.chunks[0])}}return La.reset(),Fa(La,n,t,r),La.toBytes(!0)}function Ka(e,t){return t=Object.assign({},Da,t),$a(e,Na,t)}const qa={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Ha{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){const e=this.data[this.pos];let t=Pa[e];if(void 0===t){const r=Ra[e];if(!r)throw new Error(`${eo} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const n=31&e;t=r(this.data,this.pos,n,this.options)}return this.pos+=t.encodedLength,t}}const Ga=Symbol.for("DONE"),Wa=Symbol.for("BREAK");function Ya(e,t,r){const n=[];for(let i=0;i<e.value;i++){const s=Qa(t,r);if(s===Wa){if(e.value===1/0)break;throw new Error(`${eo} got unexpected break to lengthed array`)}if(s===Ga)throw new Error(`${eo} found array but not enough entries (got ${i}, expected ${e.value})`);n[i]=s}return n}function Ja(e,t,r){const n=!0===r.useMaps,i=n?void 0:{},s=n?new Map:void 0;for(let o=0;o<e.value;o++){const a=Qa(t,r);if(a===Wa){if(e.value===1/0)break;throw new Error(`${eo} got unexpected break to lengthed map`)}if(a===Ga)throw new Error(`${eo} found map but not enough entries (got ${o} [no key], expected ${e.value})`);if(!0!==n&&"string"!==typeof a)throw new Error(`${eo} non-string keys not supported (got ${typeof a})`);const c=Qa(t,r);if(c===Ga)throw new Error(`${eo} found map but not enough entries (got ${o} [no value], expected ${e.value})`);n?s.set(a,c):i[a]=c}return n?s:i}function Qa(e,t){if(e.done())return Ga;const r=e.next();if(r.type===Ns["break"])return Wa;if(r.type.terminal)return r.value;if(r.type===Ns.array)return Ya(r,e,t);if(r.type===Ns.map)return Ja(r,e,t);if(r.type===Ns.tag){if(t.tags&&"function"===typeof t.tags[r.value]){const n=Qa(e,t);return t.tags[r.value](n)}throw new Error(`${eo} tag not supported (${r.value})`)}throw new Error("unsupported")}function Xa(e,t){if(!(e instanceof Uint8Array))throw new Error(`${eo} data to decode must be a Uint8Array`);t=Object.assign({},qa,t);const r=t.tokenizer||new Ha(e,t),n=Qa(r,t);if(n===Ga)throw new Error(`${eo} did not find any content to decode`);if(n===Wa)throw new Error(`${eo} got unexpected break`);if(!r.done())throw new Error(`${eo} too many terminals, data makes no sense`);return n}const Za=42;function ec(e){if(e.asCID!==e)return null;const t=ji.asCID(e);if(!t)return null;const r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new Ls(Ns.tag,Za),new Ls(Ns.bytes,r)]}function tc(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function rc(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const nc={float64:!0,typeEncoders:{Object:ec,undefined:tc,number:rc}};function ic(e){if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return ji.decode(e.subarray(1))}const sc={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};sc.tags[Za]=ic;const oc="dag-cbor",ac=113,cc=e=>Ka(e,nc),lc=e=>Xa(e,sc),uc=({name:e,code:t,encode:r})=>new hc(e,t,r);class hc{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?ui(this.code,t):t.then((e=>ui(this.code,e)))}throw Error("Unknown type, must be binary type")}}const dc=ki({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),fc=ki({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),pc=ki({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),yc=ki({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});class gc extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){const t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===Ns.array&&(t.elements++,1!==t.elements&&e.push([44])),t.type===Ns.map&&(t.elements++,1!==t.elements&&(t.elements%2===1?e.push([44]):e.push([58]))))}[Ns.uint.major](e,t){this.prefix(e);const r=String(t.value),n=[];for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);e.push(n)}[Ns.negint.major](e,t){this[Ns.uint.major](e,t)}[Ns.bytes.major](e,t){throw new Error(`${to} unsupported type: Uint8Array`)}[Ns.string.major](e,t){this.prefix(e);const r=Fs(JSON.stringify(t.value));e.push(r.length>32?Vs(r):r)}[Ns.array.major](e,t){this.prefix(e),this.inRecursive.push({type:Ns.array,elements:0}),e.push([91])}[Ns.map.major](e,t){this.prefix(e),this.inRecursive.push({type:Ns.map,elements:0}),e.push([123])}[Ns.tag.major](e,t){}[Ns.float.major](e,t){if("break"===t.type.name){const t=this.inRecursive.pop();if(t){if(t.type===Ns.array)e.push([93]);else{if(t.type!==Ns.map)throw new Error("Unexpected recursive type; this should not happen!");e.push([125])}return}throw new Error("Unexpected break; this should not happen!")}if(void 0===t.value)throw new Error(`${to} unsupported type: undefined`);if(this.prefix(e),"true"===t.type.name)return void e.push([116,114,117,101]);if("false"===t.type.name)return void e.push([102,97,108,115,101]);if("null"===t.type.name)return void e.push([110,117,108,108]);const r=String(t.value),n=[];let i=!1;for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s),i||46!==n[s]&&101!==n[s]&&69!==n[s]||(i=!0);i||(n.push(46),n.push(48)),e.push(n)}}function mc(e,t){if(Array.isArray(e[0])||Array.isArray(t[0]))throw new Error(`${to} complex map keys are not supported`);const r=e[0],n=t[0];if(r.type!==Ns.string||n.type!==Ns.string)throw new Error(`${to} non-string map keys are not supported`);if(r<n)return-1;if(r>n)return 1;throw new Error(`${to} unexpected duplicate map keys, this is not supported`)}const wc={addBreakTokens:!0,mapSorter:mc};function bc(e,t){return t=Object.assign({},wc,t),$a(e,new gc,t)}class vc{constructor(e,t={}){this.pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();while(32===e||9===e||13===e||10===e)e=this.data[++this.pos]}expect(e){if(this.data.length-this.pos<e.length)throw new Error(`${eo} unexpected end of input at position ${this.pos}`);for(let t=0;t<e.length;t++)if(this.data[this.pos++]!==e[t])throw new Error(`${eo} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){const e=this.pos;let t=!1,r=!1;const n=e=>{while(!this.done()){const t=this.ch();if(!e.includes(t))break;this.pos++}};if(45===this.ch()&&(t=!0,this.pos++),48===this.ch()){if(this.pos++,46!==this.ch())return new Ls(Ns.uint,0,this.pos-e);this.pos++,r=!0}if(n([48,49,50,51,52,53,54,55,56,57]),t&&this.pos===e+1)throw new Error(`${eo} unexpected token at position ${this.pos}`);if(!this.done()&&46===this.ch()){if(r)throw new Error(`${eo} unexpected token at position ${this.pos}`);r=!0,this.pos++,n([48,49,50,51,52,53,54,55,56,57])}this.done()||101!==this.ch()&&69!==this.ch()||(r=!0,this.pos++,this.done()||43!==this.ch()&&45!==this.ch()||this.pos++,n([48,49,50,51,52,53,54,55,56,57]));const i=String.fromCharCode.apply(null,this.data.subarray(e,this.pos)),s=parseFloat(i);return r?new Ls(Ns.float,s,this.pos-e):!0!==this.options.allowBigInt||Number.isSafeInteger(s)?new Ls(s>=0?Ns.uint:Ns.negint,s,this.pos-e):new Ls(s>=0?Ns.uint:Ns.negint,BigInt(i),this.pos-e)}parseString(){if(34!==this.ch())throw new Error(`${eo} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let i=this.pos,s=0;i<this.data.length&&s<65536;i++,s++){const e=this.data[i];if(92===e||e<32||e>=128)break;if(34===e){const e=String.fromCharCode.apply(null,this.data.subarray(this.pos,i));return this.pos=i+1,new Ls(Ns.string,e,s)}}const e=this.pos,t=[],r=()=>{if(this.pos+4>=this.data.length)throw new Error(`${eo} unexpected end of unicode escape sequence at position ${this.pos}`);let e=0;for(let t=0;t<4;t++){let t=this.ch();if(t>=48&&t<=57)t-=48;else if(t>=97&&t<=102)t=t-97+10;else{if(!(t>=65&&t<=70))throw new Error(`${eo} unexpected unicode escape character at position ${this.pos}`);t=t-65+10}e=16*e+t,this.pos++}return e},n=()=>{const e=this.ch();let r,n,i,s,o=null,a=e>239?4:e>223?3:e>191?2:1;if(this.pos+a>this.data.length)throw new Error(`${eo} unexpected unicode sequence at position ${this.pos}`);switch(a){case 1:e<128&&(o=e);break;case 2:r=this.data[this.pos+1],128===(192&r)&&(s=(31&e)<<6|63&r,s>127&&(o=s));break;case 3:r=this.data[this.pos+1],n=this.data[this.pos+2],128===(192&r)&&128===(192&n)&&(s=(15&e)<<12|(63&r)<<6|63&n,s>2047&&(s<55296||s>57343)&&(o=s));break;case 4:r=this.data[this.pos+1],n=this.data[this.pos+2],i=this.data[this.pos+3],128===(192&r)&&128===(192&n)&&128===(192&i)&&(s=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&i,s>65535&&s<1114112&&(o=s))}null===o?(o=65533,a=1):o>65535&&(o-=65536,t.push(o>>>10&1023|55296),o=56320|1023&o),t.push(o),this.pos+=a};while(!this.done()){const i=this.ch();let s;switch(i){case 92:if(this.pos++,this.done())throw new Error(`${eo} unexpected string termination at position ${this.pos}`);switch(s=this.ch(),this.pos++,s){case 34:case 39:case 92:case 47:t.push(s);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(r());break;default:throw new Error(`${eo} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new Ls(Ns.string,Qs(t),this.pos-e);default:if(i<32)throw new Error(`${eo} invalid control character at position ${this.pos}`);i<128?(t.push(i),this.pos++):n()}}throw new Error(`${eo} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new Ls(Ns.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new Ls(Ns.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new Ls(Ns["null"],null,4);case 102:return this.expect([102,97,108,115,101]),new Ls(Ns["false"],!1,5);case 116:return this.expect([116,114,117,101]),new Ls(Ns["true"],!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${eo} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this.pos++,this.skipWhitespace(),new Ls(Ns["break"],void 0,1);if(44!==this.ch())throw new Error(`${eo} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),93===this.ch()?(this.pos++,this.skipWhitespace(),new Ls(Ns["break"],void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(125===this.ch())return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new Ls(Ns["break"],void 0,1);if(44!==this.ch())throw new Error(`${eo} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),125===this.ch())return this.pos++,this.skipWhitespace(),new Ls(Ns["break"],void 0,1);const e=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw new Error(`${eo} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${eo} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}}function Ec(e,t){return t=Object.assign({tokenizer:new vc(e,t)},t),Xa(e,t)}function _c(e){if(e.asCID!==e)return null;const t=ji.asCID(e);if(!t)return null;const r=t.toString();return[new Ls(Ns.map,1/0,1),new Ls(Ns.string,"/",1),new Ls(Ns.string,r,r.length),new Ls(Ns["break"],void 0,1)]}function Sc(e){const t=dc.encode(e).slice(1);return[new Ls(Ns.map,1/0,1),new Ls(Ns.string,"/",1),new Ls(Ns.map,1/0,1),new Ls(Ns.string,"bytes",5),new Ls(Ns.string,t,t.length),new Ls(Ns["break"],void 0,1),new Ls(Ns["break"],void 0,1)]}function Ac(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function Ic(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const Cc={typeEncoders:{Object:_c,Uint8Array:Sc,Buffer:Sc,undefined:Ac,number:Ic}};class kc extends vc{constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return 0===this.tokenBuffer.length&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(e.type===Ns.map){const e=this._next();if(e.type===Ns.string&&"/"===e.value){const e=this._next();if(e.type===Ns.string){const t=this._next();if(t.type!==Ns["break"])throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(e),new Ls(Ns.tag,42,0)}if(e.type===Ns.map){const e=this._next();if(e.type===Ns.string&&"bytes"===e.value){const e=this._next();if(e.type===Ns.string){for(let e=0;e<2;e++){const e=this._next();if(e.type!==Ns["break"])throw new Error("Invalid encoded Bytes form")}const t=dc.decode(`m${e.value}`);return new Ls(Ns.bytes,t,e.value.length)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}return e}}const Tc={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};Tc.tags[42]=ji.parse;const Rc="dag-json",Pc=297,xc=e=>bc(e,Cc),Dc=e=>{const t=Object.assign(Tc,{tokenizer:new kc(e,Tc)});return Ec(e,t)};function Oc(e){return pc.encode(e).slice(1)}function Nc(e){return pc.decode(`u${e}`)}function Lc(e){const[t,r,n]=e;return{payload:r,signatures:[{protected:t,signature:n}],link:ji.decode(Nc(r))}}function Bc(e){const t={signature:Nc(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=Nc(e.protected)),t}function Uc(e){const t=Nc(e.payload);try{ji.decode(t)}catch(r){throw new Error("Not a valid DagJWS")}return{payload:t,signatures:e.signatures.map(Bc)}}function Mc(e){const t={signature:Oc(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=Oc(e.protected)),t}function jc(e){const t={payload:Oc(e.payload),signatures:e.signatures.map(Mc)};return t.link=ji.decode(new Uint8Array(e.payload)),t}function Vc(e){const[t,r,n,i,s]=e,o={ciphertext:i,iv:n,protected:t,tag:s};return r&&(o.recipients=[{encrypted_key:r}]),o}function zc(e){const t={};return e.encrypted_key&&(t.encrypted_key=Nc(e.encrypted_key)),e.header&&(t.header=e.header),t}function Fc(e){const t={ciphertext:Nc(e.ciphertext),protected:Nc(e.protected),iv:Nc(e.iv),tag:Nc(e.tag)};return e.aad&&(t.aad=Nc(e.aad)),e.recipients&&(t.recipients=e.recipients.map(zc)),e.unprotected&&(t.unprotected=e.unprotected),t}function $c(e){const t={};return e.encrypted_key&&(t.encrypted_key=Oc(e.encrypted_key)),e.header&&(t.header=e.header),t}function Kc(e){const t={ciphertext:Oc(e.ciphertext),protected:Oc(e.protected),iv:Oc(e.iv),tag:Oc(e.tag)};return e.aad&&(t.aad=Oc(e.aad)),e.recipients&&(t.recipients=e.recipients.map($c)),e.unprotected&&(t.unprotected=e.unprotected),t}const qc="dag-jose",Hc=133;function Gc(e){return"payload"in e&&"string"===typeof e.payload&&"signatures"in e&&Array.isArray(e.signatures)}function Wc(e){return"payload"in e&&e.payload instanceof Uint8Array&&"signatures"in e&&Array.isArray(e.signatures)}function Yc(e){return"ciphertext"in e&&e.ciphertext instanceof Uint8Array&&"iv"in e&&e.iv instanceof Uint8Array&&"protected"in e&&e.protected instanceof Uint8Array&&"tag"in e&&e.tag instanceof Uint8Array}function Jc(e){return"ciphertext"in e&&"string"===typeof e.ciphertext&&"iv"in e&&"string"===typeof e.iv&&"protected"in e&&"string"===typeof e.protected&&"tag"in e&&"string"===typeof e.tag}function Qc(e){if("string"===typeof e){const t=e.split(".");if(3===t.length)return Lc(t);if(5===t.length)return Vc(t);throw new Error("Not a valid JOSE string")}if(Gc(e)||Jc(e))return e;throw new Error("Not a valid unencoded JOSE object")}function Xc(e){let t;if("string"===typeof e&&(e=Qc(e)),Gc(e))t=Uc(e);else{if(!Jc(e))throw new Error("Not a valid JOSE object");t=Fc(e)}return new Uint8Array(cc(t))}function Zc(e){let t;try{t=lc(e)}catch(r){throw new Error("Not a valid DAG-JOSE object")}if(Wc(t))return jc(t);if(Yc(t))return Kc(t);throw new Error("Not a valid DAG-JOSE object")}const el=0,tl="identity",rl=ai,nl=e=>ui(el,rl(e)),il={code:el,name:tl,encode:rl,digest:nl},sl=Si({prefix:"\0",name:"identity",encode:e=>li(e),decode:e=>ci(e)}),ol=ki({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),al=ki({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),cl=Ai({prefix:"9",name:"base10",alphabet:"0123456789"}),ll=ki({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ul=ki({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),hl=Ai({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),dl=Ai({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),fl=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),pl=fl.reduce(((e,t,r)=>(e[r]=t,e)),[]),yl=fl.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);function gl(e){return e.reduce(((e,t)=>(e+=pl[t],e)),"")}function ml(e){const t=[];for(const r of e){const e=yl[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}const wl=Si({prefix:"🚀",name:"base256emoji",encode:gl,decode:ml}),bl=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),vl=uc({name:"sha2-256",code:18,encode:bl("SHA-256")}),El=uc({name:"sha2-512",code:19,encode:bl("SHA-512")}),_l="raw",Sl=85,Al=e=>ai(e),Il=e=>ai(e),Cl=new TextEncoder,kl=new TextDecoder,Tl="json",Rl=512,Pl=e=>Cl.encode(JSON.stringify(e)),xl=e=>JSON.parse(kl.decode(e)),Dl={...h,...d,...f,...p,...y,...i,...g,...n,...a,...m},Ol={...w,...u},Nl={raw:b,json:v};function Ll(){}class Bl extends Error{constructor(e="not initialized"){super(e),this.name="NotInitializedError",this.code=Bl.code}}Bl.code="ERR_NOT_INITIALIZED";class Ul extends Error{constructor(e="cannot initialize an initializing node"){super(e),this.name="AlreadyInitializingError",this.code=Ml.code}}Ul.code="ERR_ALREADY_INITIALIZING";class Ml extends Error{constructor(e="cannot re-initialize an initialized node"){super(e),this.name="AlreadyInitializedError",this.code=Ml.code}}Ml.code="ERR_ALREADY_INITIALIZED";class jl extends Error{constructor(e="not started"){super(e),this.name="NotStartedError",this.code=jl.code}}jl.code="ERR_NOT_STARTED";class Vl extends Error{constructor(e="cannot start, already startin"){super(e),this.name="AlreadyStartingError",this.code=Vl.code}}Vl.code="ERR_ALREADY_STARTING";class zl extends Error{constructor(e="cannot start, already started"){super(e),this.name="AlreadyStartedError",this.code=zl.code}}zl.code="ERR_ALREADY_STARTED";class Fl extends Error{constructor(e="not enabled"){super(e),this.name="NotEnabledError",this.code=Fl.code}}Fl.code="ERR_NOT_ENABLED";var $l=r(3160);function Kl(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const ql=Kl("utf8","u",(e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)}),(e=>{const t=new TextEncoder;return t.encode(e.substring(1))})),Hl=Kl("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=(0,$l.E)(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Gl={utf8:ql,"utf-8":ql,hex:Dl.base16,latin1:Hl,ascii:Hl,binary:Hl,...Dl};var Wl=Gl,Yl=r(6867);function Jl(e,t="utf8"){const r=Wl[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):(0,Yl.P)(globalThis.Buffer.from(e,"utf-8"))}var Ql=r(715);function Xl(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var Zl=Xl,eu=Zl,tu=eu;new Uint8Array(0);const ru=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},nu=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},iu=e=>(new TextEncoder).encode(e),su=e=>(new TextDecoder).decode(e);class ou{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class au{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return lu(this,e)}}class cu{constructor(e){this.decoders=e}or(e){return lu(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const lu=(e,t)=>new cu({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class uu{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new ou(e,t,r),this.decoder=new au(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const hu=({name:e,prefix:t,encode:r,decode:n})=>new uu(e,t,r,n),du=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=tu(r,t);return hu({prefix:e,name:t,encode:n,decode:e=>nu(i(e))})},fu=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},pu=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},yu=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>hu({prefix:t,name:e,encode(e){return pu(e,n,r)},decode(t){return fu(t,n,r,e)}}),gu=du({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),mu=du({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),wu=yu({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bu=yu({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),vu=yu({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Eu=yu({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),_u=yu({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Su=yu({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Au=yu({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Iu=yu({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Cu=yu({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ku=Du,Tu=128,Ru=127,Pu=~Ru,xu=Math.pow(2,31);function Du(e,t,r){t=t||[],r=r||0;var n=r;while(e>=xu)t[r++]=255&e|Tu,e/=128;while(e&Pu)t[r++]=255&e|Tu,e>>>=7;return t[r]=0|e,Du.bytes=r-n+1,t}var Ou=Bu,Nu=128,Lu=127;function Bu(e,t){var r,n=0,i=(t=t||0,0),s=t,o=e.length;do{if(s>=o)throw Bu.bytes=0,new RangeError("Could not decode varint");r=e[s++],n+=i<28?(r&Lu)<<i:(r&Lu)*Math.pow(2,i),i+=7}while(r>=Nu);return Bu.bytes=s-t,n}var Uu=Math.pow(2,7),Mu=Math.pow(2,14),ju=Math.pow(2,21),Vu=Math.pow(2,28),zu=Math.pow(2,35),Fu=Math.pow(2,42),$u=Math.pow(2,49),Ku=Math.pow(2,56),qu=Math.pow(2,63),Hu=function(e){return e<Uu?1:e<Mu?2:e<ju?3:e<Vu?4:e<zu?5:e<Fu?6:e<$u?7:e<Ku?8:e<qu?9:10},Gu={encode:ku,decode:Ou,encodingLength:Hu},Wu=Gu,Yu=Wu;const Ju=(e,t=0)=>{const r=Yu.decode(e,t);return[r,Yu.decode.bytes]},Qu=(e,t,r=0)=>(Yu.encode(e,t,r),t),Xu=e=>Yu.encodingLength(e),Zu=(e,t)=>{const r=t.byteLength,n=Xu(e),i=n+Xu(r),s=new Uint8Array(i+r);return Qu(e,s,0),Qu(r,s,n),s.set(t,i),new rh(e,r,t,s)},eh=e=>{const t=nu(e),[r,n]=Ju(t),[i,s]=Ju(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new rh(r,i,o,t)},th=(e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&ru(e.bytes,r.bytes)}};class rh{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}class nh{index=0;input="";new(e){return this.index=0,this.input=e,this}readAtomically(e){const t=this.index,r=e();return void 0===r&&(this.index=t),r}parseWith(e){const t=e();if(this.index===this.input.length)return t}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically((()=>{const t=this.readChar();if(t===e)return t}))}readSeparator(e,t,r){return this.readAtomically((()=>{if(!(t>0&&void 0===this.readGivenChar(e)))return r()}))}readNumber(e,t,r,n){return this.readAtomically((()=>{let i=0,s=0;const o=this.peekChar();if(void 0===o)return;const a="0"===o,c=2**(8*n)-1;while(1){const r=this.readAtomically((()=>{const t=this.readChar();if(void 0===t)return;const r=Number.parseInt(t,e);return Number.isNaN(r)?void 0:r}));if(void 0===r)break;if(i*=e,i+=r,i>c)return;if(s+=1,void 0!==t&&s>t)return}return 0===s||!r&&a&&s>1?void 0:i}))}readIPv4Addr(){return this.readAtomically((()=>{const e=new Uint8Array(4);for(let t=0;t<e.length;t++){const r=this.readSeparator(".",t,(()=>this.readNumber(10,3,!1,1)));if(void 0===r)return;e[t]=r}return e}))}readIPv6Addr(){const e=e=>{for(let t=0;t<e.length/2;t++){const r=2*t;if(t<e.length-3){const n=this.readSeparator(":",t,(()=>this.readIPv4Addr()));if(void 0!==n)return e[r]=n[0],e[r+1]=n[1],e[r+2]=n[2],e[r+3]=n[3],[r+4,!0]}const n=this.readSeparator(":",t,(()=>this.readNumber(16,4,!0,2)));if(void 0===n)return[r,!1];e[r]=n>>8,e[r+1]=255&n}return[e.length,!1]};return this.readAtomically((()=>{const t=new Uint8Array(16),[r,n]=e(t);if(16===r)return t;if(n)return;if(void 0===this.readGivenChar(":"))return;if(void 0===this.readGivenChar(":"))return;const i=new Uint8Array(14),s=16-(r+2),[o]=e(i.subarray(0,s));return t.set(i.subarray(0,o),16-o),t}))}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}}const ih=45,sh=15,oh=new nh;function ah(e){if(!(e.length>sh))return oh.new(e).parseWith((()=>oh.readIPv4Addr()))}function ch(e){if(!(e.length>ih))return oh.new(e).parseWith((()=>oh.readIPv6Addr()))}function lh(e){if(!(e.length>ih))return oh.new(e).parseWith((()=>oh.readIPAddr()))}function uh(e){return Boolean(ah(e))}function hh(e){return Boolean(ch(e))}function dh(e){return Boolean(lh(e))}function fh(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var ph=fh,yh=ph,gh=yh;new Uint8Array(0);const mh=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},wh=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},bh=e=>(new TextEncoder).encode(e),vh=e=>(new TextDecoder).decode(e);class Eh{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class _h{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Ah(this,e)}}class Sh{constructor(e){this.decoders=e}or(e){return Ah(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ah=(e,t)=>new Sh({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Ih{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Eh(e,t,r),this.decoder=new _h(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ch=({name:e,prefix:t,encode:r,decode:n})=>new Ih(e,t,r,n),kh=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=gh(r,t);return Ch({prefix:e,name:t,encode:n,decode:e=>wh(i(e))})},Th=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Rh=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},Ph=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Ch({prefix:t,name:e,encode(e){return Rh(e,n,r)},decode(t){return Th(t,n,r,e)}}),xh=Ch({prefix:"\0",name:"identity",encode:e=>vh(e),decode:e=>bh(e)}),Dh=Ph({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Oh=Ph({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Nh=kh({prefix:"9",name:"base10",alphabet:"0123456789"}),Lh=Ph({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Bh=Ph({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Uh=Ph({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Mh=Ph({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),jh=Ph({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Vh=Ph({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),zh=Ph({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Fh=Ph({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),$h=Ph({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Kh=Ph({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),qh=Ph({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Hh=kh({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Gh=kh({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Wh=kh({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Yh=kh({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Jh=Ph({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Qh=Ph({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Xh=Ph({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Zh=Ph({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ed=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),td=ed.reduce(((e,t,r)=>(e[r]=t,e)),[]),rd=ed.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);function nd(e){return e.reduce(((e,t)=>(e+=td[t],e)),"")}function id(e){const t=[];for(const r of e){const e=rd[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}const sd=Ch({prefix:"🚀",name:"base256emoji",encode:nd,decode:id});var od=hd,ad=128,cd=127,ld=~cd,ud=Math.pow(2,31);function hd(e,t,r){t=t||[],r=r||0;var n=r;while(e>=ud)t[r++]=255&e|ad,e/=128;while(e&ld)t[r++]=255&e|ad,e>>>=7;return t[r]=0|e,hd.bytes=r-n+1,t}var dd=yd,fd=128,pd=127;function yd(e,t){var r,n=0,i=(t=t||0,0),s=t,o=e.length;do{if(s>=o)throw yd.bytes=0,new RangeError("Could not decode varint");r=e[s++],n+=i<28?(r&pd)<<i:(r&pd)*Math.pow(2,i),i+=7}while(r>=fd);return yd.bytes=s-t,n}var gd=Math.pow(2,7),md=Math.pow(2,14),wd=Math.pow(2,21),bd=Math.pow(2,28),vd=Math.pow(2,35),Ed=Math.pow(2,42),_d=Math.pow(2,49),Sd=Math.pow(2,56),Ad=Math.pow(2,63),Id=function(e){return e<gd?1:e<md?2:e<wd?3:e<bd?4:e<vd?5:e<Ed?6:e<_d?7:e<Sd?8:e<Ad?9:10},Cd={encode:od,decode:dd,encodingLength:Id},kd=Cd,Td=kd;const Rd=(e,t=0)=>{const r=Td.decode(e,t);return[r,Td.decode.bytes]},Pd=(e,t,r=0)=>(Td.encode(e,t,r),t),xd=e=>Td.encodingLength(e),Dd=(e,t)=>{const r=t.byteLength,n=xd(e),i=n+xd(r),s=new Uint8Array(i+r);return Pd(e,s,0),Pd(r,s,n),s.set(t,i),new Ld(e,r,t,s)},Od=e=>{const t=wh(e),[r,n]=Rd(t),[i,s]=Rd(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new Ld(r,i,o,t)},Nd=(e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&mh(e.bytes,r.bytes)}};class Ld{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Bd=({name:e,code:t,encode:r})=>new Ud(e,t,r);class Ud{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Dd(this.code,t):t.then((e=>Dd(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Md=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),jd=Bd({name:"sha2-256",code:18,encode:Md("SHA-256")}),Vd=Bd({name:"sha2-512",code:19,encode:Md("SHA-512")}),zd=0,Fd="identity",$d=wh,Kd=e=>Dd(zd,$d(e)),qd={code:zd,name:Fd,encode:$d,digest:Kd},Hd="raw",Gd=85,Wd=e=>wh(e),Yd=e=>wh(e),Jd=new TextEncoder,Qd=new TextDecoder,Xd="json",Zd=512,ef=e=>Jd.encode(JSON.stringify(e)),tf=e=>JSON.parse(Qd.decode(e)),rf=(e,t)=>{const{bytes:r,version:n}=e;switch(n){case 0:return cf(r,sf(e),t||Wh.encoder);default:return lf(r,sf(e),t||Uh.encoder)}},nf=new WeakMap,sf=e=>{const t=nf.get(e);if(null==t){const t=new Map;return nf.set(e,t),t}return t};class of{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==uf)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==hf)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return of.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Dd(e,t);return of.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return of.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Nd(e.multihash,r.multihash)}toString(e){return rf(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof of)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new of(e,r,n,i||df(e,r,n.bytes))}if(!0===t[ff]){const{version:e,multihash:r,code:n}=t,i=Od(r);return of.create(e,n,i)}return null}static create(e,t,r){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==uf)throw new Error(`Version 0 CID must use dag-pb (code: ${uf}) block encoding`);return new of(e,t,r,r.bytes);case 1:{const n=df(e,t,r.bytes);return new of(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return of.create(0,uf,e)}static createV1(e,t){return of.create(1,e,t)}static decode(e){const[t,r]=of.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=of.inspectBytes(e),r=t.size-t.multihashSize,n=wh(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Ld(t.multihashCode,t.digestSize,i,n),o=0===t.version?of.createV0(s):of.createV1(t.codec,s);return[o,e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=Rd(e.subarray(t));return t+=n,r};let n=r(),i=uf;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a,l=c-s;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:l,size:c}}static parse(e,t){const[r,n]=af(e,t),i=of.decode(n);return sf(i).set(r,e),i}}const af=(e,t)=>{switch(e[0]){case"Q":{const r=t||Wh;return[Wh.prefix,r.decode(`${Wh.prefix}${e}`)]}case Wh.prefix:{const r=t||Wh;return[Wh.prefix,r.decode(e)]}case Uh.prefix:{const r=t||Uh;return[Uh.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},cf=(e,t,r)=>{const{prefix:n}=r;if(n!==Wh.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i},lf=(e,t,r)=>{const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i},uf=112,hf=18,df=(e,t,r)=>{const n=xd(e),i=n+xd(t),s=new Uint8Array(i+r.byteLength);return Pd(e,s,0),Pd(t,s,n),s.set(r,i),s},ff=Symbol.for("@ipld/js-cid/CID"),pf={...S,...A,...I,...C,...k,...T,...R,...P,...x,...D};function yf(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function gf(e=0){return null!=globalThis.Buffer?.allocUnsafe?yf(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function mf(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const wf=mf("utf8","u",(e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)}),(e=>{const t=new TextEncoder;return t.encode(e.substring(1))})),bf=mf("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=gf(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),vf={utf8:wf,"utf-8":wf,hex:pf.base16,latin1:bf,ascii:bf,binary:bf,...pf};var Ef=vf;function _f(e,t="utf8"){const r=Ef[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}const Sf=uh,Af=hh,If=function(e){let t=0;if(e=e.toString().trim(),Sf(e)){const r=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{r[t++]=255&parseInt(e,10)})),r}if(Af(e)){const r=e.split(":",8);let n;for(n=0;n<r.length;n++){const e=Sf(r[n]);let t;e&&(t=If(r[n]),r[n]=_f(t.slice(0,2),"base16")),null!=t&&++n<8&&r.splice(n,0,_f(t.slice(2,4),"base16"))}if(""===r[0])while(r.length<8)r.unshift("0");else if(""===r[r.length-1])while(r.length<8)r.push("0");else if(r.length<8){for(n=0;n<r.length&&""!==r[n];n++);const e=[n,1];for(n=9-r.length;n>0;n--)e.push("0");r.splice.apply(r,e)}const i=new Uint8Array(t+16);for(n=0;n<r.length;n++){const e=parseInt(r[n],16);i[t++]=e>>8&255,i[t++]=255&e}return i}throw new Error("invalid ip address")},Cf=function(e,t=0,r){t=~~t,r=r??e.length-t;const n=new DataView(e.buffer);if(4===r){const n=[];for(let i=0;i<r;i++)n.push(e[t+i]);return n.join(".")}if(16===r){const e=[];for(let i=0;i<r;i+=2)e.push(n.getUint16(t+i).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},kf=-1,Tf={},Rf={},Pf=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,kf,"ip6zone"],[53,kf,"dns",!0],[54,kf,"dns4",!0],[55,kf,"dns6",!0],[56,kf,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,kf,"unix",!1,!0],[421,kf,"ipfs"],[421,kf,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,kf,"garlic64"],[460,0,"quic"],[465,0,"webtransport"],[466,kf,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,kf,"memory"]];function xf(e,t,r,n,i){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(i)}}function Df(e){if("number"===typeof e){if(null!=Rf[e])return Rf[e];throw new Error(`no protocol with code: ${e}`)}if("string"===typeof e){if(null!=Tf[e])return Tf[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}Pf.forEach((e=>{const t=xf(...e);Rf[t.code]=t,Tf[t.name]=t}));var Of=r(4676);function Nf(e,t="utf8"){const r=Ef[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):yf(globalThis.Buffer.from(e,"utf-8"))}function Lf(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=gf(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return yf(r)}function Bf(e,t){const r=Df(e);switch(r.code){case 4:case 41:return zf(t);case 6:case 273:case 33:case 132:return $f(t).toString();case 53:case 54:case 55:case 56:case 400:case 777:return qf(t);case 421:return Yf(t);case 444:return Xf(t);case 445:return Xf(t);case 466:return Wf(t);default:return _f(t,"base16")}}function Uf(e,t){const r=Df(e);switch(r.code){case 4:return Vf(t);case 41:return Vf(t);case 6:case 273:case 33:case 132:return Ff(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return Kf(t);case 421:return Hf(t);case 444:return Jf(t);case 445:return Qf(t);case 466:return Gf(t);default:return Nf(t,"base16")}}const Mf=Object.values(pf).map((e=>e.decoder)),jf=function(){let e=Mf[0].or(Mf[1]);return Mf.slice(2).forEach((t=>e=e.or(t))),e}();function Vf(e){if(!dh(e))throw new Error("invalid ip address");return If(e)}function zf(e){const t=Cf(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!dh(t))throw new Error("invalid ip address");return t}function Ff(e){const t=new ArrayBuffer(2),r=new DataView(t);return r.setUint16(0,e),new Uint8Array(t)}function $f(e){const t=new DataView(e.buffer);return t.getUint16(e.byteOffset)}function Kf(e){const t=Nf(e),r=Uint8Array.from(Of.encode(t.length));return Lf([r,t],r.length+t.length)}function qf(e){const t=Of.decode(e);if(e=e.slice(Of.decode.bytes),e.length!==t)throw new Error("inconsistent lengths");return _f(e)}function Hf(e){let t;t="Q"===e[0]||"1"===e[0]?Od(Wh.decode(`z${e}`)).bytes:of.parse(e).multihash.bytes;const r=Uint8Array.from(Of.encode(t.length));return Lf([r,t],r.length+t.length)}function Gf(e){const t=jf.decode(e),r=Uint8Array.from(Of.encode(t.length));return Lf([r,t],r.length+t.length)}function Wf(e){const t=Of.decode(e),r=e.slice(Of.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return"u"+_f(r,"base64url")}function Yf(e){const t=Of.decode(e),r=e.slice(Of.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return _f(r,"base58btc")}function Jf(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(16!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const r=Uh.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const i=Ff(n);return Lf([r,i],r.length+i.length)}function Qf(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(56!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const r=Uh.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const i=Ff(n);return Lf([r,i],r.length+i.length)}function Xf(e){const t=e.slice(0,e.length-2),r=e.slice(e.length-2),n=_f(t,"base32"),i=$f(r);return`${n}:${i}`}function Zf(e){const t=[],r=e.split("/").slice(1);if(1===r.length&&""===r[0])return[];for(let n=0;n<r.length;n++){const i=r[n],s=Df(i);if(0!==s.size){if(n++,n>=r.length)throw dp("invalid address: "+e);if(!0===s.path){t.push([i,hp(r.slice(n).join("/"))]);break}t.push([i,r[n]])}else t.push([i])}return t}function ep(e){const t=[];return e.map((e=>{const r=fp(e);return t.push(r.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),hp(t.join("/"))}function tp(e){return e.map((e=>{Array.isArray(e)||(e=[e]);const t=fp(e);return e.length>1?[t.code,Uf(t.code,e[1])]:[t.code]}))}function rp(e){return e.map((e=>{const t=fp(e);return null!=e[1]?[t.code,Bf(t.code,e[1])]:[t.code]}))}function np(e){return lp(Lf(e.map((e=>{const t=fp(e);let r=Uint8Array.from(Of.encode(t.code));return e.length>1&&null!=e[1]&&(r=Lf([r,e[1]])),r}))))}function ip(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;{const e=Of.decode(t);return e+Of.decode.bytes}}function sp(e){const t=[];let r=0;while(r<e.length){const n=Of.decode(e,r),i=Of.decode.bytes,s=Df(n),o=ip(s,e.slice(r+i));if(0===o){t.push([n]),r+=i;continue}const a=e.slice(r+i,r+i+o);if(r+=o+i,r>e.length)throw dp("Invalid address Uint8Array: "+_f(e,"base16"));t.push([n,a])}return t}function op(e){const t=sp(e),r=rp(t);return ep(r)}function ap(e){e=hp(e);const t=Zf(e),r=tp(t);return np(r)}function cp(e){return ap(e)}function lp(e){const t=up(e);if(null!=t)throw t;return Uint8Array.from(e)}function up(e){try{sp(e)}catch(WV){return WV}}function hp(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function dp(e){return new Error("Error parsing address: "+e)}function fp(e){const t=Df(e[0]);return t}function pp(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var yp,gp,mp,wp,bp=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},vp=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r};const Ep=Symbol.for("nodejs.util.inspect.custom"),_p=[Df("dns").code,Df("dns4").code,Df("dns6").code,Df("dnsaddr").code],Sp=[Df("p2p").code,Df("ipfs").code],Ap=new Map,Ip=Symbol.for("@multiformats/js-multiaddr/multiaddr");function Cp(e,t){if(null==e)throw new Error("requires node address object");if(null==t)throw new Error("requires transport protocol");let r;switch(e.family){case 4:r="ip4";break;case 6:r="ip6";break;default:throw Error("Invalid addr family, should be 4 or 6.")}return new Rp("/"+[r,e.address,t,e.port].join("/"))}function kp(e){return!!Tp(e)&&e.protos().some((e=>e.resolvable))}function Tp(e){return Boolean(e?.[Ip])}class Rp{constructor(e){if(yp.set(this,void 0),gp.set(this,void 0),mp.set(this,void 0),this[wp]=!0,null==e&&(e=""),e instanceof Uint8Array)this.bytes=lp(e);else if("string"===typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=cp(e)}else{if(!Tp(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=lp(e.bytes)}}toString(){return null==bp(this,yp,"f")&&vp(this,yp,op(this.bytes),"f"),bp(this,yp,"f")}toJSON(){return this.toString()}toOptions(){const e=this.protoCodes(),t=this.toString().split("/").slice(1);let r,n;if(t.length>2)_p.includes(e[0])&&Sp.includes(e[1])?(r=Df("tcp").name,n=443):(r=Df(t[2]).name,n=parseInt(t[3]));else{if(!_p.includes(e[0]))throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');r=Df("tcp").name,n=443}const i={family:41===e[0]||55===e[0]?6:4,host:t[1],transport:r,port:n};return i}protos(){return this.protoCodes().map((e=>Object.assign({},Df(e))))}protoCodes(){const e=[],t=this.bytes;let r=0;while(r<t.length){const n=Of.decode(t,r),i=Of.decode.bytes,s=Df(n),o=ip(s,t.slice(r+i));r+=o+i,e.push(n)}return e}protoNames(){return this.protos().map((e=>e.name))}tuples(){return null==bp(this,gp,"f")&&vp(this,gp,sp(this.bytes),"f"),bp(this,gp,"f")}stringTuples(){return null==bp(this,mp,"f")&&vp(this,mp,rp(this.tuples()),"f"),bp(this,mp,"f")}encapsulate(e){return e=new Rp(e),new Rp(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),r=this.toString(),n=r.lastIndexOf(t);if(n<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new Rp(r.slice(0,n))}decapsulateCode(e){const t=this.tuples();for(let r=t.length-1;r>=0;r--)if(t[r][0]===e)return new Rp(np(t.slice(0,r)));return this}getPeerId(){try{const e=this.stringTuples().filter((e=>e[0]===Tf.ipfs.code)),t=e.pop();if(null!=t?.[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?_f(Wh.decode(`z${e}`),"base58btc"):_f(of.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter((e=>{const t=Df(e[0]);return!0===t.path}))[0][1],null==e&&(e=null)}catch{e=null}return e}equals(e){return pp(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const r=Ap.get(t.name);if(null==r)throw mn(new Error(`no available resolver for ${t.name}`),"ERR_NO_AVAILABLE_RESOLVER");const n=await r(this,e);return n.map((e=>new Rp(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[(yp=new WeakMap,gp=new WeakMap,mp=new WeakMap,wp=Ip,Ep)](){return this.inspect()}inspect(){return"<Multiaddr "+_f(this.bytes,"base16")+" - "+op(this.bytes)+">"}}function Pp(e){return new Rp(e)}const xp=ry("dns4"),Dp=ry("dns6"),Op=ry("dnsaddr"),Np=ty(ry("dns"),Op,xp,Dp),Lp=ty(ry("ip4"),ry("ip6")),Bp=ty(ey(Lp,ry("tcp")),ey(Np,ry("tcp"))),Up=ey(Lp,ry("udp")),Mp=ey(Up,ry("utp")),jp=ey(Up,ry("quic")),Vp=ty(ey(Bp,ry("ws")),ey(Np,ry("ws"))),zp=ty(ey(Bp,ry("wss")),ey(Np,ry("wss"))),Fp=ty(ey(Bp,ry("http")),ey(Lp,ry("http")),ey(Np,ry("http"))),$p=ty(ey(Bp,ry("https")),ey(Lp,ry("https")),ey(Np,ry("https"))),Kp=ty(ey(Vp,ry("p2p-webrtc-star"),ry("p2p")),ey(zp,ry("p2p-webrtc-star"),ry("p2p")),ey(Vp,ry("p2p-webrtc-star")),ey(zp,ry("p2p-webrtc-star"))),qp=(ty(ey(Vp,ry("p2p-websocket-star"),ry("p2p")),ey(zp,ry("p2p-websocket-star"),ry("p2p")),ey(Vp,ry("p2p-websocket-star")),ey(zp,ry("p2p-websocket-star"))),ty(ey(Fp,ry("p2p-webrtc-direct"),ry("p2p")),ey($p,ry("p2p-webrtc-direct"),ry("p2p")),ey(Fp,ry("p2p-webrtc-direct")),ey($p,ry("p2p-webrtc-direct")))),Hp=ty(Vp,zp,Fp,$p,Kp,qp,Bp,Mp,jp,Np),Gp=(ty(ey(Hp,ry("p2p-stardust"),ry("p2p")),ey(Hp,ry("p2p-stardust"))),ty(ey(Hp,ry("p2p")),Kp,qp,ry("p2p"))),Wp=ty(ey(Gp,ry("p2p-circuit"),Gp),ey(Gp,ry("p2p-circuit")),ey(ry("p2p-circuit"),Gp),ey(Hp,ry("p2p-circuit")),ey(ry("p2p-circuit"),Hp),ry("p2p-circuit")),Yp=()=>ty(ey(Wp,Yp),Wp),Jp=Yp(),Qp=ty(ey(Jp,Gp,Jp),ey(Gp,Jp),ey(Jp,Gp),Jp,Gp),Xp=Qp;function Zp(e){function t(t){let r;try{r=Pp(t)}catch(WV){return!1}const n=e(r.protoNames());return null!==n&&(!0===n||!1===n?n:0===n.length)}return t}function ey(...e){function t(t){if(t.length<e.length)return null;let r=t;return e.some((e=>(r="function"===typeof e?e().partialMatch(t):e.partialMatch(t),Array.isArray(r)&&(t=r),null===r))),r}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:Zp(t),partialMatch:t}}function ty(...e){function t(t){let r=null;return e.some((e=>{const n="function"===typeof e?e().partialMatch(t):e.partialMatch(t);return null!=n&&(r=n,!0)})),r}const r={toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:Zp(t),partialMatch:t};return r}function ry(e){const t=e;function r(e){let r;try{r=Pp(e)}catch(WV){return!1}const n=r.protoNames();return 1===n.length&&n[0]===t}function n(e){return 0===e.length?null:e[0]===t?e.slice(1):null}return{toString:function(){return t},matches:r,partialMatch:n}}const ny=(e,t)=>{const{bytes:r,version:n}=e;switch(n){case 0:return cy(r,sy(e),t||gu.encoder);default:return ly(r,sy(e),t||wu.encoder)}},iy=new WeakMap,sy=e=>{const t=iy.get(e);if(null==t){const t=new Map;return iy.set(e,t),t}return t};class oy{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==uy)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==hy)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return oy.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Zu(e,t);return oy.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return oy.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&th(e.multihash,r.multihash)}toString(e){return ny(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof oy)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new oy(e,r,n,i||dy(e,r,n.bytes))}if(!0===t[fy]){const{version:e,multihash:r,code:n}=t,i=eh(r);return oy.create(e,n,i)}return null}static create(e,t,r){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==uy)throw new Error(`Version 0 CID must use dag-pb (code: ${uy}) block encoding`);return new oy(e,t,r,r.bytes);case 1:{const n=dy(e,t,r.bytes);return new oy(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return oy.create(0,uy,e)}static createV1(e,t){return oy.create(1,e,t)}static decode(e){const[t,r]=oy.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=oy.inspectBytes(e),r=t.size-t.multihashSize,n=nu(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new rh(t.multihashCode,t.digestSize,i,n),o=0===t.version?oy.createV0(s):oy.createV1(t.codec,s);return[o,e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=Ju(e.subarray(t));return t+=n,r};let n=r(),i=uy;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a,l=c-s;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:l,size:c}}static parse(e,t){const[r,n]=ay(e,t),i=oy.decode(n);return sy(i).set(r,e),i}}const ay=(e,t)=>{switch(e[0]){case"Q":{const r=t||gu;return[gu.prefix,r.decode(`${gu.prefix}${e}`)]}case gu.prefix:{const r=t||gu;return[gu.prefix,r.decode(e)]}case wu.prefix:{const r=t||wu;return[wu.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},cy=(e,t,r)=>{const{prefix:n}=r;if(n!==gu.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i},ly=(e,t,r)=>{const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i},uy=112,hy=18,dy=(e,t,r)=>{const n=Xu(e),i=n+Xu(t),s=new Uint8Array(i+r.byteLength);return Qu(e,s,0),Qu(t,s,n),s.set(r,i),s},fy=Symbol.for("@ipld/js-cid/CID");var py=r(7745);const yy=hu({prefix:"\0",name:"identity",encode:e=>su(e),decode:e=>iu(e)}),gy=yu({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),my=yu({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),wy=du({prefix:"9",name:"base10",alphabet:"0123456789"}),by=yu({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),vy=yu({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Ey=du({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),_y=du({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Sy=yu({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ay=yu({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Iy=yu({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Cy=yu({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ky=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Ty=ky.reduce(((e,t,r)=>(e[r]=t,e)),[]),Ry=ky.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);function Py(e){return e.reduce(((e,t)=>(e+=Ty[t],e)),"")}function xy(e){const t=[];for(const r of e){const e=Ry[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}const Dy=hu({prefix:"🚀",name:"base256emoji",encode:Py,decode:xy}),Oy=({name:e,code:t,encode:r})=>new Ny(e,t,r);class Ny{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Zu(this.code,t):t.then((e=>Zu(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Ly=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),By=Oy({name:"sha2-256",code:18,encode:Ly("SHA-256")}),Uy=Oy({name:"sha2-512",code:19,encode:Ly("SHA-512")}),My=0,jy="identity",Vy=nu,zy=e=>Zu(My,Vy(e)),Fy={code:My,name:jy,encode:Vy,digest:zy},$y="raw",Ky=85,qy=e=>nu(e),Hy=e=>nu(e),Gy=new TextEncoder,Wy=new TextDecoder,Yy="json",Jy=512,Qy=e=>Gy.encode(JSON.stringify(e)),Xy=e=>JSON.parse(Wy.decode(e)),Zy={...U,...M,...j,...V,...z,..._,...F,...E,...$,...K};function eg(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function tg(e=0){return null!=globalThis.Buffer?.allocUnsafe?eg(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function rg(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const ng=rg("utf8","u",(e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)}),(e=>{const t=new TextEncoder;return t.encode(e.substring(1))})),ig=rg("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=tg(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),sg={utf8:ng,"utf-8":ng,hex:Zy.base16,latin1:ig,ascii:ig,binary:ig,...Zy};var og=sg;function ag(e,t="utf8"){const r=og[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}const cg=/^\/(ip[fn]s)\/([^/?#]+)/,lg=1,ug=2,hg=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,dg=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function fg(e){try{return gg(e)?Boolean(oy.parse(e)):e instanceof Uint8Array?Boolean(oy.decode(e)):Boolean(oy.asCID(e))}catch{return!1}}function pg(e,t,r=lg,n=ug){const i=mg(e);if(!1===i)return!1;const s=i.match(t);if(null==s)return!1;if("ipfs"!==s[r])return!1;let o=s[n];return null!=o&&t===hg&&(o=o.toLowerCase()),fg(o)}function yg(e,t,r=lg,n=ug){const i=mg(e);if(!1===i)return!1;const s=i.match(t);if(null==s)return!1;if("ipns"!==s[r])return!1;let o=s[n];if(null!=o&&t===hg){if(o=o.toLowerCase(),fg(o))return!0;try{!o.includes(".")&&o.includes("-")&&(o=o.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));const{hostname:e}=new py.URL(`http://${o}`);return dg.test(e)}catch(a){return!1}}return!0}function gg(e){return"string"===typeof e}function mg(e){return e instanceof Uint8Array?ag(e,"base58btc"):!!gg(e)&&e}const wg=e=>pg(e,cg)||yg(e,cg),bg=e=>pg(e,cg),vg=e=>yg(e,cg);let Eg=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>(t&=63,e+=t<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_",e)),"");function _g(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var Sg=_g,Ag=Sg,Ig=Ag;new Uint8Array(0);const Cg=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},kg=e=>(new TextEncoder).encode(e),Tg=e=>(new TextDecoder).decode(e);class Rg{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Pg{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Dg(this,e)}}class xg{constructor(e){this.decoders=e}or(e){return Dg(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Dg=(e,t)=>new xg({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Og{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Rg(e,t,r),this.decoder=new Pg(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ng=({name:e,prefix:t,encode:r,decode:n})=>new Og(e,t,r,n),Lg=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=Ig(r,t);return Ng({prefix:e,name:t,encode:n,decode:e=>Cg(i(e))})},Bg=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Ug=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},Mg=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Ng({prefix:t,name:e,encode(e){return Ug(e,n,r)},decode(t){return Bg(t,n,r,e)}}),jg=Ng({prefix:"\0",name:"identity",encode:e=>Tg(e),decode:e=>kg(e)}),Vg=Mg({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),zg=Mg({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Fg=Lg({prefix:"9",name:"base10",alphabet:"0123456789"}),$g=Mg({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Kg=Mg({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),qg=Mg({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Hg=Mg({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Gg=Mg({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Wg=Mg({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Yg=Mg({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Jg=Mg({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Qg=Mg({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Xg=Mg({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Zg=Mg({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),em=Lg({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),tm=Lg({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),rm=Lg({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),nm=Lg({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),im=Mg({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),sm=Mg({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),om=Mg({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),am=Mg({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),cm=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),lm=cm.reduce(((e,t,r)=>(e[r]=t,e)),[]),um=cm.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);function hm(e){return e.reduce(((e,t)=>(e+=lm[t],e)),"")}function dm(e){const t=[];for(const r of e){const e=um[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}const fm=Ng({prefix:"🚀",name:"base256emoji",encode:hm,decode:dm});var pm=bm,ym=128,gm=127,mm=~gm,wm=Math.pow(2,31);function bm(e,t,r){t=t||[],r=r||0;var n=r;while(e>=wm)t[r++]=255&e|ym,e/=128;while(e&mm)t[r++]=255&e|ym,e>>>=7;return t[r]=0|e,bm.bytes=r-n+1,t}var vm=Sm,Em=128,_m=127;function Sm(e,t){var r,n=0,i=(t=t||0,0),s=t,o=e.length;do{if(s>=o)throw Sm.bytes=0,new RangeError("Could not decode varint");r=e[s++],n+=i<28?(r&_m)<<i:(r&_m)*Math.pow(2,i),i+=7}while(r>=Em);return Sm.bytes=s-t,n}var Am=Math.pow(2,7),Im=Math.pow(2,14),Cm=Math.pow(2,21),km=Math.pow(2,28),Tm=Math.pow(2,35),Rm=Math.pow(2,42),Pm=Math.pow(2,49),xm=Math.pow(2,56),Dm=Math.pow(2,63),Om=function(e){return e<Am?1:e<Im?2:e<Cm?3:e<km?4:e<Tm?5:e<Rm?6:e<Pm?7:e<xm?8:e<Dm?9:10},Nm={encode:pm,decode:vm,encodingLength:Om},Lm=Nm,Bm=Lm;const Um=(e,t,r=0)=>(Bm.encode(e,t,r),t),Mm=e=>Bm.encodingLength(e),jm=(e,t)=>{const r=t.byteLength,n=Mm(e),i=n+Mm(r),s=new Uint8Array(i+r);return Um(e,s,0),Um(r,s,n),s.set(t,i),new Vm(e,r,t,s)};class Vm{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const zm=({name:e,code:t,encode:r})=>new Fm(e,t,r);class Fm{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?jm(this.code,t):t.then((e=>jm(this.code,e)))}throw Error("Unknown type, must be binary type")}}const $m=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Km=zm({name:"sha2-256",code:18,encode:$m("SHA-256")}),qm=zm({name:"sha2-512",code:19,encode:$m("SHA-512")}),Hm=0,Gm="identity",Wm=Cg,Ym=e=>jm(Hm,Wm(e)),Jm={code:Hm,name:Gm,encode:Wm,digest:Ym},Qm="raw",Xm=85,Zm=e=>Cg(e),ew=e=>Cg(e),tw=new TextEncoder,rw=new TextDecoder,nw="json",iw=512,sw=e=>tw.encode(JSON.stringify(e)),ow=e=>JSON.parse(rw.decode(e));new WeakMap;class aw{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==multiformats_src_cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==multiformats_src_cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return aw.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return aw.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return aw.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return src_cid_format(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof aw)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new aw(e,r,n,i||multiformats_src_cid_encodeCID(e,r,n.bytes))}if(!0===t[multiformats_src_cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,i=Digest.decode(r);return aw.create(e,n,i)}return null}static create(e,t,r){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==multiformats_src_cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${multiformats_src_cid_DAG_PB_CODE}) block encoding`);return new aw(e,t,r,r.bytes);case 1:{const n=multiformats_src_cid_encodeCID(e,t,r.bytes);return new aw(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return aw.create(0,multiformats_src_cid_DAG_PB_CODE,e)}static createV1(e,t){return aw.create(1,e,t)}static decode(e){const[t,r]=aw.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=aw.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Digest.Digest(t.multihashCode,t.digestSize,i,n),o=0===t.version?aw.createV0(s):aw.createV1(t.codec,s);return[o,e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),i=multiformats_src_cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a,l=c-s;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:l,size:c}}static parse(e,t){const[r,n]=multiformats_src_cid_parseCIDtoBytes(e,t),i=aw.decode(n);return src_cid_baseCache(i).set(r,e),i}}Symbol.for("@ipld/js-cid/CID");const cw={...Y,...J,...Q,...X,...Z,...ee,...te,...re,...ne,...ie};function lw(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function uw(e=0){return null!=globalThis.Buffer?.allocUnsafe?lw(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function hw(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const dw=hw("utf8","u",(e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)}),(e=>{const t=new TextEncoder;return t.encode(e.substring(1))})),fw=hw("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=uw(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),pw={utf8:dw,"utf-8":dw,hex:cw.base16,latin1:fw,ascii:fw,binary:fw,...cw};var yw=pw;function gw(e,t="utf8"){const r=yw[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function mw(e,t="utf8"){const r=yw[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):lw(globalThis.Buffer.from(e,"utf-8"))}const ww="/",bw=(new TextEncoder).encode(ww),vw=bw[0];class Ew{constructor(e,t){if("string"===typeof e)this._buf=mw(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==vw)throw new Error("Invalid key")}toString(e="utf8"){return gw(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Ew(e.join(ww))}static random(){return new Ew(Eg().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"===typeof e?new Ew(e):"function"===typeof e.uint8Array?new Ew(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=bw),this._buf[0]!==vw){const e=new Uint8Array(this._buf.byteLength+1);e.fill(vw,0,1),e.set(this._buf,1),this._buf=e}while(this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===vw)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),r=e.list();for(let n=0;n<t.length;n++){if(r.length<n+1)return!1;const e=t[n],i=r[n];if(e<i)return!0;if(e>i)return!1}return t.length<r.length}reverse(){return Ew.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(ww).slice(1)}type(){return _w(this.baseNamespace())}name(){return Sw(this.baseNamespace())}instance(e){return new Ew(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(ww)||(e+=ww),e+=this.type(),new Ew(e)}parent(){const e=this.list();return 1===e.length?new Ew(ww):new Ew(e.slice(0,-1).join(ww))}child(e){return this.toString()===ww?e:e.toString()===ww?this:new Ew(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(...e){return Ew.withNamespaces([...this.namespaces(),...Aw(e.map((e=>e.namespaces())))])}}function _w(e){const t=e.split(":");return t.length<2?"":t.slice(0,-1).join(":")}function Sw(e){const t=e.split(":");return t[t.length-1]}function Aw(e){return[].concat(...e)}var Iw=r(2044);let Cw=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/giu;function kw(e="",t="ms"){var r=null;return e=(e+"").replace(/(\d)[,_](\d)/g,"$1$2"),e.replace(Cw,(function(e,t,n){n=Tw(n),n&&(r=(r||0)+parseFloat(t,10)*n)})),r&&r/(Tw(t)||1)}function Tw(e){return kw[e]||kw[e.toLowerCase().replace(/s$/,"")]}kw.nanosecond=kw.ns=1e-6,kw["µs"]=kw["μs"]=kw.us=kw.microsecond=.001,kw.millisecond=kw.ms=kw[""]=1,kw.second=kw.sec=kw.s=1e3*kw.ms,kw.minute=kw.min=kw.m=60*kw.s,kw.hour=kw.hr=kw.h=60*kw.m,kw.day=kw.d=24*kw.h,kw.week=kw.wk=kw.w=7*kw.d,kw.month=kw.b=30.4375*kw.d,kw.year=kw.yr=kw.y=365.25*kw.d;var Rw=kw;class Pw extends Error{constructor(e="request timed out"){super(e),this.name="TimeoutError",this.code=Pw.code}}function xw(e,t){return(...r)=>{const n=r[null==t?r.length-1:t];if(!n||!n.timeout)return e(...r);const i="string"===typeof n.timeout?Rw(n.timeout):n.timeout,s=new Ql.TimeoutController(i);n.signal=(0,Iw.anySignal)([n.signal,s.signal]);const o=e(...r),a=new Promise(((e,t)=>{s.signal.addEventListener("abort",(()=>{t(new Pw)}))})),c=Date.now(),l=()=>{if(s.signal.aborted)throw new Pw;const e=Date.now()-c;if(e>i)throw s.abort(),new Pw};return o[Symbol.asyncIterator]?async function*(){const e=o[Symbol.asyncIterator]();try{while(1){const{value:t,done:r}=await Promise.race([e.next(),a]);if(r)break;l(),yield t}}catch(WV){throw l(),WV}finally{s.clear(),e.return&&e.return()}}():(async()=>{try{const e=await Promise.race([o,a]);return l(),e}catch(WV){throw l(),WV}finally{s.clear()}})()}}Pw.code="ERR_TIMEOUT";const Dw="/ipfs/";function Ow(e){if(e instanceof Uint8Array)try{e=ji.decode(e)}catch(WV){throw mn(WV,"ERR_INVALID_CID")}let t=ji.asCID(e);if(t)return{cid:t,path:void 0};e=e.toString(),e.startsWith(Dw)&&(e=e.substring(Dw.length));const r=e.split("/");let n;try{t=ji.parse(r.shift()||"")}catch(WV){throw mn(WV,"ERR_INVALID_CID")}return r.length&&(n=`/${r.join("/")}`),{cid:t,path:n}}const Nw="ERR_BAD_PATH",Lw="This command must be run in online mode. Try running 'ipfs daemon' first.",Bw=new Ew("/local/filesroot"),Uw=262144,Mw=e=>{const t=ji.asCID(e);if(t)return`/ipfs/${e}`;const r=e.toString();try{return`/ipfs/${ji.parse(r)}`}catch{}if(wg(r))return r;throw mn(new Error(`invalid path: ${e}`),Nw)},jw=e=>e instanceof Uint8Array?ji.decode(e).toString():(e=e.toString(),0===e.indexOf("/ipfs/")&&(e=e.substring("/ipfs/".length)),"/"===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),e),Vw=async function(e,t,r,n={}){const{cid:i,path:s}=Ow(r);s&&(n.path=s);let o=i,a=n.path||"";if(a.startsWith("/")&&(a=a.substring(1)),n.path)try{for await(const{value:r,remainderPath:s}of $w(i,n.path,t,e,{signal:n.signal})){if(!ji.asCID(r))break;a=s,o=r}}catch(WV){throw WV.message.startsWith("Object has no property")&&(WV.message=`no link named "${a.split("/")[0]}" under ${o}`,WV.code="ERR_NO_LINK"),WV}return{cid:o,remainderPath:a||""}},zw=e=>{if("file"!==e.type&&"directory"!==e.type&&"raw"!==e.type)throw new Error(`Unknown node type '${e.type}'`);const t={cid:e.cid,path:e.path,name:e.name,size:e.size,type:"file"};return"directory"===e.type&&(t.type="dir"),"file"===e.type&&(t.size=e.unixfs.fileSize()),"file"!==e.type&&"directory"!==e.type||(t.mode=e.unixfs.mode,void 0!==e.unixfs.mtime&&(t.mtime=e.unixfs.mtime)),t},Fw=xw((async(e,t)=>await e)),$w=async function*(e,t,r,n,i){const s=async e=>{const t=await r.getCodec(e.code),s=await n.blocks.get(e,i);return t.decode(s)},o=t.split("/").filter(Boolean);let a=await s(e),c=e;while(o.length){const r=o.shift();if(!r)throw mn(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(e.code===Cs&&Array.isArray(a.Links)){const e=a.Links.find((e=>e.Name===r));if(e){yield{value:e.Hash,remainderPath:o.join("/")},a=await s(e.Hash),c=e.Hash;continue}}if(!Object.prototype.hasOwnProperty.call(a,r))throw mn(new Error(`no link named "${r}" under ${c}`),"ERR_NO_LINK");a=a[r],yield{value:a,remainderPath:o.join("/")},ji.asCID(a)&&(c=a,a=await s(a))}yield{value:a,remainderPath:""}};class Kw{static create({start:e,stop:t}){return new Kw(e,t)}static async start(e,t){const{state:r,activate:n}=e;switch(r.status){case"stopped":try{const r=n(t);e.state={status:"starting",ready:r};const i=await r;return e.state={status:"started",value:i},i}catch(i){throw e.state={status:"stopped"},i}case"starting":throw new Vl;case"started":throw new zl;case"stopping":return await r.ready,await Kw.start(e,t);default:return Kw.panic(e)}}static async stop(e){const{state:t,deactivate:r}=e;switch(t.status){case"stopped":break;case"starting":try{await t.ready}catch(n){}return await Kw.stop(e);case"stopping":return await t.ready;case"started":r&&await r(t.value),e.state={status:"stopped"};break;default:Kw.panic(t)}}static try({state:e}){switch(e.status){case"started":return e.value;default:return null}}static async use({state:e},t){switch(e.status){case"started":return e.value;case"starting":return await Fw(e.ready,t);default:throw new jl}}static panic({state:e}){const t=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${t}, should never happen if you see this please report a bug`)}constructor(e,t){this.activate=e,this.deactivate=t,this.state={status:"stopped"}}async use(e){return await Kw.use(this,e)}try(){return Kw.try(this)}}function qw({network:e,preload:t,peerId:r,keychain:n,repo:i,ipns:s,mfsPreload:o,print:a,hashers:c,options:l}){const u=async()=>{const{libp2p:u}=await Kw.start(e,{peerId:r,repo:i,print:a,hashers:c,options:l});await Promise.all([s.startOnline({keychain:n,libp2p:u,peerId:r,repo:i}),t.start(),o.start()])};return u}function Hw({network:e,preload:t,ipns:r,repo:n,mfsPreload:i}){const s=async()=>{await Promise.all([t.stop(),r.stop(),i.stop()]),await Kw.stop(e),await n.close()};return s}var Gw=r(248);class Ww{constructor(e){this.lru=Gw(e)}get(e){const t=this.lru.get(e);if(t)return t.expire&&t.expire<Date.now()?void this.lru.remove(e):t.value}set(e,t,r){this.lru.set(e,{value:t,expire:Date.now()+r})}has(e){const t=this.get(e);return!!t}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}}var Yw=r(6729);class Jw extends Error{constructor(e){super(e),this.name="TimeoutError"}}class Qw extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const Xw=e=>void 0===globalThis.DOMException?new Qw(e):new DOMException(e),Zw=e=>{const t=void 0===e.reason?Xw("This operation was aborted."):e.reason;return t instanceof Error?t:Xw(t)};function eb(e,t,r,n){let i;const s=new Promise(((s,o)=>{if("number"!==typeof t||1!==Math.sign(t))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t!==Number.POSITIVE_INFINITY){if(n={customTimers:{setTimeout:setTimeout,clearTimeout:clearTimeout},...n},n.signal){const{signal:e}=n;e.aborted&&o(Zw(e)),e.addEventListener("abort",(()=>{o(Zw(e))}))}i=n.customTimers.setTimeout.call(void 0,(()=>{if("function"===typeof r){try{s(r())}catch(a){o(a)}return}const n="string"===typeof r?r:`Promise timed out after ${t} milliseconds`,i=r instanceof Error?r:new Jw(n);"function"===typeof e.cancel&&e.cancel(),o(i)}),t),(async()=>{try{s(await e)}catch(t){o(t)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()}else s(e)}));return s.clear=()=>{clearTimeout(i),i=void 0},s}function tb(e,t,r){let n=0,i=e.length;while(i>0){const s=Math.trunc(i/2);let o=n+s;r(e[o],t)<=0?(n=++o,i-=s+1):i=s}return n}var rb,nb=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};class ib{constructor(){rb.set(this,[])}enqueue(e,t){t={priority:0,...t};const r={priority:t.priority,run:e};if(this.size&&nb(this,rb,"f")[this.size-1].priority>=t.priority)return void nb(this,rb,"f").push(r);const n=tb(nb(this,rb,"f"),r,((e,t)=>t.priority-e.priority));nb(this,rb,"f").splice(n,0,r)}dequeue(){const e=nb(this,rb,"f").shift();return null===e||void 0===e?void 0:e.run}filter(e){return nb(this,rb,"f").filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return nb(this,rb,"f").length}}rb=new WeakMap;var sb,ob,ab,cb,lb,ub,hb,db,fb,pb,yb,gb,mb,wb,bb,vb,Eb,_b,Sb,Ab,Ib,Cb,kb,Tb,Rb,Pb,xb=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},Db=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};const Ob=new Jw;class Nb extends Error{}class Lb extends Yw{constructor(e){var t,r,n,i;if(super(),sb.add(this),ob.set(this,void 0),ab.set(this,void 0),cb.set(this,0),lb.set(this,void 0),ub.set(this,void 0),hb.set(this,0),db.set(this,void 0),fb.set(this,void 0),pb.set(this,void 0),yb.set(this,void 0),gb.set(this,0),mb.set(this,void 0),wb.set(this,void 0),bb.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:ib,...e},!("number"===typeof e.intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(r=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==r?r:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(i=null===(n=e.interval)||void 0===n?void 0:n.toString())&&void 0!==i?i:""}\` (${typeof e.interval})`);xb(this,ob,e.carryoverConcurrencyCount,"f"),xb(this,ab,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,"f"),xb(this,lb,e.intervalCap,"f"),xb(this,ub,e.interval,"f"),xb(this,pb,new e.queueClass,"f"),xb(this,yb,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,xb(this,bb,!0===e.throwOnTimeout,"f"),xb(this,wb,!1===e.autoStart,"f")}get concurrency(){return Db(this,mb,"f")}set concurrency(e){if(!("number"===typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);xb(this,mb,e,"f"),Db(this,sb,"m",Rb).call(this)}async add(e,t={}){return new Promise(((r,n)=>{const i=async()=>{var i,s,o;xb(this,gb,(s=Db(this,gb,"f"),s++,s),"f"),xb(this,cb,(o=Db(this,cb,"f"),o++,o),"f");try{if(null===(i=t.signal)||void 0===i?void 0:i.aborted)return void n(new Nb("The task was aborted."));const s=void 0===this.timeout&&void 0===t.timeout?e({signal:t.signal}):eb(Promise.resolve(e({signal:t.signal})),void 0===t.timeout?this.timeout:t.timeout,(()=>{(void 0===t.throwOnTimeout?Db(this,bb,"f"):t.throwOnTimeout)&&n(Ob)})),o=await s;r(o),this.emit("completed",o)}catch(a){n(a),this.emit("error",a)}Db(this,sb,"m",_b).call(this)};Db(this,pb,"f").enqueue(i,t),Db(this,sb,"m",Cb).call(this),this.emit("add")}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return Db(this,wb,"f")?(xb(this,wb,!1,"f"),Db(this,sb,"m",Rb).call(this),this):this}pause(){xb(this,wb,!0,"f")}clear(){xb(this,pb,new(Db(this,yb,"f")),"f")}async onEmpty(){0!==Db(this,pb,"f").size&&await Db(this,sb,"m",Pb).call(this,"empty")}async onSizeLessThan(e){Db(this,pb,"f").size<e||await Db(this,sb,"m",Pb).call(this,"next",(()=>Db(this,pb,"f").size<e))}async onIdle(){0===Db(this,gb,"f")&&0===Db(this,pb,"f").size||await Db(this,sb,"m",Pb).call(this,"idle")}get size(){return Db(this,pb,"f").size}sizeBy(e){return Db(this,pb,"f").filter(e).length}get pending(){return Db(this,gb,"f")}get isPaused(){return Db(this,wb,"f")}}ob=new WeakMap,ab=new WeakMap,cb=new WeakMap,lb=new WeakMap,ub=new WeakMap,hb=new WeakMap,db=new WeakMap,fb=new WeakMap,pb=new WeakMap,yb=new WeakMap,gb=new WeakMap,mb=new WeakMap,wb=new WeakMap,bb=new WeakMap,sb=new WeakSet,vb=function(){return Db(this,ab,"f")||Db(this,cb,"f")<Db(this,lb,"f")},Eb=function(){return Db(this,gb,"f")<Db(this,mb,"f")},_b=function(){var e;xb(this,gb,(e=Db(this,gb,"f"),e--,e),"f"),Db(this,sb,"m",Cb).call(this),this.emit("next")},Sb=function(){this.emit("empty"),0===Db(this,gb,"f")&&this.emit("idle")},Ab=function(){Db(this,sb,"m",Tb).call(this),Db(this,sb,"m",kb).call(this),xb(this,fb,void 0,"f")},Ib=function(){const e=Date.now();if(void 0===Db(this,db,"f")){const t=Db(this,hb,"f")-e;if(!(t<0))return void 0===Db(this,fb,"f")&&xb(this,fb,setTimeout((()=>{Db(this,sb,"m",Ab).call(this)}),t),"f"),!0;xb(this,cb,Db(this,ob,"f")?Db(this,gb,"f"):0,"f")}return!1},Cb=function(){if(0===Db(this,pb,"f").size)return Db(this,db,"f")&&clearInterval(Db(this,db,"f")),xb(this,db,void 0,"f"),Db(this,sb,"m",Sb).call(this),!1;if(!Db(this,wb,"f")){const e=!Db(this,sb,"a",Ib);if(Db(this,sb,"a",vb)&&Db(this,sb,"a",Eb)){const t=Db(this,pb,"f").dequeue();return!!t&&(this.emit("active"),t(),e&&Db(this,sb,"m",kb).call(this),!0)}}return!1},kb=function(){Db(this,ab,"f")||void 0!==Db(this,db,"f")||(xb(this,db,setInterval((()=>{Db(this,sb,"m",Tb).call(this)}),Db(this,ub,"f")),"f"),xb(this,hb,Date.now()+Db(this,ub,"f"),"f"))},Tb=function(){0===Db(this,cb,"f")&&0===Db(this,gb,"f")&&Db(this,db,"f")&&(clearInterval(Db(this,db,"f")),xb(this,db,void 0,"f")),xb(this,cb,Db(this,ob,"f")?Db(this,gb,"f"):0,"f"),Db(this,sb,"m",Rb).call(this)},Rb=function(){while(Db(this,sb,"m",Cb).call(this));},Pb=async function(e,t){return new Promise((r=>{const n=()=>{t&&!t()||(this.off(e,n),r())};this.on(e,n)}))};var Bb=r(7137);const Ub=new Ww(1e3),Mb=6e4,jb=Lb["default"]?Lb["default"]:Lb,Vb=new jb({concurrency:4}),zb=e=>{if(e.Path)return e.Path;throw new Error(e.Message)};async function Fb(e,t){const r=async(e,t={})=>{const r=new URLSearchParams(t);r.set("arg",e);const n=r.toString();if(!t.nocache&&Ub.has(n)){const e=Ub.get(n);return zb(e)}const i=await Vb.add((async()=>{const e=await Bb.get("https://ipfs.io/api/v0/dns",{searchParams:r}),t=new URL(e.url).search.slice(1),n=await e.json();return Ub.set(t,n,Mb),n}));return zb(i)};return r(e,t)}function $b(e){return e.endsWith(".eth")&&(e=e.replace(/.eth$/,".eth.link")),e}function Kb(){const e=async(e,t={recursive:!0})=>{if("string"!==typeof e)throw new Error("Invalid arguments, domain must be a string");return e=$b(e),Fb(e,t)};return xw(e)}function qb({network:e}){return()=>{const t=e.try();return null!=t&&Boolean(t.libp2p.isStarted())}}var Hb=Qb,Gb=128,Wb=127,Yb=~Wb,Jb=Math.pow(2,31);function Qb(e,t,r){t=t||[],r=r||0;var n=r;while(e>=Jb)t[r++]=255&e|Gb,e/=128;while(e&Yb)t[r++]=255&e|Gb,e>>>=7;return t[r]=0|e,Qb.bytes=r-n+1,t}var Xb=tv,Zb=128,ev=127;function tv(e,t){var r,n=0,i=(t=t||0,0),s=t,o=e.length;do{if(s>=o)throw tv.bytes=0,new RangeError("Could not decode varint");r=e[s++],n+=i<28?(r&ev)<<i:(r&ev)*Math.pow(2,i),i+=7}while(r>=Zb);return tv.bytes=s-t,n}var rv=Math.pow(2,7),nv=Math.pow(2,14),iv=Math.pow(2,21),sv=Math.pow(2,28),ov=Math.pow(2,35),av=Math.pow(2,42),cv=Math.pow(2,49),lv=Math.pow(2,56),uv=Math.pow(2,63),hv=function(e){return e<rv?1:e<nv?2:e<iv?3:e<sv?4:e<ov?5:e<av?6:e<cv?7:e<lv?8:e<uv?9:10},dv={encode:Hb,decode:Xb,encodingLength:hv},fv=dv,pv=fv;const yv=(e,t=0)=>{const r=pv.decode(e,t);return[r,pv.decode.bytes]},gv=(e,t,r=0)=>(pv.encode(e,t,r),t),mv=e=>pv.encodingLength(e),wv=(new Uint8Array(0),(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}),bv=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},vv=e=>(new TextEncoder).encode(e),Ev=e=>(new TextDecoder).decode(e),_v=(e,t)=>{const r=t.byteLength,n=mv(e),i=n+mv(r),s=new Uint8Array(i+r);return gv(e,s,0),gv(r,s,n),s.set(t,i),new Iv(e,r,t,s)},Sv=e=>{const t=bv(e),[r,n]=yv(t),[i,s]=yv(t.subarray(n)),o=t.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new Iv(r,i,o,t)},Av=(e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&wv(e.bytes,r.bytes)}};class Iv{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}function Cv(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var kv=Cv,Tv=kv,Rv=Tv;class Pv{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class xv{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Ov(this,e)}}class Dv{constructor(e){this.decoders=e}or(e){return Ov(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ov=(e,t)=>new Dv({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Nv{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Pv(e,t,r),this.decoder=new xv(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Lv=({name:e,prefix:t,encode:r,decode:n})=>new Nv(e,t,r,n),Bv=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=Rv(r,t);return Lv({prefix:e,name:t,encode:n,decode:e=>bv(i(e))})},Uv=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Mv=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},jv=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Lv({prefix:t,name:e,encode(e){return Mv(e,n,r)},decode(t){return Uv(t,n,r,e)}}),Vv=Bv({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),zv=Bv({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Fv=jv({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),$v=jv({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Kv=jv({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),qv=jv({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Hv=jv({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Gv=jv({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Wv=jv({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Yv=jv({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Jv=jv({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Qv=(e,t)=>{const{bytes:r,version:n}=e;switch(n){case 0:return rE(r,Zv(e),t||Vv.encoder);default:return nE(r,Zv(e),t||Fv.encoder)}},Xv=new WeakMap,Zv=e=>{const t=Xv.get(e);if(null==t){const t=new Map;return Xv.set(e,t),t}return t};class eE{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==iE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==sE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return eE.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=_v(e,t);return eE.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return eE.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Av(e.multihash,r.multihash)}toString(e){return Qv(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof eE)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new eE(e,r,n,i||oE(e,r,n.bytes))}if(!0===t[aE]){const{version:e,multihash:r,code:n}=t,i=Sv(r);return eE.create(e,n,i)}return null}static create(e,t,r){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==iE)throw new Error(`Version 0 CID must use dag-pb (code: ${iE}) block encoding`);return new eE(e,t,r,r.bytes);case 1:{const n=oE(e,t,r.bytes);return new eE(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return eE.create(0,iE,e)}static createV1(e,t){return eE.create(1,e,t)}static decode(e){const[t,r]=eE.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=eE.inspectBytes(e),r=t.size-t.multihashSize,n=bv(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Iv(t.multihashCode,t.digestSize,i,n),o=0===t.version?eE.createV0(s):eE.createV1(t.codec,s);return[o,e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=yv(e.subarray(t));return t+=n,r};let n=r(),i=iE;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a,l=c-s;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:l,size:c}}static parse(e,t){const[r,n]=tE(e,t),i=eE.decode(n);return Zv(i).set(r,e),i}}const tE=(e,t)=>{switch(e[0]){case"Q":{const r=t||Vv;return[Vv.prefix,r.decode(`${Vv.prefix}${e}`)]}case Vv.prefix:{const r=t||Vv;return[Vv.prefix,r.decode(e)]}case Fv.prefix:{const r=t||Fv;return[Fv.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},rE=(e,t,r)=>{const{prefix:n}=r;if(n!==Vv.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i},nE=(e,t,r)=>{const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i},iE=112,sE=18,oE=(e,t,r)=>{const n=mv(e),i=n+mv(t),s=new Uint8Array(i+r.byteLength);return gv(e,s,0),gv(t,s,n),s.set(r,i),s},aE=Symbol.for("@ipld/js-cid/CID"),cE=Lv({prefix:"\0",name:"identity",encode:e=>Ev(e),decode:e=>vv(e)}),lE=jv({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),uE=jv({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),hE=Bv({prefix:"9",name:"base10",alphabet:"0123456789"}),dE=jv({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),fE=jv({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),pE=Bv({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),yE=Bv({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),gE=jv({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),mE=jv({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),wE=jv({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),bE=jv({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),vE=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),EE=vE.reduce(((e,t,r)=>(e[r]=t,e)),[]),_E=vE.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);function SE(e){return e.reduce(((e,t)=>(e+=EE[t],e)),"")}function AE(e){const t=[];for(const r of e){const e=_E[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}const IE=Lv({prefix:"🚀",name:"base256emoji",encode:SE,decode:AE}),CE=({name:e,code:t,encode:r})=>new kE(e,t,r);class kE{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?_v(this.code,t):t.then((e=>_v(this.code,e)))}throw Error("Unknown type, must be binary type")}}const TE=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),RE=CE({name:"sha2-256",code:18,encode:TE("SHA-256")}),PE=CE({name:"sha2-512",code:19,encode:TE("SHA-512")}),xE=0,DE="identity",OE=bv,NE=e=>_v(xE,OE(e)),LE={code:xE,name:DE,encode:OE,digest:NE},BE="raw",UE=85,ME=e=>bv(e),jE=e=>bv(e),VE=new TextEncoder,zE=new TextDecoder,FE="json",$E=512,KE=e=>VE.encode(JSON.stringify(e)),qE=e=>JSON.parse(zE.decode(e)),HE={...he,...de,...fe,...pe,...ye,...ue,...ge,...le,...me,...we};function GE(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}const WE=Symbol.for("@libp2p/peer-id");function YE(e){return null!=e&&Boolean(e[WE])}const JE=Object.values(HE).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),HE.identity.decoder),QE=114,XE=36,ZE=37;class e_{constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[WE](){return!0}toString(){return null==this.string&&(this.string=Vv.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return eE.createV1(QE,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return GE(this.multihash.bytes,e);if("string"===typeof e)return s_(e).equals(this);if(null!=e?.multihash?.bytes)return GE(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}}class t_ extends e_{constructor(e){super({...e,type:"RSA"}),this.type="RSA",this.publicKey=e.publicKey}}class r_ extends e_{constructor(e){super({...e,type:"Ed25519"}),this.type="Ed25519",this.publicKey=e.multihash.digest}}class n_ extends e_{constructor(e){super({...e,type:"secp256k1"}),this.type="secp256k1",this.publicKey=e.multihash.digest}}function i_(e){if("RSA"===e.type)return new t_(e);if("Ed25519"===e.type)return new r_(e);if("secp256k1"===e.type)return new n_(e);throw mn(new Error("Not a PeerId"),"ERR_INVALID_PARAMETERS")}function s_(e,t){if(t=t??JE,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=Sv(Vv.decode(`z${e}`));return e.startsWith("12D")?new r_({multihash:t}):e.startsWith("16U")?new n_({multihash:t}):new t_({multihash:t})}return o_(JE.decode(e))}function o_(e){try{const t=Sv(e);if(t.code===LE.code){if(t.digest.length===XE)return new r_({multihash:t});if(t.digest.length===ZE)return new n_({multihash:t})}if(t.code===RE.code)return new t_({multihash:t})}catch{return a_(eE.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function a_(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==QE)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===RE.code)return new t_({multihash:e.multihash});if(t.code===LE.code){if(t.digest.length===XE)return new r_({multihash:e.multihash});if(t.digest.length===ZE)return new n_({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function c_(e,t){return e.length===XE?new r_({multihash:_v(LE.code,e),privateKey:t}):e.length===ZE?new n_({multihash:_v(LE.code,e),privateKey:t}):new t_({multihash:await RE.digest(e),publicKey:e,privateKey:t})}function l_({repo:e,codecs:t,bases:r,name:n}){async function i(i,s={}){if(!wg(i))throw new Error("invalid argument "+i);if(vg(i))for await(const e of n.resolve(i,s))i=e;const[,o,a,...c]=i.split("/"),l=s.cidBase?await r.getBase(s.cidBase):void 0,u=u_(a);if(0===c.length){const e=l?l.encoder.encode(u):a;return`/${o}/${e}`}const h=ji.decode(u);i=c.join("/");const d=$w(h,i,t,e,s);let f=h,p=i;for await(const e of d)ji.asCID(e.value)&&(f=e.value,p=e.remainderPath);return`/ipfs/${f.toString(l&&l.encoder)}${p?"/"+p:""}`}return xw(i)}function u_(e){try{return s_(e).toBytes()}catch{return ji.parse(e).bytes}}var h_=r(3093);function d_({addAll:e}){return(t,r={})=>{let n;const i=ji.asCID(t);return n=e(i?[{cid:i,...r}]:[{path:t.toString(),...r}],r),h_(n)}}async function*f_(e){if(null===e||void 0===e)throw mn(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");const t=ji.asCID(e);if(t)yield p_({cid:t});else{if(!(e instanceof String||"string"===typeof e)){if(null!=e.cid||null!=e.path)return yield p_(e);if(Symbol.iterator in e){const t=e[Symbol.iterator](),r=t.next();if(r.done)return t;if(ji.asCID(r.value)||r.value instanceof String||"string"===typeof r.value){yield p_({cid:r.value});for(const e of t)yield p_({cid:e});return}if(null!=r.value.cid||null!=r.value.path){yield p_(r.value);for(const e of t)yield p_(e);return}throw mn(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in e){const t=e[Symbol.asyncIterator](),r=await t.next();if(r.done)return t;if(ji.asCID(r.value)||r.value instanceof String||"string"===typeof r.value){yield p_({cid:r.value});for await(const e of t)yield p_({cid:e});return}if(null!=r.value.cid||null!=r.value.path){yield p_(r.value);for await(const e of t)yield p_(e);return}throw mn(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}throw mn(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}yield p_({path:e})}}function p_(e){const t=e.cid||`${e.path}`;if(!t)throw mn(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");const r={path:t,recursive:!1!==e.recursive};return null!=e.metadata&&(r.metadata=e.metadata),r}const y_={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};function g_({repo:e,codecs:t}){async function*r(r,n={}){const i=async function*(){for await(const{path:n,recursive:i,metadata:s}of f_(r)){const{cid:r}=await Vw(e,t,n),{reason:o}=await e.pins.isPinnedWithType(r,[y_.recursive,y_.direct]);if("recursive"===o&&!i)throw new Error(`${r} already pinned recursively`);i?await e.pins.pinRecursively(r,{metadata:s}):await e.pins.pinDirectly(r,{metadata:s}),yield r}},s=Boolean(n.lock);if(!s)return void(yield*i());const o=await e.gcLock.readLock();try{yield*i()}finally{o()}}return xw(r)}function m_(e,t,r){const n={type:e,cid:t};return r&&(n.metadata=r),n}function w_({repo:e,codecs:t}){async function*r(r={}){let n=y_.all;if(r.type&&(n=r.type,!Object.keys(y_).includes(n)))throw mn(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(r.paths){let i=!1;for await(const{path:s}of f_(r.paths)){const{cid:r}=await Vw(e,t,s),{reason:o,pinned:a,parent:c,metadata:l}=await e.pins.isPinnedWithType(r,n);if(!a)throw mn(new Error(`path '${s}' is not pinned`),"ERR_NOT_PINNED");switch(o){case y_.direct:case y_.recursive:i=!0,yield m_(o,r,l);break;default:i=!0,yield m_(`${y_.indirect} through ${c}`,r,l)}}if(!i)throw new Error("No match found")}else{if(n===y_.recursive||n===y_.all)for await(const{cid:t,metadata:r}of e.pins.recursiveKeys())yield m_(y_.recursive,t,r);if(n===y_.indirect||n===y_.all)for await(const t of e.pins.indirectKeys(r))yield m_(y_.indirect,t);if(n===y_.direct||n===y_.all)for await(const{cid:t,metadata:r}of e.pins.directKeys())yield m_(y_.direct,t,r)}}return xw(r)}function b_({rmAll:e}){async function t(t,r={}){const n=await h_(e([{path:t,...r}],r));if(!n)throw new Error("CID expected");return n}return t}function v_({repo:e,codecs:t}){async function*r(r,n={}){const i=await e.gcLock.readLock();try{for await(const{path:n,recursive:i}of f_(r)){const{cid:r}=await Vw(e,t,n),{pinned:s,reason:o}=await e.pins.isPinnedWithType(r,y_.all);if(!s)throw new Error(`${r} is not pinned`);switch(o){case y_.recursive:if(!i)throw new Error(`${r} is pinned recursively`);await e.pins.unpin(r),yield r;break;case y_.direct:await e.pins.unpin(r),yield r;break;default:throw new Error(`${r} is pinned indirectly under ${o}`)}}}finally{i()}}return xw(r)}class E_{constructor({codecs:e,repo:t}){const r=g_({codecs:e,repo:t});this.addAll=r,this.add=d_({addAll:r});const n=v_({codecs:e,repo:t});this.rmAll=n,this.rm=b_({rmAll:n}),this.ls=w_({codecs:e,repo:t}),this.remote={add:(e,t={})=>Promise.reject(new Error("Not implemented")),ls:async function*(e,t={}){return Promise.reject(new Error("Not implemented"))},rm:(e,t={})=>Promise.reject(new Error("Not implemented")),rmAll:(e,t={})=>Promise.reject(new Error("Not implemented")),service:{add:(e,t)=>Promise.reject(new Error("Not implemented")),rm:(e,t={})=>Promise.reject(new Error("Not implemented")),ls:(e={})=>Promise.reject(new Error("Not implemented"))}}}}function __(e){return e=e||new Error("Cannot open database"),mn(e,"ERR_DB_OPEN_FAILED")}function S_(e){return e=e||new Error("Delete failed"),mn(e,"ERR_DB_DELETE_FAILED")}function A_(e){return e=e||new Error("Write failed"),mn(e,"ERR_DB_WRITE_FAILED")}function I_(e){return e=e||new Error("Not Found"),mn(e,"ERR_NOT_FOUND")}function C_(e,t="utf8"){const r=Wl[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function k_(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var T_=r(4957),R_=r(1408),P_=r(593),x_=r(1173),D_=r(3155),O_=r(9693);function N_(){O_._configure(),R_._configure(P_),x_._configure(D_)}N_();const L_=["uint64","int64","sint64","fixed64","sfixed64"];function B_(e){for(const t of L_){if(null==e[t])continue;const r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}function U_(e){return B_(new R_(e))}function M_(e){for(const t of L_){if(null==e[t])continue;const r=e[t];e[t]=function(e){return r.call(this,e.toString())}}return e}function j_(){return M_(x_.create())}function V_(e,t){const r=U_(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function z_(e,t){const r=j_();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var F_,$_,K_,q_,H_;function G_(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function W_(e){function t(t){if(null==e[t.toString()])throw new Error("Invalid enum value");return e[t]}const r=function(e,r){const n=t(e);r.int32(n)},n=function(e){const r=e.int32();return t(r)};return G_("enum",F_.VARINT,r,n)}function Y_(e,t){return G_("message",F_.LENGTH_DELIMITED,e,t)}(function(e){e[e["VARINT"]=0]="VARINT",e[e["BIT64"]=1]="BIT64",e[e["LENGTH_DELIMITED"]=2]="LENGTH_DELIMITED",e[e["START_GROUP"]=3]="START_GROUP",e[e["END_GROUP"]=4]="END_GROUP",e[e["BIT32"]=5]="BIT32"})(F_||(F_={})),function(e){e["RSA"]="RSA",e["Ed25519"]="Ed25519",e["Secp256k1"]="Secp256k1"}($_||($_={})),function(e){e[e["RSA"]=0]="RSA",e[e["Ed25519"]=1]="Ed25519",e[e["Secp256k1"]=2]="Secp256k1"}(K_||(K_={})),function(e){e.codec=()=>W_(K_)}($_||($_={})),function(e){let t;e.codec=()=>(null==t&&(t=Y_(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),$_.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.Type=$_.codec().decode(e);break;case 2:r.Data=e.bytes();break;default:e.skipType(7&t);break}}return r}))),t),e.encode=t=>z_(t,e.codec()),e.decode=t=>V_(t,e.codec())}(q_||(q_={})),function(e){let t;e.codec=()=>(null==t&&(t=Y_(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),$_.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.Type=$_.codec().decode(e);break;case 2:r.Data=e.bytes();break;default:e.skipType(7&t);break}}return r}))),t),e.encode=t=>z_(t,e.codec()),e.decode=t=>V_(t,e.codec())}(H_||(H_={}));r(3068),r(7450);var J_=r(3832);function Q_(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var X_=Q_,Z_=X_,eS=Z_;new Uint8Array(0);const tS=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},rS=e=>(new TextEncoder).encode(e),nS=e=>(new TextDecoder).decode(e);class iS{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class sS{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return aS(this,e)}}class oS{constructor(e){this.decoders=e}or(e){return aS(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const aS=(e,t)=>new oS({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class cS{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new iS(e,t,r),this.decoder=new sS(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const lS=({name:e,prefix:t,encode:r,decode:n})=>new cS(e,t,r,n),uS=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=eS(r,t);return lS({prefix:e,name:t,encode:n,decode:e=>tS(i(e))})},hS=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},dS=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},fS=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>lS({prefix:t,name:e,encode(e){return dS(e,n,r)},decode(t){return hS(t,n,r,e)}}),pS=lS({prefix:"\0",name:"identity",encode:e=>nS(e),decode:e=>rS(e)}),yS=fS({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),gS=fS({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),mS=uS({prefix:"9",name:"base10",alphabet:"0123456789"}),wS=fS({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),bS=fS({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),vS=fS({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ES=fS({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_S=fS({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),SS=fS({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),AS=fS({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),IS=fS({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),CS=fS({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),kS=fS({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),TS=fS({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),RS=uS({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),PS=uS({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),xS=uS({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),DS=uS({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),OS=fS({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),NS=fS({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),LS=fS({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),BS=fS({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),US=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),MS=US.reduce(((e,t,r)=>(e[r]=t,e)),[]),jS=US.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);function VS(e){return e.reduce(((e,t)=>(e+=MS[t],e)),"")}function zS(e){const t=[];for(const r of e){const e=jS[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}const FS=lS({prefix:"🚀",name:"base256emoji",encode:VS,decode:zS});var $S=WS,KS=128,qS=127,HS=~qS,GS=Math.pow(2,31);function WS(e,t,r){t=t||[],r=r||0;var n=r;while(e>=GS)t[r++]=255&e|KS,e/=128;while(e&HS)t[r++]=255&e|KS,e>>>=7;return t[r]=0|e,WS.bytes=r-n+1,t}var YS=XS,JS=128,QS=127;function XS(e,t){var r,n=0,i=(t=t||0,0),s=t,o=e.length;do{if(s>=o)throw XS.bytes=0,new RangeError("Could not decode varint");r=e[s++],n+=i<28?(r&QS)<<i:(r&QS)*Math.pow(2,i),i+=7}while(r>=JS);return XS.bytes=s-t,n}var ZS=Math.pow(2,7),eA=Math.pow(2,14),tA=Math.pow(2,21),rA=Math.pow(2,28),nA=Math.pow(2,35),iA=Math.pow(2,42),sA=Math.pow(2,49),oA=Math.pow(2,56),aA=Math.pow(2,63),cA=function(e){return e<ZS?1:e<eA?2:e<tA?3:e<rA?4:e<nA?5:e<iA?6:e<sA?7:e<oA?8:e<aA?9:10},lA={encode:$S,decode:YS,encodingLength:cA},uA=lA,hA=uA;const dA=(e,t,r=0)=>(hA.encode(e,t,r),t),fA=e=>hA.encodingLength(e),pA=(e,t)=>{const r=t.byteLength,n=fA(e),i=n+fA(r),s=new Uint8Array(i+r);return dA(e,s,0),dA(r,s,n),s.set(t,i),new yA(e,r,t,s)};class yA{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const gA=({name:e,code:t,encode:r})=>new mA(e,t,r);class mA{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?pA(this.code,t):t.then((e=>pA(this.code,e)))}throw Error("Unknown type, must be binary type")}}const wA=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),bA=gA({name:"sha2-256",code:18,encode:wA("SHA-256")}),vA=gA({name:"sha2-512",code:19,encode:wA("SHA-512")}),EA=0,_A="identity",SA=tS,AA=e=>pA(EA,SA(e)),IA={code:EA,name:_A,encode:SA,digest:AA},CA="raw",kA=85,TA=e=>tS(e),RA=e=>tS(e),PA=new TextEncoder,xA=new TextDecoder,DA="json",OA=512,NA=e=>PA.encode(JSON.stringify(e)),LA=e=>JSON.parse(xA.decode(e));new WeakMap;class BA{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==crypto_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==crypto_node_modules_multiformats_src_cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return BA.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return BA.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return BA.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return node_modules_multiformats_src_cid_format(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof BA)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new BA(e,r,n,i||crypto_node_modules_multiformats_src_cid_encodeCID(e,r,n.bytes))}if(!0===t[crypto_node_modules_multiformats_src_cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,i=Digest.decode(r);return BA.create(e,n,i)}return null}static create(e,t,r){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==crypto_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${crypto_node_modules_multiformats_src_cid_DAG_PB_CODE}) block encoding`);return new BA(e,t,r,r.bytes);case 1:{const n=crypto_node_modules_multiformats_src_cid_encodeCID(e,t,r.bytes);return new BA(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return BA.create(0,crypto_node_modules_multiformats_src_cid_DAG_PB_CODE,e)}static createV1(e,t){return BA.create(1,e,t)}static decode(e){const[t,r]=BA.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=BA.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Digest.Digest(t.multihashCode,t.digestSize,i,n),o=0===t.version?BA.createV0(s):BA.createV1(t.codec,s);return[o,e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),i=crypto_node_modules_multiformats_src_cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a,l=c-s;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:l,size:c}}static parse(e,t){const[r,n]=crypto_node_modules_multiformats_src_cid_parseCIDtoBytes(e,t),i=BA.decode(n);return node_modules_multiformats_src_cid_baseCache(i).set(r,e),i}}Symbol.for("@ipld/js-cid/CID");const UA={...Se,...Ae,...Ie,...Ce,...ke,...Te,...Re,...Pe,...xe,...De};function MA(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function jA(e=0){return null!=globalThis.Buffer?.allocUnsafe?MA(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function VA(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const zA=VA("utf8","u",(e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)}),(e=>{const t=new TextEncoder;return t.encode(e.substring(1))})),FA=VA("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=jA(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),$A={utf8:zA,"utf-8":zA,hex:UA.base16,latin1:FA,ascii:FA,binary:FA,...UA};var KA=$A;function qA(e,t="utf8"){const r=KA[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):MA(globalThis.Buffer.from(e,"utf-8"))}function HA(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=jA(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return MA(r)}var GA={get(e=globalThis){const t=e.crypto;if(null==t||null==t.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};var WA=r(7116);r(5764);function YA(e,t="utf8"){const r=KA[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function JA(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=0===r[0]?r.slice(1):r,null!=t){if(r.length>t)throw new Error("byte array longer than desired length");r=HA([new Uint8Array(t-r.length),r])}return YA(r,"base64url")}function QA(e){const t=XA(e);return new J_.jsbn.BigInteger(YA(t,"base16"),16)}function XA(e,t){let r=qA(e,"base64urlpad");if(null!=t){if(r.length>t)throw new Error("byte array longer than desired length");r=HA([new Uint8Array(t-r.length),r])}return r}function ZA(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}const eI={"P-256":256,"P-384":384,"P-521":521},tI=Object.keys(eI);tI.join(" / ");function rI(e){const t=e?.algorithm??"AES-GCM";let r=e?.keyLength??16;const n=e?.nonceLength??12,i=e?.digest??"SHA-256",s=e?.saltLength??16,o=e?.iterations??32767,a=GA.get();async function c(e,c){const l=a.getRandomValues(new Uint8Array(s)),u=a.getRandomValues(new Uint8Array(n)),h={name:t,iv:u};"string"===typeof c&&(c=qA(c));const d={name:"PBKDF2",salt:l,iterations:o,hash:{name:i}},f=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),p=await a.subtle.deriveKey(d,f,{name:t,length:r},!0,["encrypt"]),y=await a.subtle.encrypt(h,p,e);return HA([l,h.iv,new Uint8Array(y)])}async function l(e,c){const l=e.slice(0,s),u=e.slice(s,s+n),h=e.slice(s+n),d={name:t,iv:u};"string"===typeof c&&(c=qA(c));const f={name:"PBKDF2",salt:l,iterations:o,hash:{name:i}},p=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),y=await a.subtle.deriveKey(f,p,{name:t,length:r},!0,["decrypt"]),g=await a.subtle.decrypt(d,y,h);return new Uint8Array(g)}r*=8;const u={encrypt:c,decrypt:l};return u}async function nI(e,t){const r=OS.decode(e),n=rI();return await n.decrypt(r,t)}r(3219);var iI=r(5856),sI=r.t(iI,2);
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
const oI=BigInt(0),aI=BigInt(1),cI=BigInt(2),lI=BigInt(3),uI=BigInt(8),hI=Object.freeze({a:oI,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:aI,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")});function dI(e){const{a:t,b:r}=hI,n=NI(e*e),i=NI(n*e);return NI(i+t*e+r)}const fI=hI.a===oI;class pI extends Error{constructor(e){super(e)}}class yI{constructor(e,t,r){this.x=e,this.y=t,this.z=r}static fromAffine(e){if(!(e instanceof mI))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new yI(e.x,e.y,aI)}static toAffineBatch(e){const t=MI(e.map((e=>e.z)));return e.map(((e,r)=>e.toAffine(t[r])))}static normalizeZ(e){return yI.toAffineBatch(e).map(yI.fromAffine)}equals(e){if(!(e instanceof yI))throw new TypeError("JacobianPoint expected");const{x:t,y:r,z:n}=this,{x:i,y:s,z:o}=e,a=NI(n*n),c=NI(o*o),l=NI(t*c),u=NI(i*a),h=NI(NI(r*o)*c),d=NI(NI(s*n)*a);return l===u&&h===d}negate(){return new yI(this.x,NI(-this.y),this.z)}double(){const{x:e,y:t,z:r}=this,n=NI(e*e),i=NI(t*t),s=NI(i*i),o=e+i,a=NI(cI*(NI(o*o)-n-s)),c=NI(lI*n),l=NI(c*c),u=NI(l-cI*a),h=NI(c*(a-u)-uI*s),d=NI(cI*t*r);return new yI(u,h,d)}add(e){if(!(e instanceof yI))throw new TypeError("JacobianPoint expected");const{x:t,y:r,z:n}=this,{x:i,y:s,z:o}=e;if(i===oI||s===oI)return this;if(t===oI||r===oI)return e;const a=NI(n*n),c=NI(o*o),l=NI(t*c),u=NI(i*a),h=NI(NI(r*o)*c),d=NI(NI(s*n)*a),f=NI(u-l),p=NI(d-h);if(f===oI)return p===oI?this.double():yI.ZERO;const y=NI(f*f),g=NI(f*y),m=NI(l*y),w=NI(p*p-g-cI*m),b=NI(p*(m-w)-h*g),v=NI(n*o*f);return new yI(w,b,v)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){const t=yI.ZERO;if("bigint"===typeof e&&e===oI)return t;let r=OI(e);if(r===aI)return this;if(!fI){let e=t,n=this;while(r>oI)r&aI&&(e=e.add(n)),n=n.double(),r>>=aI;return e}let{k1neg:n,k1:i,k2neg:s,k2:o}=zI(r),a=t,c=t,l=this;while(i>oI||o>oI)i&aI&&(a=a.add(l)),o&aI&&(c=c.add(l)),l=l.double(),i>>=aI,o>>=aI;return n&&(a=a.negate()),s&&(c=c.negate()),c=new yI(NI(c.x*hI.beta),c.y,c.z),a.add(c)}precomputeWindow(e){const t=fI?128/e+1:256/e+1,r=[];let n=this,i=n;for(let s=0;s<t;s++){i=n,r.push(i);for(let t=1;t<2**(e-1);t++)i=i.add(n),r.push(i);n=i.double()}return r}wNAF(e,t){!t&&this.equals(yI.BASE)&&(t=mI.BASE);const r=t&&t._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=t&&gI.get(t);n||(n=this.precomputeWindow(r),t&&1!==r&&(n=yI.normalizeZ(n),gI.set(t,n)));let i=yI.ZERO,s=yI.ZERO;const o=1+(fI?128/r:256/r),a=2**(r-1),c=BigInt(2**r-1),l=2**r,u=BigInt(r);for(let h=0;h<o;h++){const t=h*a;let r=Number(e&c);if(e>>=u,r>a&&(r-=l,e+=aI),0===r){let e=n[t];h%2&&(e=e.negate()),s=s.add(e)}else{let e=n[t+Math.abs(r)-1];r<0&&(e=e.negate()),i=i.add(e)}}return{p:i,f:s}}multiply(e,t){let r,n,i=OI(e);if(fI){const{k1neg:e,k1:s,k2neg:o,k2:a}=zI(i);let{p:c,f:l}=this.wNAF(s,t),{p:u,f:h}=this.wNAF(a,t);e&&(c=c.negate()),o&&(u=u.negate()),u=new yI(NI(u.x*hI.beta),u.y,u.z),r=c.add(u),n=l.add(h)}else{const{p:e,f:s}=this.wNAF(i,t);r=e,n=s}return yI.normalizeZ([r,n])[0]}toAffine(e=UI(this.z)){const{x:t,y:r,z:n}=this,i=e,s=NI(i*i),o=NI(s*i),a=NI(t*s),c=NI(r*o),l=NI(n*i);if(l!==aI)throw new Error("invZ was invalid");return new mI(a,c)}}yI.BASE=new yI(hI.Gx,hI.Gy,aI),yI.ZERO=new yI(oI,aI,oI);const gI=new WeakMap;class mI{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,gI.delete(this)}hasEvenY(){return this.y%cI===oI}static fromCompressedHex(e){const t=32===e.length,r=xI(t?e:e.subarray(1));if(!GI(r))throw new Error("Point is not on curve");const n=dI(r);let i=BI(n);const s=(i&aI)===aI;if(t)s&&(i=NI(-i));else{const t=1===(1&e[0]);t!==s&&(i=NI(-i))}const o=new mI(r,i);return o.assertValidity(),o}static fromUncompressedHex(e){const t=xI(e.subarray(1,33)),r=xI(e.subarray(33,65)),n=new mI(t,r);return n.assertValidity(),n}static fromHex(e){const t=DI(e),r=t.length,n=t[0];if(32===r||33===r&&(2===n||3===n))return this.fromCompressedHex(t);if(65===r&&4===n)return this.fromUncompressedHex(t);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${r}`)}static fromPrivateKey(e){return mI.BASE.multiply(YI(e))}static fromSignature(e,t,r){e=DI(e);const n=FI(e),{r:i,s:s}=QI(t);if(0!==r&&1!==r)throw new Error("Cannot recover signature: invalid recovery bit");const o=1&r?"03":"02",a=mI.fromHex(o+CI(i)),{n:c}=hI,l=UI(i,c),u=NI(-n*l,c),h=NI(s*l,c),d=mI.BASE.multiplyAndAddUnsafe(a,u,h);if(!d)throw new Error("Cannot recover signature: point at infinify");return d.assertValidity(),d}toRawBytes(e=!1){return PI(this.toHex(e))}toHex(e=!1){const t=CI(this.x);if(e){const e=this.hasEvenY()?"02":"03";return`${e}${t}`}return`04${t}${CI(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const e="Point is not on elliptic curve",{x:t,y:r}=this;if(!GI(t)||!GI(r))throw new Error(e);const n=NI(r*r),i=dI(t);if(NI(n-i)!==oI)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new mI(this.x,NI(-this.y))}double(){return yI.fromAffine(this).double().toAffine()}add(e){return yI.fromAffine(this).add(yI.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return yI.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,t,r){const n=yI.fromAffine(this),i=t===oI||t===aI||this!==mI.BASE?n.multiplyUnsafe(t):n.multiply(t),s=yI.fromAffine(e).multiplyUnsafe(r),o=i.add(s);return o.equals(yI.ZERO)?void 0:o.toAffine()}}function wI(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function bI(e){if(e.length<2||2!==e[0])throw new Error(`Invalid signature integer tag: ${AI(e)}`);const t=e[1],r=e.subarray(2,t+2);if(!t||r.length!==t)throw new Error("Invalid signature integer: wrong length");if(0===r[0]&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:xI(r),left:e.subarray(t+2)}}function vI(e){if(e.length<2||48!=e[0])throw new Error(`Invalid signature tag: ${AI(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");const{data:t,left:r}=bI(e.subarray(2)),{data:n,left:i}=bI(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${AI(i)}`);return{r:t,s:n}}mI.BASE=new mI(hI.Gx,hI.Gy),mI.ZERO=new mI(oI,oI);class EI{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromCompact(e){const t=e instanceof Uint8Array,r="Signature.fromCompact";if("string"!==typeof e&&!t)throw new TypeError(`${r}: Expected string or Uint8Array`);const n=t?AI(e):e;if(128!==n.length)throw new Error(`${r}: Expected 64-byte hex`);return new EI(RI(n.slice(0,64)),RI(n.slice(64,128)))}static fromDER(e){const t=e instanceof Uint8Array;if("string"!==typeof e&&!t)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r:r,s:n}=vI(t?e:PI(e));return new EI(r,n)}static fromHex(e){return this.fromDER(e)}assertValidity(){const{r:e,s:t}=this;if(!HI(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!HI(t))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const e=hI.n>>aI;return this.s>e}normalizeS(){return this.hasHighS()?new EI(this.r,hI.n-this.s):this}toDERRawBytes(e=!1){return PI(this.toDERHex(e))}toDERHex(e=!1){const t=wI(TI(this.s));if(e)return t;const r=wI(TI(this.r)),n=TI(r.length/2),i=TI(t.length/2),s=TI(r.length/2+t.length/2+4);return`30${s}02${n}${r}02${i}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return PI(this.toCompactHex())}toCompactHex(){return CI(this.r)+CI(this.s)}}function _I(...e){if(!e.every((e=>e instanceof Uint8Array)))throw new Error("Uint8Array list expected");if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){const t=e[n];r.set(t,i),i+=t.length}return r}const SI=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function AI(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let r=0;r<e.length;r++)t+=SI[e[r]];return t}const II=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function CI(e){if("bigint"!==typeof e)throw new Error("Expected bigint");if(!(oI<=e&&e<II))throw new Error("Expected number < 2^256");return e.toString(16).padStart(64,"0")}function kI(e){const t=PI(CI(e));if(32!==t.length)throw new Error("Error: expected 32 bytes");return t}function TI(e){const t=e.toString(16);return 1&t.length?`0${t}`:t}function RI(e){if("string"!==typeof e)throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function PI(e){if("string"!==typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){const n=2*r,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function xI(e){return RI(AI(e))}function DI(e){return e instanceof Uint8Array?Uint8Array.from(e):PI(e)}function OI(e){if("number"===typeof e&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if("bigint"===typeof e&&HI(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function NI(e,t=hI.P){const r=e%t;return r>=oI?r:t+r}function LI(e,t){const{P:r}=hI;let n=e;while(t-- >oI)n*=n,n%=r;return n}function BI(e){const{P:t}=hI,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),o=BigInt(44),a=BigInt(88),c=e*e*e%t,l=c*c*e%t,u=LI(l,lI)*l%t,h=LI(u,lI)*l%t,d=LI(h,cI)*c%t,f=LI(d,n)*d%t,p=LI(f,i)*f%t,y=LI(p,o)*p%t,g=LI(y,a)*y%t,m=LI(g,o)*p%t,w=LI(m,lI)*l%t,b=LI(w,s)*f%t,v=LI(b,r)*c%t;return LI(v,cI)}function UI(e,t=hI.P){if(e===oI||t<=oI)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=NI(e,t),n=t,i=oI,s=aI,o=aI,a=oI;while(r!==oI){const e=n/r,t=n%r,c=i-o*e,l=s-a*e;n=r,r=t,i=o,s=a,o=c,a=l}const c=n;if(c!==aI)throw new Error("invert: does not exist");return NI(i,t)}function MI(e,t=hI.P){const r=new Array(e.length),n=e.reduce(((e,n,i)=>n===oI?e:(r[i]=e,NI(e*n,t))),aI),i=UI(n,t);return e.reduceRight(((e,n,i)=>n===oI?e:(r[i]=NI(e*r[i],t),NI(e*n,t))),i),r}const jI=(e,t)=>(e+t/cI)/t,VI={a1:BigInt("0x3086d221a7d46bcde86c90e49284eb15"),b1:-aI*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a2:BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),b2:BigInt("0x3086d221a7d46bcde86c90e49284eb15"),POW_2_128:BigInt("0x100000000000000000000000000000000")};function zI(e){const{n:t}=hI,{a1:r,b1:n,a2:i,b2:s,POW_2_128:o}=VI,a=jI(s*e,t),c=jI(-n*e,t);let l=NI(e-a*r-c*i,t),u=NI(-a*n-c*s,t);const h=l>o,d=u>o;if(h&&(l=t-l),d&&(u=t-u),l>o||u>o)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:h,k1:l,k2neg:d,k2:u}}function FI(e){const{n:t}=hI,r=e.length,n=8*r-256;let i=xI(e);return n>0&&(i>>=BigInt(n)),i>=t&&(i-=t),i}let $I,KI;class qI{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return lC.hmacSha256(this.k,...e)}hmacSync(...e){return KI(this.k,...e)}checkSync(){if("function"!==typeof KI)throw new pI("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),0!==e.length&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),0!==e.length&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.checkSync(),this.incr(),this.v=this.hmacSync(this.v),this.v}}function HI(e){return oI<e&&e<hI.n}function GI(e){return oI<e&&e<hI.P}function WI(e,t,r){const n=xI(e);if(!HI(n))return;const{n:i}=hI,s=mI.BASE.multiply(n),o=NI(s.x,i);if(o===oI)return;const a=NI(UI(n,i)*NI(t+r*o,i),i);if(a===oI)return;const c=new EI(o,a),l=(s.x===c.r?0:2)|Number(s.y&aI);return{sig:c,recovery:l}}function YI(e){let t;if("bigint"===typeof e)t=e;else if("number"===typeof e&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if("string"===typeof e){if(64!==e.length)throw new Error("Expected 32 bytes of private key");t=RI(e)}else{if(!(e instanceof Uint8Array))throw new TypeError("Expected valid private key");if(32!==e.length)throw new Error("Expected 32 bytes of private key");t=xI(e)}if(!HI(t))throw new Error("Expected private key: 0 < key < n");return t}function JI(e){return e instanceof mI?(e.assertValidity(),e):mI.fromHex(e)}function QI(e){if(e instanceof EI)return e.assertValidity(),e;try{return EI.fromDER(e)}catch(t){return EI.fromCompact(e)}}function XI(e,t=!1){return mI.fromPrivateKey(e).toRawBytes(t)}function ZI(e){const t=e.length>32?e.slice(0,32):e;return xI(t)}function eC(e){const t=ZI(e),r=NI(t,hI.n);return tC(r<oI?t:r)}function tC(e){return kI(e)}function rC(e,t,r){if(null==e)throw new Error(`sign: expected valid message hash, not "${e}"`);const n=DI(e),i=YI(t),s=[tC(i),eC(n)];if(null!=r){!0===r&&(r=lC.randomBytes(32));const e=DI(r);if(32!==e.length)throw new Error("sign: Expected 32 bytes of extra data");s.push(e)}const o=_I(...s),a=ZI(n);return{seed:o,m:a,d:i}}function nC(e,t){let{sig:r,recovery:n}=e;const{canonical:i,der:s,recovered:o}=Object.assign({canonical:!0,der:!0},t);i&&r.hasHighS()&&(r=r.normalizeS(),n^=1);const a=s?r.toDERRawBytes():r.toCompactRawBytes();return o?[a,n]:a}async function iC(e,t,r={}){const{seed:n,m:i,d:s}=rC(e,t,r.extraEntropy);let o;const a=new qI;await a.reseed(n);while(!(o=WI(await a.generate(),i,s)))await a.reseed();return nC(o,r)}const sC={strict:!0};function oC(e,t,r,n=sC){let i;try{i=QI(e),t=DI(t)}catch(y){return!1}const{r:s,s:o}=i;if(n.strict&&i.hasHighS())return!1;const a=FI(t);let c;try{c=JI(r)}catch(y){return!1}const{n:l}=hI,u=UI(o,l),h=NI(a*u,l),d=NI(s*u,l),f=mI.BASE.multiplyAndAddUnsafe(c,h,d);if(!f)return!1;const p=NI(f.x,l);return p===s}mI.BASE._setWindowSize(8);const aC={node:sI,web:"object"===typeof self&&"crypto"in self?self.crypto:void 0},cC={},lC={bytesToHex:AI,hexToBytes:PI,concatBytes:_I,mod:NI,invert:UI,isValidPrivateKey(e){try{return YI(e),!0}catch(t){return!1}},_bigintTo32Bytes:kI,_normalizePrivateKey:YI,hashToPrivateKey:e=>{if(e=DI(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");const t=NI(xI(e),hI.n-aI)+aI;return kI(t)},randomBytes:(e=32)=>{if(aC.web)return aC.web.getRandomValues(new Uint8Array(e));if(aC.node){const{randomBytes:t}=aC.node;return Uint8Array.from(t(e))}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>lC.hashToPrivateKey(lC.randomBytes(40)),sha256:async(...e)=>{if(aC.web){const t=await aC.web.subtle.digest("SHA-256",_I(...e));return new Uint8Array(t)}if(aC.node){const{createHash:t}=aC.node,r=t("sha256");return e.forEach((e=>r.update(e))),Uint8Array.from(r.digest())}throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(aC.web){const r=await aC.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=_I(...t),i=await aC.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}if(aC.node){const{createHmac:r}=aC.node,n=r("sha256",e);return t.forEach((e=>n.update(e))),Uint8Array.from(n.digest())}throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let r=cC[e];if(void 0===r){const t=await lC.sha256(Uint8Array.from(e,(e=>e.charCodeAt(0))));r=_I(t,t),cC[e]=r}return lC.sha256(r,...t)},taggedHashSync:(e,...t)=>{if("function"!==typeof $I)throw new pI("sha256Sync is undefined, you need to set it");let r=cC[e];if(void 0===r){const t=$I(Uint8Array.from(e,(e=>e.charCodeAt(0))));r=_I(t,t),cC[e]=r}return $I(r,...t)},precompute(e=8,t=mI.BASE){const r=t===mI.BASE?t:new mI(t.x,t.y);return r._setWindowSize(e),r.multiply(lI),r}};function uC(e){if(isNaN(e)||e<=0)throw mn(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return lC.randomBytes(e)}Object.defineProperties(lC,{sha256Sync:{configurable:!1,get(){return $I},set(e){$I||($I=e)}},hmacSha256Sync:{configurable:!1,get(){return KI},set(e){KI||(KI=e)}}});r(8095);function hC(e){const t=J_.asn1.fromDer(YA(e,"ascii")),r=J_.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:JA(r.n),e:JA(r.e),d:JA(r.d),p:JA(r.p),q:JA(r.q),dp:JA(r.dP),dq:JA(r.dQ),qi:JA(r.qInv),alg:"RS256"}}function dC(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw mn(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");const t=J_.pki.privateKeyToAsn1({n:QA(e.n),e:QA(e.e),d:QA(e.d),p:QA(e.p),q:QA(e.q),dP:QA(e.dp),dQ:QA(e.dq),qInv:QA(e.qi)});return qA(J_.asn1.toDer(t).getBytes(),"ascii")}function fC(e){const t=J_.asn1.fromDer(YA(e,"ascii")),r=J_.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:JA(r.n),e:JA(r.e)}}function pC(e){if(null==e.n||null==e.e)throw mn(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");const t=J_.pki.publicKeyToAsn1({n:QA(e.n),e:QA(e.e)});return qA(J_.asn1.toDer(t).getBytes(),"ascii")}function yC(e,t){return t.map((t=>QA(e[t])))}function gC(e){return J_.pki.setRsaPrivateKey(...yC(e,["n","e","d","p","q","dp","dq","qi"]))}function mC(e){return J_.pki.setRsaPublicKey(...yC(e,["n","e"]))}async function wC(e){const t=await GA.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await _C(t);return{privateKey:r[0],publicKey:r[1]}}async function bC(e){const t=await GA.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),r=[t,await SC(e)],n=await _C({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function vC(e,t){const r=await GA.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await GA.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}async function EC(e,t,r){const n=await GA.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await GA.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}async function _C(e){if(null==e.privateKey||null==e.publicKey)throw mn(new Error("Private and public key are required"),"ERR_INVALID_PARAMETERS");return await Promise.all([GA.get().subtle.exportKey("jwk",e.privateKey),GA.get().subtle.exportKey("jwk",e.publicKey)])}async function SC(e){return await GA.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function AC(e,t,r,n){const i=t?mC(e):gC(e),s=YA(Uint8Array.from(r),"ascii"),o=n(s,i);return qA(o,"ascii")}function IC(e,t){return AC(e,!0,t,((e,t)=>t.encrypt(e)))}function CC(e,t){return AC(e,!1,t,((e,t)=>t.decrypt(e)))}async function kC(e,t){const r=rI(),n=await r.encrypt(e,t);return OS.encode(n)}class TC{constructor(e){this._key=e}async verify(e,t){return await EC(this._key,t,e)}marshal(){return pC(this._key)}get bytes(){return q_.encode({Type:$_.RSA,Data:this.marshal()}).subarray()}encrypt(e){return IC(this._key,e)}equals(e){return ZA(this.bytes,e.bytes)}async hash(){const{bytes:e}=await bA.digest(this.bytes);return e}}class RC{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return uC(16)}async sign(e){return await vC(this._key,e)}get public(){if(null==this._publicKey)throw mn(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new TC(this._publicKey)}decrypt(e){return CC(this._key,e)}marshal(){return dC(this._key)}get bytes(){return H_.encode({Type:$_.RSA,Data:this.marshal()}).subarray()}equals(e){return ZA(this.bytes,e.bytes)}async hash(){const{bytes:e}=await bA.digest(this.bytes);return e}async id(){const e=await this.public.hash();return YA(e,"base58btc")}async export(e,t="pkcs-8"){if("pkcs-8"===t){const t=new J_.util.ByteBuffer(this.marshal()),r=J_.asn1.fromDer(t),n=J_.pki.privateKeyFromAsn1(r),i={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return J_.pki.encryptRsaPrivateKey(n,e,i)}if("libp2p-key"===t)return await kC(this.bytes,e);throw mn(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}async function PC(e){const t=hC(e),r=await bC(t);return new RC(r.privateKey,r.publicKey)}function xC(e){const t=fC(e);return new TC(t)}async function DC(e){const t=await bC(e);return new RC(t.privateKey,t.publicKey)}async function OC(e){const t=await wC(e);return new RC(t.privateKey,t.publicKey)}var NC=r(7420),LC=r.t(NC,2);
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
const BC=BigInt(0),UC=BigInt(1),MC=BigInt(2),jC=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),VC=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:jC,n:jC,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),zC=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),FC=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),$C=(BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235")),KC=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),qC=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),HC=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class GC{constructor(e,t,r,n){this.x=e,this.y=t,this.z=r,this.t=n}static fromAffine(e){if(!(e instanceof ZC))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(ZC.ZERO)?GC.ZERO:new GC(e.x,e.y,UC,hk(e.x*e.y))}static toAffineBatch(e){const t=fk(e.map((e=>e.z)));return e.map(((e,r)=>e.toAffine(t[r])))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){WC(e);const{x:t,y:r,z:n}=this,{x:i,y:s,z:o}=e,a=hk(t*o),c=hk(i*n),l=hk(r*o),u=hk(s*n);return a===c&&l===u}negate(){return new GC(hk(-this.x),this.y,this.z,hk(-this.t))}double(){const{x:e,y:t,z:r}=this,{a:n}=VC,i=hk(e*e),s=hk(t*t),o=hk(MC*hk(r*r)),a=hk(n*i),c=e+t,l=hk(hk(c*c)-i-s),u=a+s,h=u-o,d=a-s,f=hk(l*h),p=hk(u*d),y=hk(l*d),g=hk(h*u);return new GC(f,p,g,y)}add(e){WC(e);const{x:t,y:r,z:n,t:i}=this,{x:s,y:o,z:a,t:c}=e,l=hk((r-t)*(o+s)),u=hk((r+t)*(o-s)),h=hk(u-l);if(h===BC)return this.double();const d=hk(n*MC*c),f=hk(i*MC*a),p=f+d,y=u+l,g=f-d,m=hk(p*h),w=hk(y*g),b=hk(p*g),v=hk(h*y);return new GC(m,w,v,b)}subtract(e){return this.add(e.negate())}precomputeWindow(e){const t=1+256/e,r=[];let n=this,i=n;for(let s=0;s<t;s++){i=n,r.push(i);for(let t=1;t<2**(e-1);t++)i=i.add(n),r.push(i);n=i.double()}return r}wNAF(e,t){!t&&this.equals(GC.BASE)&&(t=ZC.BASE);const r=t&&t._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=t&&XC.get(t);n||(n=this.precomputeWindow(r),t&&1!==r&&(n=GC.normalizeZ(n),XC.set(t,n)));let i=GC.ZERO,s=GC.ZERO;const o=1+256/r,a=2**(r-1),c=BigInt(2**r-1),l=2**r,u=BigInt(r);for(let h=0;h<o;h++){const t=h*a;let r=Number(e&c);if(e>>=u,r>a&&(r-=l,e+=UC),0===r){let e=n[t];h%2&&(e=e.negate()),s=s.add(e)}else{let e=n[t+Math.abs(r)-1];r<0&&(e=e.negate()),i=i.add(e)}}return GC.normalizeZ([i,s])[0]}multiply(e,t){return this.wNAF(Ek(e,VC.l),t)}multiplyUnsafe(e){let t=Ek(e,VC.l,!1);const r=GC.BASE,n=GC.ZERO;if(t===BC)return n;if(this.equals(n)||t===UC)return this;if(this.equals(r))return this.wNAF(t);let i=n,s=this;while(t>BC)t&UC&&(i=i.add(s)),s=s.double(),t>>=UC;return i}isSmallOrder(){return this.multiplyUnsafe(VC.h).equals(GC.ZERO)}isTorsionFree(){return this.multiplyUnsafe(VC.l).equals(GC.ZERO)}toAffine(e=dk(this.z)){const{x:t,y:r,z:n}=this,i=hk(t*e),s=hk(r*e),o=hk(n*e);if(o!==UC)throw new Error("invZ was invalid");return new ZC(i,s)}fromRistrettoBytes(){JC()}toRistrettoBytes(){JC()}fromRistrettoHash(){JC()}}function WC(e){if(!(e instanceof GC))throw new TypeError("ExtendedPoint expected")}function YC(e){if(!(e instanceof QC))throw new TypeError("RistrettoPoint expected")}function JC(){throw new Error("Legacy method: switch to RistrettoPoint")}GC.BASE=new GC(VC.Gx,VC.Gy,UC,hk(VC.Gx*VC.Gy)),GC.ZERO=new GC(BC,UC,UC,BC);class QC{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){const{d:t}=VC,r=hk(FC*e*e),n=hk((r+UC)*qC);let i=BigInt(-1);const s=hk((i-t*r)*hk(r+t));let{isValid:o,value:a}=gk(n,s),c=hk(a*e);ak(c)||(c=hk(-c)),o||(a=c),o||(i=r);const l=hk(i*(r-UC)*HC-s),u=a*a,h=hk((a+a)*s),d=hk(l*$C),f=hk(UC-u),p=hk(UC+u);return new GC(hk(h*p),hk(f*d),hk(d*p),hk(h*f))}static hashToCurve(e){e=vk(e,64);const t=uk(e.slice(0,32)),r=this.calcElligatorRistrettoMap(t),n=uk(e.slice(32,64)),i=this.calcElligatorRistrettoMap(n);return new QC(r.add(i))}static fromHex(e){e=vk(e,32);const{a:t,d:r}=VC,n="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",i=uk(e);if(!bk(ok(i),e)||ak(i))throw new Error(n);const s=hk(i*i),o=hk(UC+t*s),a=hk(UC-t*s),c=hk(o*o),l=hk(a*a),u=hk(t*r*c-l),{isValid:h,value:d}=mk(hk(u*l)),f=hk(d*a),p=hk(d*f*u);let y=hk((i+i)*f);ak(y)&&(y=hk(-y));const g=hk(o*p),m=hk(y*g);if(!h||ak(m)||g===BC)throw new Error(n);return new QC(new GC(y,g,UC,m))}toRawBytes(){let{x:e,y:t,z:r,t:n}=this.ep;const i=hk(hk(r+t)*hk(r-t)),s=hk(e*t),o=hk(s*s),{value:a}=mk(hk(i*o)),c=hk(a*i),l=hk(a*s),u=hk(c*l*n);let h;if(ak(n*u)){let r=hk(t*FC),n=hk(e*FC);e=r,t=n,h=hk(c*KC)}else h=l;ak(e*u)&&(t=hk(-t));let d=hk((r-t)*h);return ak(d)&&(d=hk(-d)),ok(d)}toHex(){return nk(this.toRawBytes())}toString(){return this.toHex()}equals(e){YC(e);const t=this.ep,r=e.ep,n=hk(t.x*r.y)===hk(t.y*r.x),i=hk(t.y*r.y)===hk(t.x*r.x);return n||i}add(e){return YC(e),new QC(this.ep.add(e.ep))}subtract(e){return YC(e),new QC(this.ep.subtract(e.ep))}multiply(e){return new QC(this.ep.multiply(e))}multiplyUnsafe(e){return new QC(this.ep.multiplyUnsafe(e))}}QC.BASE=new QC(GC.BASE),QC.ZERO=new QC(GC.ZERO);const XC=new WeakMap;class ZC{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,XC.delete(this)}static fromHex(e,t=!0){const{d:r,P:n}=VC;e=vk(e,32);const i=e.slice();i[31]=-129&e[31];const s=ck(i);if(t&&s>=n)throw new Error("Expected 0 < hex < P");if(!t&&s>=zC)throw new Error("Expected 0 < hex < 2**256");const o=hk(s*s),a=hk(o-UC),c=hk(r*o+UC);let{isValid:l,value:u}=gk(a,c);if(!l)throw new Error("Point.fromHex: invalid y coordinate");const h=(u&UC)===UC,d=0!==(128&e[31]);return d!==h&&(u=hk(-u)),new ZC(u,s)}static async fromPrivateKey(e){return(await Ck(e)).point}toRawBytes(){const e=ok(this.y);return e[31]|=this.x&UC?128:0,e}toHex(){return nk(this.toRawBytes())}toX25519(){const{y:e}=this,t=hk((UC+e)*dk(UC-e));return ok(t)}isTorsionFree(){return GC.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new ZC(hk(-this.x),this.y)}add(e){return GC.fromAffine(this).add(GC.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return GC.fromAffine(this).multiply(e,this).toAffine()}}ZC.BASE=new ZC(VC.Gx,VC.Gy),ZC.ZERO=new ZC(BC,UC);class ek{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromHex(e){const t=vk(e,64),r=ZC.fromHex(t.slice(0,32),!1),n=ck(t.slice(32,64));return new ek(r,n)}assertValidity(){const{r:e,s:t}=this;if(!(e instanceof ZC))throw new Error("Expected Point instance");return Ek(t,VC.l,!1),this}toRawBytes(){const e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(ok(this.s),32),e}toHex(){return nk(this.toRawBytes())}}function tk(...e){if(!e.every((e=>e instanceof Uint8Array)))throw new Error("Expected Uint8Array list");if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){const t=e[n];r.set(t,i),i+=t.length}return r}const rk=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function nk(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=rk[e[r]];return t}function ik(e){if("string"!==typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){const n=2*r,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function sk(e){const t=32,r=e.toString(16).padStart(2*t,"0");return ik(r)}function ok(e){return sk(e).reverse()}function ak(e){return(hk(e)&UC)===UC}function ck(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+nk(Uint8Array.from(e).reverse()))}const lk=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function uk(e){return hk(ck(e)&lk)}function hk(e,t=VC.P){const r=e%t;return r>=BC?r:t+r}function dk(e,t=VC.P){if(e===BC||t<=BC)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=hk(e,t),n=t,i=BC,s=UC,o=UC,a=BC;while(r!==BC){const e=n/r,t=n%r,c=i-o*e,l=s-a*e;n=r,r=t,i=o,s=a,o=c,a=l}const c=n;if(c!==UC)throw new Error("invert: does not exist");return hk(i,t)}function fk(e,t=VC.P){const r=new Array(e.length),n=e.reduce(((e,n,i)=>n===BC?e:(r[i]=e,hk(e*n,t))),UC),i=dk(n,t);return e.reduceRight(((e,n,i)=>n===BC?e:(r[i]=hk(e*r[i],t),hk(e*n,t))),i),r}function pk(e,t){const{P:r}=VC;let n=e;while(t-- >BC)n*=n,n%=r;return n}function yk(e){const{P:t}=VC,r=BigInt(5),n=BigInt(10),i=BigInt(20),s=BigInt(40),o=BigInt(80),a=e*e%t,c=a*e%t,l=pk(c,MC)*c%t,u=pk(l,UC)*e%t,h=pk(u,r)*u%t,d=pk(h,n)*h%t,f=pk(d,i)*d%t,p=pk(f,s)*f%t,y=pk(p,o)*p%t,g=pk(y,o)*p%t,m=pk(g,n)*h%t,w=pk(m,MC)*e%t;return{pow_p_5_8:w,b2:c}}function gk(e,t){const r=hk(t*t*t),n=hk(r*r*t),i=yk(e*n).pow_p_5_8;let s=hk(e*r*i);const o=hk(t*s*s),a=s,c=hk(s*FC),l=o===e,u=o===hk(-e),h=o===hk(-e*FC);return l&&(s=a),(u||h)&&(s=c),ak(s)&&(s=hk(-s)),{isValid:l||u,value:s}}function mk(e){return gk(UC,e)}function wk(e){return hk(ck(e),VC.l)}function bk(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function vk(e,t){const r=e instanceof Uint8Array?Uint8Array.from(e):ik(e);if("number"===typeof t&&r.length!==t)throw new Error(`Expected ${t} bytes`);return r}function Ek(e,t,r=!0){if(!t)throw new TypeError("Specify max value");if("number"===typeof e&&Number.isSafeInteger(e)&&(e=BigInt(e)),"bigint"===typeof e&&e<t)if(r){if(BC<e)return e}else if(BC<=e)return e;throw new TypeError("Expected valid scalar: 0 < scalar < max")}function _k(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Sk(e){if(e="bigint"===typeof e||"number"===typeof e?sk(Ek(e,zC)):vk(e),32!==e.length)throw new Error("Expected 32 bytes");return e}function Ak(e){const t=_k(e.slice(0,32)),r=e.slice(32,64),n=wk(t),i=ZC.BASE.multiply(n),s=i.toRawBytes();return{head:t,prefix:r,scalar:n,point:i,pointBytes:s}}let Ik;async function Ck(e){return Ak(await Ok.sha512(Sk(e)))}async function kk(e){return(await Ck(e)).pointBytes}async function Tk(e,t){e=vk(e);const{prefix:r,scalar:n,pointBytes:i}=await Ck(t),s=wk(await Ok.sha512(r,e)),o=ZC.BASE.multiply(s),a=wk(await Ok.sha512(o.toRawBytes(),i,e)),c=hk(s+a*n,VC.l);return new ek(o,c).toRawBytes()}function Rk(e,t,r){t=vk(t),r instanceof ZC||(r=ZC.fromHex(r,!1));const{r:n,s:i}=e instanceof ek?e.assertValidity():ek.fromHex(e),s=GC.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:s,pub:r,msg:t}}function Pk(e,t,r,n){const i=wk(n),s=GC.fromAffine(e).multiplyUnsafe(i),o=GC.fromAffine(t).add(s);return o.subtract(r).multiplyUnsafe(VC.h).equals(GC.ZERO)}async function xk(e,t,r){const{r:n,SB:i,msg:s,pub:o}=Rk(e,t,r),a=await Ok.sha512(n.toRawBytes(),o.toRawBytes(),s);return Pk(o,n,i,a)}ZC.BASE._setWindowSize(8);const Dk={node:LC,web:"object"===typeof self&&"crypto"in self?self.crypto:void 0},Ok={bytesToHex:nk,hexToBytes:ik,concatBytes:tk,getExtendedPublicKey:Ck,mod:hk,invert:dk,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:e=>{if(e=vk(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return hk(ck(e),VC.l-UC)+UC},randomBytes:(e=32)=>{if(Dk.web)return Dk.web.getRandomValues(new Uint8Array(e));if(Dk.node){const{randomBytes:t}=Dk.node;return new Uint8Array(t(e).buffer)}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Ok.randomBytes(32),sha512:async(...e)=>{const t=tk(...e);if(Dk.web){const e=await Dk.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}if(Dk.node)return Uint8Array.from(Dk.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")},precompute(e=8,t=ZC.BASE){const r=t.equals(ZC.BASE)?t:new ZC(t.x,t.y);return r._setWindowSize(e),r.multiply(MC),r},sha512Sync:void 0};Object.defineProperties(Ok,{sha512Sync:{configurable:!1,get(){return Ik},set(e){Ik||(Ik=e)}}});const Nk=32,Lk=64,Bk=32;async function Uk(){const e=Ok.randomPrivateKey(),t=await kk(e),r=zk(e,t);return{privateKey:r,publicKey:t}}async function Mk(e){if(e.length!==Bk)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,r=await kk(t),n=zk(t,r);return{privateKey:n,publicKey:r}}async function jk(e,t){const r=e.slice(0,Bk);return await Tk(t,r)}async function Vk(e,t,r){return await xk(t,r,e)}function zk(e,t){const r=new Uint8Array(Lk);for(let n=0;n<Bk;n++)r[n]=e[n],r[Bk+n]=t[n];return r}class Fk{constructor(e){this._key=Wk(e,Nk)}async verify(e,t){return await Vk(this._key,t,e)}marshal(){return this._key}get bytes(){return q_.encode({Type:$_.Ed25519,Data:this.marshal()}).subarray()}equals(e){return ZA(this.bytes,e.bytes)}async hash(){const{bytes:e}=await bA.digest(this.bytes);return e}}class $k{constructor(e,t){this._key=Wk(e,Lk),this._publicKey=Wk(t,Nk)}async sign(e){return await jk(this._key,e)}get public(){return new Fk(this._publicKey)}marshal(){return this._key}get bytes(){return H_.encode({Type:$_.Ed25519,Data:this.marshal()}).subarray()}equals(e){return ZA(this.bytes,e.bytes)}async hash(){const{bytes:e}=await bA.digest(this.bytes);return e}async id(){const e=await IA.digest(this.public.bytes);return xS.encode(e.bytes).substring(1)}async export(e,t="libp2p-key"){if("libp2p-key"===t)return await kC(this.bytes,e);throw mn(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function Kk(e){if(e.length>Lk){e=Wk(e,Lk+Nk);const t=e.slice(0,Lk),r=e.slice(Lk,e.length);return new $k(t,r)}e=Wk(e,Lk);const t=e.slice(0,Lk),r=e.slice(Nk);return new $k(t,r)}function qk(e){return e=Wk(e,Nk),new Fk(e)}async function Hk(){const{privateKey:e,publicKey:t}=await Uk();return new $k(e,t)}async function Gk(e){const{privateKey:t,publicKey:r}=await Mk(e);return new $k(t,r)}function Wk(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw mn(new Error(`Key must be a Uint8Array of length ${t}, got ${e.length}`),"ERR_INVALID_KEY_TYPE");return e}function Yk(){return lC.randomPrivateKey()}async function Jk(e,t){const{digest:r}=await bA.digest(t);try{return await iC(r,e)}catch(WV){throw mn(WV,"ERR_INVALID_INPUT")}}async function Qk(e,t,r){try{const{digest:n}=await bA.digest(r);return oC(t,n,e)}catch(WV){throw mn(WV,"ERR_INVALID_INPUT")}}function Xk(e){const t=mI.fromHex(e).toRawBytes(!0);return t}function Zk(e){try{XI(e,!0)}catch(WV){throw mn(WV,"ERR_INVALID_PRIVATE_KEY")}}function eT(e){try{mI.fromHex(e)}catch(WV){throw mn(WV,"ERR_INVALID_PUBLIC_KEY")}}function tT(e){try{return XI(e,!0)}catch(WV){throw mn(WV,"ERR_INVALID_PRIVATE_KEY")}}class rT{constructor(e){eT(e),this._key=e}async verify(e,t){return await Qk(this._key,t,e)}marshal(){return Xk(this._key)}get bytes(){return q_.encode({Type:$_.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return ZA(this.bytes,e.bytes)}async hash(){const{bytes:e}=await bA.digest(this.bytes);return e}}class nT{constructor(e,t){this._key=e,this._publicKey=t??tT(e),Zk(this._key),eT(this._publicKey)}async sign(e){return await Jk(this._key,e)}get public(){return new rT(this._publicKey)}marshal(){return this._key}get bytes(){return H_.encode({Type:$_.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return ZA(this.bytes,e.bytes)}async hash(){const{bytes:e}=await bA.digest(this.bytes);return e}async id(){const e=await this.public.hash();return YA(e,"base58btc")}async export(e,t="libp2p-key"){if("libp2p-key"===t)return await kC(this.bytes,e);throw mn(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function iT(e){return new nT(e)}function sT(e){return new rT(e)}async function oT(){const e=await Yk();return new nT(e)}const aT={rsa:Ue,ed25519:Me,secp256k1:je};function cT(e){const t=Object.keys(aT).join(" / ");return mn(new Error(`invalid or unsupported key type ${e}. Must be ${t}`),"ERR_UNSUPPORTED_KEY_TYPE")}function lT(e){if(e=e.toLowerCase(),"rsa"===e||"ed25519"===e||"secp256k1"===e)return aT[e];throw cT(e)}async function uT(e,t){return await lT(e).generateKeyPair(t??2048)}function hT(e){const t=q_.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case $_.RSA:return aT.rsa.unmarshalRsaPublicKey(r);case $_.Ed25519:return aT.ed25519.unmarshalEd25519PublicKey(r);case $_.Secp256k1:return aT.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw cT(t.Type??"RSA")}}function dT(e,t){return t=(t??"rsa").toLowerCase(),lT(t),e.bytes}async function fT(e){const t=H_.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case $_.RSA:return await aT.rsa.unmarshalRsaPrivateKey(r);case $_.Ed25519:return aT.ed25519.unmarshalEd25519PrivateKey(r);case $_.Secp256k1:return aT.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw cT(t.Type??"RSA")}}function pT(e,t){return t=(t??"rsa").toLowerCase(),lT(t),e.bytes}async function yT(e,t){try{const r=await nI(e,t);return await fT(r)}catch(i){}const r=J_.pki.decryptRsaPrivateKey(e,t);if(null===r)throw mn(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let n=J_.asn1.toDer(J_.pki.privateKeyToAsn1(r));return n=qA(n.getBytes(),"ascii"),await aT.rsa.unmarshalRsaPrivateKey(n)}const gT="ERR_IPNS_EXPIRED_RECORD",mT="ERR_UNRECOGNIZED_VALIDITY",wT="ERR_SIGNATURE_CREATION",bT="ERR_SIGNATURE_VERIFICATION",vT="ERR_UNRECOGNIZED_FORMAT",ET="ERR_UNDEFINED_PARAMETER",_T="ERR_INVALID_RECORD_DATA",ST="ERR_INVALID_EMBEDDED_KEY",AT="ERR_MISSING_PRIVATE_KEY";var IT=r(3281);const CT=IT.Reader,kT=["uint64","int64","sint64","fixed64","sfixed64"];function TT(e,t){const r=CT.create(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}kT.forEach((e=>{const t=CT.prototype[e];CT.prototype[e]=function(){return BigInt(t.call(this).toString())}}));const RT=IT.Writer,PT=["uint64","int64","sint64","fixed64","sfixed64"];function xT(e,t){const r=RT.create();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var DT,OT;function NT(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function LT(e){function t(t){if(null==e[t.toString()])throw new Error("Invalid enum value");return e[t]}const r=function(e,r){const n=t(e);r.int32(n)},n=function(e){const r=e.uint32();return t(r)};return NT("enum",DT.VARINT,r,n)}function BT(e,t){return NT("message",DT.LENGTH_DELIMITED,e,t)}PT.forEach((e=>{const t=RT.prototype[e];RT.prototype[e]=function(e){return t.call(this,e.toString())}})),function(e){e[e["VARINT"]=0]="VARINT",e[e["BIT64"]=1]="BIT64",e[e["LENGTH_DELIMITED"]=2]="LENGTH_DELIMITED",e[e["START_GROUP"]=3]="START_GROUP",e[e["END_GROUP"]=4]="END_GROUP",e[e["BIT32"]=5]="BIT32"}(DT||(DT={})),function(e){let t,r,n;(function(e){e["EOL"]="EOL"})(t=e.ValidityType||(e.ValidityType={})),function(e){e[e["EOL"]=0]="EOL"}(r||(r={})),function(e){e.codec=()=>LT(r)}(t=e.ValidityType||(e.ValidityType={})),e.codec=()=>(null==n&&(n=BT(((t,r,n={})=>{!1!==n.lengthDelimited&&r.fork(),null!=t.value&&(r.uint32(10),r.bytes(t.value)),null!=t.signature&&(r.uint32(18),r.bytes(t.signature)),null!=t.validityType&&(r.uint32(24),e.ValidityType.codec().encode(t.validityType,r)),null!=t.validity&&(r.uint32(34),r.bytes(t.validity)),null!=t.sequence&&(r.uint32(40),r.uint64(t.sequence)),null!=t.ttl&&(r.uint32(48),r.uint64(t.ttl)),null!=t.pubKey&&(r.uint32(58),r.bytes(t.pubKey)),null!=t.signatureV2&&(r.uint32(66),r.bytes(t.signatureV2)),null!=t.data&&(r.uint32(74),r.bytes(t.data)),!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={},i=null==r?t.len:t.pos+r;while(t.pos<i){const r=t.uint32();switch(r>>>3){case 1:n.value=t.bytes();break;case 2:n.signature=t.bytes();break;case 3:n.validityType=e.ValidityType.codec().decode(t);break;case 4:n.validity=t.bytes();break;case 5:n.sequence=t.uint64();break;case 6:n.ttl=t.uint64();break;case 7:n.pubKey=t.bytes();break;case 8:n.signatureV2=t.bytes();break;case 9:n.data=t.bytes();break;default:t.skipType(7&r);break}}return n}))),n),e.encode=t=>xT(t,e.codec()),e.decode=t=>TT(t,e.codec())}(OT||(OT={}));var UT=r(605);const MT=gn("ipns:utils"),jT=Jl("/ipns/");function VT(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(e).trim().match(t);if(null==r)throw new Error("Invalid format");const n=parseInt(r[1],10),i=parseInt(r[2],10)-1,s=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),l=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(n,i,s,o,a,c,l))}const zT=async(e,t)=>{if(null==t||null==e){const e=new Error("one or more of the provided parameters are not defined");throw MT.error(e),mn(e,ET)}let r;if(null!=t.pubKey){try{r=hT(t.pubKey)}catch(WV){throw MT.error(WV),WV}const n=await c_(t.pubKey);if(!n.equals(e))throw mn(new Error("Embedded public key did not match PeerID"),ST)}else null!=e.publicKey&&(r=hT(e.publicKey));if(null!=r)return r;throw mn(new Error("no public key is available"),ET)},FT=(e,t,r)=>{const n=Jl(t);return(0,UT.concat)([e,r,n])},$T=e=>{const t=Jl("ipns-signature:");return(0,UT.concat)([t,e])},KT=e=>OT.encode(e),qT=e=>{const t=OT.decode(e);return null!=t.sequence&&(t.sequence=BigInt(t.sequence)),null!=t.ttl&&(t.ttl=BigInt(t.ttl)),{value:t.value??new Uint8Array(0),signature:t.signature??new Uint8Array(0),validityType:t.validityType??OT.ValidityType.EOL,validity:t.validity??new Uint8Array(0),sequence:t.sequence??0n,pubKey:t.pubKey,ttl:t.ttl??void 0,signatureV2:t.signatureV2,data:t.data}},HT=e=>(0,UT.concat)([jT,e.toBytes()]),GT=e=>o_(e.slice(jT.length)),WT=(e,t,r,n,i)=>{let s;if(r!==OT.ValidityType.EOL)throw mn(new Error("Unknown validity type"),mT);s=0;const o={Value:e,Validity:t,ValidityType:s,Sequence:n,TTL:i};return Ka(o)},YT=e=>{const t=Xa(e);if(0!==t.ValidityType)throw mn(new Error("Unknown validity type"),mT);return t.ValidityType=OT.ValidityType.EOL,Number.isInteger(t.Sequence)&&(t.Sequence=BigInt(t.Sequence)),Number.isInteger(t.TTL)&&(t.TTL=BigInt(t.TTL)),t},JT=gn("ipns"),QT=il.code,XT="/ipns/",ZT=XT.length,eR=async(e,t,r,n)=>{const i=new T_(Date.now()+Number(n)),s=OT.ValidityType.EOL,[o,a]=n.toString().split("."),c=BigInt(o)*BigInt(1e5)+BigInt(a??"0");return await tR(e,t,r,s,i,c)},tR=async(e,t,r,n,i,s)=>{r=BigInt(r);const o=Jl(i.toString());if(null==e.privateKey)throw mn(new Error("Missing private key"),AT);const a=await fT(e.privateKey),c=await iR(a,t,n,o),l=WT(t,o,n,r,s),u=$T(l),h=await a.sign(u),d={value:t,signature:c,validityType:n,validity:o,sequence:r,ttl:s,signatureV2:h,data:l};if(null!=e.publicKey){const t=hi(e.toBytes());t.code===QT&&k_(e.publicKey,t.digest)||(d.pubKey=e.publicKey)}return JT("ipns entry for %b created",t),d},rR=e=>xi.encode(e).slice(1),nR=e=>new Ew(`/ipns/${rR(e)}`),iR=async(e,t,r,n)=>{try{const i=FT(t,r,n);return await e.sign(i)}catch(i){throw JT.error("record signature creation failed",i),mn(new Error("record signature creation failed"),wT)}},sR=gn("ipfs:ipns:publisher"),oR=I_().code,aR=36e5;class cR{constructor(e,t){this._routing=e,this._datastore=t}async publishWithEOL(e,t,r,n){const i=await this._updateOrCreateRecord(e,t,r,n);return this._putRecordToRouting(i,e,n)}publish(e,t,r){return this.publishWithEOL(e,t,aR,r)}async _putRecordToRouting(e,t,r){if(!YE(t)){const e="peerId received is not valid";throw sR.error(e),mn(new Error(e),"ERR_INVALID_PEER_ID")}if(null==t.publicKey)throw mn(new Error("Public key was missing"),"ERR_MISSING_PUBLIC_KEY");const n=HT(t);return await this._publishEntry(n,e,r),e}async _publishEntry(e,t,r){try{const n=await this._routing.put(e,t,r);return sR(`ipns record for ${C_(e,"base32")} was stored in the routing`),n}catch(WV){const r=`ipns record for ${C_(e,"base32")} could not be stored in the routing - ${WV.stack}`;throw sR.error(r),sR.error(WV),mn(new Error(r),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(e,t={}){if(!YE(e)){const e="peerId received is not valid";throw sR.error(e),mn(new Error(e),"ERR_INVALID_PEER_ID")}const r=!1!==t.checkRouting;try{const t=await this._datastore.get(nR(e.toBytes()));return this._unmarshalData(t)}catch(WV){if(WV.code!==oR){const t=`unexpected error getting the ipns record ${e.toString()} from datastore`;throw sR.error(t),mn(new Error(t),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!r)throw mn(WV,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{const t=HT(e),r=await this._routing.get(t);return this._unmarshalData(r)}catch(WV){throw sR.error(WV),WV}}}_unmarshalData(e){try{return qT(e)}catch(WV){throw mn(WV,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(e,t,r,n){if(!YE(e)){const e="peerId received is not valid";throw sR.error(e),mn(new Error(e),"ERR_INVALID_PEER_ID")}const i={checkRouting:!0};let s;try{s=await this._getPublished(e,i)}catch(WV){if(WV.code!==oR){const r=`unexpected error when determining the last published IPNS record for ${e.toString()} ${WV.stack}`;throw sR.error(r),mn(new Error(r),"ERR_DETERMINING_PUBLISHED_RECORD")}}let o,a=0n;s&&void 0!==s.sequence&&(a=k_(s.value,t)?s.sequence:s.sequence+BigInt(1));try{o=await eR(e,t,a,r)}catch(WV){const r=`ipns record for ${t} could not be created`;throw sR.error(WV),mn(new Error(r),"ERR_CREATING_IPNS_RECORD")}try{const r=KT(o);return await this._datastore.put(nR(e.toBytes()),r,n),sR(`ipns record for ${C_(t,"base32")} was stored in the datastore`),r}catch(WV){const r=`ipns record for ${t} could not be stored in the datastore`;throw sR.error(r),mn(new Error(r),"ERR_STORING_IN_DATASTORE")}}}cR.defaultRecordLifetime=aR;const lR=gn("ipfs:ipns:republisher"),uR=6e4,hR=60*uR,dR=4*hR,fR=24*hR;class pR{constructor(e,t,r,n,i={pass:""}){this._publisher=e,this._datastore=t,this._peerId=r,this._keychain=n,this._options=i,this._republishHandle=null}async start(){if(this._republishHandle)throw mn(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");const e={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:t=>{e._timeoutId=setTimeout((async()=>{e._timeoutId=null;try{e._inflightTask=e._task(),await e._inflightTask,e._task&&e.runPeriodically(t)}catch(WV){lR.error(WV)}}),t())},cancel:async()=>{null!=e._timeoutId&&clearTimeout(e._timeoutId),e._task=null,await e._inflightTask}},{pass:t}=this._options;let r=!0;e._task=async()=>{const e=new Ql.TimeoutController(3e4);try{await this._republishEntries(this._peerId,t,{signal:e.signal})}finally{e.clear()}},e.runPeriodically((()=>r?(r=!1,this._options.initialBroadcastInterval||uR):this._options.broadcastInterval||dR)),this._republishHandle=e}async stop(){const e=this._republishHandle;if(!e)throw mn(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await e.cancel()}async _republishEntries(e,t,r){try{await this._republishEntry(e,r)}catch(WV){const t="cannot republish entry for the node's private key";return void lR.error(t)}if(t)try{const e=await this._keychain.listKeys();for(const n of e){if("self"===n.name)continue;const e=await this._keychain.exportKey(n.name,t),i=await yT(e,t),s=await c_(i.public.bytes,i.bytes);await this._republishEntry(s,r)}}catch(WV){lR.error(WV)}}async _republishEntry(e,t){try{const r=await this._getPreviousValue(e);await this._publisher.publishWithEOL(e,r,fR,t)}catch(WV){if("ERR_NO_ENTRY_FOUND"===WV.code)return;throw WV}}async _getPreviousValue(e){if(!YE(e))throw mn(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{const t=await this._datastore.get(nR(e.toBytes()));if(!(t instanceof Uint8Array))throw mn(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{const e=qT(t);return e.value}catch(WV){throw lR.error(WV),mn(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(WV){if(WV&&WV.notFound)throw mn(new Error(`no previous entry for record with id: ${e.toString()}`),"ERR_NO_ENTRY_FOUND");throw WV}}}const yR=gn("ipns:validator"),gR=async(e,t)=>{const{value:r,validityType:n,validity:i}=t;let s,o,a;null!=t.signatureV2&&null!=t.data?(o=t.signatureV2,s=$T(t.data),mR(t)):(o=t.signature??new Uint8Array(0),s=FT(r,n,i));try{a=await e.verify(s,o)}catch(WV){a=!1}if(!a)throw yR.error("record signature verification failed"),mn(new Error("record signature verification failed"),bT);if(null!=i&&n===OT.ValidityType.EOL){let e;try{e=VT(C_(i))}catch(c){throw yR.error("unrecognized validity format (not an rfc3339 format)"),mn(new Error("unrecognized validity format (not an rfc3339 format)"),vT)}if(e.getTime()<Date.now())throw yR.error("record has expired"),mn(new Error("record has expired"),gT)}else if(null!=n)throw yR.error("unrecognized validity type"),mn(new Error("unrecognized validity type"),mT);yR("ipns entry for %b is valid",r)},mR=e=>{if(null==e.data)throw mn(new Error("Record data is missing"),_T);const t=YT(e.data);if(!k_(t.Value,e.value))throw mn(new Error('Field "value" did not match between protobuf and CBOR'),bT);if(!k_(t.Validity,e.validity))throw mn(new Error('Field "validity" did not match between protobuf and CBOR'),bT);if(t.ValidityType!==e.validityType)throw mn(new Error('Field "validityType" did not match between protobuf and CBOR'),bT);if(t.Sequence!==e.sequence)throw mn(new Error('Field "sequence" did not match between protobuf and CBOR'),bT);if(t.TTL!==e.ttl)throw mn(new Error('Field "ttl" did not match between protobuf and CBOR'),bT)},wR=async(e,t)=>{const r=GT(e),n=qT(t),i=await zT(r,n);await gR(i,n)},bR=gn("ipfs:ipns:resolver"),vR=I_().code,ER=32;class _R{constructor(e){this._routing=e}async resolve(e,t={}){if("string"!==typeof e)throw mn(new Error("invalid name"),"ERR_INVALID_NAME");const r=t.recursive&&"true"===t.recursive.toString(),n=e.split("/");if(3!==n.length||""!==n[0])throw mn(new Error("invalid name"),"ERR_INVALID_NAME");const i=n[2];let s=1/0;r&&(s=ER);const o=await this.resolver(i,s,t);return bR(`${e} was locally resolved correctly`),o}async resolver(e,t,r){if(0===t){const e=`could not resolve name (recursion limit of ${ER} exceeded)`;throw bR.error(e),mn(new Error(e),"ERR_RESOLVE_RECURSION_LIMIT")}const n=await this._resolveName(e,r),i=n.split("/");return"ipfs"!==i[1]&&t?this.resolver(i[2],t-1,r):n}async _resolveName(e,t){const r=s_(e),n=HT(r);let i;try{i=await this._routing.get(n,t)}catch(WV){if(bR.error("could not get record from routing",WV),WV.code===vR)throw mn(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND");throw mn(new Error(`unexpected error getting the ipns record ${r.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}return this._validateRecord(r,i)}async _validateRecord(e,t){await wR((0,UT.concat)([Jl("/ipns/"),e.toBytes()]),t);const r=qT(t);return C_(r.value)}}class SR{constructor(e){this.lru=Gw(e)}get(e){const t=this.lru.get(e);if(t)return t.expire&&t.expire<Date.now()?void this.lru.remove(e):t.value}set(e,t,r){this.lru.set(e,{value:t,expire:Date.now()+r})}has(e){const t=this.get(e);return!!t}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}}const AR=gn("ipfs:ipns"),IR=6e4;class CR{constructor(e,t,r,n,i){this.publisher=new cR(e,t),this.republisher=new pR(this.publisher,t,r,n,i),this.resolver=new _R(e),this.cache=new SR(1e3),this.routing=e}async publish(e,t,r=cR.defaultRecordLifetime,n){try{await this.publisher.publishWithEOL(e,t,r,n),AR(`IPNS value ${C_(t,"base32")} was published correctly`);const i=e.toString(),s=parseFloat(r),o=s<IR?s:IR;return this.cache.set(i,t,o),AR(`IPNS value ${C_(t,"base32")} was cached correctly`),{name:i,value:t}}catch(WV){throw AR.error(WV),WV}}async resolve(e,t={}){if("string"!==typeof e)throw mn(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!t.nocache&&!t.recursive){const t=e.split("/")[2],r=this.cache.get(t);if(r)return r}try{const r=await this.resolver.resolve(e,t);return AR(`IPNS record from ${e} was resolved correctly`),r}catch(WV){throw AR.error(WV),WV}}async initializeKeyspace(e,t,r){return this.publish(e,t,cR.defaultRecordLifetime,r)}}var kR=r(1303);const TR=(e,t)=>async function*(){const r=await kR(e);yield*r.sort(t)}();var RR=r(4593),PR=r(5565),xR=r(7939);class DR{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:r,value:n}of e)await this.put(r,n,t),yield{key:r,value:n}}async*getMany(e,t={}){for await(const r of e)yield this.get(r,t)}async*deleteMany(e,t={}){for await(const r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(t,r){e.push({key:t,value:r})},delete(e){t.push(e)},commit:async r=>{await RR(this.putMany(e,r)),e=[],await RR(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(null!=e.prefix&&(r=PR(r,(t=>t.key.toString().startsWith(e.prefix)))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>PR(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>TR(e,t)),r)),null!=e.offset){let t=0;r=PR(r,(()=>t++>=e.offset))}return null!=e.limit&&(r=xR(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(null!=e.prefix&&(r=PR(r,(t=>t.toString().startsWith(e.prefix)))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>PR(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>TR(e,t)),r)),null!=e.offset){let t=0;r=PR(r,(()=>t++>=e.offset))}return null!=e.limit&&(r=xR(r,e.limit)),r}}class OR{constructor(e){if(!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class NR{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new OR(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new OR(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}function LR(e={}){const t=e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}};return UR(t,e)}function BR(e={}){const t=e=>{let t;const r=[];while(!e.isEmpty()){if(t=e.shift(),null==t)break;if(null!=t.error)throw t.error;!1===t.done&&r.push(t.value)}return null==t?{done:!0}:{done:!0===t.done,value:r}};return UR(t,e)}function UR(e,t){t=t??{};let r,n,i,s=t.onEnd,o=new NR;const a=async()=>o.isEmpty()?i?{done:!0}:await new Promise(((t,i)=>{n=s=>{n=null,o.push(s);try{t(e(o))}catch(WV){i(WV)}return r}})):e(o),c=e=>null!=n?n(e):(o.push(e),r),l=e=>(o=new NR,null!=n?n({error:e}):(o.push({error:e}),r)),u=e=>{if(i)return r;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:e})},h=e=>i?r:(i=!0,null!=e?l(e):c({done:!0})),d=()=>(o=new NR,h(),{done:!0}),f=e=>(h(e),{done:!0});if(r={[Symbol.asyncIterator](){return this},next:a,return:d,throw:f,push:u,end:h,get readableLength(){return o.size}},null==s)return r;const p=r;return r={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(e){return p.throw(e),null!=s&&(s(e),s=void 0),{done:!0}},return(){return p.return(),null!=s&&(s(),s=void 0),{done:!0}},push:u,end(e){return p.end(e),null!=s&&(s(e),s=void 0),r},get readableLength(){return p.readableLength}},r}const MR=gn("datastore:core:tiered");class jR extends DR{constructor(e){super(),this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map((e=>e.open())))}catch(WV){throw __()}}async put(e,t,r){try{await Promise.all(this.stores.map((n=>n.put(e,t,r))))}catch(WV){throw A_()}}async get(e,t){for(const r of this.stores)try{const n=await r.get(e,t);if(n)return n}catch(WV){MR.error(WV)}throw I_()}async has(e,t){for(const r of this.stores)if(await r.has(e,t))return!0;return!1}async delete(e,t){try{await Promise.all(this.stores.map((r=>r.delete(e,t))))}catch(WV){throw S_()}}async*putMany(e,t={}){let r;const n=this.stores.map((e=>{const n=LR({objectMode:!0});return RR(e.putMany(n,t)).catch((e=>{r=e})),n}));try{for await(const t of e){if(r)throw r;n.forEach((e=>e.push(t))),yield t}}finally{n.forEach((e=>e.end()))}}async*deleteMany(e,t={}){let r;const n=this.stores.map((e=>{const n=LR({objectMode:!0});return RR(e.deleteMany(n,t)).catch((e=>{r=e})),n}));try{for await(const t of e){if(r)throw r;n.forEach((e=>e.push(t))),yield t}}finally{n.forEach((e=>e.end()))}}async close(){await Promise.all(this.stores.map((e=>e.close())))}batch(){const e=this.stores.map((e=>e.batch()));return{put:(t,r)=>{e.forEach((e=>e.put(t,r)))},delete:t=>{e.forEach((e=>e.delete(t)))},commit:async t=>{for(const r of e)await r.commit(t)}}}query(e,t){return this.stores[this.stores.length-1].query(e,t)}queryKeys(e,t){return this.stores[this.stores.length-1].queryKeys(e,t)}}var VR=r(6905);const zR=(e,t)=>{const r=t.map(((e,t)=>({entry:OT.decode(e),index:t})));return r.sort(((e,t)=>{if(null!=e.entry.signatureV2&&null==t.entry.signatureV2)return-1;if(null==e.entry.signatureV2&&null!=t.entry.signatureV2)return 1;const r=e.entry.sequence??0n,n=t.entry.sequence??0n;if(r>n)return-1;if(r<n)return 1;const i=e.entry.validity??new Uint8Array(0),s=t.entry.validity??new Uint8Array(0),o=VT(C_(i)),a=VT(C_(s));return o.getTime()>a.getTime()?-1:o.getTime()<a.getTime()?1:0})),r[0].index},FR="SHARDING",$R="_README";class KR extends DR{constructor(){super(),this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[e.toString()]=t}async get(e){const t=await this.has(e);if(!t)throw I_();return this.data[e.toString()]}async has(e){return void 0!==this.data[e.toString()]}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map((([e,t])=>({key:new Ew(e),value:t})))}async*_allKeys(){yield*Object.entries(this.data).map((([e])=>new Ew(e)))}}var qR=r(2121),HR=r(4014);const GR=(...e)=>{let t;while(e.length>0)t=e.shift()(t);return t},WR=e=>null!=e&&("function"===typeof e[Symbol.asyncIterator]||"function"===typeof e[Symbol.iterator]||"function"===typeof e.next),YR=e=>null!=e&&"function"===typeof e.sink&&WR(e.source),JR=e=>t=>{const r=e.sink(t);if(null!=r.then){const t=LR({objectMode:!0});r.then((()=>{t.end()}),(e=>{t.end(e)}));const n=async function*(){yield*e.source,t.end()};return HR(t,n())}return e.source};function QR(e,...t){if(YR(e)){const t=e;e=()=>t.source}else if(WR(e)){const t=e;e=()=>t}const r=[e,...t];if(r.length>1&&YR(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)YR(r[n])&&(r[n]=JR(r[n]));return GR(...r)}new Ew(FR),new Ew($R);const XR="/record/";function ZR(e){return C_(e,"base32")}function eP(e){("string"===typeof e||e instanceof String)&&(e=Jl(e.toString()));const t=C_(e,"base64url");return`${XR}${t}`}function tP(e){if(e.substring(0,XR.length)!==XR)throw mn(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");const t=e.substring(XR.length);return Jl(t,"base64url")}const rP=gn("datastore-pubsub:publisher");class nP extends DR{constructor(e,t,r,n,i,s){if(super(),!n)throw mn(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if("function"!==typeof n)throw mn(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if("function"!==typeof i)throw mn(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(s&&"function"!==typeof s)throw mn(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=t,this._peerId=r,this._validator=n,this._selector=i,this._handleSubscriptionKeyFn=s,this._onMessage=this._onMessage.bind(this),this._pubsub.addEventListener("message",this._onMessage)}async put(e,t,r){if(!(e instanceof Uint8Array)){const e="datastore key does not have a valid format";throw rP.error(e),mn(new Error(e),"ERR_INVALID_DATASTORE_KEY")}if(!(t instanceof Uint8Array)){const e="received value is not a Uint8Array";throw rP.error(e),mn(new Error(e),"ERR_INVALID_VALUE_RECEIVED")}const n=eP(e);rP(`publish value for topic ${n}`),await this._pubsub.publish(n,t)}async get(e,t){if(!(e instanceof Uint8Array)){const e="datastore key does not have a valid format";throw rP.error(e),mn(new Error(e),"ERR_INVALID_DATASTORE_KEY")}const r=eP(e),n=await this._pubsub.getTopics();if(n&&Array.isArray(n)&&n.indexOf(r)>-1)return this._getLocal(e,t);try{await this._pubsub.subscribe(r)}catch(WV){const t=`cannot subscribe topic ${r}`;throw rP.error(t),mn(new Error(t),"ERR_SUBSCRIBING_TOPIC")}return rP(`subscribed values for key ${r}`),this._getLocal(e)}unsubscribe(e){const t=eP(e);return this._pubsub.unsubscribe(t)}async _getLocal(e,t){const r=new Ew("/"+ZR(e),!1);let n;try{n=await this._datastore.get(r,t)}catch(WV){if("ERR_NOT_FOUND"!==WV.code){const e=`unexpected error getting the ipns record for ${r.toString()}`;throw rP.error(e),mn(new Error(e),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}const t=`local record requested was not found for ${r.toString()}`;throw rP.error(t),mn(new Error(t),"ERR_NOT_FOUND")}if(!(n instanceof Uint8Array)){const e="found record that we couldn't convert to a value";throw rP.error(e),mn(new Error(e),"ERR_INVALID_RECORD_RECEIVED")}return n}async _onMessage(e){const t=e.detail;if("signed"!==t.type)return void rP.error("unsigned message received, this module can only work with signed messages");const{data:r,from:n,topic:i}=t;let s;try{s=tP(i)}catch(WV){return void rP.error(WV)}if(rP(`message received for topic ${i}`),this._peerId.equals(n))rP("message discarded as it is from the same peer");else{if(this._handleSubscriptionKeyFn){let e;try{e=await this._handleSubscriptionKeyFn(s)}catch(WV){return void rP.error("message discarded by the subscriptionKeyFn")}s=e}try{await this._storeIfSubscriptionIsBetter(s,r)}catch(WV){rP.error(WV)}}}async _storeIfSubscriptionIsBetter(e,t,r){let n=!1;try{n=await this._isBetter(e,t)}catch(WV){if("ERR_NOT_VALID_RECORD"!==WV.code)throw WV}n&&await this._storeRecord(e,t,r)}async _validateRecord(e,t){return this._validator(e,t)}async _selectRecord(e,t){const r=await this._selector(e,t);return 0===r}async _isBetter(e,t){try{await this._validateRecord(e,t)}catch(WV){const t="record received through pubsub is not valid";throw rP.error(t),mn(new Error(t),"ERR_NOT_VALID_RECORD")}const r=new Ew(e);let n;try{n=await this._getLocal(r.uint8Array())}catch(WV){return!0}return!k_(n,t)&&this._selectRecord(e,[n,t])}async _storeRecord(e,t,r){const n=new Ew("/"+ZR(e),!1);await this._datastore.put(n,t,r),rP(`record for ${eP(e)} was stored in the datastore`)}}const iP=gn("ipfs:ipns:pubsub");class sP{constructor(e,t,r){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new nP(e,t,r,wR,zR,this._handleSubscriptionKey)}async put(e,t,r){try{await this._pubsubDs.put(e,t,r)}catch(WV){throw iP.error(WV),WV}}async get(e,t){let r,n;try{r=await this._pubsubDs.get(e,t)}catch(s){n=s}const i=e.slice(0,ZT);if(C_(i)===XT){const t=Ti.encode(e).substring(1),r=Ti.encode(e.slice(ZT)).substring(1);this._subscriptions[t]=r,iP(`subscribed to pubsub topic ${t}, id ${r}`)}if(n)throw n;return r}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=C_(e,"base58btc"));const t=this._subscriptions[e];if(!t)throw mn(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");try{const e=HT(s_(t));return e}catch(WV){throw iP.error(WV),WV}}getSubscriptions(){const e=Object.values(this._subscriptions).filter(Boolean);return e.map((e=>`${XT}${e}`))}async cancel(e){if("string"!==typeof e)throw mn(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(XT)&&(e=e.substring(ZT));const t=Object.keys(this._subscriptions).find((t=>this._subscriptions[t]===e));if(!t)return{canceled:!1};const r=Jl(t);return this._pubsubDs.unsubscribe(r),delete this._subscriptions[t],iP(`unsubscribed pubsub ${t}: ${e}`),{canceled:!0}}}function oP(){O_._configure(),R_._configure(P_),x_._configure(D_)}oP();const aP=["uint64","int64","sint64","fixed64","sfixed64"];function cP(e){for(const t of aP){if(null==e[t])continue;const r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}function lP(e){return cP(new R_(e))}function uP(e){for(const t of aP){if(null==e[t])continue;const r=e[t];e[t]=function(e){return r.call(this,e.toString())}}return e}function hP(){return uP(x_.create())}function dP(e,t){const r=lP(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function fP(e,t){const r=hP();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var pP,yP;function gP(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function mP(e,t){return gP("message",pP.LENGTH_DELIMITED,e,t)}function wP(e){const t=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0"),n=String(e.getUTCDate()).padStart(2,"0"),i=String(e.getUTCHours()).padStart(2,"0"),s=String(e.getUTCMinutes()).padStart(2,"0"),o=String(e.getUTCSeconds()).padStart(2,"0"),a=e.getUTCMilliseconds(),c=String(1e3*a*1e3).padStart(9,"0");return`${t}-${r}-${n}T${i}:${s}:${o}.${c}Z`}function bP(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(e).trim().match(t);if(null==r)throw new Error("Invalid format");const n=parseInt(r[1],10),i=parseInt(r[2],10)-1,s=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),l=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(n,i,s,o,a,c,l))}(function(e){e[e["VARINT"]=0]="VARINT",e[e["BIT64"]=1]="BIT64",e[e["LENGTH_DELIMITED"]=2]="LENGTH_DELIMITED",e[e["START_GROUP"]=3]="START_GROUP",e[e["END_GROUP"]=4]="END_GROUP",e[e["BIT32"]=5]="BIT32"})(pP||(pP={})),function(e){let t;e.codec=()=>(null==t&&(t=mP(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.key&&e.key.byteLength>0)&&(t.uint32(10),t.bytes(e.key)),(!0===r.writeDefaults||null!=e.value&&e.value.byteLength>0)&&(t.uint32(18),t.bytes(e.value)),!0!==r.writeDefaults&&""===e.timeReceived||(t.uint32(42),t.string(e.timeReceived)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={key:new Uint8Array(0),value:new Uint8Array(0),timeReceived:""},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.key=e.bytes();break;case 2:r.value=e.bytes();break;case 5:r.timeReceived=e.string();break;default:e.skipType(7&t);break}}return r}))),t),e.encode=t=>fP(t,e.codec()),e.decode=t=>dP(t,e.codec())}(yP||(yP={}));class vP{constructor(e,t,r){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=r}serialize(){return yP.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:wP(this.timeReceived)}}static deserialize(e){const t=yP.decode(e);return new vP(t.key,t.value,new Date(t.timeReceived))}static fromDeserialized(e){const t=bP(e.timeReceived);if(null==e.key)throw new Error("key missing from deserialized object");if(null==e.value)throw new Error("value missing from deserialized object");const r=new vP(e.key,e.value,t);return r}}const EP=gn("ipfs:ipns:offline-datastore");class _P{constructor(e){this._datastore=e,this.stores=[]}async put(e,t,r){if(!(e instanceof Uint8Array))throw mn(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(t instanceof Uint8Array))throw mn(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let n;try{n=this._routingKey(e)}catch(WV){throw EP.error(WV),mn(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const i=new vP(e,t,new Date);await this._datastore.put(n,i.serialize(),r)}async get(e,t){if(!(e instanceof Uint8Array))throw mn(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let r;try{r=this._routingKey(e)}catch(WV){throw EP.error(WV),mn(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const n=await this._datastore.get(r,t);let i;try{i=vP.deserialize(n)}catch(WV){throw EP.error(WV),WV}return i.value}_routingKey(e){return new Ew("/dht/record/"+C_(e,"base32"),!1)}}const SP=gn("ipfs:ipns:dht-datastore");class AP{constructor(e){this._dht=e}async put(e,t,r){try{await RR(this._dht.put(e,t,r))}catch(WV){throw SP.error(WV),WV}}async get(e,t){for await(const r of this._dht.get(e,t))if("VALUE"===r.name)return r.value;throw I_()}}function IP({libp2p:e,repo:t,peerId:r,options:n}){const i=[];let s;if(VR(n,"EXPERIMENTAL.ipnsPubsub",!1)&&(s=new sP(e.pubsub,t.datastore,r),i.push(s)),!0!==VR(n,"offline",!1)&&["dht","dhtclient","dhtserver"].includes(VR(n,"config.Routing.Type","none"))&&i.push(new AP(e.dht)),VR(n,"offline",!1)||0===i.length){const e=new _P(t.datastore);i.push(e)}return new jR(i)}const CP=gn("ipfs:components:ipns");class kP{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){const e=this.online||this.offline;if(e)return e;throw new Bl}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:t,keychain:r}){if(null!=this.offline)throw new Ml;CP("initializing IPNS keyspace (offline)");const n=new _P(e.datastore),i=new CR(n,e.datastore,t,r,this.options);this.offline=i}async startOnline({libp2p:e,repo:t,peerId:r,keychain:n}){if(null!=this.online)throw new Ml;const i=IP({libp2p:e,repo:t,peerId:r,options:this.options}),s=new CR(i,t.datastore,r,n,this.options);await s.republisher.start(),this.online=s}async stop(){const e=this.online;e&&(await e.republisher.stop(),this.online=null)}publish(e,t,r,n){return this.getIPNS().publish(e,t,r,n)}resolve(e,t){return this.getIPNS().resolve(e,t)}initializeKeyspace(e,t,r){return this.getIPNS().initializeKeyspace(e,t,r)}}async function TP({ipns:e,repo:t,codecs:r},n,i){if(vg(n))return e.resolve(n);const{cid:s,path:o}=Ow(n);await RR($w(s,o||"",r,t,i))}const RP=gn("ipfs:name:publish");function PP({ipns:e,repo:t,codecs:r,peerId:n,isOnline:i,keychain:s}){const o=async e=>{let t;if("self"===e&&null!=n.privateKey)t=await fT(n.privateKey);else try{const r=await s.exportKey(e,"temp");t=await yT(r,"temp")}catch(WV){throw RP.error(WV),mn(WV,"ERR_CANNOT_GET_KEY")}return c_(t.public.bytes,t.bytes)};async function a(n,s={}){const a=!(!1===s.resolve),c=s.lifetime||"24h",l=s.key||"self";if(!i())throw mn(new Error(Lw),"OFFLINE_ERROR");try{n=Mw(n)}catch(WV){throw RP.error(WV),WV}let u=0;try{u=Rw(c)||0,u=parseFloat(u.toFixed(6))}catch(WV){throw RP.error(WV),WV}const h=await Promise.all([o(l),a?TP({ipns:e,repo:t,codecs:r},n):Promise.resolve()]),d=Jl(n),f=await e.publish(h[0],d,u,s);return{name:f.name,value:C_(f.value)}}return xw(a)}var xP=r(2734);const DP=Wr.bind({ignoreUndefined:!0}),OP=gn("ipfs:name:resolve"),NP=(e,t)=>t.length>0?e+"/"+t.join("/"):e;function LP({dns:e,ipns:t,isOnline:r,options:{offline:n}}){async function*i(i,s={}){if(s=DP({nocache:!1,recursive:!0},s),n&&s&&s.nocache)throw mn(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");if(!r()&&!n)throw mn(new Error(Lw),"OFFLINE_ERROR");let o=i.toString();o.startsWith("/ipns/")||(o=`/ipns/${o}`);let[a,c,...l]=o.slice(1).split("/");try{if("1"===c.substring(0,1)){const e=s_(c),t=hi(e.toBytes()),r=ji.createV1(114,t);c=r.toString(hl)}else{const e=ji.parse(c);1===e.version&&(c=e.toString(hl))}}catch(WV){if(xP(c))return void(yield NP(await e(c,s),l));throw OP.error(WV),mn(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}const u=await t.resolve(`/${a}/${c}`,s);yield NP(u instanceof Uint8Array?C_(u):u,l)}return xw(i)}function BP(e,t){if(!e||!t||!t.ipnsPubsub)throw mn(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(e.routing instanceof sP)return e.routing;const r=(e.routing.stores||[]).find((e=>e instanceof sP));if(!r)throw mn(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return r}function UP({ipns:e,options:t}){const r=t.EXPERIMENTAL;async function n(t,n={}){const i=BP(e,r);return i.cancel(t,n)}return xw(n)}function MP({ipns:e,options:t}){const r=t.EXPERIMENTAL;async function n(t={}){try{return{enabled:Boolean(BP(e,r))}}catch(WV){return{enabled:!1}}}return xw(n)}function jP({ipns:e,options:t}){const r=t.EXPERIMENTAL;async function n(t={}){const n=BP(e,r);return n.getSubscriptions(t)}return xw(n)}class VP{constructor({ipns:e,options:t}){this.cancel=UP({ipns:e,options:t}),this.state=MP({ipns:e,options:t}),this.subs=jP({ipns:e,options:t})}}class zP{constructor({dns:e,ipns:t,repo:r,codecs:n,peerId:i,isOnline:s,keychain:o,options:a}){this.publish=PP({ipns:t,repo:r,codecs:n,peerId:i,isOnline:s,keychain:o}),this.resolve=LP({dns:e,ipns:t,isOnline:s,options:a}),this.pubsub=new VP({ipns:t,options:a})}}const FP=I_().code,$P={default:"<dst>",edges:"<src> -> <dst>"};function KP({repo:e,codecs:t,resolve:r,preload:n}){async function*i(i,s={}){if(0===s.maxDepth)return;if(s.edges&&s.format&&s.format!==$P.default)throw new Error("Cannot set edges to true and also specify format");if(s.format=s.edges?$P.edges:s.format,"number"!==typeof s.maxDepth&&(s.maxDepth=s.recursive?1/0:1),s.timeout){const e=new Ql.TimeoutController(s.timeout),t=[e.signal];s.signal&&t.push(s.signal),s.signal=(0,Iw.anySignal)(t)}const o=Array.isArray(i)?i:[i],a=o.map((e=>qP(n,e,s)));for(const n of a)try{yield*HP(r,e,t,n,s)}catch(WV){yield{ref:"",err:WV.message}}}return i}function qP(e,t,r){const{cid:n,path:i}=Ow(t);return!1!==r.preload&&e(n),`/ipfs/${n}${i||""}`}async function*HP(e,t,r,n,i){const s=await e(n,i),{cid:o}=Ow(s),a=null!=i.maxDepth?i.maxDepth:1/0,c=i.unique||!1;for await(const l of WP(t,r,o,a,c,i))l.parent&&(l.isDuplicate||(yield{ref:GP(l.parent.cid,l.node.cid,l.node.name,i.format)}))}function GP(e,t,r="",n=$P.default){let i=n.replace(/<src>/g,e.toString());return i=i.replace(/<dst>/g,t.toString()),i=i.replace(/<linkname>/g,r),i}async function*WP(e,t,r,n,i,s){const o=new Set;async function*a(r,c){const l=c+1;if(!(l>n))try{for await(const n of YP(e,t,r.cid,s))yield{parent:r,node:n,isDuplicate:i&&o.has(n.cid.toString())},i&&o.add(n.cid.toString()),yield*a(n,l)}catch(WV){throw WV.code===FP&&(WV.message=`Could not find object with CID: ${r.cid}`),WV}}yield*a({cid:r},0)}async function*YP(e,t,r,n){const i=await e.blocks.get(r,n),s=await t.getCodec(r.code),o=s.decode(i),a=r.code===Cs,c=[];for(const[l,u]of JP(o,c)){if(a){const e=l.match(/^Links\/(\d+)\/Hash$/);if(e){const t=Number(e[1]);if(t<o.Links.length){yield{name:o.Links[t].Name,cid:u};continue}}}yield{name:l,cid:u}}}const JP=function*(e,t){if(null!=e&&!(e instanceof Uint8Array)){for(const[r,n]of Object.entries(e)){const e=[...t,r];if(null!=n&&"object"===typeof n)if(Array.isArray(n))for(const[t,r]of n.entries()){const n=[...e,t],i=ji.asCID(r);i?yield[n.join("/"),i]:"object"===typeof r&&(yield*JP(r,n))}else{const t=ji.asCID(n);t?yield[e.join("/"),t]:yield*JP(n,e)}}return[]}};function QP({repo:e}){async function*t(t={}){for await(const r of e.blocks.queryKeys({},{signal:t.signal}))yield{ref:r.toString()}}return xw(t)}function XP({network:e}){async function t(t={}){const{bitswap:r}=await e.use(t),n=r.getWantlist();return Array.from(n).map((e=>e[1].cid))}return xw(t)}function ZP({network:e}){async function t(t,r={}){const{bitswap:n}=await e.use(r),i=n.wantlistForPeer(t);return Array.from(i).map((e=>e[1].cid))}return xw(t)}function ex({network:e}){async function t(t,r={}){const{bitswap:n}=await e.use(r);return Array.isArray(t)||(t=[t]),n.unwant(t)}return xw(t)}function tx({network:e}){async function t(t={}){const r=(await e.use(t)).bitswap,n=r.stat().snapshot;return{provideBufLen:parseInt(n.providesBufferLength.toString()),blocksReceived:BigInt(n.blocksReceived.toString()),wantlist:Array.from(r.getWantlist()).map((e=>e[1].cid)),peers:r.peers(),dupBlksReceived:BigInt(n.dupBlksReceived.toString()),dupDataReceived:BigInt(n.dupDataReceived.toString()),dataReceived:BigInt(n.dataReceived.toString()),blocksSent:BigInt(n.blocksSent.toString()),dataSent:BigInt(n.dataSent.toString())}}return xw(t)}class rx{constructor({network:e}){this.wantlist=XP({network:e}),this.wantlistForPeer=ZP({network:e}),this.unwant=ex({network:e}),this.stat=tx({network:e})}}function nx(e){try{return Xp.matches(e)}catch(WV){return!1}}function ix({repo:e}){async function t(t,r={}){if(!nx(t))throw new Error(`${t} is not a valid Multiaddr`);const n=await e.config.getAll(r),i=n.Bootstrap||[];return i.push(t.toString()),n.Bootstrap=Array.from(new Set(i)).sort(((e,t)=>e.localeCompare(t))),await e.config.replace(n),{Peers:[t]}}return xw(t)}function sx({repo:e}){async function t(t={}){const r=await e.config.getAll(t),n=r.Bootstrap||[];return r.Bootstrap=[],await e.config.replace(r),{Peers:n.map((e=>Pp(e)))}}return xw(t)}function ox({repo:e}){async function t(t={}){const r=await e.config.get("Bootstrap",t);return{Peers:(r||[]).map((e=>Pp(e)))}}return xw(t)}var ax=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}});function cx({repo:e}){async function t(t={}){const r=await e.config.getAll(t);return r.Bootstrap=ax().Bootstrap,await e.config.replace(r),{Peers:ax().Bootstrap.map((e=>Pp(e)))}}return xw(t)}function lx({repo:e}){async function t(t,r={}){if(!nx(t))throw new Error(`${t} is not a valid Multiaddr`);const n=await e.config.getAll(r);return n.Bootstrap=(n.Bootstrap||[]).filter((e=>e.toString()!==t.toString())),await e.config.replace(n),{Peers:[t]}}return xw(t)}class ux{constructor({repo:e}){this.add=ix({repo:e}),this.list=ox({repo:e}),this.rm=lx({repo:e}),this.clear=sx({repo:e}),this.reset=cx({repo:e})}}function hx({preload:e,repo:t}){async function r(r,n={}){return!1!==n.preload&&e(r),t.blocks.get(r,n)}return xw(r)}function dx({codecs:e,hashers:t,repo:r,preload:n}){async function i(i,s={}){const o=s.pin?await r.gcLock.readLock():null;try{const a=null!=s.version?s.version:0,c=s.format||(0===a?"dag-pb":"raw"),l=await t.getHasher(s.mhtype||"sha2-256"),u=await l.digest(i),h=await e.getCodec(c),d=ji.create(a,h.code,u);return await r.blocks.put(d,i,{signal:s.signal}),!1!==s.preload&&n(d),!0===s.pin&&await r.pins.pinRecursively(d,{signal:s.signal}),d}finally{o&&o()}}return xw(i)}var fx=r(8869);function px(e){return e instanceof Uint8Array?ji.decode(e):ji.parse(e.toString())}const yx=8;function gx({repo:e}){async function*t(t,r={}){Array.isArray(t)||(t=[t]);const n=await e.gcLock.writeLock();try{yield*QR(t,(t=>qR(t,(t=>async()=>{t=px(t);const n={cid:t};try{const r=await e.blocks.has(t);if(!r)throw mn(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await e.blocks.delete(t)}catch(WV){r.force||(WV.message=`cannot remove ${t}: ${WV.message}`,n.error=WV)}return n}))),(e=>fx(e,{concurrency:yx})),(e=>PR(e,(()=>!r.quiet))))}finally{n()}}return xw(t)}function mx({repo:e,preload:t}){async function r(r,n={}){r=px(r),!1!==n.preload&&t(r);const i=await e.blocks.get(r);return{cid:r,size:i.length}}return xw(r)}class wx{constructor({codecs:e,hashers:t,preload:r,repo:n}){this.get=hx({preload:r,repo:n}),this.put=dx({codecs:e,hashers:t,preload:r,repo:n}),this.rm=gx({repo:n}),this.stat=mx({preload:r,repo:n})}}var bx=r(6154),vx=r(3294),Ex=r(8132);function _x(e){return ArrayBuffer.isView(e)||e instanceof ArrayBuffer}function Sx(e){return e.constructor&&("Blob"===e.constructor.name||"File"===e.constructor.name)&&"function"===typeof e.stream}function Ax(e){return"object"===typeof e&&(e.path||e.content)}const Ix=e=>e&&"function"===typeof e.getReader;async function*Cx(e){yield e}async function kx(e){if(_x(e))return Cx(Tx(e));if("string"===typeof e||e instanceof String)return Cx(Tx(e.toString()));if(Sx(e))return vx(e);if(Ix(e)&&(e=bx(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=Ex(e),{value:r,done:n}=await t.peek();if(n)return Cx(new Uint8Array(0));if(t.push(r),Number.isInteger(r))return Cx(Uint8Array.from(await kR(t)));if(_x(r)||"string"===typeof r||r instanceof String)return qR(t,Tx)}throw mn(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}function Tx(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Array.isArray(e)?Uint8Array.from(e):Jl(e.toString())}async function*Rx(e,t){if(null===e||void 0===e)throw mn(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if("string"===typeof e||e instanceof String)yield Px(e.toString(),t);else if(_x(e)||Sx(e))yield Px(e,t);else{if(Ix(e)&&(e=bx(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const r=Ex(e),{value:n,done:i}=await r.peek();if(i)return void(yield{content:[]});if(r.push(n),Number.isInteger(n)||_x(n)||"string"===typeof n||n instanceof String)return void(yield Px(r,t));throw mn(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(!Ax(e))throw mn(new Error('Unexpected input: cannot convert "'+typeof e+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT");yield Px(e,t)}}async function Px(e,t){const{path:r,mode:n,mtime:i,content:s}=e,o={path:r||"",mode:Rn(n),mtime:Pn(i)};return s?o.content=await t(s):r||(o.content=await t(e)),o}function xx(e){return Rx(e,kx)}function Dx({addAll:e}){async function t(t,r={}){const n=await h_(e(xx(t),r));if(null==n)throw Error("Failed to add a file, if you see this please report a bug");return n}return t}var Ox=r(4810),Nx=r(469);function Lx(e){const t=new Array(4);for(let r=0;r<4;r++)t[r]=255&e,e>>=8;return new Uint8Array(t)}uc({name:"murmur3-32",code:35,encode:e=>Lx(Nx.x86.hash32(e))});const Bx=uc({name:"murmur3-128",code:34,encode:e=>si(Nx.x64.hash128(e))});async function Ux(e){return(await Bx.encode(e)).slice(0,8).reverse()}const Mx={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:vl,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:0x3df305dfb2a804,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:Ux,hamtHashCode:34,hamtBucketBits:8};var jx=(e={})=>{const t=Wr.bind({ignoreUndefined:!0});return t(Mx,e)};const Vx=async(e,t,r)=>{r.codec||(r.codec=s),r.hasher||(r.hasher=vl),void 0===r.cidVersion&&(r.cidVersion=1),r.codec===s&&r.hasher!==vl&&(r.cidVersion=1);const n=await r.hasher.digest(e),i=ji.create(r.cidVersion,r.codec.code,n);return r.onlyHash||await t.put(i,e,{signal:r.signal}),i};var zx=Vx;const Fx=async(e,t,r)=>{const n=new xn({type:"directory",mtime:e.mtime,mode:e.mode}),i=ks(Es({Data:n.marshal()})),s=await zx(i,t,r),o=e.path;return{cid:s,path:o,unixfs:n,size:i.length}};var $x=Fx;async function Kx(e,t){return t(await kR(e))}var qx=Kx,Hx=r(8165);function Gx(e,t,r){return Wx(e,t,r)}async function Wx(e,t,r){const n=[];for await(const i of Hx(e,r.maxChildrenPerNode))n.push(await t(i));return n.length>1?Wx(n,t,r):n[0]}var Yx=Gx;async function Jx(e,t,r){const n=new Zx(r.layerRepeat);let i=0,s=1,o=n;for await(const a of Hx(e,r.maxChildrenPerNode))o.isFull()&&(o!==n&&n.addChild(await o.reduce(t)),i&&i%r.layerRepeat===0&&s++,o=new Xx(s,r.layerRepeat,i),i++),o.append(a);return o&&o!==n&&n.addChild(await o.reduce(t)),n.reduce(t)}var Qx=Jx;class Xx{constructor(e,t,r=0){this.maxDepth=e,this.layerRepeat=t,this.currentDepth=1,this.iteration=r,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;const e=this._findParent(this.node,this.currentDepth);return!e||(this._addNextNodeToParent(e),!1)}_addNextNodeToParent(e){this.parent=e;const t={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(t),this.currentDepth=t.depth,this.node=t}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,t){let r=[];return e.children.length&&(r=await Promise.all(e.children.filter((e=>e.data)).map((e=>this._reduce(e,t))))),t((e.data||[]).concat(r))}_findParent(e,t){const r=e.parent;if(r&&0!==r.depth)return r.children.length!==r.maxChildren&&r.maxChildren?r:this._findParent(r,t)}}class Zx extends Xx{constructor(e){super(0,e),this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}}async function*eD(e,t,r){for await(let n of e.content)yield async()=>{let i;r.progress(n.length,e.path);const o={codec:s,cidVersion:r.cidVersion,hasher:r.hasher,onlyHash:r.onlyHash};return r.rawLeaves?(o.codec=b,o.cidVersion=1):(i=new xn({type:r.leafType,data:n}),n=ks({Data:i.marshal(),Links:[]})),{cid:await zx(n,t,o),unixfs:i,size:n.length}}}var tD=eD;const rD={flat:qx,balanced:Yx,trickle:Qx};async function*nD(e,t,r){let n,i,s=-1;i="function"===typeof r.bufferImporter?r.bufferImporter:tD;for await(const o of Ox(i(e,t,r),r.blockWriteConcurrency))s++,0!==s?(1===s&&n&&(yield n,n=null),yield o):n=o;n&&(n.single=!0,yield n)}const iD=(e,t,r)=>{async function n(n){if(1===n.length&&n[0].single&&r.reduceSingleLeafToSelf){const i=n[0];if(void 0!==e.mtime||void 0!==e.mode){let n=await t.get(i.cid);i.unixfs=new xn({type:"file",mtime:e.mtime,mode:e.mode,data:n}),n=ks(Es({Data:i.unixfs.marshal()})),i.cid=await zx(n,t,{...r,codec:s,hasher:r.hasher,cidVersion:r.cidVersion}),i.size=n.length}return{cid:i.cid,path:e.path,unixfs:i.unixfs,size:i.size}}const i=new xn({type:"file",mtime:e.mtime,mode:e.mode}),o=n.filter((e=>!(e.cid.code!==Sl||!e.size)||(!(!e.unixfs||e.unixfs.data||!e.unixfs.fileSize())||Boolean(e.unixfs&&e.unixfs.data&&e.unixfs.data.length)))).map((e=>e.cid.code===Sl?(i.addBlockSize(e.size),{Name:"",Tsize:e.size,Hash:e.cid}):(e.unixfs&&e.unixfs.data?i.addBlockSize(e.unixfs.data.length):i.addBlockSize(e.unixfs&&e.unixfs.fileSize()||0),{Name:"",Tsize:e.size,Hash:e.cid}))),a={Data:i.marshal(),Links:o},c=ks(Es(a)),l=await zx(c,t,r);return{cid:l,path:e.path,unixfs:i,size:c.length+a.Links.reduce(((e,t)=>e+t.Tsize),0)}}return n};function sD(e,t,r){const n=rD[r.strategy];if(!n)throw mn(new Error(`Unknown importer build strategy name: ${r.strategy}`),"ERR_BAD_STRATEGY");return n(nD(e,t,r),iD(e,t,r),r)}var oD=sD,aD=r(9668),cD=r(3060);async function*lD(e,t){let r,n,i;if(t.minChunkSize&&t.maxChunkSize&&t.avgChunkSize)i=t.avgChunkSize,r=t.minChunkSize,n=t.maxChunkSize;else{if(!t.avgChunkSize)throw mn(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");i=t.avgChunkSize,r=i/3,n=i+i/2}if(r<16)throw mn(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");n<r&&(n=r),i<r&&(i=r);const s=Math.floor(Math.log2(i));for await(const o of hD(e,{min:r,max:n,bits:s,window:t.window,polynomial:t.polynomial}))yield o}var uD=lD;async function*hD(e,t){const r=await(0,cD.create)(t.bits,t.min,t.max,t.window),n=new aD;for await(const i of e){n.append(i);const e=r.fingerprint(i);for(let t=0;t<e.length;t++){const r=e[t],i=n.slice(0,r);n.consume(r),yield i}}n.length&&(yield n.slice(0))}async function*dD(e,t){let r=new aD,n=0,i=!1;const s=t.maxChunkSize;for await(const o of e){r.append(o),n+=o.length;while(n>=s)if(yield r.slice(0,s),i=!0,s===r.length)r=new aD,n=0;else{const e=new aD;e.append(r.shallowSlice(s)),r=e,n-=s}}i&&!n||(yield r.slice(0,n))}var fD=dD;async function*pD(e){for await(const t of e){if(void 0===t.length)throw mn(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if("string"===typeof t||t instanceof String)yield Jl(t.toString());else if(Array.isArray(t))yield Uint8Array.from(t);else{if(!(t instanceof Uint8Array))throw mn(new Error("Content was invalid"),"ERR_INVALID_CONTENT");yield t}}}var yD=pD;function gD(e){return Symbol.iterator in e}function mD(e){return Symbol.asyncIterator in e}function wD(e){try{if(e instanceof Uint8Array)return async function*(){yield e}();if(gD(e))return async function*(){yield*e}();if(mD(e))return e}catch{throw mn(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw mn(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*bD(e,t,r){for await(const n of e)if(n.path&&("./"===n.path.substring(0,2)&&(r.wrapWithDirectory=!0),n.path=n.path.split("/").filter((e=>e&&"."!==e)).join("/")),n.content){let e,i;e="function"===typeof r.chunker?r.chunker:"rabin"===r.chunker?uD:fD,i="function"===typeof r.chunkValidator?r.chunkValidator:yD;const s={path:n.path,mtime:n.mtime,mode:n.mode,content:e(i(wD(n.content),r),r)};yield()=>oD(s,t,r)}else{if(!n.path)throw new Error("Import candidate must have content or path or both");{const e={path:n.path,mtime:n.mtime,mode:n.mode};yield()=>$x(e,t,r)}}}var vD=bD;class ED{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}}var _D=ED;class SD extends _D{constructor(e,t){super(e,t),this._children={}}async put(e,t){this.cid=void 0,this.size=void 0,this._children[e]=t}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){const e=Object.keys(this._children);for(let t=0;t<e.length;t++){const r=e[t];yield{key:r,child:this._children[r]}}}async*flush(e){const t=Object.keys(this._children),r=[];for(let c=0;c<t.length;c++){let n=this._children[t[c]];if(n instanceof _D)for await(const t of n.flush(e))n=t,yield n;null!=n.size&&n.cid&&r.push({Name:t[c],Tsize:n.size,Hash:n.cid})}const n=new xn({type:"directory",mtime:this.mtime,mode:this.mode}),i={Data:n.marshal(),Links:r},s=ks(Es(i)),o=await zx(s,e,this.options),a=s.length+i.Links.reduce(((e,t)=>e+(null==t.Tsize?0:t.Tsize)),0);this.cid=o,this.size=a,yield{cid:o,unixfs:n,path:this.path,size:a}}}var AD=SD,ID=r(544);function CD(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var kD=CD,TD=kD,RD=TD;new Uint8Array(0);const PD=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},xD=e=>(new TextEncoder).encode(e),DD=e=>(new TextDecoder).decode(e);class OD{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ND{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return BD(this,e)}}class LD{constructor(e){this.decoders=e}or(e){return BD(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const BD=(e,t)=>new LD({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class UD{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new OD(e,t,r),this.decoder=new ND(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const MD=({name:e,prefix:t,encode:r,decode:n})=>new UD(e,t,r,n),jD=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=RD(r,t);return MD({prefix:e,name:t,encode:n,decode:e=>PD(i(e))})},VD=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},zD=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},FD=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>MD({prefix:t,name:e,encode(e){return zD(e,n,r)},decode(t){return VD(t,n,r,e)}}),$D=MD({prefix:"\0",name:"identity",encode:e=>DD(e),decode:e=>xD(e)}),KD=FD({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),qD=FD({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),HD=jD({prefix:"9",name:"base10",alphabet:"0123456789"}),GD=FD({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),WD=FD({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),YD=FD({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),JD=FD({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),QD=FD({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),XD=FD({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ZD=FD({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),eO=FD({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),tO=FD({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),rO=FD({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),nO=FD({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),iO=jD({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),sO=jD({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),oO=jD({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),aO=jD({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),cO=FD({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),lO=FD({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),uO=FD({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),hO=FD({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),dO=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),fO=dO.reduce(((e,t,r)=>(e[r]=t,e)),[]),pO=dO.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);function yO(e){return e.reduce(((e,t)=>(e+=fO[t],e)),"")}function gO(e){const t=[];for(const r of e){const e=pO[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}const mO=MD({prefix:"🚀",name:"base256emoji",encode:yO,decode:gO});var wO=SO,bO=128,vO=127,EO=~vO,_O=Math.pow(2,31);function SO(e,t,r){t=t||[],r=r||0;var n=r;while(e>=_O)t[r++]=255&e|bO,e/=128;while(e&EO)t[r++]=255&e|bO,e>>>=7;return t[r]=0|e,SO.bytes=r-n+1,t}var AO=kO,IO=128,CO=127;function kO(e,t){var r,n=0,i=(t=t||0,0),s=t,o=e.length;do{if(s>=o)throw kO.bytes=0,new RangeError("Could not decode varint");r=e[s++],n+=i<28?(r&CO)<<i:(r&CO)*Math.pow(2,i),i+=7}while(r>=IO);return kO.bytes=s-t,n}var TO=Math.pow(2,7),RO=Math.pow(2,14),PO=Math.pow(2,21),xO=Math.pow(2,28),DO=Math.pow(2,35),OO=Math.pow(2,42),NO=Math.pow(2,49),LO=Math.pow(2,56),BO=Math.pow(2,63),UO=function(e){return e<TO?1:e<RO?2:e<PO?3:e<xO?4:e<DO?5:e<OO?6:e<NO?7:e<LO?8:e<BO?9:10},MO={encode:wO,decode:AO,encodingLength:UO},jO=MO,VO=jO;const zO=(e,t,r=0)=>(VO.encode(e,t,r),t),FO=e=>VO.encodingLength(e),$O=(e,t)=>{const r=t.byteLength,n=FO(e),i=n+FO(r),s=new Uint8Array(i+r);return zO(e,s,0),zO(r,s,n),s.set(t,i),new KO(e,r,t,s)};class KO{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const qO=({name:e,code:t,encode:r})=>new HO(e,t,r);class HO{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?$O(this.code,t):t.then((e=>$O(this.code,e)))}throw Error("Unknown type, must be binary type")}}const GO=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),WO=qO({name:"sha2-256",code:18,encode:GO("SHA-256")}),YO=qO({name:"sha2-512",code:19,encode:GO("SHA-512")}),JO=0,QO="identity",XO=PD,ZO=e=>$O(JO,XO(e)),eN={code:JO,name:QO,encode:XO,digest:ZO},tN="raw",rN=85,nN=e=>PD(e),iN=e=>PD(e),sN=new TextEncoder,oN=new TextDecoder,aN="json",cN=512,lN=e=>sN.encode(JSON.stringify(e)),uN=e=>JSON.parse(oN.decode(e));new WeakMap;class hN{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==hamt_sharding_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==hamt_sharding_node_modules_multiformats_src_cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return hN.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return hN.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return hN.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return hamt_sharding_node_modules_multiformats_src_cid_format(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof hN)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new hN(e,r,n,i||hamt_sharding_node_modules_multiformats_src_cid_encodeCID(e,r,n.bytes))}if(!0===t[hamt_sharding_node_modules_multiformats_src_cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,i=Digest.decode(r);return hN.create(e,n,i)}return null}static create(e,t,r){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==hamt_sharding_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${hamt_sharding_node_modules_multiformats_src_cid_DAG_PB_CODE}) block encoding`);return new hN(e,t,r,r.bytes);case 1:{const n=hamt_sharding_node_modules_multiformats_src_cid_encodeCID(e,t,r.bytes);return new hN(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return hN.create(0,hamt_sharding_node_modules_multiformats_src_cid_DAG_PB_CODE,e)}static createV1(e,t){return hN.create(1,e,t)}static decode(e){const[t,r]=hN.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=hN.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Digest.Digest(t.multihashCode,t.digestSize,i,n),o=0===t.version?hN.createV0(s):hN.createV1(t.codec,s);return[o,e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),i=hamt_sharding_node_modules_multiformats_src_cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a,l=c-s;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:l,size:c}}static parse(e,t){const[r,n]=hamt_sharding_node_modules_multiformats_src_cid_parseCIDtoBytes(e,t),i=hN.decode(n);return hamt_sharding_node_modules_multiformats_src_cid_baseCache(i).set(r,e),i}}Symbol.for("@ipld/js-cid/CID");const dN={...Ve,...ze,...Fe,...$e,...Ke,...qe,...He,...Ge,...We,...Ye};function fN(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function pN(e=0){return null!=globalThis.Buffer?.allocUnsafe?fN(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function yN(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const gN=yN("utf8","u",(e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)}),(e=>{const t=new TextEncoder;return t.encode(e.substring(1))})),mN=yN("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=pN(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),wN={utf8:gN,"utf-8":gN,hex:dN.base16,latin1:mN,ascii:mN,binary:mN,...dN};var bN=wN;function vN(e,t="utf8"){const r=bN[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):fN(globalThis.Buffer.from(e,"utf-8"))}class EN{constructor(e,t,r=0){this._options=e,this._popCount=0,this._parent=t,this._posAtParent=r,this._children=new ID,this.key=null}async put(e,t){const r=await this._findNewBucketAndPos(e);await r.bucket._putAt(r,e,t)}async get(e){const t=await this._findChild(e);if(null!=t)return t.value}async del(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);null!=r&&r.key===e&&t.bucket._delAt(t.pos)}leafCount(){const e=this._children.compactArray();return e.reduce(((e,t)=>t instanceof EN?e+t.leafCount():e+1),0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const e=this._children.compactArray();for(const t of e)t instanceof EN?yield*t.eachLeafSeries():yield t}serialize(e,t){const r=[];return t(this._children.reduce(((r,n,i)=>(null!=n&&(n instanceof EN?r.push(n.serialize(e,t)):r.push(e(n,i))),r)),r))}async asyncTransform(e,t){return await IN(this,e,t)}toJSON(){return this.serialize(SN,AN)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);if(!(r instanceof EN))return null!=r&&r.key===e?r:void 0}async _findPlace(e){const t=this._options.hash("string"===typeof e?vN(e):e),r=await t.take(this._options.bits),n=this._children.get(r);return n instanceof EN?await n._findPlace(t):{bucket:this,pos:r,hash:t,existingChild:n}}async _findNewBucketAndPos(e){const t=await this._findPlace(e);if(null!=t.existingChild&&t.existingChild.key!==e){const e=new EN(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,e);const r=await e._findPlace(t.existingChild.hash);return r.bucket._putAt(r,t.existingChild.key,t.existingChild.value),await e._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,r){this._putObjectAt(e.pos,{key:t,value:r,hash:e.hash})}_putObjectAt(e,t){null==this._children.get(e)&&this._popCount++,this._children.set(e,t)}_delAt(e){if(-1===e)throw new Error("Invalid position");null!=this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(null!=this._parent&&this._popCount<=1)if(1===this._popCount){const e=this._children.find(_N);if(null!=e&&!(e instanceof EN)){const t=e.hash;t.untake(this._options.bits);const r={pos:this._posAtParent,hash:t,bucket:this._parent};this._parent._putAt(r,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}}function _N(e){return Boolean(e)}function SN(e,t){return e.key}function AN(e){return e}async function IN(e,t,r){const n=[];for(const i of e._children.compactArray())if(i instanceof EN)await IN(i,t,r);else{const r=await t(i);n.push({bitField:e._children.bitField(),children:r})}return await r(n)}const CN=[255,254,252,248,240,224,192,128],kN=[1,3,7,15,31,63,127,255];class TN{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(e){let t=e,r=0;while(t>0&&this._haveBits()){const e=this._value[this._currentBytePos],n=this._currentBitPos+1,i=Math.min(n,t),s=RN(e,n-i,i);r=(r<<i)+s,t-=i,this._currentBitPos-=i,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return r}untake(e){this._currentBitPos+=e;while(this._currentBitPos>7)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function RN(e,t,r){const n=PN(t,r);return(e&n)>>>t}function PN(e,t){return CN[e]&kN[Math.min(t+e-1,7)]}function xN(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=pN(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return fN(r)}function DN(e){function t(t){return t instanceof ON?t:new ON(t,e)}return t}class ON{constructor(e,t){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;while(this._availableBits<t)await this._produceMoreBits();let r=0;while(t>0){const e=this._buffers[this._currentBufferIndex],n=Math.min(e.availableBits(),t),i=e.take(n);r=(r<<n)+i,t-=n,this._availableBits-=n,0===e.availableBits()&&this._currentBufferIndex++}return r}untake(e){let t=e;while(t>0){const e=this._buffers[this._currentBufferIndex],r=Math.min(e.totalBits()-e.availableBits(),t);e.untake(r),t-=r,this._availableBits+=r,this._currentBufferIndex>0&&e.totalBits()===e.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const e=this._depth>0?xN([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),r=new TN(t);this._buffers.push(r),this._availableBits+=r.availableBits()}}function NN(e){if(null==e||null==e.hashFn)throw new Error("please define an options.hashFn");const t={bits:e.bits??8,hash:DN(e.hashFn)};return new EN(t)}class LN extends _D{constructor(e,t){super(e,t),this._bucket=NN({hashFn:t.hamtHashFn,bits:t.hamtBucketBits})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){for await(const t of UN(this._bucket,e,this,this.options))yield{...t,path:this.path}}}var BN=LN;async function*UN(e,t,r,n){const i=e._children,s=[];let o=0;for(let f=0;f<i.length;f++){const e=i.get(f);if(!e)continue;const r=f.toString(16).toUpperCase().padStart(2,"0");if(e instanceof EN){let i;for await(const r of await UN(e,t,null,n))i=r;if(!i)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:r,Tsize:i.size,Hash:i.cid}),o+=i.size}else if("function"===typeof e.value.flush){const n=e.value;let i;for await(const e of n.flush(t))i=e,yield i;const a=r+e.key;s.push({Name:a,Tsize:i.size,Hash:i.cid}),o+=i.size}else{const t=e.value;if(!t.cid)continue;const n=r+e.key,i=t.size;s.push({Name:n,Tsize:i,Hash:t.cid}),o+=i}}const a=Uint8Array.from(i.bitField().reverse()),c=new xn({type:"hamt-sharded-directory",data:a,fanout:e.tableSize(),hashType:n.hamtHashCode,mtime:r&&r.mtime,mode:r&&r.mode}),l={Data:c.marshal(),Links:s},u=ks(Es(l)),h=await zx(u,t,n),d=u.length+o;yield{cid:h,unixfs:c,size:d}}async function MN(e,t,r,n){let i=t;t instanceof AD&&t.directChildrenCount()>=r&&(i=await jN(t,n));const s=i.parent;if(s){if(i!==t){if(e&&(e.parent=i),!i.parentKey)throw new Error("No parent key found");await s.put(i.parentKey,i)}return MN(i,s,r,n)}return i}async function jN(e,t){const r=new BN({root:e.root,dir:!0,parent:e.parent,parentKey:e.parentKey,path:e.path,dirty:e.dirty,flat:!1,mtime:e.mtime,mode:e.mode},t);for await(const{key:n,child:i}of e.eachChildSeries())await r.put(n,i);return r}var VN=MN;const zN=(e="")=>(e.trim().match(/([^\\/]|\\\/)+/g)||[]).filter(Boolean);var FN=zN;async function $N(e,t,r){const n=FN(e.path||""),i=n.length-1;let s=t,o="";for(let a=0;a<n.length;a++){const c=n[a];o+=`${o?"/":""}${c}`;const l=a===i;if(s.dirty=!0,s.cid=void 0,s.size=void 0,l)await s.put(c,e),t=await VN(null,s,r.shardSplitThreshold,r);else{let e=await s.get(c);e&&e instanceof _D||(e=new AD({root:!1,dir:!0,parent:s,parentKey:c,path:o,dirty:!0,flat:!0,mtime:e&&e.unixfs&&e.unixfs.mtime,mode:e&&e.unixfs&&e.unixfs.mode},r)),await s.put(c,e),s=e}}return t}async function*KN(e,t){e instanceof _D?yield*e.flush(t):e&&e.unixfs&&e.unixfs.isDirectory()&&(yield e)}async function*qN(e,t,r){let n=new AD({root:!0,dir:!0,path:"",dirty:!0,flat:!0},r);for await(const i of e)i&&(n=await $N(i,n,r),i.unixfs&&i.unixfs.isDirectory()||(yield i));if(r.wrapWithDirectory)yield*KN(n,t);else for await(const i of n.eachChildSeries())i&&(yield*KN(i.child,t))}var HN=qN;async function*GN(e,t,r={}){const n=jx(r);let i,s,o;i="function"===typeof r.dagBuilder?r.dagBuilder:vD,s="function"===typeof r.treeBuilder?r.treeBuilder:HN,o=Symbol.asyncIterator in e||Symbol.iterator in e?e:[e];for await(const a of s(Ox(i(o,t,n),n.fileImportConcurrency),t,n))yield{cid:a.cid,path:a.path,unixfs:a.unixfs,size:a.size}}async function*WN(e,t){if("string"===typeof e||e instanceof String||_x(e)||Sx(e)||e._readableState)throw mn(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(Ix(e)&&(e=bx(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const r=Ex(e),{value:n,done:i}=await r.peek();if(i)return void(yield*[]);if(r.push(n),Number.isInteger(n))throw mn(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(n._readableState)return void(yield*qR(r,(e=>YN({content:e},t))));if(_x(n))return void(yield YN({content:r},t));if(Ax(n)||n[Symbol.iterator]||n[Symbol.asyncIterator]||Ix(n)||Sx(n))return void(yield*qR(r,(e=>YN(e,t))))}if(Ax(e))throw mn(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");throw mn(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}async function YN(e,t){const{path:r,mode:n,mtime:i,content:s}=e,o={path:r||"",mode:Rn(n),mtime:Pn(i)};return s?o.content=await t(s):r||(o.content=await t(e)),o}function JN(e){return WN(e,kx)}const QN=e=>{if(e){if(e.startsWith("size-")){const t=e.split("-")[1],r=parseInt(t);if(isNaN(r))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:r}}if(e.startsWith("rabin"))return{chunker:"rabin",...XN(e)};throw new Error(`Unrecognized chunker option: ${e}`)}return{chunker:"fixed"}},XN=e=>{const t={},r=e.split("-");switch(r.length){case 1:t.avgChunkSize=262144;break;case 2:t.avgChunkSize=ZN(r[1],"avg");break;case 4:t.minChunkSize=ZN(r[1],"min"),t.avgChunkSize=ZN(r[2],"avg"),t.maxChunkSize=ZN(r[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return t},ZN=(e,t)=>{const r=parseInt(e);if(isNaN(r))throw new Error(`Chunker parameter ${t} must be an integer`);return r},eL=Wr.bind({ignoreUndefined:!0});function tL({repo:e,preload:t,hashers:r,options:n}){const i=n&&n.sharding;async function*s(n,s={}){const o=eL({shardSplitThreshold:i?1e3:1/0,strategy:"balanced"},s,{...QN(s.chunker)});o.hashAlg&&"sha2-256"!==o.hashAlg&&1!==o.cidVersion&&(o.cidVersion=1),o.trickle&&(o.strategy="trickle"),"trickle"===o.strategy&&(o.leafType="raw",o.reduceSingleLeafToSelf=!1),o.cidVersion>0&&void 0===o.rawLeaves&&(o.rawLeaves=!0),void 0!==o.hashAlg&&void 0===o.rawLeaves&&(o.rawLeaves=!0),delete o.trickle;const a={};if(o.progress){const e=o.progress;o.progress=(t,r)=>{a[r]||(a[r]=0),a[r]+=t,e(a[r],r)}}let c;null!=o.hashAlg&&(c=await r.getHasher(o.hashAlg));const l=QR(JN(n),(t=>GN(t,e.blocks,{...o,hasher:c,pin:!1})),rL(o),nL(t,o),iL(e,o)),u=await e.gcLock.readLock();try{for await(const e of l){const t=e.path??e.cid.toString();delete a[t],yield{...e,path:t}}}finally{u()}}return xw(s)}function rL(e){async function*t(t){for await(const r of t){let t=r.cid;1===e.cidVersion&&(t=t.toV1());let n=r.path?r.path:t.toString();e.wrapWithDirectory&&!r.path&&(n=""),yield{path:n,cid:t,size:r.size,mode:r.unixfs&&r.unixfs.mode,mtime:r.unixfs&&r.unixfs.mtime}}}return t}function nL(e,t){async function*r(r){for await(const n of r){const r=!n.path||t.wrapWithDirectory?""===n.path:!n.path.includes("/"),i=r&&!t.onlyHash&&!1!==t.preload;i&&e(n.cid),yield n}}return r}function iL(e,t){async function*r(r){for await(const n of r){const r=!(n.path&&n.path.includes("/")),i=(null==t.pin||t.pin)&&r&&!t.onlyHash;i&&await e.pins.pinRecursively(n.cid),yield n}}return r}const sL=async function(e){return(await Bx.encode(e)).slice(0,8).reverse()},oL=(e,t,r)=>Promise.all(e.map((e=>{if(null==e.Name)throw new Error("Unexpected Link without a Name");if(2===e.Name.length){const n=parseInt(e.Name,16);return t._putObjectAt(n,new EN({hash:r._options.hash,bits:r._options.bits},t,n))}return r.put(e.Name.substring(2),!0)}))),aL=e=>e.toString(16).toUpperCase().padStart(2,"0").substring(0,2),cL=e=>{let t=e.bucket;const r=[];while(t._parent)r.push(t),t=t._parent;return r.push(t),r.reverse()},lL=async(e,t,r,n,i)=>{if(!n){const e=NN({hashFn:sL});n={rootBucket:e,hamtDepth:1,lastBucket:e}}await oL(e.Links,n.lastBucket,n.rootBucket);const s=await n.rootBucket._findNewBucketAndPos(t);let o=aL(s.pos);const a=cL(s);a.length>n.hamtDepth&&(n.lastBucket=a[n.hamtDepth],o=aL(n.lastBucket._posAtParent));const c=e.Links.find((e=>{if(null==e.Name)return!1;const r=e.Name.substring(0,2),n=e.Name.substring(2);return r===o&&(!n||n===t)}));if(!c)return null;if(null!=c.Name&&c.Name.substring(2)===t)return c.Hash;n.hamtDepth++;const l=await r.get(c.Hash,i);return e=Ts(l),lL(e,t,r,n,i)};var uL=lL;function hL(e,t,r,n){const i=e.length,s=t+i;return r>=s||n<t?new Uint8Array(0):(n>=t&&n<s&&(e=e.subarray(0,n-t)),r>=t&&r<s&&(e=e.subarray(r-t)),e)}var dL=hL;const fL=(e,t,r)=>{if(t||(t=0),t<0)throw mn(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(t>e)throw mn(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(r||0===r||(r=e-t),r<0)throw mn(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return t+r>e&&(r=e-t),{offset:t,length:r}};var pL=fL;async function yL(e,t,r,n,i,s,o,a){if(t instanceof Uint8Array)return void r.push(dL(t,n,i,s));if(null==t.Data)throw mn(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let c;try{c=xn.unmarshal(t.Data)}catch(WV){throw mn(WV,"ERR_NOT_UNIXFS")}if(null!=c.data){const e=c.data,t=dL(e,n,i,s);r.push(t),n+=t.byteLength}const l=[];for(let u=0;u<t.Links.length;u++){const e=t.Links[u],r=n,o=r+c.blockSizes[u];if((i>=r&&i<o||s>=r&&s<=o||i<r&&s>o)&&l.push({link:e,blockStart:n}),n=o,n>s)break}await QR(l,(t=>qR(t,(t=>async()=>{const r=await e.get(t.link.Hash,{signal:a.signal});return{...t,block:r}}))),(e=>fx(e,{ordered:!0})),(async t=>{for await(const{link:n,block:c,blockStart:l}of t){let t;switch(n.Hash.code){case Cs:t=Ts(c);break;case Sl:t=c;break;default:return void r.end(mn(new Error(`Unsupported codec: ${n.Hash.code}`),"ERR_NOT_UNIXFS"))}o.add((async()=>{await yL(e,t,r,l,i,s,o,a)}))}}))}const gL=(e,t,r,n,i,s,o)=>{async function*a(e={}){const n=r.fileSize();if(void 0===n)throw new Error("File was a directory");const{offset:i,length:s}=pL(n,e.offset,e.length);if(0===s)return;const a=new Lb({concurrency:1}),c=LR();a.add((async()=>{await yL(o,t,c,0,i,i+s,a,e)})),a.on("error",(e=>{c.end(e)}));let l=0;for await(const t of c)null!=t&&(l+=t.byteLength,l===s&&c.end(),yield t)}return a};var mL=gL;const wL=(e,t,r,n,i,s,o)=>{async function*a(e={}){const r=e.offset||0,a=e.length||t.Links.length,c=t.Links.slice(r,a);for(const t of c){const r=await i(t.Hash,t.Name||"",`${n}/${t.Name||""}`,[],s+1,o,e);r.entry&&(yield r.entry)}}return a};var bL=wL;const vL=(e,t,r,n,i,s,o)=>{function a(e={}){return EL(t,n,i,s,o,e)}return a};async function*EL(e,t,r,n,i,s){const o=e.Links;for(const a of o){const o=null!=a.Name?a.Name.substring(2):null;if(o){const e=await r(a.Hash,o,`${t}/${o}`,[],n+1,i,s);yield e.entry}else{const o=await i.get(a.Hash);e=Ts(o);for await(const a of EL(e,t,r,n,i,s))yield a}}}var _L=vL;const SL=(e,t)=>{const r=e.Links.find((e=>e.Name===t));return r&&r.Hash},AL={raw:mL,file:mL,directory:bL,"hamt-sharded-directory":_L,metadata:(e,t,r,n,i,s,o)=>()=>[],symlink:(e,t,r,n,i,s,o)=>()=>[]},IL=async(e,t,r,n,i,s,o,a)=>{const c=await o.get(e,a),l=Ts(c);let u,h;if(t||(t=e.toString()),null==l.Data)throw mn(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{u=xn.unmarshal(l.Data)}catch(WV){throw mn(WV,"ERR_NOT_UNIXFS")}if(r||(r=t),n.length){let e;if(e=u&&"hamt-sharded-directory"===u.type?await uL(l,n[0],o):SL(l,n[0]),!e)throw mn(new Error("file does not exist"),"ERR_NOT_FOUND");const t=n.shift(),i=`${r}/${t}`;h={cid:e,toResolve:n,name:t||"",path:i}}return{entry:{type:u.isDirectory()?"directory":"file",name:t,path:r,cid:e,content:AL[u.type](e,l,u,r,i,s,o),unixfs:u,depth:s,node:l,size:u.fileSize()},next:h}};var CL=IL;const kL=e=>{async function*t(t={}){const{offset:r,length:n}=pL(e.length,t.offset,t.length);yield dL(e,0,r,r+n)}return t},TL=async(e,t,r,n,i,s,o,a)=>{if(n.length)throw mn(new Error(`No link named ${r} found in raw node ${e}`),"ERR_NOT_FOUND");const c=await o.get(e,a);return{entry:{type:"raw",name:t,path:r,cid:e,content:kL(c),depth:s,size:c.length,node:c}}};var RL=TL;const PL=async(e,t,r,n,i,s,o,a)=>{const c=await o.get(e),l=lc(c);let u=l,h=r;while(n.length){const i=n[0];if(!(i in u))throw mn(new Error(`No property named ${i} found in cbor node ${e}`),"ERR_NO_PROP");{n.shift(),h=`${h}/${i}`;const o=ji.asCID(u[i]);if(o)return{entry:{type:"object",name:t,path:r,cid:e,node:c,depth:s,size:c.length,content:async function*(){yield l}},next:{cid:o,name:i,path:h,toResolve:n}};u=u[i]}}return{entry:{type:"object",name:t,path:r,cid:e,node:c,depth:s,size:c.length,content:async function*(){yield l}}}};var xL=PL;const DL=e=>{async function*t(t={}){const{offset:r,length:n}=pL(e.length,t.offset,t.length);yield dL(e,0,r,r+n)}return t},OL=async(e,t,r,n,i,s,o,a)=>{if(n.length)throw mn(new Error(`No link named ${r} found in raw node ${e}`),"ERR_NOT_FOUND");const c=await hi(e.multihash.bytes);return{entry:{type:"identity",name:t,path:r,cid:e,content:DL(c.digest),depth:s,size:c.digest.length,node:c.digest}}};var NL=OL;const LL={[Cs]:CL,[Sl]:RL,[ac]:xL,[il.code]:NL};function BL(e,t,r,n,i,s,o){const a=LL[e.code];if(!a)throw mn(new Error(`No resolver for code ${e.code}`),"ERR_NO_RESOLVER");return a(e,t,r,n,BL,i,s,o)}var UL=BL;const ML=(e="")=>(e.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),jL=e=>{if(e instanceof Uint8Array)return{cid:ji.decode(e),toResolve:[]};const t=ji.asCID(e);if(t)return{cid:t,toResolve:[]};if("string"===typeof e){0===e.indexOf("/ipfs/")&&(e=e.substring(6));const t=ML(e);return{cid:ji.parse(t[0]),toResolve:t.slice(1)}}throw mn(new Error(`Unknown path type ${e}`),"ERR_BAD_PATH")};async function*VL(e,t,r={}){let{cid:n,toResolve:i}=jL(e),s=n.toString(),o=s;const a=i.length;while(1){const c=await UL(n,s,o,i,a,t,r);if(!c.entry&&!c.next)throw mn(new Error(`Could not resolve ${e}`),"ERR_NOT_FOUND");if(c.entry&&(yield c.entry),!c.next)return;i=c.next.toResolve,n=c.next.cid,s=c.next.name,o=c.next.path}}async function zL(e,t,r={}){const n=await h_(VL(e,t,r));if(!n)throw mn(new Error(`Could not resolve ${e}`),"ERR_NOT_FOUND");return n}async function*FL(e,t,r={}){const n=await zL(e,t,r);if(n&&(yield n,"directory"===n.type))for await(const s of i(n,r))yield s;async function*i(e,t){for await(const r of e.content(t))yield r,r instanceof Uint8Array||"directory"===r.type&&(yield*i(r,t))}}function $L({repo:e,preload:t}){async function*r(r,n={}){if(r=jw(r),!1!==n.preload){const e=r.split("/");t(ji.parse(e[0]))}const i=await zL(r,e.blocks,n);if("directory"===i.type)throw new Error("this dag node is a directory");if(!i.content)throw new Error("this dag node has no content");yield*i.content(n)}return xw(r)}function KL(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function qL(e=0){return null!=globalThis.Buffer?.alloc?KL(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function HL(e=0){return null!=globalThis.Buffer?.allocUnsafe?KL(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function GL(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=HL(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return KL(r)}function WL(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}const YL=Symbol.for("@achingbrain/uint8arraylist");function JL(e,t){if(null==t||t<0)throw new RangeError("index is out of bounds");let r=0;for(const n of e){const e=r+n.byteLength;if(t<e)return{buf:n,index:t-r};r=e}throw new RangeError("index is out of bounds")}function QL(e){return Boolean(e?.[YL])}class XL{constructor(...e){Object.defineProperty(this,YL,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let t=0;for(const r of e)if(r instanceof Uint8Array)t+=r.byteLength,this.bufs.push(r);else{if(!QL(r))throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");t+=r.byteLength,this.bufs.push(...r.bufs)}this.length+=t}prepend(...e){this.prependAll(e)}prependAll(e){let t=0;for(const r of e.reverse())if(r instanceof Uint8Array)t+=r.byteLength,this.bufs.unshift(r);else{if(!QL(r))throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");t+=r.byteLength,this.bufs.unshift(...r.bufs)}this.length+=t}get(e){const t=JL(this.bufs,e);return t.buf[t.index]}set(e,t){const r=JL(this.bufs,e);r.buf[r.index]=t}write(e,t=0){if(e instanceof Uint8Array)for(let r=0;r<e.length;r++)this.set(t+r,e[r]);else{if(!QL(e))throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList");for(let r=0;r<e.length;r++)this.set(t+r,e.get(r))}}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0))while(this.bufs.length>0){if(!(e>=this.bufs[0].byteLength)){this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift()}}slice(e,t){const{bufs:r,length:n}=this._subList(e,t);return GL(r,n)}subarray(e,t){const{bufs:r,length:n}=this._subList(e,t);return 1===r.length?r[0]:GL(r,n)}sublist(e,t){const{bufs:r,length:n}=this._subList(e,t),i=new XL;return i.length=n,i.bufs=r,i}_subList(e,t){if(e=e??0,t=t??this.length,e<0&&(e=this.length+e),t<0&&(t=this.length+t),e<0||t>this.length)throw new RangeError("index is out of bounds");if(e===t)return{bufs:[],length:0};if(0===e&&t===this.length)return{bufs:[...this.bufs],length:this.length};const r=[];let n=0;for(let i=0;i<this.bufs.length;i++){const s=this.bufs[i],o=n,a=o+s.byteLength;if(n=a,e>=a)continue;const c=e>=o&&e<a,l=t>o&&t<=a;if(c&&l){if(e===o&&t===a){r.push(s);break}const n=e-o;r.push(s.subarray(n,n+(t-e)));break}if(c){if(0===e){r.push(s);continue}r.push(s.subarray(e-o))}else{if(l){if(t===a){r.push(s);break}r.push(s.subarray(0,t-o));break}r.push(s)}}return{bufs:r,length:t-e}}getInt8(e){const t=this.subarray(e,e+1),r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getInt8(0)}setInt8(e,t){const r=HL(1),n=new DataView(r.buffer,r.byteOffset,r.byteLength);n.setInt8(0,t),this.write(r,e)}getInt16(e,t){const r=this.subarray(e,e+2),n=new DataView(r.buffer,r.byteOffset,r.byteLength);return n.getInt16(0,t)}setInt16(e,t,r){const n=qL(2),i=new DataView(n.buffer,n.byteOffset,n.byteLength);i.setInt16(0,t,r),this.write(n,e)}getInt32(e,t){const r=this.subarray(e,e+4),n=new DataView(r.buffer,r.byteOffset,r.byteLength);return n.getInt32(0,t)}setInt32(e,t,r){const n=qL(4),i=new DataView(n.buffer,n.byteOffset,n.byteLength);i.setInt32(0,t,r),this.write(n,e)}getBigInt64(e,t){const r=this.subarray(e,e+8),n=new DataView(r.buffer,r.byteOffset,r.byteLength);return n.getBigInt64(0,t)}setBigInt64(e,t,r){const n=qL(8),i=new DataView(n.buffer,n.byteOffset,n.byteLength);i.setBigInt64(0,t,r),this.write(n,e)}getUint8(e){const t=this.subarray(e,e+1),r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getUint8(0)}setUint8(e,t){const r=HL(1),n=new DataView(r.buffer,r.byteOffset,r.byteLength);n.setUint8(0,t),this.write(r,e)}getUint16(e,t){const r=this.subarray(e,e+2),n=new DataView(r.buffer,r.byteOffset,r.byteLength);return n.getUint16(0,t)}setUint16(e,t,r){const n=qL(2),i=new DataView(n.buffer,n.byteOffset,n.byteLength);i.setUint16(0,t,r),this.write(n,e)}getUint32(e,t){const r=this.subarray(e,e+4),n=new DataView(r.buffer,r.byteOffset,r.byteLength);return n.getUint32(0,t)}setUint32(e,t,r){const n=qL(4),i=new DataView(n.buffer,n.byteOffset,n.byteLength);i.setUint32(0,t,r),this.write(n,e)}getBigUint64(e,t){const r=this.subarray(e,e+8),n=new DataView(r.buffer,r.byteOffset,r.byteLength);return n.getBigUint64(0,t)}setBigUint64(e,t,r){const n=qL(8),i=new DataView(n.buffer,n.byteOffset,n.byteLength);i.setBigUint64(0,t,r),this.write(n,e)}getFloat32(e,t){const r=this.subarray(e,e+4),n=new DataView(r.buffer,r.byteOffset,r.byteLength);return n.getFloat32(0,t)}setFloat32(e,t,r){const n=qL(4),i=new DataView(n.buffer,n.byteOffset,n.byteLength);i.setFloat32(0,t,r),this.write(n,e)}getFloat64(e,t){const r=this.subarray(e,e+8),n=new DataView(r.buffer,r.byteOffset,r.byteLength);return n.getFloat64(0,t)}setFloat64(e,t,r){const n=qL(8),i=new DataView(n.buffer,n.byteOffset,n.byteLength);i.setFloat64(0,t,r),this.write(n,e)}equals(e){if(null==e)return!1;if(!(e instanceof XL))return!1;if(e.bufs.length!==this.bufs.length)return!1;for(let t=0;t<this.bufs.length;t++)if(!WL(this.bufs[t],e.bufs[t]))return!1;return!0}static fromUint8Arrays(e,t){const r=new XL;return r.bufs=e,null==t&&(t=e.reduce(((e,t)=>e+t.byteLength),0)),r.length=t,r}}function ZL(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var eB=ZL,tB=eB,rB=tB;new Uint8Array(0);const nB=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},iB=e=>(new TextEncoder).encode(e),sB=e=>(new TextDecoder).decode(e);class oB{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class aB{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return lB(this,e)}}class cB{constructor(e){this.decoders=e}or(e){return lB(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const lB=(e,t)=>new cB({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class uB{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new oB(e,t,r),this.decoder=new aB(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const hB=({name:e,prefix:t,encode:r,decode:n})=>new uB(e,t,r,n),dB=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=rB(r,t);return hB({prefix:e,name:t,encode:n,decode:e=>nB(i(e))})},fB=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},pB=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},yB=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>hB({prefix:t,name:e,encode(e){return pB(e,n,r)},decode(t){return fB(t,n,r,e)}}),gB=hB({prefix:"\0",name:"identity",encode:e=>sB(e),decode:e=>iB(e)}),mB=yB({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),wB=yB({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),bB=dB({prefix:"9",name:"base10",alphabet:"0123456789"}),vB=yB({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),EB=yB({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),_B=yB({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),SB=yB({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),AB=yB({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),IB=yB({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),CB=yB({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),kB=yB({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),TB=yB({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),RB=yB({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),PB=yB({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),xB=dB({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),DB=dB({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),OB=dB({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),NB=dB({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),LB=yB({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),BB=yB({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),UB=yB({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),MB=yB({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),jB=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),VB=jB.reduce(((e,t,r)=>(e[r]=t,e)),[]),zB=jB.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);function FB(e){return e.reduce(((e,t)=>(e+=VB[t],e)),"")}function $B(e){const t=[];for(const r of e){const e=zB[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}const KB=hB({prefix:"🚀",name:"base256emoji",encode:FB,decode:$B});var qB=JB,HB=128,GB=127,WB=~GB,YB=Math.pow(2,31);function JB(e,t,r){t=t||[],r=r||0;var n=r;while(e>=YB)t[r++]=255&e|HB,e/=128;while(e&WB)t[r++]=255&e|HB,e>>>=7;return t[r]=0|e,JB.bytes=r-n+1,t}var QB=eU,XB=128,ZB=127;function eU(e,t){var r,n=0,i=(t=t||0,0),s=t,o=e.length;do{if(s>=o)throw eU.bytes=0,new RangeError("Could not decode varint");r=e[s++],n+=i<28?(r&ZB)<<i:(r&ZB)*Math.pow(2,i),i+=7}while(r>=XB);return eU.bytes=s-t,n}var tU=Math.pow(2,7),rU=Math.pow(2,14),nU=Math.pow(2,21),iU=Math.pow(2,28),sU=Math.pow(2,35),oU=Math.pow(2,42),aU=Math.pow(2,49),cU=Math.pow(2,56),lU=Math.pow(2,63),uU=function(e){return e<tU?1:e<rU?2:e<nU?3:e<iU?4:e<sU?5:e<oU?6:e<aU?7:e<cU?8:e<lU?9:10},hU={encode:qB,decode:QB,encodingLength:uU},dU=hU,fU=dU;const pU=(e,t,r=0)=>(fU.encode(e,t,r),t),yU=e=>fU.encodingLength(e),gU=(e,t)=>{const r=t.byteLength,n=yU(e),i=n+yU(r),s=new Uint8Array(i+r);return pU(e,s,0),pU(r,s,n),s.set(t,i),new mU(e,r,t,s)};class mU{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const wU=({name:e,code:t,encode:r})=>new bU(e,t,r);class bU{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?gU(this.code,t):t.then((e=>gU(this.code,e)))}throw Error("Unknown type, must be binary type")}}const vU=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),EU=wU({name:"sha2-256",code:18,encode:vU("SHA-256")}),_U=wU({name:"sha2-512",code:19,encode:vU("SHA-512")}),SU=0,AU="identity",IU=nB,CU=e=>gU(SU,IU(e)),kU={code:SU,name:AU,encode:IU,digest:CU},TU="raw",RU=85,PU=e=>nB(e),xU=e=>nB(e),DU=new TextEncoder,OU=new TextDecoder,NU="json",LU=512,BU=e=>DU.encode(JSON.stringify(e)),UU=e=>JSON.parse(OU.decode(e));new WeakMap;class MU{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==it_tar_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==it_tar_node_modules_multiformats_src_cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return MU.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return MU.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return MU.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return it_tar_node_modules_multiformats_src_cid_format(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof MU)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new MU(e,r,n,i||it_tar_node_modules_multiformats_src_cid_encodeCID(e,r,n.bytes))}if(!0===t[it_tar_node_modules_multiformats_src_cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,i=Digest.decode(r);return MU.create(e,n,i)}return null}static create(e,t,r){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==it_tar_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${it_tar_node_modules_multiformats_src_cid_DAG_PB_CODE}) block encoding`);return new MU(e,t,r,r.bytes);case 1:{const n=it_tar_node_modules_multiformats_src_cid_encodeCID(e,t,r.bytes);return new MU(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return MU.create(0,it_tar_node_modules_multiformats_src_cid_DAG_PB_CODE,e)}static createV1(e,t){return MU.create(1,e,t)}static decode(e){const[t,r]=MU.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=MU.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Digest.Digest(t.multihashCode,t.digestSize,i,n),o=0===t.version?MU.createV0(s):MU.createV1(t.codec,s);return[o,e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),i=it_tar_node_modules_multiformats_src_cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a,l=c-s;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:l,size:c}}static parse(e,t){const[r,n]=it_tar_node_modules_multiformats_src_cid_parseCIDtoBytes(e,t),i=MU.decode(n);return it_tar_node_modules_multiformats_src_cid_baseCache(i).set(r,e),i}}Symbol.for("@ipld/js-cid/CID");const jU={...et,...tt,...rt,...nt,...it,...st,...ot,...at,...ct,...lt};function VU(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function zU(e=0){return null!=globalThis.Buffer?.allocUnsafe?VU(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function FU(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const $U=FU("utf8","u",(e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)}),(e=>{const t=new TextEncoder;return t.encode(e.substring(1))})),KU=FU("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=zU(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),qU={utf8:$U,"utf-8":$U,hex:jU.base16,latin1:KU,ascii:KU,binary:KU,...jU};var HU=qU;function GU(e,t="utf8"){const r=HU[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function WU(e,t="utf8"){const r=HU[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):VU(globalThis.Buffer.from(e,"utf-8"))}"0".charCodeAt(0),WU("ustar\0","binary"),WU("ustar ","binary"),WU(" \0","binary");function YU(e){const t=async function*(){let t=yield,r=new XL;for await(const n of e)if(null!=t){r.append(n);while(r.length>=t){const e=r.sublist(0,t);if(r.consume(t),t=yield e,null==t){r.length>0&&(t=yield r,r=new XL);break}}}else r.append(n),t=yield r,r=new XL;if(null!=t)throw Object.assign(new Error(`stream ended before ${t} bytes became available`),{code:"ERR_UNDER_READ",buffer:r})}();return t.next(),t}var JU=r(1993);function QU(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=zU(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return VU(r)}async function XU(e){let t=new Uint8Array(0);for await(const r of e)t=QU([t,r],t.length+r.length);return t}const ZU="0000000000000000000",eM="7777777777777777777",tM="0".charCodeAt(0),rM=WU("ustar\0","binary"),nM=WU("00","binary"),iM=parseInt("7777",8),sM=257,oM=263,aM=function(e){switch(e){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72;default:return 0}},cM=function(e){let t=256;for(let r=0;r<148;r++)t+=e[r];for(let r=156;r<512;r++)t+=e[r];return t},lM=function(e,t){const r=e.toString(8);return r.length>t?WU(eM.slice(0,t)+" "):WU(ZU.slice(0,t-r.length)+r+" ")},uM=function(e){const t=WU(e).byteLength;let r=Math.floor(Math.log(t)/Math.log(10))+1;return t+r>=Math.pow(10,r)&&r++,`${t+r}${e}`};function hM(e){let t="";null!=e.name&&(t+=uM(" path="+e.name+"\n")),null!=e.linkname&&(t+=uM(" linkpath="+e.linkname+"\n"));const r=e.pax;if(null!=r)for(const n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t+=uM(" "+n+"="+r[n]+"\n"));return WU(t)}function dM(e){const t=new Uint8Array(512);let r=e.name,n="";if(5===e.typeflag&&"/"!==r[r.length-1]&&(r+="/"),WU(r).byteLength!==r.length)return null;while(WU(r).byteLength>100){const e=r.indexOf("/");if(-1===e)return null;n+=""!==n?"/"+r.slice(0,e):r.slice(0,e),r=r.slice(e+1)}return WU(r).byteLength>100||WU(n).byteLength>155||null!=e.linkname&&WU(e.linkname).byteLength>100?null:(t.set(WU(r),0),t.set(lM(e.mode&iM,6),100),t.set(lM(e.uid,6),108),t.set(lM(e.gid,6),116),t.set(lM(e.size,11),124),t.set(lM(e.mtime.getTime()/1e3|0,11),136),t[156]=tM+aM(e.type),null!=e.linkname&&t.set(WU(e.linkname),157),t.set(rM,sM),t.set(nM,oM),null!=e.uname&&t.set(WU(e.uname),265),null!=e.gname&&t.set(WU(e.gname),297),t.set(lM(e.devmajor??0,6),329),t.set(lM(e.devminor??0,6),337),null!=n&&t.set(WU(n),345),t.set(lM(cM(t),6),148),t)}const{S_IFMT:fM,S_IFBLK:pM,S_IFCHR:yM,S_IFDIR:gM,S_IFIFO:mM,S_IFLNK:wM}=JU,bM=parseInt("755",8),vM=parseInt("644",8),EM=new Uint8Array(1024);function _M(e=0){switch(e&fM){case pM:return"block-device";case yM:return"character-device";case gM:return"directory";case mM:return"fifo";case wM:return"symlink";default:return"file"}}function SM(e){return e&=511,0!==e?EM.subarray(0,512-e):new Uint8Array(0)}function AM(e){if(null==e.pax){const t=dM(e);if(null!=t)return t}return IM(e)}function IM(e){const t=hM(e),r={name:"PaxHeader",mode:e.mode,uid:e.uid,gid:e.gid,size:t.length,mtime:e.mtime,type:"pax-header",linkname:e.linkname,uname:e.uname,gname:e.gname,devmajor:e.devmajor,devminor:e.devminor};return new XL(dM(r)??new Uint8Array(0),t,SM(t.length),dM({...r,size:e.size,type:e.type})??new Uint8Array(0)).subarray()}function CM(){return async function*(e){for await(let{header:t,body:r}of e){const e={...t,size:"symlink"===t.type?0:t.size??0,type:t.type??_M(t.mode),mode:t.mode??("directory"===t.type?bM:vM),uid:t.uid??0,gid:t.gid??0,mtime:t.mtime??new Date};if("string"===typeof r&&(r=WU(r)),r instanceof Uint8Array||QL(r)){e.size=r.length,yield AM(e),yield QL(r)?r.subarray():r,yield SM(e.size);continue}if("symlink"===e.type&&null==e.linkname){if(null==r)throw new Error("type was symlink but no linkname or body specified");e.linkname=GU(await XU(r)),yield AM(e);continue}if(yield AM(e),"file"!==e.type&&"contiguous-file"!==e.type)continue;let n=0;for await(const t of r??[])n+=t.length,yield QL(t)?t.subarray():t;if(n!==e.size)throw new Error(`size mismatch, wrote ${n} of ${e.size} bytes`);yield SM(e.size)}yield EM}}
/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */
const kM=4,TM=0,RM=1,PM=2;function xM(e){let t=e.length;while(--t>=0)e[t]=0}const DM=0,OM=1,NM=2,LM=3,BM=258,UM=29,MM=256,jM=MM+1+UM,VM=30,zM=19,FM=2*jM+1,$M=15,KM=16,qM=7,HM=256,GM=16,WM=17,YM=18,JM=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),QM=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),XM=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),ZM=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ej=512,tj=new Array(2*(jM+2));xM(tj);const rj=new Array(2*VM);xM(rj);const nj=new Array(ej);xM(nj);const ij=new Array(BM-LM+1);xM(ij);const sj=new Array(UM);xM(sj);const oj=new Array(VM);function aj(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}let cj,lj,uj;function hj(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}xM(oj);const dj=e=>e<256?nj[e]:nj[256+(e>>>7)],fj=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},pj=(e,t,r)=>{e.bi_valid>KM-r?(e.bi_buf|=t<<e.bi_valid&65535,fj(e,e.bi_buf),e.bi_buf=t>>KM-e.bi_valid,e.bi_valid+=r-KM):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},yj=(e,t,r)=>{pj(e,r[2*t],r[2*t+1])},gj=(e,t)=>{let r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1},mj=e=>{16===e.bi_valid?(fj(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)},wj=(e,t)=>{const r=t.dyn_tree,n=t.max_code,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,c=t.stat_desc.max_length;let l,u,h,d,f,p,y=0;for(d=0;d<=$M;d++)e.bl_count[d]=0;for(r[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<FM;l++)u=e.heap[l],d=r[2*r[2*u+1]+1]+1,d>c&&(d=c,y++),r[2*u+1]=d,u>n||(e.bl_count[d]++,f=0,u>=a&&(f=o[u-a]),p=r[2*u],e.opt_len+=p*(d+f),s&&(e.static_len+=p*(i[2*u+1]+f)));if(0!==y){do{d=c-1;while(0===e.bl_count[d])d--;e.bl_count[d]--,e.bl_count[d+1]+=2,e.bl_count[c]--,y-=2}while(y>0);for(d=c;0!==d;d--){u=e.bl_count[d];while(0!==u)h=e.heap[--l],h>n||(r[2*h+1]!==d&&(e.opt_len+=(d-r[2*h+1])*r[2*h],r[2*h+1]=d),u--)}}},bj=(e,t,r)=>{const n=new Array($M+1);let i,s,o=0;for(i=1;i<=$M;i++)o=o+r[i-1]<<1,n[i]=o;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=gj(n[t]++,t))}},vj=()=>{let e,t,r,n,i;const s=new Array($M+1);for(r=0,n=0;n<UM-1;n++)for(sj[n]=r,e=0;e<1<<JM[n];e++)ij[r++]=n;for(ij[r-1]=n,i=0,n=0;n<16;n++)for(oj[n]=i,e=0;e<1<<QM[n];e++)nj[i++]=n;for(i>>=7;n<VM;n++)for(oj[n]=i<<7,e=0;e<1<<QM[n]-7;e++)nj[256+i++]=n;for(t=0;t<=$M;t++)s[t]=0;e=0;while(e<=143)tj[2*e+1]=8,e++,s[8]++;while(e<=255)tj[2*e+1]=9,e++,s[9]++;while(e<=279)tj[2*e+1]=7,e++,s[7]++;while(e<=287)tj[2*e+1]=8,e++,s[8]++;for(bj(tj,jM+1,s),e=0;e<VM;e++)rj[2*e+1]=5,rj[2*e]=gj(e,5);cj=new aj(tj,JM,MM+1,jM,$M),lj=new aj(rj,QM,0,VM,$M),uj=new aj(new Array(0),XM,0,zM,qM)},Ej=e=>{let t;for(t=0;t<jM;t++)e.dyn_ltree[2*t]=0;for(t=0;t<VM;t++)e.dyn_dtree[2*t]=0;for(t=0;t<zM;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*HM]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},_j=e=>{e.bi_valid>8?fj(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Sj=(e,t,r,n)=>{const i=2*t,s=2*r;return e[i]<e[s]||e[i]===e[s]&&n[t]<=n[r]},Aj=(e,t,r)=>{const n=e.heap[r];let i=r<<1;while(i<=e.heap_len){if(i<e.heap_len&&Sj(t,e.heap[i+1],e.heap[i],e.depth)&&i++,Sj(t,n,e.heap[i],e.depth))break;e.heap[r]=e.heap[i],r=i,i<<=1}e.heap[r]=n},Ij=(e,t,r)=>{let n,i,s,o,a=0;if(0!==e.sym_next)do{n=255&e.pending_buf[e.sym_buf+a++],n+=(255&e.pending_buf[e.sym_buf+a++])<<8,i=e.pending_buf[e.sym_buf+a++],0===n?yj(e,i,t):(s=ij[i],yj(e,s+MM+1,t),o=JM[s],0!==o&&(i-=sj[s],pj(e,i,o)),n--,s=dj(n),yj(e,s,r),o=QM[s],0!==o&&(n-=oj[s],pj(e,n,o)))}while(a<e.sym_next);yj(e,HM,t)},Cj=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.elems;let o,a,c,l=-1;for(e.heap_len=0,e.heap_max=FM,o=0;o<s;o++)0!==r[2*o]?(e.heap[++e.heap_len]=l=o,e.depth[o]=0):r[2*o+1]=0;while(e.heap_len<2)c=e.heap[++e.heap_len]=l<2?++l:0,r[2*c]=1,e.depth[c]=0,e.opt_len--,i&&(e.static_len-=n[2*c+1]);for(t.max_code=l,o=e.heap_len>>1;o>=1;o--)Aj(e,r,o);c=s;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Aj(e,r,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,r[2*c]=r[2*o]+r[2*a],e.depth[c]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,r[2*o+1]=r[2*a+1]=c,e.heap[1]=c++,Aj(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],wj(e,t),bj(r,l,e.bl_count)},kj=(e,t,r)=>{let n,i,s=-1,o=t[1],a=0,c=7,l=4;for(0===o&&(c=138,l=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=o,o=t[2*(n+1)+1],++a<c&&i===o||(a<l?e.bl_tree[2*i]+=a:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[2*GM]++):a<=10?e.bl_tree[2*WM]++:e.bl_tree[2*YM]++,a=0,s=i,0===o?(c=138,l=3):i===o?(c=6,l=3):(c=7,l=4))},Tj=(e,t,r)=>{let n,i,s=-1,o=t[1],a=0,c=7,l=4;for(0===o&&(c=138,l=3),n=0;n<=r;n++)if(i=o,o=t[2*(n+1)+1],!(++a<c&&i===o)){if(a<l)do{yj(e,i,e.bl_tree)}while(0!==--a);else 0!==i?(i!==s&&(yj(e,i,e.bl_tree),a--),yj(e,GM,e.bl_tree),pj(e,a-3,2)):a<=10?(yj(e,WM,e.bl_tree),pj(e,a-3,3)):(yj(e,YM,e.bl_tree),pj(e,a-11,7));a=0,s=i,0===o?(c=138,l=3):i===o?(c=6,l=3):(c=7,l=4)}},Rj=e=>{let t;for(kj(e,e.dyn_ltree,e.l_desc.max_code),kj(e,e.dyn_dtree,e.d_desc.max_code),Cj(e,e.bl_desc),t=zM-1;t>=3;t--)if(0!==e.bl_tree[2*ZM[t]+1])break;return e.opt_len+=3*(t+1)+5+5+4,t},Pj=(e,t,r,n)=>{let i;for(pj(e,t-257,5),pj(e,r-1,5),pj(e,n-4,4),i=0;i<n;i++)pj(e,e.bl_tree[2*ZM[i]+1],3);Tj(e,e.dyn_ltree,t-1),Tj(e,e.dyn_dtree,r-1)},xj=e=>{let t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return TM;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return RM;for(t=32;t<MM;t++)if(0!==e.dyn_ltree[2*t])return RM;return TM};let Dj=!1;const Oj=e=>{Dj||(vj(),Dj=!0),e.l_desc=new hj(e.dyn_ltree,cj),e.d_desc=new hj(e.dyn_dtree,lj),e.bl_desc=new hj(e.bl_tree,uj),e.bi_buf=0,e.bi_valid=0,Ej(e)},Nj=(e,t,r,n)=>{pj(e,(DM<<1)+(n?1:0),3),_j(e),fj(e,r),fj(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},Lj=e=>{pj(e,OM<<1,3),yj(e,HM,tj),mj(e)},Bj=(e,t,r,n)=>{let i,s,o=0;e.level>0?(e.strm.data_type===PM&&(e.strm.data_type=xj(e)),Cj(e,e.l_desc),Cj(e,e.d_desc),o=Rj(e),i=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=i&&(i=s)):i=s=r+5,r+4<=i&&-1!==t?Nj(e,t,r,n):e.strategy===kM||s===i?(pj(e,(OM<<1)+(n?1:0),3),Ij(e,tj,rj)):(pj(e,(NM<<1)+(n?1:0),3),Pj(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),Ij(e,e.dyn_ltree,e.dyn_dtree)),Ej(e),n&&_j(e)},Uj=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(ij[r]+MM+1)]++,e.dyn_dtree[2*dj(t)]++),e.sym_next===e.sym_end);var Mj=Oj,jj=Nj,Vj=Bj,zj=Uj,Fj=Lj,$j={_tr_init:Mj,_tr_stored_block:jj,_tr_flush_block:Vj,_tr_tally:zj,_tr_align:Fj};const Kj=(e,t,r,n)=>{let i=65535&e|0,s=e>>>16&65535|0,o=0;while(0!==r){o=r>2e3?2e3:r,r-=o;do{i=i+t[n++]|0,s=s+i|0}while(--o);i%=65521,s%=65521}return i|s<<16|0};var qj=Kj;const Hj=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t},Gj=new Uint32Array(Hj()),Wj=(e,t,r,n)=>{const i=Gj,s=n+r;e^=-1;for(let o=n;o<s;o++)e=e>>>8^i[255&(e^t[o])];return-1^e};var Yj=Wj,Jj={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Qj={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Xj,_tr_stored_block:Zj,_tr_flush_block:eV,_tr_tally:tV,_tr_align:rV}=$j,{Z_NO_FLUSH:nV,Z_PARTIAL_FLUSH:iV,Z_FULL_FLUSH:sV,Z_FINISH:oV,Z_BLOCK:aV,Z_OK:cV,Z_STREAM_END:lV,Z_STREAM_ERROR:uV,Z_DATA_ERROR:hV,Z_BUF_ERROR:dV,Z_DEFAULT_COMPRESSION:fV,Z_FILTERED:pV,Z_HUFFMAN_ONLY:yV,Z_RLE:gV,Z_FIXED:mV,Z_DEFAULT_STRATEGY:wV,Z_UNKNOWN:bV,Z_DEFLATED:vV}=Qj,EV=9,_V=15,SV=8,AV=29,IV=256,CV=IV+1+AV,kV=30,TV=19,RV=2*CV+1,PV=15,xV=3,DV=258,OV=DV+xV+1,NV=32,LV=42,BV=57,UV=69,MV=73,jV=91,VV=103,zV=113,FV=666,$V=1,KV=2,qV=3,HV=4,GV=3,WV=(e,t)=>(e.msg=Jj[t],t),YV=e=>2*e-(e>4?9:0),JV=e=>{let t=e.length;while(--t>=0)e[t]=0},QV=e=>{let t,r,n,i=e.w_size;t=e.hash_size,n=t;do{r=e.head[--n],e.head[n]=r>=i?r-i:0}while(--t);t=i,n=t;do{r=e.prev[--n],e.prev[n]=r>=i?r-i:0}while(--t)};let XV=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,ZV=XV;const ez=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))},tz=(e,t)=>{eV(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ez(e.strm)},rz=(e,t)=>{e.pending_buf[e.pending++]=t},nz=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},iz=(e,t,r,n)=>{let i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),r),1===e.state.wrap?e.adler=qj(e.adler,t,i,r):2===e.state.wrap&&(e.adler=Yj(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)},sz=(e,t)=>{let r,n,i=e.max_chain_length,s=e.strstart,o=e.prev_length,a=e.nice_match;const c=e.strstart>e.w_size-OV?e.strstart-(e.w_size-OV):0,l=e.window,u=e.w_mask,h=e.prev,d=e.strstart+DV;let f=l[s+o-1],p=l[s+o];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(r=t,l[r+o]===p&&l[r+o-1]===f&&l[r]===l[s]&&l[++r]===l[s+1]){s+=2,r++;do{}while(l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&s<d);if(n=DV-(d-s),s=d-DV,n>o){if(e.match_start=t,o=n,n>=a)break;f=l[s+o-1],p=l[s+o]}}}while((t=h[t&u])>c&&0!==--i);return o<=e.lookahead?o:e.lookahead},oz=e=>{const t=e.w_size;let r,n,i;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-OV)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),QV(e),n+=t),0===e.strm.avail_in)break;if(r=iz(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=xV){i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=ZV(e,e.ins_h,e.window[i+1]);while(e.insert)if(e.ins_h=ZV(e,e.ins_h,e.window[i+xV-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,e.lookahead+e.insert<xV)break}}while(e.lookahead<OV&&0!==e.strm.avail_in)},az=(e,t)=>{let r,n,i,s=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,o=0,a=e.strm.avail_in;do{if(r=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,n=e.strstart-e.block_start,r>n+e.strm.avail_in&&(r=n+e.strm.avail_in),r>i&&(r=i),r<s&&(0===r&&t!==oV||t===nV||r!==n+e.strm.avail_in))break;o=t===oV&&r===n+e.strm.avail_in?1:0,Zj(e,0,0,o),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,ez(e.strm),n&&(n>r&&(n=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,r-=n),r&&(iz(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(0===o);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?HV:t!==nV&&t!==oV&&0===e.strm.avail_in&&e.strstart===e.block_start?KV:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(iz(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,s=i>e.w_size?e.w_size:i,n=e.strstart-e.block_start,(n>=s||(n||t===oV)&&t!==nV&&0===e.strm.avail_in&&n<=i)&&(r=n>i?i:n,o=t===oV&&0===e.strm.avail_in&&r===n?1:0,Zj(e,e.block_start,r,o),e.block_start+=r,ez(e.strm)),o?qV:$V)},cz=(e,t)=>{let r,n;for(;;){if(e.lookahead<OV){if(oz(e),e.lookahead<OV&&t===nV)return $V;if(0===e.lookahead)break}if(r=0,e.lookahead>=xV&&(e.ins_h=ZV(e,e.ins_h,e.window[e.strstart+xV-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-OV&&(e.match_length=sz(e,r)),e.match_length>=xV)if(n=tV(e,e.strstart-e.match_start,e.match_length-xV),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=xV){e.match_length--;do{e.strstart++,e.ins_h=ZV(e,e.ins_h,e.window[e.strstart+xV-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=ZV(e,e.ins_h,e.window[e.strstart+1]);else n=tV(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(tz(e,!1),0===e.strm.avail_out))return $V}return e.insert=e.strstart<xV-1?e.strstart:xV-1,t===oV?(tz(e,!0),0===e.strm.avail_out?qV:HV):e.sym_next&&(tz(e,!1),0===e.strm.avail_out)?$V:KV},lz=(e,t)=>{let r,n,i;for(;;){if(e.lookahead<OV){if(oz(e),e.lookahead<OV&&t===nV)return $V;if(0===e.lookahead)break}if(r=0,e.lookahead>=xV&&(e.ins_h=ZV(e,e.ins_h,e.window[e.strstart+xV-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=xV-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-OV&&(e.match_length=sz(e,r),e.match_length<=5&&(e.strategy===pV||e.match_length===xV&&e.strstart-e.match_start>4096)&&(e.match_length=xV-1)),e.prev_length>=xV&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-xV,n=tV(e,e.strstart-1-e.prev_match,e.prev_length-xV),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=ZV(e,e.ins_h,e.window[e.strstart+xV-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!==--e.prev_length);if(e.match_available=0,e.match_length=xV-1,e.strstart++,n&&(tz(e,!1),0===e.strm.avail_out))return $V}else if(e.match_available){if(n=tV(e,0,e.window[e.strstart-1]),n&&tz(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return $V}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=tV(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<xV-1?e.strstart:xV-1,t===oV?(tz(e,!0),0===e.strm.avail_out?qV:HV):e.sym_next&&(tz(e,!1),0===e.strm.avail_out)?$V:KV},uz=(e,t)=>{let r,n,i,s;const o=e.window;for(;;){if(e.lookahead<=DV){if(oz(e),e.lookahead<=DV&&t===nV)return $V;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=xV&&e.strstart>0&&(i=e.strstart-1,n=o[i],n===o[++i]&&n===o[++i]&&n===o[++i])){s=e.strstart+DV;do{}while(n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&i<s);e.match_length=DV-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=xV?(r=tV(e,1,e.match_length-xV),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=tV(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(tz(e,!1),0===e.strm.avail_out))return $V}return e.insert=0,t===oV?(tz(e,!0),0===e.strm.avail_out?qV:HV):e.sym_next&&(tz(e,!1),0===e.strm.avail_out)?$V:KV},hz=(e,t)=>{let r;for(;;){if(0===e.lookahead&&(oz(e),0===e.lookahead)){if(t===nV)return $V;break}if(e.match_length=0,r=tV(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(tz(e,!1),0===e.strm.avail_out))return $V}return e.insert=0,t===oV?(tz(e,!0),0===e.strm.avail_out?qV:HV):e.sym_next&&(tz(e,!1),0===e.strm.avail_out)?$V:KV};function dz(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}const fz=[new dz(0,0,0,0,az),new dz(4,4,8,4,cz),new dz(4,5,16,8,cz),new dz(4,6,32,32,cz),new dz(4,4,16,16,lz),new dz(8,16,32,32,lz),new dz(8,16,128,128,lz),new dz(8,32,128,256,lz),new dz(32,128,258,1024,lz),new dz(32,258,258,4096,lz)],pz=e=>{e.window_size=2*e.w_size,JV(e.head),e.max_lazy_match=fz[e.level].max_lazy,e.good_match=fz[e.level].good_length,e.nice_match=fz[e.level].nice_length,e.max_chain_length=fz[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=xV-1,e.match_available=0,e.ins_h=0};function yz(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=vV,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*RV),this.dyn_dtree=new Uint16Array(2*(2*kV+1)),this.bl_tree=new Uint16Array(2*(2*TV+1)),JV(this.dyn_ltree),JV(this.dyn_dtree),JV(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(PV+1),this.heap=new Uint16Array(2*CV+1),JV(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*CV+1),JV(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const gz=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==LV&&t.status!==BV&&t.status!==UV&&t.status!==MV&&t.status!==jV&&t.status!==VV&&t.status!==zV&&t.status!==FV?1:0},mz=e=>{if(gz(e))return WV(e,uV);e.total_in=e.total_out=0,e.data_type=bV;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?BV:t.wrap?LV:zV,e.adler=2===t.wrap?0:1,t.last_flush=-2,Xj(t),cV},wz=e=>{const t=mz(e);return t===cV&&pz(e.state),t},bz=(e,t)=>gz(e)||2!==e.state.wrap?uV:(e.state.gzhead=t,cV),vz=(e,t,r,n,i,s)=>{if(!e)return uV;let o=1;if(t===fV&&(t=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),i<1||i>EV||r!==vV||n<8||n>15||t<0||t>9||s<0||s>mV||8===n&&1!==o)return WV(e,uV);8===n&&(n=9);const a=new yz;return e.state=a,a.strm=e,a.status=LV,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+xV-1)/xV),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=t,a.strategy=s,a.method=r,wz(e)},Ez=(e,t)=>vz(e,t,vV,_V,SV,wV),_z=(e,t)=>{if(gz(e)||t>aV||t<0)return e?WV(e,uV):uV;const r=e.state;if(!e.output||0!==e.avail_in&&!e.input||r.status===FV&&t!==oV)return WV(e,0===e.avail_out?dV:uV);const n=r.last_flush;if(r.last_flush=t,0!==r.pending){if(ez(e),0===e.avail_out)return r.last_flush=-1,cV}else if(0===e.avail_in&&YV(t)<=YV(n)&&t!==oV)return WV(e,dV);if(r.status===FV&&0!==e.avail_in)return WV(e,dV);if(r.status===LV&&0===r.wrap&&(r.status=zV),r.status===LV){let t=vV+(r.w_bits-8<<4)<<8,n=-1;if(n=r.strategy>=yV||r.level<2?0:r.level<6?1:6===r.level?2:3,t|=n<<6,0!==r.strstart&&(t|=NV),t+=31-t%31,nz(r,t),0!==r.strstart&&(nz(r,e.adler>>>16),nz(r,65535&e.adler)),e.adler=1,r.status=zV,ez(e),0!==r.pending)return r.last_flush=-1,cV}if(r.status===BV)if(e.adler=0,rz(r,31),rz(r,139),rz(r,8),r.gzhead)rz(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),rz(r,255&r.gzhead.time),rz(r,r.gzhead.time>>8&255),rz(r,r.gzhead.time>>16&255),rz(r,r.gzhead.time>>24&255),rz(r,9===r.level?2:r.strategy>=yV||r.level<2?4:0),rz(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(rz(r,255&r.gzhead.extra.length),rz(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Yj(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=UV;else if(rz(r,0),rz(r,0),rz(r,0),rz(r,0),rz(r,0),rz(r,9===r.level?2:r.strategy>=yV||r.level<2?4:0),rz(r,GV),r.status=zV,ez(e),0!==r.pending)return r.last_flush=-1,cV;if(r.status===UV){if(r.gzhead.extra){let t=r.pending,n=(65535&r.gzhead.extra.length)-r.gzindex;while(r.pending+n>r.pending_buf_size){let i=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>t&&(e.adler=Yj(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex+=i,ez(e),0!==r.pending)return r.last_flush=-1,cV;t=0,n-=i}let i=new Uint8Array(r.gzhead.extra);r.pending_buf.set(i.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending+=n,r.gzhead.hcrc&&r.pending>t&&(e.adler=Yj(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex=0}r.status=MV}if(r.status===MV){if(r.gzhead.name){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=Yj(e.adler,r.pending_buf,r.pending-n,n)),ez(e),0!==r.pending)return r.last_flush=-1,cV;n=0}t=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,rz(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=Yj(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=jV}if(r.status===jV){if(r.gzhead.comment){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=Yj(e.adler,r.pending_buf,r.pending-n,n)),ez(e),0!==r.pending)return r.last_flush=-1,cV;n=0}t=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,rz(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=Yj(e.adler,r.pending_buf,r.pending-n,n))}r.status=VV}if(r.status===VV){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(ez(e),0!==r.pending))return r.last_flush=-1,cV;rz(r,255&e.adler),rz(r,e.adler>>8&255),e.adler=0}if(r.status=zV,ez(e),0!==r.pending)return r.last_flush=-1,cV}if(0!==e.avail_in||0!==r.lookahead||t!==nV&&r.status!==FV){let n=0===r.level?az(r,t):r.strategy===yV?hz(r,t):r.strategy===gV?uz(r,t):fz[r.level].func(r,t);if(n!==qV&&n!==HV||(r.status=FV),n===$V||n===qV)return 0===e.avail_out&&(r.last_flush=-1),cV;if(n===KV&&(t===iV?rV(r):t!==aV&&(Zj(r,0,0,!1),t===sV&&(JV(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),ez(e),0===e.avail_out))return r.last_flush=-1,cV}return t!==oV?cV:r.wrap<=0?lV:(2===r.wrap?(rz(r,255&e.adler),rz(r,e.adler>>8&255),rz(r,e.adler>>16&255),rz(r,e.adler>>24&255),rz(r,255&e.total_in),rz(r,e.total_in>>8&255),rz(r,e.total_in>>16&255),rz(r,e.total_in>>24&255)):(nz(r,e.adler>>>16),nz(r,65535&e.adler)),ez(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?cV:lV)},Sz=e=>{if(gz(e))return uV;const t=e.state.status;return e.state=null,t===zV?WV(e,hV):cV},Az=(e,t)=>{let r=t.length;if(gz(e))return uV;const n=e.state,i=n.wrap;if(2===i||1===i&&n.status!==LV||n.lookahead)return uV;if(1===i&&(e.adler=qj(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){0===i&&(JV(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(r-n.w_size,r),0),t=e,r=n.w_size}const s=e.avail_in,o=e.next_in,a=e.input;e.avail_in=r,e.next_in=0,e.input=t,oz(n);while(n.lookahead>=xV){let e=n.strstart,t=n.lookahead-(xV-1);do{n.ins_h=ZV(n,n.ins_h,n.window[e+xV-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++}while(--t);n.strstart=e,n.lookahead=xV-1,oz(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=xV-1,n.match_available=0,e.next_in=o,e.input=a,e.avail_in=s,n.wrap=i,cV};var Iz=Ez,Cz=vz,kz=wz,Tz=mz,Rz=bz,Pz=_z,xz=Sz,Dz=Az,Oz="pako deflate (from Nodeca project)",Nz={deflateInit:Iz,deflateInit2:Cz,deflateReset:kz,deflateResetKeep:Tz,deflateSetHeader:Rz,deflate:Pz,deflateEnd:xz,deflateSetDictionary:Dz,deflateInfo:Oz};const Lz=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Bz=function(e){const t=Array.prototype.slice.call(arguments,1);while(t.length){const r=t.shift();if(r){if("object"!==typeof r)throw new TypeError(r+"must be non-object");for(const t in r)Lz(r,t)&&(e[t]=r[t])}}return e},Uz=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,i=0,s=e.length;n<s;n++){let t=e[n];r.set(t,i),i+=t.length}return r},Mz={assign:Bz,flattenChunks:Uz};let jz=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Qbe){jz=!1}const Vz=new Uint8Array(256);for(let Xbe=0;Xbe<256;Xbe++)Vz[Xbe]=Xbe>=252?6:Xbe>=248?5:Xbe>=240?4:Xbe>=224?3:Xbe>=192?2:1;Vz[254]=Vz[254]=1;var zz=e=>{if("function"===typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,r,n,i,s,o=e.length,a=0;for(i=0;i<o;i++)r=e.charCodeAt(i),55296===(64512&r)&&i+1<o&&(n=e.charCodeAt(i+1),56320===(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(a),s=0,i=0;s<a;i++)r=e.charCodeAt(i),55296===(64512&r)&&i+1<o&&(n=e.charCodeAt(i+1),56320===(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|63&r):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|63&r):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|63&r);return t};const Fz=(e,t)=>{if(t<65534&&e.subarray&&jz)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var $z=(e,t)=>{const r=t||e.length;if("function"===typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let n,i;const s=new Array(2*r);for(i=0,n=0;n<r;){let t=e[n++];if(t<128){s[i++]=t;continue}let o=Vz[t];if(o>4)s[i++]=65533,n+=o-1;else{t&=2===o?31:3===o?15:7;while(o>1&&n<r)t=t<<6|63&e[n++],o--;o>1?s[i++]=65533:t<65536?s[i++]=t:(t-=65536,s[i++]=55296|t>>10&1023,s[i++]=56320|1023&t)}}return Fz(s,i)},Kz=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;while(r>=0&&128===(192&e[r]))r--;return r<0||0===r?t:r+Vz[e[r]]>t?r:t},qz={string2buf:zz,buf2string:$z,utf8border:Kz};function Hz(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Gz=Hz;const Wz=Object.prototype.toString,{Z_NO_FLUSH:Yz,Z_SYNC_FLUSH:Jz,Z_FULL_FLUSH:Qz,Z_FINISH:Xz,Z_OK:Zz,Z_STREAM_END:eF,Z_DEFAULT_COMPRESSION:tF,Z_DEFAULT_STRATEGY:rF,Z_DEFLATED:nF}=Qj;function iF(e){this.options=Mz.assign({level:tF,method:nF,chunkSize:16384,windowBits:15,memLevel:8,strategy:rF},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Gz,this.strm.avail_out=0;let r=Nz.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==Zz)throw new Error(Jj[r]);if(t.header&&Nz.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"===typeof t.dictionary?qz.string2buf(t.dictionary):"[object ArrayBuffer]"===Wz.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,r=Nz.deflateSetDictionary(this.strm,e),r!==Zz)throw new Error(Jj[r]);this._dict_set=!0}}function sF(e,t){const r=new iF(t);if(r.push(e,!0),r.err)throw r.msg||Jj[r.err];return r.result}function oF(e,t){return t=t||{},t.raw=!0,sF(e,t)}function aF(e,t){return t=t||{},t.gzip=!0,sF(e,t)}iF.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let i,s;if(this.ended)return!1;for(s=t===~~t?t:!0===t?Xz:Yz,"string"===typeof e?r.input=qz.string2buf(e):"[object ArrayBuffer]"===Wz.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(s===Jz||s===Qz)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(i=Nz.deflate(r,s),i===eF)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=Nz.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Zz;if(0!==r.avail_out){if(s>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},iF.prototype.onData=function(e){this.chunks.push(e)},iF.prototype.onEnd=function(e){e===Zz&&(this.result=Mz.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var cF=iF,lF=sF,uF=oF,hF=aF,dF=Qj,fF={Deflate:cF,deflate:lF,deflateRaw:uF,gzip:hF,constants:dF};const pF=16209,yF=16191;var gF=function(e,t){let r,n,i,s,o,a,c,l,u,h,d,f,p,y,g,m,w,b,v,E,_,S,A,I;const C=e.state;r=e.next_in,A=e.input,n=r+(e.avail_in-5),i=e.next_out,I=e.output,s=i-(t-e.avail_out),o=i+(e.avail_out-257),a=C.dmax,c=C.wsize,l=C.whave,u=C.wnext,h=C.window,d=C.hold,f=C.bits,p=C.lencode,y=C.distcode,g=(1<<C.lenbits)-1,m=(1<<C.distbits)-1;e:do{f<15&&(d+=A[r++]<<f,f+=8,d+=A[r++]<<f,f+=8),w=p[d&g];t:for(;;){if(b=w>>>24,d>>>=b,f-=b,b=w>>>16&255,0===b)I[i++]=65535&w;else{if(!(16&b)){if(0===(64&b)){w=p[(65535&w)+(d&(1<<b)-1)];continue t}if(32&b){C.mode=yF;break e}e.msg="invalid literal/length code",C.mode=pF;break e}v=65535&w,b&=15,b&&(f<b&&(d+=A[r++]<<f,f+=8),v+=d&(1<<b)-1,d>>>=b,f-=b),f<15&&(d+=A[r++]<<f,f+=8,d+=A[r++]<<f,f+=8),w=y[d&m];r:for(;;){if(b=w>>>24,d>>>=b,f-=b,b=w>>>16&255,!(16&b)){if(0===(64&b)){w=y[(65535&w)+(d&(1<<b)-1)];continue r}e.msg="invalid distance code",C.mode=pF;break e}if(E=65535&w,b&=15,f<b&&(d+=A[r++]<<f,f+=8,f<b&&(d+=A[r++]<<f,f+=8)),E+=d&(1<<b)-1,E>a){e.msg="invalid distance too far back",C.mode=pF;break e}if(d>>>=b,f-=b,b=i-s,E>b){if(b=E-b,b>l&&C.sane){e.msg="invalid distance too far back",C.mode=pF;break e}if(_=0,S=h,0===u){if(_+=c-b,b<v){v-=b;do{I[i++]=h[_++]}while(--b);_=i-E,S=I}}else if(u<b){if(_+=c+u-b,b-=u,b<v){v-=b;do{I[i++]=h[_++]}while(--b);if(_=0,u<v){b=u,v-=b;do{I[i++]=h[_++]}while(--b);_=i-E,S=I}}}else if(_+=u-b,b<v){v-=b;do{I[i++]=h[_++]}while(--b);_=i-E,S=I}while(v>2)I[i++]=S[_++],I[i++]=S[_++],I[i++]=S[_++],v-=3;v&&(I[i++]=S[_++],v>1&&(I[i++]=S[_++]))}else{_=i-E;do{I[i++]=I[_++],I[i++]=I[_++],I[i++]=I[_++],v-=3}while(v>2);v&&(I[i++]=I[_++],v>1&&(I[i++]=I[_++]))}break}}break}}while(r<n&&i<o);v=f>>3,r-=v,f-=v<<3,d&=(1<<f)-1,e.next_in=r,e.next_out=i,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=i<o?o-i+257:257-(i-o),C.hold=d,C.bits=f};const mF=15,wF=852,bF=592,vF=0,EF=1,_F=2,SF=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),AF=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),IF=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),CF=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),kF=(e,t,r,n,i,s,o,a)=>{const c=a.bits;let l,u,h,d,f,p,y=0,g=0,m=0,w=0,b=0,v=0,E=0,_=0,S=0,A=0,I=null;const C=new Uint16Array(mF+1),k=new Uint16Array(mF+1);let T,R,P,x=null;for(y=0;y<=mF;y++)C[y]=0;for(g=0;g<n;g++)C[t[r+g]]++;for(b=c,w=mF;w>=1;w--)if(0!==C[w])break;if(b>w&&(b=w),0===w)return i[s++]=20971520,i[s++]=20971520,a.bits=1,0;for(m=1;m<w;m++)if(0!==C[m])break;for(b<m&&(b=m),_=1,y=1;y<=mF;y++)if(_<<=1,_-=C[y],_<0)return-1;if(_>0&&(e===vF||1!==w))return-1;for(k[1]=0,y=1;y<mF;y++)k[y+1]=k[y]+C[y];for(g=0;g<n;g++)0!==t[r+g]&&(o[k[t[r+g]]++]=g);if(e===vF?(I=x=o,p=20):e===EF?(I=SF,x=AF,p=257):(I=IF,x=CF,p=0),A=0,g=0,y=m,f=s,v=b,E=0,h=-1,S=1<<b,d=S-1,e===EF&&S>wF||e===_F&&S>bF)return 1;for(;;){T=y-E,o[g]+1<p?(R=0,P=o[g]):o[g]>=p?(R=x[o[g]-p],P=I[o[g]-p]):(R=96,P=0),l=1<<y-E,u=1<<v,m=u;do{u-=l,i[f+(A>>E)+u]=T<<24|R<<16|P|0}while(0!==u);l=1<<y-1;while(A&l)l>>=1;if(0!==l?(A&=l-1,A+=l):A=0,g++,0===--C[y]){if(y===w)break;y=t[r+o[g]]}if(y>b&&(A&d)!==h){0===E&&(E=b),f+=m,v=y-E,_=1<<v;while(v+E<w){if(_-=C[v+E],_<=0)break;v++,_<<=1}if(S+=1<<v,e===EF&&S>wF||e===_F&&S>bF)return 1;h=A&d,i[h]=b<<24|v<<16|f-s|0}}return 0!==A&&(i[f+A]=y-E<<24|64<<16|0),a.bits=b,0};var TF=kF;const RF=0,PF=1,xF=2,{Z_FINISH:DF,Z_BLOCK:OF,Z_TREES:NF,Z_OK:LF,Z_STREAM_END:BF,Z_NEED_DICT:UF,Z_STREAM_ERROR:MF,Z_DATA_ERROR:jF,Z_MEM_ERROR:VF,Z_BUF_ERROR:zF,Z_DEFLATED:FF}=Qj,$F=16180,KF=16181,qF=16182,HF=16183,GF=16184,WF=16185,YF=16186,JF=16187,QF=16188,XF=16189,ZF=16190,e$=16191,t$=16192,r$=16193,n$=16194,i$=16195,s$=16196,o$=16197,a$=16198,c$=16199,l$=16200,u$=16201,h$=16202,d$=16203,f$=16204,p$=16205,y$=16206,g$=16207,m$=16208,w$=16209,b$=16210,v$=16211,E$=852,_$=592,S$=15,A$=S$,I$=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function C$(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const k$=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<$F||t.mode>v$?1:0},T$=e=>{if(k$(e))return MF;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=$F,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(E$),t.distcode=t.distdyn=new Int32Array(_$),t.sane=1,t.back=-1,LF},R$=e=>{if(k$(e))return MF;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,T$(e)},P$=(e,t)=>{let r;if(k$(e))return MF;const n=e.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?MF:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,R$(e))},x$=(e,t)=>{if(!e)return MF;const r=new C$;e.state=r,r.strm=e,r.window=null,r.mode=$F;const n=P$(e,t);return n!==LF&&(e.state=null),n},D$=e=>x$(e,A$);let O$,N$,L$=!0;const B$=e=>{if(L$){O$=new Int32Array(512),N$=new Int32Array(32);let t=0;while(t<144)e.lens[t++]=8;while(t<256)e.lens[t++]=9;while(t<280)e.lens[t++]=7;while(t<288)e.lens[t++]=8;TF(PF,e.lens,0,288,O$,0,e.work,{bits:9}),t=0;while(t<32)e.lens[t++]=5;TF(xF,e.lens,0,32,N$,0,e.work,{bits:5}),L$=!1}e.lencode=O$,e.lenbits=9,e.distcode=N$,e.distbits=5},U$=(e,t,r,n)=>{let i;const s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>n&&(i=n),s.window.set(t.subarray(r-n,r-n+i),s.wnext),n-=i,n?(s.window.set(t.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},M$=(e,t)=>{let r,n,i,s,o,a,c,l,u,h,d,f,p,y,g,m,w,b,v,E,_,S,A=0;const I=new Uint8Array(4);let C,k;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(k$(e)||!e.output||!e.input&&0!==e.avail_in)return MF;r=e.state,r.mode===e$&&(r.mode=t$),o=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,n=e.input,a=e.avail_in,l=r.hold,u=r.bits,h=a,d=c,S=LF;e:for(;;)switch(r.mode){case $F:if(0===r.wrap){r.mode=t$;break}while(u<16){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}if(2&r.wrap&&35615===l){0===r.wbits&&(r.wbits=15),r.check=0,I[0]=255&l,I[1]=l>>>8&255,r.check=Yj(r.check,I,2,0),l=0,u=0,r.mode=KF;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",r.mode=w$;break}if((15&l)!==FF){e.msg="unknown compression method",r.mode=w$;break}if(l>>>=4,u-=4,_=8+(15&l),0===r.wbits&&(r.wbits=_),_>15||_>r.wbits){e.msg="invalid window size",r.mode=w$;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&l?XF:e$,l=0,u=0;break;case KF:while(u<16){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}if(r.flags=l,(255&r.flags)!==FF){e.msg="unknown compression method",r.mode=w$;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=w$;break}r.head&&(r.head.text=l>>8&1),512&r.flags&&4&r.wrap&&(I[0]=255&l,I[1]=l>>>8&255,r.check=Yj(r.check,I,2,0)),l=0,u=0,r.mode=qF;case qF:while(u<32){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}r.head&&(r.head.time=l),512&r.flags&&4&r.wrap&&(I[0]=255&l,I[1]=l>>>8&255,I[2]=l>>>16&255,I[3]=l>>>24&255,r.check=Yj(r.check,I,4,0)),l=0,u=0,r.mode=HF;case HF:while(u<16){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}r.head&&(r.head.xflags=255&l,r.head.os=l>>8),512&r.flags&&4&r.wrap&&(I[0]=255&l,I[1]=l>>>8&255,r.check=Yj(r.check,I,2,0)),l=0,u=0,r.mode=GF;case GF:if(1024&r.flags){while(u<16){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}r.length=l,r.head&&(r.head.extra_len=l),512&r.flags&&4&r.wrap&&(I[0]=255&l,I[1]=l>>>8&255,r.check=Yj(r.check,I,2,0)),l=0,u=0}else r.head&&(r.head.extra=null);r.mode=WF;case WF:if(1024&r.flags&&(f=r.length,f>a&&(f=a),f&&(r.head&&(_=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+f),_)),512&r.flags&&4&r.wrap&&(r.check=Yj(r.check,n,f,s)),a-=f,s+=f,r.length-=f),r.length))break e;r.length=0,r.mode=YF;case YF:if(2048&r.flags){if(0===a)break e;f=0;do{_=n[s+f++],r.head&&_&&r.length<65536&&(r.head.name+=String.fromCharCode(_))}while(_&&f<a);if(512&r.flags&&4&r.wrap&&(r.check=Yj(r.check,n,f,s)),a-=f,s+=f,_)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=JF;case JF:if(4096&r.flags){if(0===a)break e;f=0;do{_=n[s+f++],r.head&&_&&r.length<65536&&(r.head.comment+=String.fromCharCode(_))}while(_&&f<a);if(512&r.flags&&4&r.wrap&&(r.check=Yj(r.check,n,f,s)),a-=f,s+=f,_)break e}else r.head&&(r.head.comment=null);r.mode=QF;case QF:if(512&r.flags){while(u<16){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}if(4&r.wrap&&l!==(65535&r.check)){e.msg="header crc mismatch",r.mode=w$;break}l=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=e$;break;case XF:while(u<32){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}e.adler=r.check=I$(l),l=0,u=0,r.mode=ZF;case ZF:if(0===r.havedict)return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=a,r.hold=l,r.bits=u,UF;e.adler=r.check=1,r.mode=e$;case e$:if(t===OF||t===NF)break e;case t$:if(r.last){l>>>=7&u,u-=7&u,r.mode=y$;break}while(u<3){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}switch(r.last=1&l,l>>>=1,u-=1,3&l){case 0:r.mode=r$;break;case 1:if(B$(r),r.mode=c$,t===NF){l>>>=2,u-=2;break e}break;case 2:r.mode=s$;break;case 3:e.msg="invalid block type",r.mode=w$}l>>>=2,u-=2;break;case r$:l>>>=7&u,u-=7&u;while(u<32){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}if((65535&l)!==(l>>>16^65535)){e.msg="invalid stored block lengths",r.mode=w$;break}if(r.length=65535&l,l=0,u=0,r.mode=n$,t===NF)break e;case n$:r.mode=i$;case i$:if(f=r.length,f){if(f>a&&(f=a),f>c&&(f=c),0===f)break e;i.set(n.subarray(s,s+f),o),a-=f,s+=f,c-=f,o+=f,r.length-=f;break}r.mode=e$;break;case s$:while(u<14){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}if(r.nlen=257+(31&l),l>>>=5,u-=5,r.ndist=1+(31&l),l>>>=5,u-=5,r.ncode=4+(15&l),l>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=w$;break}r.have=0,r.mode=o$;case o$:while(r.have<r.ncode){while(u<3){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}r.lens[T[r.have++]]=7&l,l>>>=3,u-=3}while(r.have<19)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,C={bits:r.lenbits},S=TF(RF,r.lens,0,19,r.lencode,0,r.work,C),r.lenbits=C.bits,S){e.msg="invalid code lengths set",r.mode=w$;break}r.have=0,r.mode=a$;case a$:while(r.have<r.nlen+r.ndist){for(;;){if(A=r.lencode[l&(1<<r.lenbits)-1],g=A>>>24,m=A>>>16&255,w=65535&A,g<=u)break;if(0===a)break e;a--,l+=n[s++]<<u,u+=8}if(w<16)l>>>=g,u-=g,r.lens[r.have++]=w;else{if(16===w){k=g+2;while(u<k){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}if(l>>>=g,u-=g,0===r.have){e.msg="invalid bit length repeat",r.mode=w$;break}_=r.lens[r.have-1],f=3+(3&l),l>>>=2,u-=2}else if(17===w){k=g+3;while(u<k){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}l>>>=g,u-=g,_=0,f=3+(7&l),l>>>=3,u-=3}else{k=g+7;while(u<k){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}l>>>=g,u-=g,_=0,f=11+(127&l),l>>>=7,u-=7}if(r.have+f>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=w$;break}while(f--)r.lens[r.have++]=_}}if(r.mode===w$)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=w$;break}if(r.lenbits=9,C={bits:r.lenbits},S=TF(PF,r.lens,0,r.nlen,r.lencode,0,r.work,C),r.lenbits=C.bits,S){e.msg="invalid literal/lengths set",r.mode=w$;break}if(r.distbits=6,r.distcode=r.distdyn,C={bits:r.distbits},S=TF(xF,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,C),r.distbits=C.bits,S){e.msg="invalid distances set",r.mode=w$;break}if(r.mode=c$,t===NF)break e;case c$:r.mode=l$;case l$:if(a>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=a,r.hold=l,r.bits=u,gF(e,d),o=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,n=e.input,a=e.avail_in,l=r.hold,u=r.bits,r.mode===e$&&(r.back=-1);break}for(r.back=0;;){if(A=r.lencode[l&(1<<r.lenbits)-1],g=A>>>24,m=A>>>16&255,w=65535&A,g<=u)break;if(0===a)break e;a--,l+=n[s++]<<u,u+=8}if(m&&0===(240&m)){for(b=g,v=m,E=w;;){if(A=r.lencode[E+((l&(1<<b+v)-1)>>b)],g=A>>>24,m=A>>>16&255,w=65535&A,b+g<=u)break;if(0===a)break e;a--,l+=n[s++]<<u,u+=8}l>>>=b,u-=b,r.back+=b}if(l>>>=g,u-=g,r.back+=g,r.length=w,0===m){r.mode=p$;break}if(32&m){r.back=-1,r.mode=e$;break}if(64&m){e.msg="invalid literal/length code",r.mode=w$;break}r.extra=15&m,r.mode=u$;case u$:if(r.extra){k=r.extra;while(u<k){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=h$;case h$:for(;;){if(A=r.distcode[l&(1<<r.distbits)-1],g=A>>>24,m=A>>>16&255,w=65535&A,g<=u)break;if(0===a)break e;a--,l+=n[s++]<<u,u+=8}if(0===(240&m)){for(b=g,v=m,E=w;;){if(A=r.distcode[E+((l&(1<<b+v)-1)>>b)],g=A>>>24,m=A>>>16&255,w=65535&A,b+g<=u)break;if(0===a)break e;a--,l+=n[s++]<<u,u+=8}l>>>=b,u-=b,r.back+=b}if(l>>>=g,u-=g,r.back+=g,64&m){e.msg="invalid distance code",r.mode=w$;break}r.offset=w,r.extra=15&m,r.mode=d$;case d$:if(r.extra){k=r.extra;while(u<k){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=w$;break}r.mode=f$;case f$:if(0===c)break e;if(f=d-c,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=w$;break}f>r.wnext?(f-=r.wnext,p=r.wsize-f):p=r.wnext-f,f>r.length&&(f=r.length),y=r.window}else y=i,p=o-r.offset,f=r.length;f>c&&(f=c),c-=f,r.length-=f;do{i[o++]=y[p++]}while(--f);0===r.length&&(r.mode=l$);break;case p$:if(0===c)break e;i[o++]=r.length,c--,r.mode=l$;break;case y$:if(r.wrap){while(u<32){if(0===a)break e;a--,l|=n[s++]<<u,u+=8}if(d-=c,e.total_out+=d,r.total+=d,4&r.wrap&&d&&(e.adler=r.check=r.flags?Yj(r.check,i,d,o-d):qj(r.check,i,d,o-d)),d=c,4&r.wrap&&(r.flags?l:I$(l))!==r.check){e.msg="incorrect data check",r.mode=w$;break}l=0,u=0}r.mode=g$;case g$:if(r.wrap&&r.flags){while(u<32){if(0===a)break e;a--,l+=n[s++]<<u,u+=8}if(4&r.wrap&&l!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=w$;break}l=0,u=0}r.mode=m$;case m$:S=BF;break e;case w$:S=jF;break e;case b$:return VF;case v$:default:return MF}return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=a,r.hold=l,r.bits=u,(r.wsize||d!==e.avail_out&&r.mode<w$&&(r.mode<y$||t!==DF))&&U$(e,e.output,e.next_out,d-e.avail_out),h-=e.avail_in,d-=e.avail_out,e.total_in+=h,e.total_out+=d,r.total+=d,4&r.wrap&&d&&(e.adler=r.check=r.flags?Yj(r.check,i,d,e.next_out-d):qj(r.check,i,d,e.next_out-d)),e.data_type=r.bits+(r.last?64:0)+(r.mode===e$?128:0)+(r.mode===c$||r.mode===n$?256:0),(0===h&&0===d||t===DF)&&S===LF&&(S=zF),S},j$=e=>{if(k$(e))return MF;let t=e.state;return t.window&&(t.window=null),e.state=null,LF},V$=(e,t)=>{if(k$(e))return MF;const r=e.state;return 0===(2&r.wrap)?MF:(r.head=t,t.done=!1,LF)},z$=(e,t)=>{const r=t.length;let n,i,s;return k$(e)?MF:(n=e.state,0!==n.wrap&&n.mode!==ZF?MF:n.mode===ZF&&(i=1,i=qj(i,t,r,0),i!==n.check)?jF:(s=U$(e,t,r,r),s?(n.mode=b$,VF):(n.havedict=1,LF)))};var F$=R$,$$=P$,K$=T$,q$=D$,H$=x$,G$=M$,W$=j$,Y$=V$,J$=z$,Q$="pako inflate (from Nodeca project)",X$={inflateReset:F$,inflateReset2:$$,inflateResetKeep:K$,inflateInit:q$,inflateInit2:H$,inflate:G$,inflateEnd:W$,inflateGetHeader:Y$,inflateSetDictionary:J$,inflateInfo:Q$};function Z$(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var eK=Z$;const tK=Object.prototype.toString,{Z_NO_FLUSH:rK,Z_FINISH:nK,Z_OK:iK,Z_STREAM_END:sK,Z_NEED_DICT:oK,Z_STREAM_ERROR:aK,Z_DATA_ERROR:cK,Z_MEM_ERROR:lK}=Qj;function uK(e){this.options=Mz.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Gz,this.strm.avail_out=0;let r=X$.inflateInit2(this.strm,t.windowBits);if(r!==iK)throw new Error(Jj[r]);if(this.header=new eK,X$.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"===typeof t.dictionary?t.dictionary=qz.string2buf(t.dictionary):"[object ArrayBuffer]"===tK.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=X$.inflateSetDictionary(this.strm,t.dictionary),r!==iK)))throw new Error(Jj[r])}function hK(e,t){const r=new uK(t);if(r.push(e),r.err)throw r.msg||Jj[r.err];return r.result}function dK(e,t){return t=t||{},t.raw=!0,hK(e,t)}uK.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(o=t===~~t?t:!0===t?nK:rK,"[object ArrayBuffer]"===tK.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=X$.inflate(r,o),s===oK&&i&&(s=X$.inflateSetDictionary(r,i),s===iK?s=X$.inflate(r,o):s===cK&&(s=oK));while(r.avail_in>0&&s===sK&&r.state.wrap>0&&0!==e[r.next_in])X$.inflateReset(r),s=X$.inflate(r,o);switch(s){case aK:case cK:case oK:case lK:return this.onEnd(s),this.ended=!0,!1}if(a=r.avail_out,r.next_out&&(0===r.avail_out||s===sK))if("string"===this.options.to){let e=qz.utf8border(r.output,r.next_out),t=r.next_out-e,i=qz.buf2string(r.output,e);r.next_out=t,r.avail_out=n-t,t&&r.output.set(r.output.subarray(e,e+t),0),this.onData(i)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(s!==iK||0!==a){if(s===sK)return s=X$.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},uK.prototype.onData=function(e){this.chunks.push(e)},uK.prototype.onEnd=function(e){e===iK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Mz.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var fK=uK,pK=hK,yK=dK,gK=hK,mK=Qj,wK={Inflate:fK,inflate:pK,inflateRaw:yK,ungzip:gK,constants:mK};const{Deflate:bK,deflate:vK,deflateRaw:EK,gzip:_K}=fF,{Inflate:SK,inflate:AK,inflateRaw:IK,ungzip:CK}=wK;var kK=bK,TK=vK,RK=EK,PK=_K,xK=SK,DK=AK,OK=IK,NK=CK,LK=Qj,BK={Deflate:kK,deflate:TK,deflateRaw:RK,gzip:PK,Inflate:xK,inflate:DK,inflateRaw:OK,ungzip:NK,constants:LK},UK=r(3053);const MK=6;function jK({repo:e,preload:t}){async function*r(r,n={}){if(null!=n.compressionLevel&&(n.compressionLevel<-1||n.compressionLevel>9))throw mn(new Error("Compression level must be between -1 and 9"),"ERR_INVALID_PARAMS");if(!1!==n.preload){let e;try{e=jw(r).split("/")}catch(WV){throw mn(WV,"ERR_INVALID_PATH")}t(ji.parse(e[0]))}const i=ji.asCID(r)||r,s=await zL(i,e.blocks,n);if("file"===s.type||"raw"===s.type){const e=[];return n.compress&&!0!==n.archive?e.push(s.content):e.push([{header:{name:s.path,mode:"file"===s.type&&s.unixfs.mode,mtime:"file"===s.type&&s.unixfs.mtime?new Date(1e3*s.unixfs.mtime.secs):void 0,size:s.size,type:"file"},body:s.content()}],CM(),(e=>qR(e,(e=>e.slice())))),n.compress&&e.push((async function*(e){const t=await UK(e);yield BK.gzip(t,{level:n.compressionLevel||MK})})),void(yield*QR(...e))}if("directory"!==s.type)throw mn(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");{const t=[FL(i,e.blocks,n),async function*(e){for await(const t of e){const e={header:{name:t.path,size:t.size}};if("file"===t.type)e.header.type="file",e.header.mode=null!=t.unixfs.mode?t.unixfs.mode:void 0,e.header.mtime=t.unixfs.mtime?new Date(1e3*t.unixfs.mtime.secs):void 0,e.body=t.content();else if("raw"===t.type)e.header.type="file",e.body=t.content();else{if("directory"!==t.type)throw mn(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");e.header.type="directory",e.header.mode=null!=t.unixfs.mode?t.unixfs.mode:void 0,e.header.mtime=t.unixfs.mtime?new Date(1e3*t.unixfs.mtime.secs):void 0}yield e}},CM(),e=>qR(e,(e=>e.slice()))];if(n.compress){if(!n.archive)throw mn(new Error("file is not regular"),"ERR_INVALID_PATH");n.compress&&t.push((async function*(e){const t=await UK(e);yield BK.gzip(t,{level:n.compressionLevel||MK})}))}yield*QR(...t)}}return xw(r)}function VK({repo:e,preload:t}){async function*r(r,n={}){const i=jw(r),s=i.split("/");!1!==n.preload&&t(ji.parse(s[0]));const o=ji.asCID(i)||i,a=await zL(o,e.blocks,n);if("file"!==a.type){if("directory"!==a.type)throw mn(new Error(`Unknown UnixFS type ${a.type}`),"ERR_UNKNOWN_UNIXFS_TYPE");for await(const e of a.content())yield zw(e)}else yield zw(a)}return xw(r)}class zK{constructor({preload:e,repo:t,hashers:r,options:n}){const i=tL({preload:e,repo:t,options:n,hashers:r});this.addAll=i,this.add=Dx({addAll:i}),this.cat=$L({repo:t,preload:e}),this.get=jK({repo:t,preload:e}),this.ls=VK({repo:t,preload:e})}}const FK="0.16.1",$K="d1f1e75b2060c5c2e64d133a7a6bbabd2641e5ef",KK="^0.156.1";function qK({repo:e}){async function t(t={}){const r=await e.version.get();return{version:FK,commit:$K,repo:`${r}`,"ipfs-core":FK,"interface-ipfs-core":KK}}return xw(t)}const HK=gn("ipfs:components:id");function GK({peerId:e,network:t}){async function r(r={}){const n=t.try();if(!n){if(r.peerId)throw new jl;if(null==e.publicKey)throw mn(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");return{id:e,publicKey:C_(e.publicKey,"base64pad"),addresses:[],agentVersion:`js-ipfs/${FK}`,protocolVersion:"9000",protocols:[]}}const{libp2p:i}=n,s=r.peerId?r.peerId:e,o=await WK(s,i,r),a=C_(o.metadata.get("AgentVersion")||new Uint8Array),c=C_(o.metadata.get("ProtocolVersion")||new Uint8Array),l=o.id.toString(),u=o.publicKey?C_(o.publicKey,"base64pad"):"";return{id:s,publicKey:u,addresses:(o.addresses||[]).map((e=>{const t=e.toString();return t.endsWith(`/p2p/${l}`)?t:`${t}/p2p/${l}`})).sort().map((e=>Pp(e))),agentVersion:a,protocolVersion:c,protocols:(o.protocols||[]).sort()}}return xw(r)}async function WK(e,t,r){let n=await t.peerStore.get(e);n||(n=await YK(e,t,r));let i=e.publicKey?e.publicKey:await t.peerStore.keyBook.get(e);if(null==i)try{i=await t.getPublicKey(e,r)}catch(WV){HK.error("Could not load public key for",e.toString(),WV)}return{...n,publicKey:i,metadata:n.metadata||new Map,addresses:n.addresses.map((e=>e.multiaddr))}}async function YK(e,t,r){if(null==t.dht)throw mn(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");for await(const i of t.dht.findPeer(e,r))if("FINAL_PEER"===i.name)break;const n=await t.peerStore.get(e);if(!n)throw mn(new Error("Could not find peer"),"ERR_NOT_FOUND");return n}var JK=QK;function QK(e,t,r){var n,i,s;if(Array.isArray(t)&&(n=t.slice(0)),"string"==typeof t&&(n=t.split(".")),"symbol"==typeof t&&(n=[t]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");if(i=n.pop(),!i)return!1;XK(i);while(s=n.shift())if(XK(s),"undefined"==typeof e[s]&&(e[s]={}),e=e[s],!e||"object"!=typeof e)return!1;return e[i]=r,!0}function XK(e){if("__proto__"==e||"constructor"==e||"prototype"==e)throw new Error("setting of prototype values not supported")}const ZK={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:e=>(JK(e,"Discovery.MDNS.Enabled",!1),JK(e,"Discovery.webRTCStar.Enabled",!1),e.Swarm={...e.Swarm||{},DisableNatPortMap:!0},e)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:e=>(JK(e,"Discovery.MDNS.Enabled",!0),JK(e,"Discovery.webRTCStar.Enabled",!0),JK(e,"Swarm",{...e.Swarm||{},DisableNatPortMap:!1}),e)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:e=>{const t=ax();return JK(e,"Addresses.API",t.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),JK(e,"Addresses.Gateway",t.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),JK(e,"Addresses.Swarm",t.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),JK(e,"Addresses.Delegates",[]),JK(e,"Bootstrap",[]),JK(e,"Discovery.MDNS.Enabled",!1),JK(e,"Discovery.webRTCStar.Enabled",!1),JK(e,"Swarm",{...e.Swarm||{},DisableNatPortMap:!0}),e}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:e=>{const t=ax();return JK(e,"Addresses.API",t.Addresses.API),JK(e,"Addresses.Gateway",t.Addresses.Gateway),JK(e,"Addresses.Swarm",t.Addresses.Swarm),JK(e,"Addresses.Delegates",t.Addresses.Delegates),JK(e,"Bootstrap",t.Bootstrap),JK(e,"Discovery.MDNS.Enabled",t.Discovery.MDNS.Enabled),JK(e,"Discovery.webRTCStar.Enabled",t.Discovery.webRTCStar.Enabled),JK(e,"Swarm",{...e.Swarm||{},DisableNatPortMap:!1}),e}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:e=>{const t=e.Swarm||{},r=t.ConnMgr||{};return r.LowWater=20,r.HighWater=40,t.ConnMgr=r,e.Swarm=t,e}},"default-power":{description:'Inverse of "lowpower" profile.',transform:e=>{const t=ax();return e.Swarm=t.Swarm,e}}},eq=gn("ipfs:core:config");function tq({repo:e}){return{getAll:xw(t),get:xw(r),set:xw(n),replace:xw(i),profiles:{apply:xw(s),list:xw(rq)}};async function t(t={}){return e.config.getAll(t)}async function r(t,r){return t?e.config.get(t,r):Promise.reject(new Error("key argument is required"))}async function n(t,r,n){return e.config.set(t,r,n)}async function i(t,r){return e.config.replace(t,r)}async function s(t,r={dryRun:!1}){const{dryRun:n}=r,i=ZK[t];if(!i)throw new Error(`No profile with name '${t}' exists`);try{const t=await e.config.getAll(r);let s=JSON.parse(JSON.stringify(t));return s=i.transform(s),n||await e.config.replace(s,r),delete t.Identity.PrivKey,delete s.Identity.PrivKey,{original:t,updated:s}}catch(WV){throw eq(WV),new Error(`Could not apply profile '${t}' to config: ${WV.message}`)}}}async function rq(e){return Object.keys(ZK).map((e=>({name:e,description:ZK[e].description})))}const nq=({enumerable:e=!0,configurable:t=!1}={})=>({enumerable:e,configurable:t,writable:!1}),iq=function*(e,t){if(null!=e&&!(e instanceof Uint8Array))for(const[r,n]of Object.entries(e)){const e=[...t,r];if(null!=n&&"object"===typeof n)if(Array.isArray(n))for(const[t,r]of n.entries()){const n=[...e,t],i=ji.asCID(r);i?yield[n.join("/"),i]:"object"===typeof r&&(yield*iq(r,n))}else{const t=ji.asCID(n);t?yield[e.join("/"),t]:yield*iq(n,e)}}},sq=function*(e,t){if(null!=e)for(const[r,n]of Object.entries(e)){const e=[...t,r];if(yield e.join("/"),null!=n&&!(n instanceof Uint8Array)&&"object"===typeof n&&!ji.asCID(n))if(Array.isArray(n))for(const[t,r]of n.entries()){const n=[...e,t];yield n.join("/"),"object"!==typeof r||ji.asCID(r)||(yield*sq(r,n))}else yield*sq(n,e)}},oq=(e,t)=>{let r=e;for(const[n,i]of t.entries()){if(r=r[i],null==r)throw new Error(`Object has no property at ${t.slice(0,n+1).map((e=>`[${JSON.stringify(e)}]`)).join("")}`);const e=ji.asCID(r);if(e)return{value:e,remaining:t.slice(n+1).join("/")}}return{value:r}};class aq{constructor({cid:e,bytes:t,value:r}){if(!e||!t||"undefined"===typeof r)throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=r,this.asBlock=this,Object.defineProperties(this,{cid:nq(),bytes:nq(),value:nq(),asBlock:nq()})}links(){return iq(this.value,[])}tree(){return sq(this.value,[])}get(e="/"){return oq(this.value,e.split("/").filter(Boolean))}}const cq=({bytes:e,cid:t,value:r,codec:n})=>{const i=void 0!==r?r:n&&n.decode(e);if(void 0===i)throw new Error('Missing required argument, must either provide "value" or "codec"');return new aq({cid:t,bytes:e,value:i})};function lq(e){const t=cc({version:1,roots:e}),r=Of.encode(t.length),n=new Uint8Array(r.length+t.length);return n.set(r,0),n.set(t,r.length),n}function uq(e){return{async setRoots(t){const r=lq(t);await e.write(r)},async writeBlock(t){const{cid:r,bytes:n}=t;await e.write(new Uint8Array(Of.encode(r.bytes.length+n.length))),await e.write(r.bytes),n.length&&await e.write(n)},async close(){await e.end()}}}function hq(){}function dq(){const e=[];let t=null,r=hq,n=!1,i=null,s=hq;const o=()=>(t||(t=new Promise((e=>{r=()=>{t=null,r=hq,e()}}))),t),a={write(t){e.push(t);const r=o();return s(),r},async end(){n=!0;const e=o();s(),await e}},c={async next(){const t=e.shift();return t?(0===e.length&&r(),{done:!1,value:t}):n?(r(),{done:!0,value:void 0}):(i||(i=new Promise((e=>{s=()=>(i=null,s=hq,e(c.next()))}))),i)}};return{writer:a,iterator:c}}const fq={Null:e=>null===e,Int:e=>Number.isInteger(e),Float:e=>"number"===typeof e&&Number.isFinite(e),String:e=>"string"===typeof e,Bool:e=>"boolean"===typeof e,Bytes:e=>e instanceof Uint8Array,Link:e=>!fq.Null(e)&&"object"===typeof e&&e.asCID===e,List:e=>Array.isArray(e),Map:e=>!fq.Null(e)&&"object"===typeof e&&e.asCID!==e&&!fq.List(e)&&!fq.Bytes(e)},pq={Int:fq.Int,"CarHeader > version":e=>pq.Int(e),"CarHeader > roots (anon) > valueType (anon)":fq.Link,"CarHeader > roots (anon)":e=>fq.List(e)&&Array.prototype.every.call(e,pq["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":e=>pq["CarHeader > roots (anon)"](e),CarHeader:e=>{const t=e&&Object.keys(e);return fq.Map(e)&&["version"].every((e=>t.includes(e)))&&Object.entries(e).every((([e,t])=>pq["CarHeader > "+e]&&pq["CarHeader > "+e](t)))}},yq=pq.CarHeader,gq={SHA2_256:18,LENGTH:32,DAG_PB:112},mq=40;async function wq(e){const t=await e.upTo(8);if(!t.length)throw new Error("Unexpected end of data");const r=Of.decode(t);return e.seek(Of.decode.bytes),r}async function bq(e){const t=await e.exactly(mq),r=new DataView(t.buffer,t.byteOffset,t.byteLength);let n=0;const i={version:2,characteristics:[r.getBigUint64(n,!0),r.getBigUint64(n+=8,!0)],dataOffset:Number(r.getBigUint64(n+=8,!0)),dataSize:Number(r.getBigUint64(n+=8,!0)),indexOffset:Number(r.getBigUint64(n+=8,!0))};return e.seek(mq),i}async function vq(e,t){const r=await wq(e);if(0===r)throw new Error("Invalid CAR header (zero length)");const n=await e.exactly(r);e.seek(r);const i=lc(n);if(!yq(i))throw new Error("Invalid CAR header format");if(1!==i.version&&2!==i.version||void 0!==t&&i.version!==t)throw new Error(`Invalid CAR version: ${i.version}${void 0!==t?` (expected ${t})`:""}`);const s=Array.isArray(i.roots);if(1===i.version&&!s||2===i.version&&s)throw new Error("Invalid CAR header format");if(1===i.version)return i;const o=await bq(e);e.seek(o.dataOffset-e.pos);const a=await vq(e,1);return Object.assign(a,o)}async function Eq(e){const t=await e.upTo(8);Of.decode(t);const r=Of.decode.bytes,n=Of.decode(t.subarray(Of.decode.bytes)),i=Of.decode.bytes,s=r+i+n,o=await e.exactly(s);return e.seek(s),o}async function _q(e){const t=await e.exactly(2);if(t[0]===gq.SHA2_256&&t[1]===gq.LENGTH){const t=await e.exactly(34);e.seek(34);const r=hi(t);return ji.create(0,gq.DAG_PB,r)}const r=await wq(e);if(1!==r)throw new Error(`Unexpected CID version (${r})`);const n=await wq(e),i=await Eq(e),s=hi(i);return ji.create(r,n,s)}async function Sq(e){const t=e.pos;let r=await wq(e);if(0===r)throw new Error("Invalid CAR section (zero length)");r+=e.pos-t;const n=await _q(e),i=r-Number(e.pos-t);return{cid:n,length:r,blockLength:i}}async function Aq(e){const{cid:t,blockLength:r}=await Sq(e),n=await e.exactly(r);return e.seek(r),{bytes:n,cid:t}}async function Iq(e){const t=e.pos,{cid:r,length:n,blockLength:i}=await Sq(e),s={cid:r,length:n,blockLength:i,offset:t,blockOffset:e.pos};return e.seek(s.blockLength),s}function Cq(e){const t=(async()=>{const t=await vq(e);if(2===t.version){const r=e.pos-t.dataOffset;e=Pq(e,t.dataSize-r)}return t})();return{header:()=>t,async*blocks(){await t;while((await e.upTo(8)).length>0)yield await Aq(e)},async*blocksIndex(){await t;while((await e.upTo(8)).length>0)yield await Iq(e)}}}function kq(e){let t=0;return{async upTo(r){return e.subarray(t,t+Math.min(r,e.length-t))},async exactly(r){if(r>e.length-t)throw new Error("Unexpected end of data");return e.subarray(t,t+r)},seek(e){t+=e},get pos(){return t}}}function Tq(e){let t=0,r=0,n=0,i=new Uint8Array(0);const s=async t=>{r=i.length-n;const s=[i.subarray(n)];while(r<t){const t=await e();if(null==t)break;r<0?t.length>r&&s.push(t.subarray(-r)):s.push(t),r+=t.length}i=new Uint8Array(s.reduce(((e,t)=>e+t.length),0));let o=0;for(const e of s)i.set(e,o),o+=e.length;n=0};return{async upTo(e){return i.length-n<e&&await s(e),i.subarray(n,n+Math.min(i.length-n,e))},async exactly(e){if(i.length-n<e&&await s(e),i.length-n<e)throw new Error("Unexpected end of data");return i.subarray(n,n+e)},seek(e){t+=e,n+=e},get pos(){return t}}}function Rq(e){const t=e[Symbol.asyncIterator]();async function r(){const e=await t.next();return e.done?null:e.value}return Tq(r)}function Pq(e,t){let r=0;return{async upTo(n){let i=await e.upTo(n);return i.length+r>t&&(i=i.subarray(0,t-r)),i},async exactly(n){const i=await e.exactly(n);if(i.length+r>t)throw new Error("Unexpected end of data");return i},seek(t){r+=t,e.seek(t)},get pos(){return e.pos}}}class xq{constructor(e,t){this._encoder=t,this._mutex=t.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array)||!e.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");const t=ji.asCID(e.cid);if(!t)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then((()=>this._encoder.writeBlock({cid:t,bytes:e.bytes}))),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=Nq(e);const{encoder:t,iterator:r}=Oq(),n=new xq(e,t),i=new Dq(r);return{writer:n,out:i}}static createAppender(){const{encoder:e,iterator:t}=Oq();e.setRoots=()=>Promise.resolve();const r=new xq([],e),n=new Dq(t);return{writer:r,out:n}}static async updateRootsInBytes(e,t){const r=kq(e);await vq(r);const n=lq(t);if(Number(r.pos)!==n.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${r.pos} bytes, new header is ${n.length} bytes)`);return e.set(n,0),e}}class Dq{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}}function Oq(){const e=dq(),{writer:t,iterator:r}=e,n=uq(t);return{encoder:n,iterator:r}}function Nq(e){if(void 0===e)return[];if(!Array.isArray(e)){const t=ji.asCID(e);if(!t)throw new TypeError("roots must be a single CID or an array of CIDs");return[t]}const t=[];for(const r of e){const e=ji.asCID(r);if(!e)throw new TypeError("roots must be a single CID or an array of CIDs");t.push(e)}return t}const Lq=async({cid:e,load:t,seen:r})=>{r=r||new Set;const n=e.toString(Ti);if(r.has(n))return;const i=await t(e);if(r.add(n),null!==i)for(const[,s]of i.links())await Lq({cid:s,load:t,seen:r})},Bq=gn("ipfs:components:dag:import"),Uq=[Sl,Rl];function Mq({repo:e,preload:t,codecs:r}){async function*n(n,i={}){!1!==i.preload&&t(n);const s=ji.asCID(n);if(!s)throw new Error(`Unexpected error converting CID type: ${n}`);Bq(`Exporting ${s} as car`);const{writer:o,out:a}=await xq.create([s]);let c=null;(async()=>{try{const t=jq(e,o,{signal:i.signal,timeout:i.timeout},r);await Lq({cid:s,load:t})}catch(t){c=t}finally{o.close()}})();for await(const e of a){if(c)break;yield e}if(c)throw c}return xw(n)}function jq(e,t,r,n){return async i=>{const s=await n.getCodec(i.code);if(!s)throw new Error(`Can't decode links in block with codec 0x${i.code.toString(16)} to form complete DAG`);const o=await e.blocks.get(i,r);return Bq(`Adding block ${i} to car`),await t.put({cid:i,bytes:o}),Uq.includes(i.code)?null:cq({bytes:o,cid:i,codec:s})}}var Vq=r(80);function zq({codecs:e,repo:t,preload:r}){const n=async function(n,i={}){if(!1!==i.preload&&r(n),i.path){const r=i.localResolve?await Vq($w(n,i.path,e,t,i)):await h_($w(n,i.path,e,t,i)),s=r;if(!s)throw mn(new Error("Not found"),"ERR_NOT_FOUND");return s}const s=await e.getCodec(n.code),o=await t.blocks.get(n,i),a=s.decode(o);return{value:a,remainderPath:""}};return xw(n)}class Fq{constructor(e,t,r){this._version=e,this._roots=t,this._iterable=r,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}}class $q extends Fq{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){const{version:t,roots:r,iterator:n}=await qq(e);return new $q(t,r,n)}static async fromIterable(e){const{version:t,roots:r,iterator:n}=await Hq(e);return new $q(t,r,n)}}class Kq extends(null){[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");this._decoded=!0;const e=this._iterable[Symbol.asyncIterator]();return{async next(){const t=await e.next();return t.done?t:{done:!1,value:t.value.cid}}}}static async fromBytes(e){const{version:t,roots:r,iterator:n}=await qq(e);return new Kq(t,r,n)}static async fromIterable(e){const{version:t,roots:r,iterator:n}=await Hq(e);return new Kq(t,r,n)}}async function qq(e){if(!(e instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return Gq(kq(e))}async function Hq(e){if(!e||"function"!==typeof e[Symbol.asyncIterator])throw new TypeError("fromIterable() requires an async iterable");return Gq(Rq(e))}async function Gq(e){const t=Cq(e),{version:r,roots:n}=await t.header();return{version:r,roots:n,iterator:t.blocks()}}const Wq=gn("ipfs:components:dag:import");function Yq({repo:e}){async function*t(t,r={}){const n=await e.gcLock.readLock();try{const i={signal:r.signal,timeout:r.timeout},s=Ex(t),{value:o,done:a}=await s.peek();if(a)return;let c;o&&s.push(o),c=o instanceof Uint8Array?[s]:s;for await(const t of c){const n=await Jq(e,i,t);if(!1!==r.pinRoots)for(const t of n){let r="";try{await e.blocks.has(t)?(Wq(`Pinning root ${t}`),await e.pins.pinRecursively(t)):r="blockstore: block not found"}catch(WV){r=WV.message}yield{root:{cid:t,pinErrorMsg:r}}}}}finally{n()}}return xw(t)}async function Jq(e,t,r){const n=await $q.fromIterable(r),i=await n.getRoots();return await RR(e.blocks.putMany(qR(n,(({cid:e,bytes:t})=>(Wq(`Import block ${e}`),{key:e,value:t}))),{signal:t.signal})),i}function Qq({repo:e,codecs:t,hashers:r,preload:n}){async function i(i,s={}){const o=s.pin?await e.gcLock.readLock():null;try{const a=await t.getCodec(s.storeCodec||"dag-cbor");if(!a)throw new Error(`Unknown storeCodec ${s.storeCodec}, please configure additional BlockCodecs for this IPFS instance`);if(s.inputCodec){if(!(i instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");const e=await t.getCodec(s.inputCodec);if(!e)throw new Error(`Unknown inputCodec ${s.inputCodec}, please configure additional BlockCodecs for this IPFS instance`);i=e.decode(i)}const c=null!=s.version?s.version:1,l=await r.getHasher(s.hashAlg||"sha2-256");if(!l)throw new Error(`Unknown hash algorithm ${s.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);const u=a.encode(i),h=await l.digest(u),d=ji.create(c,a.code,h);return await e.blocks.put(d,u,{signal:s.signal}),s.pin&&await e.pins.pinRecursively(d),!1!==s.preload&&n(d),d}finally{o&&o()}}return xw(i)}function Xq({repo:e,codecs:t,preload:r}){async function n(n,i={}){const{cid:s}=Ow(n);return!1!==i.preload&&r(s),Vw(e,t,n,i)}return xw(n)}class Zq{constructor({repo:e,codecs:t,hashers:r,preload:n}){this.export=Mq({repo:e,preload:n,codecs:t}),this.get=zq({codecs:t,repo:e,preload:n}),this.import=Yq({repo:e}),this.resolve=Xq({repo:e,codecs:t,preload:n}),this.put=Qq({repo:e,codecs:t,hashers:r,preload:n})}}const eH=(e,t)=>t,tH=(e,t,r,n)=>{if(null!=n&&!1===n.assumeHttp)return`tcp://${e}:${t}`;let i="tcp",s=`:${t}`;const o=r[r.length-1];return"tcp"===o.protocol&&(i="443"===t?"https":"http",s="443"===t||"80"===t?"":s),`${i}://${e}${s}`},rH={ip4:eH,ip6:(e,t,r,n)=>1===n.length&&"ip6"===n[0].protocol?t:`[${t}]`,tcp:(e,t,r,n,i)=>n.some((e=>["http","https","ws","wss"].includes(e.protocol)))?`${e}:${t}`:tH(e,t,n,i),udp:(e,t)=>`udp://${e}:${t}`,dnsaddr:eH,dns4:eH,dns6:eH,ipfs:(e,t)=>`${e}/ipfs/${t}`,p2p:(e,t)=>`${e}/p2p/${t}`,http:e=>`http://${e}`,https:e=>`https://${e}`,ws:e=>`ws://${e}`,wss:e=>`wss://${e}`,"p2p-websocket-star":e=>`${e}/p2p-websocket-star`,"p2p-webrtc-star":e=>`${e}/p2p-webrtc-star`,"p2p-webrtc-direct":e=>`${e}/p2p-webrtc-direct`};function nH(e,t){const r=Pp(e),n=r.toString().split("/").slice(1);return r.tuples().map((e=>({protocol:n.shift()??"",content:null!=e[1]?n.shift()??"":""}))).reduce(((e,r,n,i)=>{const s=rH[r.protocol];if(null==s)throw new Error(`Unsupported protocol ${r.protocol}`);return s(e,r.content,n,i,t)}),"")}function iH(e){if(!Array.isArray(e))throw new TypeError("Expected an array, got "+typeof e);e=[...e];for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}const sH=gn("ipfs:preload"),oH=Lb["default"]?Lb["default"]:Lb,aH=new oH({concurrency:4});function cH(e,t={}){return sH(e),aH.add((async()=>{const r=await Bb.post(e,{signal:t.signal}),n=r.body.getReader();try{while(1){const{done:e}=await n.read();if(e)return}}finally{n.releaseLock()}}))}const lH=gn("ipfs:preload");function uH(e={}){if(e.enabled=Boolean(e.enabled),e.addresses=e.addresses||[],e.cache=e.cache||1e3,!e.enabled||!e.addresses.length){lH("preload disabled");const e=()=>{};return Object.assign(e,{start:()=>{},stop:()=>{}})}let t=!0,r=[];const n=e.addresses.map((e=>nH(e))),i=Gw(e.cache),s=async e=>{try{if(t)throw new Error(`preload ${e} but preloader is not started`);const s=e.toString();if(i.has(s))return;i.set(s,!0);const o=iH(n);let a=!1;const c=Date.now();for(const e of o){if(t)throw new Error(`preload aborted for ${s}`);let n;try{n=new AbortController,r=r.concat(n),await cH(`${e}/api/v0/refs?r=true&arg=${encodeURIComponent(s)}`,{signal:n.signal}),a=!0}catch(WV){"aborted"!==WV.type&&lH.error(WV)}finally{r=r.filter((e=>e!==n))}if(a)break}lH(`${a?"":"un"}successfully preloaded ${s} in ${Date.now()-c}ms`)}catch(WV){lH.error(WV)}};return s.start=()=>{t=!1},s.stop=()=>{t=!0,lH(`aborting ${r.length} pending preload request(s)`),r.forEach((e=>e.abort())),r=[]},s}const hH=gn("ipfs:mfs-preload");function dH({preload:e,files:t,options:r={}}){if(r.interval=r.interval||3e4,!r.enabled){hH("MFS preload disabled");const e=async()=>{};return{start:e,stop:e}}let n,i="";const s=async()=>{try{const o=await t.stat("/"),a=o.cid.toString();i!==a&&(hH(`preloading updated MFS root ${i} -> ${o.cid}`),await e(o.cid),i=a)}catch(WV){hH.error("failed to preload MFS root",WV)}finally{n=setTimeout(s,r.interval)}};return{async start(){const e=await t.stat("/");i=e.cid.toString(),hH(`monitoring MFS root ${e.cid}`),n=setTimeout(s,r.interval)},stop(){clearTimeout(n)}}}class fH extends Error{constructor(e){super(e),this.name="TimeoutError"}}class pH extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const yH=e=>void 0===globalThis.DOMException?new pH(e):new DOMException(e),gH=e=>{const t=void 0===e.reason?yH("This operation was aborted."):e.reason;return t instanceof Error?t:yH(t)};function mH(e,t){const{milliseconds:r,fallback:n,message:i,customTimers:s={setTimeout:setTimeout,clearTimeout:clearTimeout}}=t;let o;const a=new Promise(((a,c)=>{if("number"!==typeof r||1!==Math.sign(r))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(r!==Number.POSITIVE_INFINITY){if(t.signal){const{signal:e}=t;e.aborted&&c(gH(e)),e.addEventListener("abort",(()=>{c(gH(e))}))}o=s.setTimeout.call(void 0,(()=>{if(n){try{a(n())}catch(o){c(o)}return}const t="string"===typeof i?i:`Promise timed out after ${r} milliseconds`,s=i instanceof Error?i:new fH(t);"function"===typeof e.cancel&&e.cancel(),c(s)}),r),(async()=>{try{a(await e)}catch(t){c(t)}finally{s.clearTimeout.call(void 0,o)}})()}else a(e)}));return a.clear=()=>{s.clearTimeout.call(void 0,o),o=void 0},a}const wH="lock:worker:request-read",bH="lock:worker:release-read",vH="lock:master:grant-read",EH="lock:worker:request-write",_H="lock:worker:release-write",SH="lock:master:grant-write",AH={},IH=e=>{e.addEventListener("message",(t=>{IH.dispatchEvent("message",e,t)})),null!=e.port&&e.port.addEventListener("message",(t=>{IH.dispatchEvent("message",e,t)}))};IH.addEventListener=(e,t)=>{null==AH[e]&&(AH[e]=[]),AH[e].push(t)},IH.removeEventListener=(e,t)=>{null!=AH[e]&&(AH[e]=AH[e].filter((e=>e===t)))},IH.dispatchEvent=function(e,t,r){null!=AH[e]&&AH[e].forEach((e=>e(t,r)))};var CH=IH;const kH=(e,t,r,n,i)=>(s,o)=>{if(o.data.type!==r)return;const a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};e.dispatchEvent(new MessageEvent(t,{data:{name:a.name,handler:async()=>(s.postMessage({type:i,name:a.name,identifier:a.identifier}),await new Promise((e=>{const t=r=>{if(null==r||null==r.data)return;const i={type:r.data.type,name:r.data.name,identifier:r.data.identifier};i.type===n&&i.identifier===a.identifier&&(s.removeEventListener("message",t),e())};s.addEventListener("message",t)})))}}))},TH=(e,t,r,n)=>async()=>{const i=Eg();return globalThis.postMessage({type:t,identifier:i,name:e}),await new Promise((t=>{const s=o=>{if(null==o||null==o.data)return;const a={type:o.data.type,identifier:o.data.identifier};a.type===r&&a.identifier===i&&(globalThis.removeEventListener("message",s),t((()=>{globalThis.postMessage({type:n,identifier:i,name:e})})))};globalThis.addEventListener("message",s)}))},RH={singleProcess:!1};var PH=e=>{e=Object.assign({},RH,e);const t=Boolean(globalThis.document)||e.singleProcess;if(t){const e=new EventTarget;return CH.addEventListener("message",kH(e,"requestReadLock",wH,bH,vH)),CH.addEventListener("message",kH(e,"requestWriteLock",EH,_H,SH)),e}return{isWorker:!0,readLock:e=>TH(e,wH,vH,bH),writeLock:e=>TH(e,EH,SH,_H)}};const xH={};let DH;async function OH(e,t){let r;const n=new Promise((e=>{r=e}));return e.add((async()=>await mH((async()=>await new Promise((e=>{r((()=>{e()}))})))(),{milliseconds:t.timeout}))),await n}const NH=(e,t)=>{if(!0===DH.isWorker)return{readLock:DH.readLock(e,t),writeLock:DH.writeLock(e,t)};const r=new Lb({concurrency:1});let n;return{async readLock(){if(null!=n)return await OH(n,t);n=new Lb({concurrency:t.concurrency,autoStart:!1});const e=n,i=OH(n,t);return r.add((async()=>(e.start(),await e.onIdle().then((()=>{n===e&&(n=null)}))))),await i},async writeLock(){return n=null,await OH(r,t)}}},LH={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function BH(e){const t=Object.assign({},LH,e);return null==DH&&(DH=PH(t),!0!==DH.isWorker&&(DH.addEventListener("requestReadLock",(e=>{null!=xH[e.data.name]&&xH[e.data.name].readLock().then((async t=>await e.data.handler().finally((()=>t()))))})),DH.addEventListener("requestWriteLock",(async e=>{null!=xH[e.data.name]&&xH[e.data.name].writeLock().then((async t=>await e.data.handler().finally((()=>t()))))})))),null==xH[t.name]&&(xH[t.name]=NH(t.name,t)),xH[t.name]}let UH;function MH(e=!1){if(UH)return UH;const t=BH({singleProcess:e});return UH={readLock:e=>async(...r)=>{const n=await t.readLock();try{return await e.apply(null,r)}finally{n()}},writeLock:e=>async(...r)=>{const n=await t.writeLock();try{return await e.apply(null,r)}finally{n()}}},UH}const jH=gn("ipfs:mfs:utils:with-mfs-root");async function VH(e,t){if(t&&t.signal&&t.signal.aborted)throw mn(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});let r;await e.repo.datastore.open();try{const t=await e.repo.datastore.get(Bw);r=ji.decode(t)}catch(WV){if("ERR_NOT_FOUND"!==WV.code)throw WV;jH("Creating new MFS root");const i=ks({Data:new xn({type:"directory"}).marshal(),Links:[]}),s=await vl.digest(i);if(r=ji.createV0(s),await e.repo.blocks.put(r,i),t&&t.signal&&t.signal.aborted)throw mn(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await e.repo.datastore.put(Bw,r.bytes)}return jH(`Loaded MFS root /ipfs/${r}`),r}function zH(e=""){return(e.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean)}const FH="ipfs",$H=async(e,t,r)=>{const n=await VH(e,r);let i={entryType:"file"},s="";if(s=ji.asCID(t)?`/ipfs/${t}`:t.toString(),s=s.trim(),s=s.replace(/(\/\/+)/g,"/"),s.endsWith("/")&&s.length>1&&(s=s.substring(0,s.length-1)),!s)throw mn(new Error("paths must not be empty"),"ERR_NO_PATH");if("/"!==s.substring(0,1))throw mn(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");"/"===s.substring(s.length-1)&&(s=s.substring(0,s.length-1));const o=zH(s);if(o[0]===FH){let e;e=2===o.length?`/${o.join("/")}`:`/${o.slice(0,o.length-1).join("/")}`,i={type:"ipfs",depth:o.length-2,entryType:"file",mfsPath:`/${o.join("/")}`,mfsDirectory:e,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}else{const e=`/${FH}/${n}${o.length?"/"+o.join("/"):""}`,t=`/${FH}/${n}/${o.slice(0,o.length-1).join("/")}`;i={type:"mfs",depth:o.length,entryType:"file",mfsDirectory:t,mfsPath:e,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}const a="mfs"===i.type?i.mfsPath:i.path;try{const t=await zL(a,e.repo.blocks,r);i.cid=t.cid,i.mfsPath=`/ipfs/${t.path}`,i.entryType=t.type,i.content=t.content,"file"!==i.entryType&&"directory"!==i.entryType||"file"!==t.type&&"directory"!==t.type||(i.unixfs=t.unixfs)}catch(WV){if("ERR_NOT_FOUND"!==WV.code)throw WV}return i.exists=Boolean(i.cid),i},KH=Wr.bind({ignoreUndefined:!0}),qH=gn("ipfs:mfs:stat"),HH={withLocal:!1};function GH(e){async function t(t,r={}){r=KH(HH,r),qH(`Fetching stats for ${t}`);const{type:n,cid:i,mfsPath:s}=await $H(e,t,r),o="ipfs"===n&&i?i:s;let a;try{a=await zL(o,e.repo.blocks)}catch(WV){if("ERR_NOT_FOUND"===WV.code)throw mn(new Error(`${t} does not exist`),"ERR_NOT_FOUND");throw WV}if(!WH[a.type])throw new Error(`Cannot stat codec ${a.cid.code}`);return WH[a.type](a)}return xw(t)}const WH={raw:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:e=>{const t={cid:e.cid,type:"file",size:e.unixfs.fileSize(),cumulativeSize:ks(e.node).length+(e.node.Links||[]).reduce(((e,t)=>e+(t.Tsize||0)),0),blocks:e.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:e.unixfs.mode};return e.unixfs.mtime&&(t.mtime=e.unixfs.mtime),t},directory:e=>{const t={cid:e.cid,type:"directory",size:0,cumulativeSize:ks(e.node).length+(e.node.Links||[]).reduce(((e,t)=>e+(t.Tsize||0)),0),blocks:e.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:e.unixfs.mode};return e.unixfs.mtime&&(t.mtime=e.unixfs.mtime),t},object:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})},YH=gn("ipfs:mfs:utils:to-trail");async function JH(e,t){YH(`Creating trail for path ${t}`);const r=[];for await(const n of VL(t,e.repo.blocks))r.push({name:n.name,cid:n.cid,size:n.size,type:n.type});return r}const QH=async(e,t,r)=>{r.codec||(r.codec=s),r.hasher||(r.hasher=vl),void 0===r.cidVersion&&(r.cidVersion=1),r.codec===s&&r.hasher!==vl&&(r.cidVersion=1);const n=await r.hasher.digest(e),i=ji.create(r.cidVersion,r.codec.code,n);return r.onlyHash||await t.put(i,e,{signal:r.signal}),i},XH=Bx.code,ZH=8;async function eG(e){return(await Bx.encode(e)).slice(0,8).reverse()}class tG{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}}class rG extends tG{constructor(e,t){super(e,t),this._bucket=NN({hashFn:eG,bits:ZH})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){yield*nG(this._bucket,e,this,this.options)}}async function*nG(e,t,r,n){const i=e._children,s=[];let o=0;for(let f=0;f<i.length;f++){const e=i.get(f);if(!e)continue;const r=f.toString(16).toUpperCase().padStart(2,"0");if(e instanceof EN){let i;for await(const r of await nG(e,t,null,n))i=r;if(!i)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:r,Tsize:i.size,Hash:i.cid}),o+=i.size}else if("function"===typeof e.value.flush){const n=e.value;let i;for await(const e of n.flush(t))i=e,yield i;const a=r+e.key;s.push({Name:a,Tsize:i.size,Hash:i.cid}),o+=i.size}else{const t=e.value;if(!t.cid)continue;const n=r+e.key,i=t.size;s.push({Name:n,Tsize:i,Hash:t.cid}),o+=i}}const a=Uint8Array.from(i.bitField().reverse()),c=new xn({type:"hamt-sharded-directory",data:a,fanout:e.tableSize(),hashType:XH,mtime:r&&r.mtime,mode:r&&r.mode}),l={Data:c.marshal(),Links:s},u=ks(Es(l)),h=await QH(u,t,n),d=u.length+o;yield{cid:h,node:l,size:d}}const iG=gn("ipfs:mfs:core:utils:hamt-utils"),sG=async(e,t,r,n)=>{if(!n.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");const i=Uint8Array.from(r._children.bitField().reverse()),s=xn.unmarshal(n.parent.Data),o=new xn({type:"hamt-sharded-directory",data:i,fanout:r.tableSize(),hashType:XH,mode:s.mode,mtime:s.mtime}),a=await e.hashers.getHasher(n.hashAlg),c={Data:o.marshal(),Links:t.sort(((e,t)=>(e.Name||"").localeCompare(t.Name||"")))},l=ks(c),u=await a.digest(l),h=ji.create(n.cidVersion,Cs,u);return n.flush&&await e.repo.blocks.put(h,l),{node:c,cid:h,size:t.reduce(((e,t)=>e+(t.Tsize||0)),l.length)}},oG=async(e,t,r,n,i)=>{const s=new EN({hash:r._options.hash,bits:r._options.bits},n,i);return n._putObjectAt(i,s),await cG(e,t,s,r),s},aG=async e=>{const t=NN({hashFn:eG,bits:ZH});return await Promise.all(e.map((async e=>{const r=e.Name||"";if(2===r.length){const e=parseInt(r,16),n=new EN({hash:t._options.hash,bits:t._options.bits},t,e);return t._putObjectAt(e,n),Promise.resolve()}return t.put(r.substring(2),{size:e.Tsize,cid:e.Hash})}))),t},cG=async(e,t,r,n)=>{await Promise.all(t.map((async t=>{const i=t.Name||"";if(2===i.length){iG("Populating sub bucket",i);const s=parseInt(i,16),o=await e.repo.blocks.get(t.Hash),a=Ts(o),c=new EN({hash:n._options.hash,bits:n._options.bits},r,s);return r._putObjectAt(s,c),await cG(e,a.Links,c,n),Promise.resolve()}return n.put(i.substring(2),{size:t.Tsize,cid:t.Hash})})))},lG=e=>e.toString(16).toUpperCase().padStart(2,"0").substring(0,2),uG=async(e,t,r)=>{const n=await aG(r.Links),i=await n._findNewBucketAndPos(t),s=[{bucket:i.bucket,prefix:lG(i.pos)}];let o=i.bucket;while(o!==n)s.push({bucket:o,prefix:lG(o._posAtParent)}),o=o._parent;s.reverse(),s[0].node=r;for(let a=0;a<s.length;a++){const r=s[a];if(!r.node)throw new Error("Could not generate HAMT path");const i=r.node.Links.filter((e=>(e.Name||"").substring(0,2)===r.prefix)).pop();if(!i){iG(`Link ${r.prefix}${t} will be added`);continue}if(i.Name===`${r.prefix}${t}`){iG(`Link ${r.prefix}${t} will be replaced`);continue}iG(`Found subshard ${r.prefix}`);const o=await e.repo.blocks.get(i.Hash),c=Ts(o);if(!s[a+1]){iG(`Loaded new subshard ${r.prefix}`),await oG(e,c.Links,n,r.bucket,parseInt(r.prefix,16));const i=await n._findNewBucketAndPos(t);s.push({bucket:i.bucket,prefix:lG(i.pos),node:c});continue}const l=s[a+1];await cG(e,c.Links,l.bucket,n),l.node=c}return await n.put(t,!0),s.reverse(),{rootBucket:n,path:s}},hG=async(e,t,r={})=>{const n=new rG({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:r.mtime,mode:r.mode},r);for(let s=0;s<t.length;s++)await n._bucket.put(t[s].name,{size:t[s].size,cid:t[s].cid});const i=await h_(n.flush(e.repo.blocks));if(!i)throw new Error("Flushing shard yielded no result");return i},dG=gn("ipfs:mfs:core:utils:add-link");async function fG(e,t){let r=t.parent;if(t.parentCid){const n=ji.asCID(t.parentCid);if(null===n)throw mn(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(n.code!==Cs)throw mn(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");dG(`Loading parent node ${n}`);const i=await e.repo.blocks.get(n);r=Ts(i)}if(!r)throw mn(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!t.cid)throw mn(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!t.name)throw mn(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!t.size&&0!==t.size)throw mn(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!r.Data)throw mn(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");const n=xn.unmarshal(r.Data);return"hamt-sharded-directory"===n.type?(dG("Adding link to sharded directory"),gG(e,{...t,parent:r})):r.Links.length>=t.shardSplitThreshold?(dG("Converting directory to sharded directory"),pG(e,{...t,parent:r,mtime:n.mtime,mode:n.mode})):(dG(`Adding ${t.name} (${t.cid}) to regular directory`),yG(e,{...t,parent:r}))}const pG=async(e,t)=>{const r=await hG(e,t.parent.Links.map((e=>({name:e.Name||"",size:e.Tsize||0,cid:e.Hash}))).concat({name:t.name,size:t.size,cid:t.cid}),t);return dG(`Converted directory to sharded directory ${r.cid}`),r},yG=async(e,t)=>{const r=t.parent.Links.filter((e=>e.Name!==t.name));if(r.push({Name:t.name,Tsize:t.size,Hash:t.cid}),!t.parent.Data)throw mn(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");const n=xn.unmarshal(t.parent.Data);let i;if(n.mtime){const e=Date.now(),t=Math.floor(e/1e3);n.mtime={secs:t,nsecs:1e3*(e-1e3*t)},i=n.marshal()}else i=t.parent.Data;t.parent=Es({Data:i,Links:r});const s=await e.hashers.getHasher(t.hashAlg),o=ks(t.parent),a=await s.digest(o),c=ji.create(t.cidVersion,Cs,a);return t.flush&&await e.repo.blocks.put(c,o),{node:t.parent,cid:c,size:o.length}},gG=async(e,t)=>{const{shard:r,path:n}=await mG(e,t),i=await h_(r.flush(e.repo.blocks));if(!i)throw new Error("No result from flushing shard");const s=await e.repo.blocks.get(i.cid),o=Ts(s),a=t.parent.Links.filter((e=>(e.Name||"").substring(0,2)!==n[0].prefix)),c=o.Links.find((e=>(e.Name||"").substring(0,2)===n[0].prefix));if(!c)throw new Error(`No link found with prefix ${n[0].prefix}`);return a.push(c),sG(e,a,n[0].bucket,t)},mG=async(e,t)=>{const r={name:t.name,cid:t.cid,size:t.size};if(!t.parent.Data)throw mn(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");const n=await aG(t.parent.Links),i=xn.unmarshal(t.parent.Data),s=new rG({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mode:i.mode},t);s._bucket=n,i.mtime&&(s.mtime={secs:Math.round(Date.now()/1e3)});const o=await n._findNewBucketAndPos(r.name),a=wG(o);a[0].node=t.parent;let c=0;while(c<a.length){const t=a[c];c++;const i=t.node;if(!i)throw new Error("Segment had no node");const s=i.Links.find((e=>(e.Name||"").substring(0,2)===t.prefix));if(!s){dG(`Link ${t.prefix}${r.name} will be added`),c=a.length;break}if(s.Name===`${t.prefix}${r.name}`){dG(`Link ${t.prefix}${r.name} will be replaced`),c=a.length;break}if((s.Name||"").length>2){dG(`Link ${s.Name} ${s.Hash} will be replaced with a subshard`),c=a.length;break}dG(`Found subshard ${t.prefix}`);const o=await e.repo.blocks.get(s.Hash),l=Ts(o);if(!a[c]){dG(`Loaded new subshard ${t.prefix}`),await oG(e,l.Links,n,t.bucket,parseInt(t.prefix,16));const i=await n._findNewBucketAndPos(r.name);a.push({bucket:i.bucket,prefix:lG(i.pos),node:l});break}const u=a[c];await cG(e,l.Links,u.bucket,n),u.node=l}return await s._bucket.put(r.name,{size:r.size,cid:r.cid}),{shard:s,path:a}},wG=e=>{const t=[{bucket:e.bucket,prefix:lG(e.pos)}];let r=e.bucket._parent,n=e.bucket._posAtParent;while(r)t.push({bucket:r,prefix:lG(n)}),n=r._posAtParent,r=r._parent;return t.reverse(),t},bG=gn("ipfs:mfs:utils:update-tree"),vG={shardSplitThreshold:1e3};async function EG(e,t,r){r=Object.assign({},vG,r),bG("Trail",t),t=t.slice().reverse();let n,i=0;for await(const o of e.repo.blocks.getMany(t.map((e=>e.cid)))){const s=Ts(o),a=t[i].cid,c=t[i].name;if(i++,!n){n={cid:a,name:c,size:o.length};continue}const l=await fG(e,{parent:s,name:n.name,cid:n.cid,size:n.size,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold,hashAlg:r.hashAlg,cidVersion:r.cidVersion});n={cid:l.cid,name:c,size:l.size}}const{cid:s}=n;return bG(`Final CID ${s}`),s}const _G=gn("ipfs:mfs:utils:update-mfs-root");async function SG(e,t,r){if(r&&r.signal&&r.signal.aborted)throw mn(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return _G(`New MFS root will be ${t}`),await e.repo.datastore.put(Bw,t.bytes),t}async function AG(e,t,r){const n=new xn({type:t,mode:r.mode,mtime:r.mtime}),i=await e.hashers.getHasher(r.hashAlg),s={Data:n.marshal(),Links:[]},o=ks(s),a=await i.digest(o),c=ji.create(r.cidVersion,Cs,a);return r.flush&&await e.repo.blocks.put(c,o),{cid:c,node:s}}const IG=Wr.bind({ignoreUndefined:!0}),CG=gn("ipfs:mfs:mkdir"),kG={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};function TG(e){async function t(t,r={}){const n=IG(kG,r);if(!t)throw new Error("no path given to Mkdir");if(t=t.trim(),"/"===t){if(n.parents)return;throw mn(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if("/"!==t.substring(0,1))throw mn(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");CG(`Creating ${t}`);const i=zH(t);if("ipfs"===i[0])throw mn(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");const s=await VH(e,n);let o;const a=[],c=await AG(e,"directory",n);for(let u=0;u<=i.length;u++){const r=i.slice(0,u),l=`/ipfs/${s}/${r.join("/")}`;try{if(o=await zL(l,e.repo.blocks),"file"!==o.type&&"directory"!==o.type)throw mn(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(u===i.length){if(n.parents)return;throw mn(new Error("file already exists"),"ERR_ALREADY_EXISTS")}a.push({name:o.name,cid:o.cid})}catch(WV){if("ERR_NOT_FOUND"!==WV.code)throw WV;if(u<i.length&&!n.parents)throw mn(new Error(`Intermediate directory path ${l} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await RG(e,r[r.length-1],c,a[a.length-1],a,n)}}const l=await EG(e,a,n);await SG(e,l,n)}return xw(t)}const RG=async(e,t,r,n,i,s)=>{CG(`Adding empty dir called ${t} to ${n.cid}`);const o=await fG(e,{parent:n.node,parentCid:n.cid,size:0,cid:r.cid,name:t,hashAlg:s.hashAlg,cidVersion:s.cidVersion,flush:s.flush,shardSplitThreshold:s.shardSplitThreshold});i[i.length-1].cid=o.cid,i.push({name:t,cid:r.cid})},PG=Wr.bind({ignoreUndefined:!0}),xG=gn("ipfs:mfs:cp"),DG={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};function OG(e){async function t(t,r,n={}){const i=PG(DG,n);Array.isArray(t)||(t=[t]);const s=await Promise.all(t.map((t=>$H(e,t,i))));let o=await $H(e,r,i);if(!s.length||!o)throw mn(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");const a=s.find((e=>!e.exists));if(a)throw mn(new Error(`${a.path} does not exist`),"ERR_INVALID_PARAMS");const c=NG(o);if(o.exists){if(xG("Destination exists"),1===s.length&&!c)throw mn(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(xG("Destination does not exist"),s.length>1){if(!i.parents)throw mn(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await TG(e)(o.path,i),o=await $H(e,o.path,i)}else if(o.parts.length>1){const t=`/${o.parts.slice(0,-1).join("/")}`;try{await GH(e)(t,i)}catch(WV){if("ERR_NOT_FOUND"!==WV.code)throw WV;if(!i.parents)throw mn(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await TG(e)(t,i),o=await $H(e,o.path,i)}}const l=NG(o)?o.mfsPath:o.mfsDirectory,u=await JH(e,l);if(1===s.length){const t=s.pop();if(!t)throw mn(new Error("could not find source"),"ERR_INVALID_PARAMS");const r=c?t.name:o.name;return xG(`Only one source, copying to destination ${c?"directory":"file"} ${r}`),LG(e,t,r,u,i)}return xG("Multiple sources, wrapping in a directory"),BG(e,s,o,u,i)}return xw(t)}const NG=e=>e.unixfs&&e.unixfs.type&&e.unixfs.type.includes("directory"),LG=async(e,t,r,n,i)=>{let s=n.pop();if(!s)throw mn(new Error("destination had no parent"),"ERR_INVALID_PARAMS");s=await UG(e,t,r,s,i),n.push(s);const o=await EG(e,n,i);await SG(e,o,i)},BG=async(e,t,r,n,i)=>{for(let o=0;o<t.length;o++){const n=t[o];r=await UG(e,n,n.name,r,i)}n[n.length-1]=r;const s=await EG(e,n,i);await SG(e,s,i)},UG=async(e,t,r,n,i)=>{const s=await e.repo.blocks.get(t.cid),{node:o,cid:a,size:c}=await fG(e,{parentCid:n.cid,size:s.length,cid:t.cid,name:r,hashAlg:i.hashAlg,cidVersion:i.cidVersion,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold});return n.node=o,n.cid=a,n.size=c,n},MG=gn("ipfs:mfs:core:utils:remove-link");async function jG(e,t){let r=t.parent;if(t.parentCid){const n=ji.asCID(t.parentCid);if(null===n)throw mn(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");MG(`Loading parent node ${n}`);const i=await e.repo.blocks.get(n);r=Ts(i)}if(!r)throw mn(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!t.name)throw mn(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!r.Data)throw mn(new Error("Parent node had no data"),"ERR_INVALID_NODE");const n=xn.unmarshal(r.Data);return"hamt-sharded-directory"===n.type?(MG(`Removing ${t.name} from sharded directory`),zG(e,{...t,parent:r})):(MG(`Removing link ${t.name} regular directory`),VG(e,{...t,parent:r}))}const VG=async(e,t)=>{t.parent.Links=t.parent.Links.filter((e=>e.Name!==t.name));const r=await ks(t.parent),n=await e.hashers.getHasher(t.hashAlg),i=await n.digest(r),s=ji.create(t.cidVersion,Cs,i);return await e.repo.blocks.put(s,r),MG(`Updated regular directory ${s}`),{node:t.parent,cid:s}},zG=async(e,t)=>{const{rootBucket:r,path:n}=await uG(e,t.name,t.parent);await r.del(t.name);const{node:i}=await FG(e,n,t.name,t);return sG(e,i.Links,r,t)},FG=async(e,t,r,n)=>{const i=t.pop();if(!i)throw mn(new Error("Could not find parent"),"EINVALIDPARENT");const{bucket:s,prefix:o,node:a}=i;if(!a)throw mn(new Error("Could not find parent"),"EINVALIDPARENT");const c=a.Links.find((e=>(e.Name||"").substring(0,2)===o));if(!c)throw mn(new Error(`No link found with prefix ${o} for file ${r}`),"ERR_NOT_FOUND");if(c.Name===`${o}${r}`){MG(`Removing existing link ${c.Name}`);const t=a.Links.filter((e=>e.Name!==c.Name));return await s.del(r),sG(e,t,s,n)}MG(`Descending into sub-shard ${c.Name} for ${o}${r}`);const l=await FG(e,t,r,n);let u=l.cid,h=l.size,d=o;if(1===l.node.Links.length){MG(`Removing subshard for ${o}`);const e=l.node.Links[0];d=`${o}${(e.Name||"").substring(2)}`,u=e.Hash,h=e.Tsize||0}return MG(`Updating shard ${o} with name ${d}`),$G(e,s,a,o,d,h,u,n)},$G=(e,t,r,n,i,s,o,a)=>{const c=r.Links.filter((e=>e.Name!==n));return c.push({Name:i,Tsize:s,Hash:o}),sG(e,c,t,a)},KG=Wr.bind({ignoreUndefined:!0}),qG={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};function HG(e){async function t(t,r={}){const n=KG(qG,r);Array.isArray(t)||(t=[t]);const i=await Promise.all(t.map((t=>$H(e,t,n))));if(!i.length)throw mn(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");i.forEach((e=>{if("/"===e.path)throw mn(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")}));for(const s of i)await GG(e,s.path,n)}return xw(t)}const GG=async(e,t,r)=>{const n=await $H(e,t,r),i=await JH(e,n.mfsPath),s=i[i.length-1];i.pop();const o=i[i.length-1];if(!o)throw mn(new Error(`${t} does not exist`),"ERR_NOT_FOUND");if("directory"===s.type&&!r.recursive)throw mn(new Error(`${t} is a directory, use -r to remove directories`),"ERR_WAS_DIR");const{cid:a}=await jG(e,{parentCid:o.cid,name:s.name,hashAlg:r.hashAlg,cidVersion:r.cidVersion,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold});o.cid=a;const c=await EG(e,i,r);await SG(e,c,r)},WG=Wr.bind({ignoreUndefined:!0}),YG=gn("ipfs:mfs:touch"),JG={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function QG(e,t,r){let n=0;return(e.includes("x")||e.includes("X")&&(r||1&t||8&t||64&t))&&(n+=1),e.includes("w")&&(n+=2),e.includes("r")&&(n+=4),n}function XG(e,t){let r=0;return e.includes("u")&&(r+=t<<6),e.includes("g")&&(r+=t<<3),e.includes("o")&&(r+=t),r}function ZG(e,t,r){return t.includes("t")&&(r+=parseInt("1000",8)),t.includes("s")&&(e.includes("u")&&(r+=parseInt("4000",8)),e.includes("g")&&(r+=parseInt("2000",8))),r}function eW(e,t,r){t||(t=0);const n=e.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!n)throw new Error(`Invalid file mode: ${e}`);let[,i,s,o]=n;"a"!==i&&i||(i="ugo");let a=QG(o,t,r);return a=XG(i,a),a=ZG(i,o,a),"="===s?(i.includes("u")&&(t&=parseInt("7077",8),t|=a),i.includes("g")&&(t&=parseInt("7707",8),t|=a),i.includes("o")&&(t&=parseInt("7770",8),t|=a),t):"+"===s?a|t:"-"===s?a^t:t}function tW(e,t){if(e instanceof String||"string"===typeof e){const r=`${e}`;e=r.match(/^\d+$/g)?parseInt(r,8):0+r.split(",").reduce(((e,r)=>eW(r,e,t.isDirectory())),t.mode||0)}return e}function rW(e){async function t(t,r,n={}){const i=WG(JG,n);YG(`Fetching stats for ${t}`);const{cid:s,mfsDirectory:o,name:a}=await $H(e,t,i);if(s.code!==Cs)throw mn(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(i.recursive){const n=await QR((async function*(){for await(const n of FL(s,e.repo.blocks)){if("file"!==n.type&&"directory"!==n.type)throw mn(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");n.unixfs.mode=tW(r,n.unixfs);const e=Es({Data:n.unixfs.marshal(),Links:n.node.Links});yield{path:n.path,content:e}}}),(t=>GN(t,e.repo.blocks,{...i,pin:!1,dagBuilder:async function*(e,t,r){for await(const n of e)yield async function(){const e=n.content,i=ks(e),s=await QH(i,t,r);if(!e.Data)throw mn(new Error(`${s} had no data`),"ERR_INVALID_NODE");const o=xn.unmarshal(e.Data);return{cid:s,size:i.length,path:n.path,unixfs:o}}}})),(e=>h_(e)));if(!n)throw mn(new Error(`Could not chmod ${t}`),"ERR_COULD_NOT_CHMOD");return await HG(e)(t,i),void await OG(e)(`/ipfs/${n.cid}`,t,i)}const c=await e.repo.blocks.get(s),l=Ts(c);if(!l.Data)throw mn(new Error(`${s} had no data`),"ERR_INVALID_NODE");const u=xn.unmarshal(l.Data);u.mode=tW(r,u);const h=ks({Data:u.marshal(),Links:l.Links}),d=i.hashAlg||JG.hashAlg,f=await e.hashers.getHasher(d),p=await f.digest(h),y=ji.create(i.cidVersion,Cs,p);i.flush&&await e.repo.blocks.put(y,h);const g=await JH(e,o),m=g[g.length-1],w=ji.decode(m.cid.bytes),b=await e.repo.blocks.get(w),v=Ts(b),E=await fG(e,{parent:v,name:a,cid:y,size:h.length,flush:i.flush,hashAlg:d,cidVersion:s.version,shardSplitThreshold:1/0});m.cid=E.cid;const _=await EG(e,g,i);await SG(e,_,i)}return xw(t)}const nW=Wr.bind({ignoreUndefined:!0}),iW={};function sW(e){async function t(t,r={}){r=nW(iW,r);const{cid:n}=await GH(e)(t,r);return n}return xw(t)}const oW=Wr.bind({ignoreUndefined:!0}),aW={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};function cW(e){async function t(t,r,n={}){const i=oW(aW,n);await OG(e)(t,r,i),await HG(e)(t,{...i,recursive:!0})}return xw(t)}const lW=Wr.bind({ignoreUndefined:!0}),uW=gn("ipfs:mfs:touch"),hW={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};function dW(e){async function t(t,r={}){const n=lW(hW,r);n.mtime=n.mtime||new Date,uW(`Touching ${t} mtime: ${n.mtime}`);const{cid:i,mfsDirectory:s,name:o,exists:a}=await $H(e,t,n),c=r.hashAlg||hW.hashAlg,l=await e.hashers.getHasher(c);let u,h,d=n.cidVersion;if(a){if(i.code!==Cs)throw mn(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");d=i.version;const r=await e.repo.blocks.get(i),s=Ts(r);if(!s.Data)throw mn(new Error(`${t} had no data`),"ERR_INVALID_NODE");const o=xn.unmarshal(s.Data);o.mtime=n.mtime,u=ks({Data:o.marshal(),Links:s.Links});const a=await l.digest(u);h=ji.create(n.cidVersion,Cs,a),n.flush&&await e.repo.blocks.put(h,u)}else{const t=new xn({type:"file",mtime:n.mtime});u=ks({Data:t.marshal(),Links:[]});const r=await l.digest(u);h=ji.create(n.cidVersion,Cs,r),n.flush&&await e.repo.blocks.put(h,u)}const f=await JH(e,s),p=f[f.length-1],y=p.cid,g=await e.repo.blocks.get(y),m=Ts(g),w=await fG(e,{parent:m,name:o,cid:h,size:u.length,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:d});p.cid=w.cid;const b=await EG(e,f,n);await SG(e,b,n)}return xw(t)}const fW=Wr.bind({ignoreUndefined:!0}),pW={offset:0,length:1/0};function yW(e){function t(t,r={}){return r=fW(pW,r),{[Symbol.asyncIterator]:async function*(){const n=await $H(e,t,r),i=await zL(n.mfsPath,e.repo.blocks);if("file"!==i.type)throw mn(new Error(`${t} was not a file`),"ERR_NOT_FILE");if(!i.content)throw mn(new Error(`Could not load content stream from ${t}`),"ERR_NO_CONTENT");for await(const e of i.content({offset:r.offset,length:r.length}))yield e}}}return xw(t)}const gW=gn("ipfs:mfs:utils:to-async-iterator");function mW(e){if(!e)throw mn(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if(("string"===typeof e||e instanceof String)&&(gW("Content was a string"),e=Jl(e.toString())),e.length)return gW("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield e}};if(e[Symbol.asyncIterator])return gW("Content was an async iterator"),e;if(e[Symbol.iterator])return gW("Content was an iterator"),e;if(global.Blob&&e instanceof global.Blob){gW("Content was an HTML5 Blob");let t=0;const r={next:()=>t>e.size?{done:!0}:new Promise(((r,n)=>{const i=e.slice(t,Uw);t+=Uw;const s=new global.FileReader,o=e=>{if(s.removeEventListener("loadend",o,!1),e.error)return n(e.error);r({done:!1,value:new Uint8Array(s.result)})};s.addEventListener("loadend",o),s.readAsArrayBuffer(i)}))};return{[Symbol.asyncIterator]:()=>r}}throw mn(new Error(`Don't know how to convert ${e} into an async iterator`),"ERR_INVALID_PARAMS")}const wW=Wr.bind({ignoreUndefined:!0}),bW=gn("ipfs:mfs:write"),vW={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(e,t)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};function EW(e){async function t(t,r,n={}){const i=wW(vW,n);let s,o,a;if(bW("Reading source, destination and parent"),await MH().readLock((async()=>{s=await mW(r),o=await $H(e,t,i),a=await $H(e,o.mfsDirectory,i)}))(),bW("Read source, destination and parent"),!i.parents&&!a.exists)throw mn(new Error("directory does not exist"),"ERR_NO_EXIST");if(null==s)throw mn(new Error("could not create source"),"ERR_NO_SOURCE");if(null==o)throw mn(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!i.create&&!o.exists)throw mn(new Error("file does not exist"),"ERR_NO_EXIST");if("file"!==o.entryType)throw mn(new Error("not a file"),"ERR_NOT_A_FILE");return _W(e,t,s,o,i)}return xw(t)}const _W=async(e,t,r,n,i)=>{const s=await SW(e,r,n,i);await MH().writeLock((async()=>{const r=zH(t),n=r.pop();if(null==n)throw mn(new Error("source does not exist"),"ERR_NO_EXIST");let o=!1;try{await GH(e)(`/${r.join("/")}`,i),o=!0}catch(WV){if("ERR_NOT_FOUND"!==WV.code)throw WV}o||await TG(e)(`/${r.join("/")}`,i);const a=await $H(e,t,i),c=await JH(e,a.mfsDirectory),l=c[c.length-1];if(!l)throw mn(new Error("directory does not exist"),"ERR_NO_EXIST");if(!l.type||!l.type.includes("directory"))throw mn(new Error(`cannot write to ${l.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");const u=await e.repo.blocks.get(l.cid),h=Ts(u),d=await fG(e,{parent:h,name:n,cid:s.cid,size:s.size,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold,hashAlg:i.hashAlg,cidVersion:i.cidVersion});l.cid=d.cid;const f=await EG(e,c,i);await SG(e,f,i)}))()},SW=async(e,t,r,n)=>{r.exists?bW(`Overwriting file ${r.cid} offset ${n.offset} length ${n.length}`):bW(`Writing file offset ${n.offset} length ${n.length}`);const i=[];if(n.offset>0)if(r.unixfs){if(bW(`Writing first ${n.offset} bytes of original file`),i.push((()=>r.content({offset:0,length:n.offset}))),r.unixfs.fileSize()<n.offset){const e=n.offset-r.unixfs.fileSize();bW(`Writing zeros for extra ${e} bytes`),i.push(IW(e))}}else bW(`Writing zeros for first ${n.offset} bytes`),i.push(IW(n.offset));i.push(AW(t,n.length));const s=kW(CW(i),(e=>{if(r.unixfs&&!n.truncate){const t=r.unixfs.fileSize();if(t>e)return bW(`Writing last ${t-e} of ${t} bytes from original file starting at offset ${e}`),r.content({offset:e});bW("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}));let o,a;void 0!==n.mode&&null!==n.mode?o=Rn(n.mode):r&&r.unixfs&&(o=r.unixfs.mode),null!=n.mtime?a=Pn(n.mtime):r&&r.unixfs&&(a=r.unixfs.mtime);const c=await e.hashers.getHasher(n.hashAlg),l=await h_(GN([{content:s,mode:o,mtime:a}],e.repo.blocks,{progress:n.progress,hasher:c,cidVersion:n.cidVersion,strategy:n.strategy,rawLeaves:n.rawLeaves,reduceSingleLeafToSelf:n.reduceSingleLeafToSelf,leafType:n.leafType}));if(!l)throw mn(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return bW(`Wrote ${l.cid}`),{cid:l.cid,size:l.size}},AW=(e,t)=>async function*(){let r=0;for await(const n of e){if(r+=n.length,r>t)return void(yield n.slice(0,t-r));yield n}},IW=(e,t=Uw)=>{const r=new Uint8Array(t);async function*n(){while(1)yield r.slice()}return AW(n(),e)},CW=async function*(e){for(let t=0;t<e.length;t++)yield*e[t]()},kW=async function*(e,t){let r=0;for await(const n of e)r+=n.length,yield n;for await(const n of t(r))r+=n.length,yield n},TW=e=>{const t={cid:e.cid,name:e.name,type:"directory"===e.type?"directory":"file",size:e.size};return"file"!==e.type&&"directory"!==e.type||(t.mode=e.unixfs.mode,t.mtime=e.unixfs.mtime),t};function RW(e){async function*t(t,r={}){const n=await $H(e,t,r),i=await zL(n.mfsPath,e.repo.blocks);"directory"!==i.type?yield TW(i):yield*qR(i.content(r),TW)}return xw(t)}const PW={stat:GH},xW={chmod:rW,cp:OG,flush:sW,mkdir:TG,mv:cW,rm:HG,touch:dW},DW={write:EW,read:yW,ls:RW},OW=({options:e,mfs:t,operations:r,lock:n})=>{Object.keys(r).forEach((i=>{t[i]=n(r[i](e))}))},NW={repoOwner:!0,repo:null};function LW(e){const{repoOwner:t}=Object.assign({},NW||{},e),r=MH(t),n=e=>r.readLock(e),i=e=>r.writeLock(e),s={};return OW({options:e,mfs:s,operations:PW,lock:n}),OW({options:e,mfs:s,operations:xW,lock:i}),Object.keys(DW).forEach((t=>{s[t]=DW[t](e)})),s}function BW({repo:e,preload:t,hashers:r,options:n}){const i=LW({repo:e,repoOwner:!1!==n.repoOwner,hashers:r}),s=e=>{const r=(...r)=>{const n=r.filter((e=>bg(e)||fg(e)));if(n.length){const e=r[r.length-1];e&&!1!==e.preload&&n.forEach((e=>t(e)))}return e(...r)};return r};return{...i,chmod:i.chmod,cp:s(i.cp),mkdir:i.mkdir,stat:s(i.stat),rm:i.rm,read:s(i.read),touch:i.touch,write:i.write,mv:s(i.mv),flush:i.flush,ls:s((async function*(...e){for await(const t of i.ls(...e))yield{...t,size:t.size||0}}))}}function UW({keychain:e}){const t=(t,r)=>e.exportKey(t,r);return xw(t)}const MW="Ed25519",jW=2048;function VW({keychain:e}){const t=(t,r={type:MW,size:jW})=>e.createKey(t,r.type||MW,r.size||jW);return xw(t)}function zW({keychain:e}){const t=(t,r,n)=>e.importKey(t,r,n);return xw(t)}function FW({keychain:e}){const t=t=>e.findKeyByName(t);return xw(t)}function $W({keychain:e}){const t=()=>e.listKeys();return xw(t)}function KW({keychain:e}){const t=async(t,r)=>{const n=await e.renameKey(t,r);return{was:t,now:n.name,id:n.id,overwrite:!1}};return xw(t)}function qW({keychain:e}){const t=t=>e.removeKey(t);return xw(t)}class HW{constructor({keychain:e}){this.gen=VW({keychain:e}),this.list=$W({keychain:e}),this.rm=qW({keychain:e}),this.rename=KW({keychain:e}),this.export=UW({keychain:e}),this.import=zW({keychain:e}),this.info=FW({keychain:e})}}function GW({repo:e,preload:t}){async function r(r,n={}){!1!==n.preload&&t(r);const i=await e.blocks.get(r,n);return Ts(i)}return xw(r)}function WW({repo:e,preload:t}){const r=GW({repo:e,preload:t});async function n(e,t={}){const n=await r(e,t);return n.Data||new Uint8Array(0)}return xw(n)}function YW(e,t=[]){for(const n in e){const i=e[n];if("/"===n&&1===Object.keys(e).length)try{t.push({Name:"",Tsize:0,Hash:ji.parse(i)});continue}catch(r){}const s=ji.asCID(i);s?t.push({Name:"",Tsize:0,Hash:s}):(Array.isArray(i)&&YW(i,t),i&&"object"===typeof i&&YW(i,t))}return t}function JW({repo:e,codecs:t}){async function r(r,n={}){const i=await t.getCodec(r.code),s=await e.blocks.get(r,n),o=i.decode(s);switch(r.code){case Sl:return[];case Cs:return o.Links;case ac:case Pc:return YW(o);default:throw new Error(`Cannot resolve links from codec ${r.code}`)}}return xw(r)}function QW({repo:e,preload:t}){async function r(r={}){let n;if(r.template){if("unixfs-dir"!==r.template)throw new Error("unknown template");n=new xn({type:"directory"}).marshal()}const i=ks({Data:n,Links:[]}),s=await vl.digest(i),o=ji.createV0(s);return await e.blocks.put(o,i,{signal:r.signal}),!1!==r.preload&&t(o),o}return xw(r)}function XW({repo:e,preload:t}){async function r(r,n={}){const i=await e.gcLock.readLock();try{const s=ks(r),o=await vl.digest(s),a=ji.createV1(Cs,o);return await e.blocks.put(a,s,{signal:n.signal}),!1!==n.preload&&t(a),n.pin&&await e.pins.pinRecursively(a,{signal:n.signal}),a}finally{i()}}return xw(r)}function ZW({repo:e,preload:t}){const r=GW({repo:e,preload:t});async function n(e,t={}){const n=await r(e,t),i=ks(n),s=i.length,o=n.Links.reduce(((e,t)=>e+(t.Tsize||0)),0);return{Hash:e,NumLinks:n.Links.length,BlockSize:s,LinksSize:s-(n.Data||[]).length,DataSize:(n.Data||[]).length,CumulativeSize:s+o}}return xw(n)}function eY({repo:e,preload:t}){const r=GW({repo:e,preload:t}),n=XW({repo:e,preload:t});async function i(e,t,i={}){const s=await r(e,i);return n({...s,Links:s.Links.concat([t])},i)}return xw(i)}function tY({repo:e,preload:t}){const r=GW({repo:e,preload:t}),n=XW({repo:e,preload:t});async function i(e,t,i={}){const s=await r(e,i),o=(0,UT.concat)([s.Data||[],t]);return n({...s,Data:o},i)}return xw(i)}function rY({repo:e,preload:t}){const r=GW({repo:e,preload:t}),n=XW({repo:e,preload:t});async function i(e,t,i={}){const s=await r(e,i),o=("string"===typeof t?t:t.Name)||"";return s.Links=s.Links.filter((e=>e.Name!==o)),n(s,i)}return xw(i)}function nY({repo:e,preload:t}){const r=GW({repo:e,preload:t}),n=XW({repo:e,preload:t});async function i(e,t,i={}){const s=await r(e,i);return n({...s,Data:t},i)}return xw(i)}class iY{constructor({repo:e,preload:t}){this.addLink=eY({repo:e,preload:t}),this.appendData=tY({repo:e,preload:t}),this.rmLink=rY({repo:e,preload:t}),this.setData=nY({repo:e,preload:t})}}class sY{constructor({repo:e,codecs:t,preload:r}){this.data=WW({repo:e,preload:r}),this.get=GW({repo:e,preload:r}),this.links=JW({repo:e,codecs:t}),this.new=QW({repo:e,preload:r}),this.put=XW({repo:e,preload:r}),this.stat=ZW({repo:e,preload:r}),this.patch=new iY({repo:e,preload:r})}}const oY=gn("ipfs:repo:gc");function aY({repo:e,hashers:t}){async function*r(r={}){const n=Date.now();let i;try{i=await VH({repo:e,hashers:t},r),await e.pins.pinRecursively(i),yield*e.gc()}finally{i&&await e.pins.unpin(i)}oY(`Complete (${Date.now()-n}ms)`)}return xw(r)}function cY({repo:e}){async function t(t={}){const r=await e.stat();return{numObjects:BigInt(r.numObjects.toString()),repoSize:BigInt(r.repoSize.toString()),repoPath:r.repoPath,version:`${r.version}`,storageMax:BigInt(r.storageMax.toString())}}return xw(t)}const lY=12;function uY({repo:e}){async function t(t={}){try{await e._checkInitialized(t)}catch(WV){const t=[/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some((t=>t.test(WV.message)));if(t)return lY;throw WV}return e.version.get()}return xw(t)}class hY{constructor({repo:e,hashers:t}){this.gc=aY({repo:e,hashers:t}),this.stat=cY({repo:e}),this.version=uY({repo:e}),this.setApiAddr=t=>e.apiAddr.set(t)}}function dY(e,t){let r;if(r=e.metrics?t.peer?e.metrics.forPeer(t.peer):t.proto?e.metrics.forProtocol(t.proto):e.metrics.getGlobal():void 0,!r)return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0};const n=r.getMovingAverages(),i=r.getSnapshot();return{totalIn:i.dataReceived,totalOut:i.dataSent,rateIn:n.dataReceived[6e4].movingAverage/60,rateOut:n.dataSent[6e4].movingAverage/60}}function fY({network:e}){const t=async function*(t={}){const{libp2p:r}=await e.use(t);if(!t.poll)return void(yield dY(r,t));const n=t.interval||1e3;let i,s=-1;try{if(s="string"===typeof n?Rw(n)||-1:n,!s||s<0)throw new Error("invalid duration")}catch(WV){throw mn(WV,"ERR_INVALID_POLL_INTERVAL")}try{while(1)yield dY(r,t),await new Promise((e=>{i=setTimeout(e,s)}))}finally{clearTimeout(i)}};return xw(t)}class pY{constructor({repo:e,network:t}){this.repo=cY({repo:e}),this.bw=fY({network:t}),this.bitswap=tx({network:t})}}var yY=gY;function gY(e,t,r){if(!e)return r;var n,i;if(Array.isArray(t)&&(n=t.slice(0)),"string"==typeof t&&(n=t.split(".")),"symbol"==typeof t&&(n=[t]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");while(n.length){if(i=n.shift(),!e)return r;if(e=e[i],void 0===e)return r}return e}var mY=r(308);const wY=Jr("ipfs:repo:migrator:migration-8");function bY(e){return e.child?bY(e.child):e}function vY(e){try{const t=Pi.decode(`b${e.toString().toLowerCase().slice(1)}`),r=ji.decode(t).multihash.bytes,n=Pi.encode(r).slice(1).toUpperCase();return new Ew(`/${n}`,!1)}catch(WV){return e}}function EY(e){try{const t=Pi.decode(`b${e.toString().toLowerCase().slice(1)}`),r=hi(t),n=Pi.encode(ji.createV1(Sl,r).bytes).slice(1);return new Ew(`/${n.toUpperCase()}`,!1)}catch{return e}}async function _Y(e,t,r){const n=e.blocks;await n.open();const i=bY(n),s=await mY(i.queryKeys({filters:[e=>{const t=r(e);return t.toString()!==e.toString()}]}));try{let e=0;for await(const n of i.query({})){const o=r(n.key);o.toString()!==n.key.toString()&&(e+=1,wY(`Migrating Block from ${n.key} to ${o}`,await i.has(n.key)),await i.delete(n.key),await i.put(o,n.value),t(e/s*100,`Migrated Block from ${n.key} to ${o}`))}}finally{await n.close()}}const SY={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(e,t=(()=>{}))=>_Y(e,t,vY),revert:(e,t=(()=>{}))=>_Y(e,t,EY)},AY=wn.Reader,IY=wn.Writer,CY=(wn.util,wn.roots["default"]||(wn.roots["default"]={})),kY=CY.ipfs=(()=>{const e={};return e.pin=function(){const e={};return e.Set=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.version=0,e.prototype.fanout=0,e.prototype.seed=0,e.encode=function(e,t){return t||(t=IY.create()),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(8).uint32(e.version),null!=e.fanout&&Object.hasOwnProperty.call(e,"fanout")&&t.uint32(16).uint32(e.fanout),null!=e.seed&&Object.hasOwnProperty.call(e,"seed")&&t.uint32(29).fixed32(e.seed),t},e.decode=function(e,t){e instanceof AY||(e=AY.create(e));var r=void 0===t?e.len:e.pos+t,n=new CY.ipfs.pin.Set;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.version=e.uint32();break;case 2:n.fanout=e.uint32();break;case 3:n.seed=e.fixed32();break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof CY.ipfs.pin.Set)return e;var t=new CY.ipfs.pin.Set;return null!=e.version&&(t.version=e.version>>>0),null!=e.fanout&&(t.fanout=e.fanout>>>0),null!=e.seed&&(t.seed=e.seed>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.version=0,r.fanout=0,r.seed=0),null!=e.version&&e.hasOwnProperty("version")&&(r.version=e.version),null!=e.fanout&&e.hasOwnProperty("fanout")&&(r.fanout=e.fanout),null!=e.seed&&e.hasOwnProperty("seed")&&(r.seed=e.seed),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e}(),e}(),e})();var TY=r(6132);const RY=new Ew("/local/pins"),PY=256,xY=8192,DY=ji.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),OY={direct:"direct",recursive:"recursive"};function NY(e){return new Ew(`/${Pi.encode(e.multihash.bytes).toUpperCase().substring(1)}`)}function LY(e,t){for(let r=0;r<e.byteLength;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}const BY=kY.pin.Set;function UY(e){const t=e.Data;if(!t)throw new Error("No data present");const r=Of.decode(t),n=Of.decode.bytes;if(n<=0)throw new Error("Invalid Set header length");if(n+r>t.length)throw new Error("Impossibly large set header length");const i=t.slice(n,r+n),s=BY.toObject(BY.decode(i),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(1!==s.version)throw new Error(`Unsupported Set version: ${s.version}`);if(s.fanout>e.Links.length)throw new Error("Impossibly large fanout");return{header:s,data:t.slice(r+n)}}function MY(e,t){const r=new Uint8Array(4),n=new DataView(r.buffer);n.setUint32(0,e,!0);const i=Jl(t.toString()),s=(0,UT.concat)([r,i],r.byteLength+i.byteLength);return TY(C_(s))}async function*jY(e,t){const r=UY(t);let n=0;for(const i of t.Links){if(n<r.header.fanout){const t=i.Hash;if(!DY.equals(t)){const r=await e.get(t),n=Ts(r);yield*jY(e,n)}}else yield i.Hash;n++}}async function*VY(e,t,r){const n=t.Links.find((e=>e.Name===r));if(!n)throw new Error("No link found with name "+r);const i=await e.get(n.Hash),s=Ts(i);yield*jY(e,s)}function zY(e,t){return r(t,0);async function r(t,n){const i=BY.encode({version:1,fanout:PY,seed:n}).finish(),s=Of.encode(i.length),o=(0,UT.concat)([s,i]),a=[];for(let e=0;e<PY;e++)a.push({Name:"",Tsize:1,Hash:DY});if(t.length<=xY){const e=t.map((e=>({link:{Name:"",Tsize:1,Hash:e.key},data:e.data||new Uint8Array}))).sort(((e,t)=>LY(e.link.Hash.bytes,t.link.Hash.bytes))),r=a.concat(e.map((e=>e.link))),n=(0,UT.concat)([o,...e.map((e=>e.data))]);return{Data:n,Links:r}}{const e=t.reduce(((e,t)=>{const r=MY(n,t.key)%PY;return e[r]=r in e?e[r].concat([t]):[t],e}),[]);let i=0;for(const t of e){const e=await r(t,n+1);await c(e,i),i++}return{Data:o,Links:a}}async function c(t,r){const n=ks(t),i=await vl.digest(n),s=ji.createV0(i);await e.put(s,n);const o=t.Links.reduce(((e,t)=>e+(t.Tsize||0)),0)+n.length;a[r]={Name:"",Tsize:o,Hash:s}}}}async function FY(e,t,r){const n=await zY(e,r.map((e=>({key:e})))),i=ks(n),s=await vl.digest(i),o=ji.createV0(s);await e.put(o,i);const a=n.Links.reduce(((e,t)=>e+t.Tsize),0)+i.length;return{Name:t,Tsize:a,Hash:o}}async function $Y(e,t,r,n){if(!await t.has(RY))return;const i=await t.get(RY),s=ji.decode(i),o=await e.get(s),a=Ts(o);let c=0;const l=await mY(VY(e,a,OY.recursive))+await mY(VY(e,a,OY.direct));for await(const u of VY(e,a,OY.recursive)){c++;const e={depth:1/0};0!==u.version&&(e.version=u.version),u.code!==Cs&&(e.codec=u.code),await r.put(NY(u),Ka(e)),n(c/l*100,`Migrated recursive pin ${u}`)}for await(const u of VY(e,a,OY.direct)){c++;const e={depth:0};0!==u.version&&(e.version=u.version),u.code!==Cs&&(e.codec=u.code),await r.put(NY(u),Ka(e)),n(c/l*100,`Migrated direct pin ${u}`)}await e.delete(s),await t.delete(RY)}async function KY(e,t,r,n){const i=[],s=[];let o=0;const a=await mY(r.queryKeys({}));for await(const{key:d,value:f}of r.query({})){o++;const e=Xa(f),t=ji.create(e.version||0,e.codec||Cs,hi(Pi.decode("b"+d.toString().toLowerCase().split("/").pop())));0===e.depth?(n(o/a*100,`Reverted direct pin ${t}`),s.push(t)):(n(o/a*100,`Reverted recursive pin ${t}`),i.push(t))}n(100,"Updating pin root");const c={Links:[await FY(e,OY.direct,s),await FY(e,OY.recursive,i)]},l=ks(c),u=await vl.digest(l),h=ji.createV0(u);await e.put(h,l),await t.put(RY,h.bytes)}async function qY(e,t,r){const n=e.blocks,i=e.datastore,s=e.pins;await n.open(),await i.open(),await s.open();try{await r(n,i,s,t)}finally{await s.close(),await i.close(),await n.close()}}const HY={version:9,description:"Migrates pins to datastore",migrate:(e,t=(()=>{}))=>qY(e,t,$Y),revert:(e,t=(()=>{}))=>qY(e,t,KY)},GY=new Ew("/config"),WY=new Ew("/version");function YY(e){let t=e;while(t.db||t.child)if(t=t.db||t.child,"level-js"===t.type||"Level"===t.constructor.name)return t}async function JY(e,t,r){const n=await t(e);if(n)return n;const i=YY(r);return!!i&&new Promise(((t,r)=>{const n=i.store("readonly").get(e.toString());n.transaction.onabort=()=>{r(n.transaction.error)},n.transaction.oncomplete=()=>{t(Boolean(n.result))}}))}async function QY(e,t,r,n){if(await r(e))return t(e);const i=YY(n);if(!i)throw I_();return new Promise(((t,r)=>{const n=i.store("readonly").get(e.toString());n.transaction.onabort=()=>{r(n.transaction.error)},n.transaction.oncomplete=()=>{if(n.result)return t(n.result);r(I_())}}))}function XY(e){const t=e.get.bind(e),r=e.has.bind(e);return e.get=n=>QY(n,t,r,e),e.has=t=>JY(t,r,e),e}function ZY(e){return{...e,root:XY(e.root),datastore:XY(e.datastore),pins:XY(e.pins),keys:XY(e.keys)}}async function eJ(e,t,r=(()=>{})){const n=YY(t);if(!n)return void r(`${e} did not need an upgrade`);r(`Upgrading ${e}`);const i=(e,t)=>[{type:"del",key:e},{type:"put",key:Jl(e),value:t}];await sJ(n,i)}async function tJ(e,t,r=(()=>{})){const n=YY(t);if(!n)return void r(`${e} did not need a downgrade`);r(`Downgrading ${e}`);const i=(e,t)=>[{type:"del",key:e},{type:"put",key:C_(e),value:t}];await sJ(n,i)}function rJ(e){return e.child?rJ(e.child):e}async function nJ(e,t,r){const n=Object.entries(e).map((([e,t])=>({key:e,backend:rJ(t)}))).filter((({key:e,backend:t})=>"LevelDatastore"===t.constructor.name)).map((({key:e,backend:t})=>({name:e,store:t})));t(0,`Migrating ${n.length} dbs`);let i=0;const s=e=>{t(Math.round(i/n.length*100),e)};for(const{name:o,store:a}of n){await a.open();try{await r(o,a,s)}finally{i++,await a.close()}}t(100,`Migrated ${n.length} dbs`)}const iJ={version:10,description:"Migrates datastore-level keys to binary",migrate:(e,t=(()=>{}))=>nJ(e,t,eJ),revert:(e,t=(()=>{}))=>nJ(e,t,tJ)};function sJ(e,t){function r(t,r){const n=e.store("readwrite"),i=n.transaction;let s,o=0;function a(){const e=t[o++],r=e.key;let c;try{c="del"===e.type?n.delete(r):n.put(e.value,r)}catch(WV){return s=WV,void i.abort()}o<t.length&&(c.onsuccess=a)}i.onabort=()=>r(s||i.error||new Error("aborted by user")),i.oncomplete=()=>r(),a()}return new Promise(((n,i)=>{const s=e.iterator(),o=e=>e;function a(){const e=(e,o,c)=>{if(e||void 0===o){const e=e=>{e?i(e):n()};s.end(e)}else r(t(o,c),a)};s.next(e)}s._deserializeKey=s._deserializeValue=o,a()}))}const oJ=new Ew("/local/filesroot");async function aJ(e,t=(()=>{})){if(t(100,"Migrating MFS root to repo datastore"),await e.root.open(),await e.datastore.open(),await e.root.has(oJ)){const t=await e.root.get(oJ);await e.datastore.put(oJ,t),await e.root.delete(oJ)}await e.datastore.close(),await e.root.close(),t(100,"Stored MFS root in repo datastore")}async function cJ(e,t=(()=>{})){if(t(100,"Migrating MFS root to repo root datastore"),await e.root.open(),await e.datastore.open(),await e.datastore.has(oJ)){const t=await e.datastore.get(oJ);await e.root.put(oJ,t),await e.datastore.delete(oJ)}await e.datastore.close(),await e.root.close(),t(100,"Stored MFS root in repo root datastore")}const lJ={version:11,description:"Store mfs root in the datastore",migrate:aJ,revert:cJ},uJ=wn.Reader,hJ=wn.Writer,dJ=wn.util,fJ=wn.roots["default"]||(wn.roots["default"]={}),pJ=fJ.Protocols=(()=>{function e(e){if(this.protocols=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.protocols=dJ.emptyArray,e.encode=function(e,t){if(t||(t=hJ.create()),null!=e.protocols&&e.protocols.length)for(var r=0;r<e.protocols.length;++r)t.uint32(10).string(e.protocols[r]);return t},e.decode=function(e,t){e instanceof uJ||(e=uJ.create(e));var r=void 0===t?e.len:e.pos+t,n=new fJ.Protocols;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.protocols&&n.protocols.length||(n.protocols=[]),n.protocols.push(e.string());break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof fJ.Protocols)return e;var t=new fJ.Protocols;if(e.protocols){if(!Array.isArray(e.protocols))throw TypeError(".Protocols.protocols: array expected");t.protocols=[];for(var r=0;r<e.protocols.length;++r)t.protocols[r]=String(e.protocols[r])}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.protocols=[]),e.protocols&&e.protocols.length){r.protocols=[];for(var n=0;n<e.protocols.length;++n)r.protocols[n]=e.protocols[n]}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e})(),yJ=wn.Reader,gJ=wn.Writer,mJ=wn.util,wJ=wn.roots["default"]||(wn.roots["default"]={}),bJ=wJ.Addresses=(()=>{function e(e){if(this.addrs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.addrs=mJ.emptyArray,e.prototype.certifiedRecord=null,e.encode=function(e,t){if(t||(t=gJ.create()),null!=e.addrs&&e.addrs.length)for(var r=0;r<e.addrs.length;++r)wJ.Addresses.Address.encode(e.addrs[r],t.uint32(10).fork()).ldelim();return null!=e.certifiedRecord&&Object.hasOwnProperty.call(e,"certifiedRecord")&&wJ.Addresses.CertifiedRecord.encode(e.certifiedRecord,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof yJ||(e=yJ.create(e));var r=void 0===t?e.len:e.pos+t,n=new wJ.Addresses;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.addrs&&n.addrs.length||(n.addrs=[]),n.addrs.push(wJ.Addresses.Address.decode(e,e.uint32()));break;case 2:n.certifiedRecord=wJ.Addresses.CertifiedRecord.decode(e,e.uint32());break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof wJ.Addresses)return e;var t=new wJ.Addresses;if(e.addrs){if(!Array.isArray(e.addrs))throw TypeError(".Addresses.addrs: array expected");t.addrs=[];for(var r=0;r<e.addrs.length;++r){if("object"!==typeof e.addrs[r])throw TypeError(".Addresses.addrs: object expected");t.addrs[r]=wJ.Addresses.Address.fromObject(e.addrs[r])}}if(null!=e.certifiedRecord){if("object"!==typeof e.certifiedRecord)throw TypeError(".Addresses.certifiedRecord: object expected");t.certifiedRecord=wJ.Addresses.CertifiedRecord.fromObject(e.certifiedRecord)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.addrs=[]),t.defaults&&(r.certifiedRecord=null),e.addrs&&e.addrs.length){r.addrs=[];for(var n=0;n<e.addrs.length;++n)r.addrs[n]=wJ.Addresses.Address.toObject(e.addrs[n],t)}return null!=e.certifiedRecord&&e.hasOwnProperty("certifiedRecord")&&(r.certifiedRecord=wJ.Addresses.CertifiedRecord.toObject(e.certifiedRecord,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e.Address=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}let t;return e.prototype.multiaddr=mJ.newBuffer([]),e.prototype.isCertified=null,Object.defineProperty(e.prototype,"_isCertified",{get:mJ.oneOfGetter(t=["isCertified"]),set:mJ.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=gJ.create()),null!=e.multiaddr&&Object.hasOwnProperty.call(e,"multiaddr")&&t.uint32(10).bytes(e.multiaddr),null!=e.isCertified&&Object.hasOwnProperty.call(e,"isCertified")&&t.uint32(16).bool(e.isCertified),t},e.decode=function(e,t){e instanceof yJ||(e=yJ.create(e));var r=void 0===t?e.len:e.pos+t,n=new wJ.Addresses.Address;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.multiaddr=e.bytes();break;case 2:n.isCertified=e.bool();break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof wJ.Addresses.Address)return e;var t=new wJ.Addresses.Address;return null!=e.multiaddr&&("string"===typeof e.multiaddr?mJ.base64.decode(e.multiaddr,t.multiaddr=mJ.newBuffer(mJ.base64.length(e.multiaddr)),0):e.multiaddr.length&&(t.multiaddr=e.multiaddr)),null!=e.isCertified&&(t.isCertified=Boolean(e.isCertified)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.multiaddr="":(r.multiaddr=[],t.bytes!==Array&&(r.multiaddr=mJ.newBuffer(r.multiaddr)))),null!=e.multiaddr&&e.hasOwnProperty("multiaddr")&&(r.multiaddr=t.bytes===String?mJ.base64.encode(e.multiaddr,0,e.multiaddr.length):t.bytes===Array?Array.prototype.slice.call(e.multiaddr):e.multiaddr),null!=e.isCertified&&e.hasOwnProperty("isCertified")&&(r.isCertified=e.isCertified,t.oneofs&&(r._isCertified="isCertified")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e}(),e.CertifiedRecord=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.seq=mJ.Long?mJ.Long.fromBits(0,0,!0):0,e.prototype.raw=mJ.newBuffer([]),e.encode=function(e,t){return t||(t=gJ.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.raw&&Object.hasOwnProperty.call(e,"raw")&&t.uint32(18).bytes(e.raw),t},e.decode=function(e,t){e instanceof yJ||(e=yJ.create(e));var r=void 0===t?e.len:e.pos+t,n=new wJ.Addresses.CertifiedRecord;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.seq=e.uint64();break;case 2:n.raw=e.bytes();break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof wJ.Addresses.CertifiedRecord)return e;var t=new wJ.Addresses.CertifiedRecord;return null!=e.seq&&(mJ.Long?(t.seq=mJ.Long.fromValue(e.seq)).unsigned=!0:"string"===typeof e.seq?t.seq=parseInt(e.seq,10):"number"===typeof e.seq?t.seq=e.seq:"object"===typeof e.seq&&(t.seq=new mJ.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.raw&&("string"===typeof e.raw?mJ.base64.decode(e.raw,t.raw=mJ.newBuffer(mJ.base64.length(e.raw)),0):e.raw.length&&(t.raw=e.raw)),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(mJ.Long){var n=new mJ.Long(0,0,!0);r.seq=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.seq=t.longs===String?"0":0;t.bytes===String?r.raw="":(r.raw=[],t.bytes!==Array&&(r.raw=mJ.newBuffer(r.raw)))}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"===typeof e.seq?r.seq=t.longs===String?String(e.seq):e.seq:r.seq=t.longs===String?mJ.Long.prototype.toString.call(e.seq):t.longs===Number?new mJ.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.raw&&e.hasOwnProperty("raw")&&(r.raw=t.bytes===String?mJ.base64.encode(e.raw,0,e.raw.length):t.bytes===Array?Array.prototype.slice.call(e.raw):e.raw),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e}(),e})(),vJ=wn.Reader,EJ=wn.Writer,_J=wn.util,SJ=wn.roots["default"]||(wn.roots["default"]={}),AJ=SJ.Peer=(()=>{function e(e){if(this.addresses=[],this.protocols=[],this.metadata=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}let t;return e.prototype.addresses=_J.emptyArray,e.prototype.protocols=_J.emptyArray,e.prototype.metadata=_J.emptyArray,e.prototype.pubKey=null,e.prototype.peerRecordEnvelope=null,Object.defineProperty(e.prototype,"_pubKey",{get:_J.oneOfGetter(t=["pubKey"]),set:_J.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_peerRecordEnvelope",{get:_J.oneOfGetter(t=["peerRecordEnvelope"]),set:_J.oneOfSetter(t)}),e.encode=function(e,t){if(t||(t=EJ.create()),null!=e.addresses&&e.addresses.length)for(var r=0;r<e.addresses.length;++r)SJ.Address.encode(e.addresses[r],t.uint32(10).fork()).ldelim();if(null!=e.protocols&&e.protocols.length)for(r=0;r<e.protocols.length;++r)t.uint32(18).string(e.protocols[r]);if(null!=e.metadata&&e.metadata.length)for(r=0;r<e.metadata.length;++r)SJ.Metadata.encode(e.metadata[r],t.uint32(26).fork()).ldelim();return null!=e.pubKey&&Object.hasOwnProperty.call(e,"pubKey")&&t.uint32(34).bytes(e.pubKey),null!=e.peerRecordEnvelope&&Object.hasOwnProperty.call(e,"peerRecordEnvelope")&&t.uint32(42).bytes(e.peerRecordEnvelope),t},e.decode=function(e,t){e instanceof vJ||(e=vJ.create(e));var r=void 0===t?e.len:e.pos+t,n=new SJ.Peer;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.addresses&&n.addresses.length||(n.addresses=[]),n.addresses.push(SJ.Address.decode(e,e.uint32()));break;case 2:n.protocols&&n.protocols.length||(n.protocols=[]),n.protocols.push(e.string());break;case 3:n.metadata&&n.metadata.length||(n.metadata=[]),n.metadata.push(SJ.Metadata.decode(e,e.uint32()));break;case 4:n.pubKey=e.bytes();break;case 5:n.peerRecordEnvelope=e.bytes();break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof SJ.Peer)return e;var t=new SJ.Peer;if(e.addresses){if(!Array.isArray(e.addresses))throw TypeError(".Peer.addresses: array expected");t.addresses=[];for(var r=0;r<e.addresses.length;++r){if("object"!==typeof e.addresses[r])throw TypeError(".Peer.addresses: object expected");t.addresses[r]=SJ.Address.fromObject(e.addresses[r])}}if(e.protocols){if(!Array.isArray(e.protocols))throw TypeError(".Peer.protocols: array expected");t.protocols=[];for(r=0;r<e.protocols.length;++r)t.protocols[r]=String(e.protocols[r])}if(e.metadata){if(!Array.isArray(e.metadata))throw TypeError(".Peer.metadata: array expected");t.metadata=[];for(r=0;r<e.metadata.length;++r){if("object"!==typeof e.metadata[r])throw TypeError(".Peer.metadata: object expected");t.metadata[r]=SJ.Metadata.fromObject(e.metadata[r])}}return null!=e.pubKey&&("string"===typeof e.pubKey?_J.base64.decode(e.pubKey,t.pubKey=_J.newBuffer(_J.base64.length(e.pubKey)),0):e.pubKey.length&&(t.pubKey=e.pubKey)),null!=e.peerRecordEnvelope&&("string"===typeof e.peerRecordEnvelope?_J.base64.decode(e.peerRecordEnvelope,t.peerRecordEnvelope=_J.newBuffer(_J.base64.length(e.peerRecordEnvelope)),0):e.peerRecordEnvelope.length&&(t.peerRecordEnvelope=e.peerRecordEnvelope)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.addresses=[],r.protocols=[],r.metadata=[]),e.addresses&&e.addresses.length){r.addresses=[];for(var n=0;n<e.addresses.length;++n)r.addresses[n]=SJ.Address.toObject(e.addresses[n],t)}if(e.protocols&&e.protocols.length){r.protocols=[];for(n=0;n<e.protocols.length;++n)r.protocols[n]=e.protocols[n]}if(e.metadata&&e.metadata.length){r.metadata=[];for(n=0;n<e.metadata.length;++n)r.metadata[n]=SJ.Metadata.toObject(e.metadata[n],t)}return null!=e.pubKey&&e.hasOwnProperty("pubKey")&&(r.pubKey=t.bytes===String?_J.base64.encode(e.pubKey,0,e.pubKey.length):t.bytes===Array?Array.prototype.slice.call(e.pubKey):e.pubKey,t.oneofs&&(r._pubKey="pubKey")),null!=e.peerRecordEnvelope&&e.hasOwnProperty("peerRecordEnvelope")&&(r.peerRecordEnvelope=t.bytes===String?_J.base64.encode(e.peerRecordEnvelope,0,e.peerRecordEnvelope.length):t.bytes===Array?Array.prototype.slice.call(e.peerRecordEnvelope):e.peerRecordEnvelope,t.oneofs&&(r._peerRecordEnvelope="peerRecordEnvelope")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e})(),IJ=(SJ.Address=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}let t;return e.prototype.multiaddr=_J.newBuffer([]),e.prototype.isCertified=null,Object.defineProperty(e.prototype,"_isCertified",{get:_J.oneOfGetter(t=["isCertified"]),set:_J.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=EJ.create()),null!=e.multiaddr&&Object.hasOwnProperty.call(e,"multiaddr")&&t.uint32(10).bytes(e.multiaddr),null!=e.isCertified&&Object.hasOwnProperty.call(e,"isCertified")&&t.uint32(16).bool(e.isCertified),t},e.decode=function(e,t){e instanceof vJ||(e=vJ.create(e));var r=void 0===t?e.len:e.pos+t,n=new SJ.Address;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.multiaddr=e.bytes();break;case 2:n.isCertified=e.bool();break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof SJ.Address)return e;var t=new SJ.Address;return null!=e.multiaddr&&("string"===typeof e.multiaddr?_J.base64.decode(e.multiaddr,t.multiaddr=_J.newBuffer(_J.base64.length(e.multiaddr)),0):e.multiaddr.length&&(t.multiaddr=e.multiaddr)),null!=e.isCertified&&(t.isCertified=Boolean(e.isCertified)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.multiaddr="":(r.multiaddr=[],t.bytes!==Array&&(r.multiaddr=_J.newBuffer(r.multiaddr)))),null!=e.multiaddr&&e.hasOwnProperty("multiaddr")&&(r.multiaddr=t.bytes===String?_J.base64.encode(e.multiaddr,0,e.multiaddr.length):t.bytes===Array?Array.prototype.slice.call(e.multiaddr):e.multiaddr),null!=e.isCertified&&e.hasOwnProperty("isCertified")&&(r.isCertified=e.isCertified,t.oneofs&&(r._isCertified="isCertified")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e})(),SJ.Metadata=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key="",e.prototype.value=_J.newBuffer([]),e.encode=function(e,t){return t||(t=EJ.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).bytes(e.value),t},e.decode=function(e,t){e instanceof vJ||(e=vJ.create(e));var r=void 0===t?e.len:e.pos+t,n=new SJ.Metadata;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.key=e.string();break;case 2:n.value=e.bytes();break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof SJ.Metadata)return e;var t=new SJ.Metadata;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&("string"===typeof e.value?_J.base64.decode(e.value,t.value=_J.newBuffer(_J.base64.length(e.value)),0):e.value.length&&(t.value=e.value)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.key="",t.bytes===String?r.value="":(r.value=[],t.bytes!==Array&&(r.value=_J.newBuffer(r.value)))),null!=e.key&&e.hasOwnProperty("key")&&(r.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(r.value=t.bytes===String?_J.base64.encode(e.value,0,e.value.length):t.bytes===Array?Array.prototype.slice.call(e.value):e.value),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e})(),wn.Reader),CJ=wn.Writer,kJ=wn.util,TJ=wn.roots["default"]||(wn.roots["default"]={}),RJ=TJ.Envelope=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.publicKey=kJ.newBuffer([]),e.prototype.payloadType=kJ.newBuffer([]),e.prototype.payload=kJ.newBuffer([]),e.prototype.signature=kJ.newBuffer([]),e.encode=function(e,t){return t||(t=CJ.create()),null!=e.publicKey&&Object.hasOwnProperty.call(e,"publicKey")&&t.uint32(10).bytes(e.publicKey),null!=e.payloadType&&Object.hasOwnProperty.call(e,"payloadType")&&t.uint32(18).bytes(e.payloadType),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&t.uint32(26).bytes(e.payload),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(42).bytes(e.signature),t},e.decode=function(e,t){e instanceof IJ||(e=IJ.create(e));var r=void 0===t?e.len:e.pos+t,n=new TJ.Envelope;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.publicKey=e.bytes();break;case 2:n.payloadType=e.bytes();break;case 3:n.payload=e.bytes();break;case 5:n.signature=e.bytes();break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof TJ.Envelope)return e;var t=new TJ.Envelope;return null!=e.publicKey&&("string"===typeof e.publicKey?kJ.base64.decode(e.publicKey,t.publicKey=kJ.newBuffer(kJ.base64.length(e.publicKey)),0):e.publicKey.length&&(t.publicKey=e.publicKey)),null!=e.payloadType&&("string"===typeof e.payloadType?kJ.base64.decode(e.payloadType,t.payloadType=kJ.newBuffer(kJ.base64.length(e.payloadType)),0):e.payloadType.length&&(t.payloadType=e.payloadType)),null!=e.payload&&("string"===typeof e.payload?kJ.base64.decode(e.payload,t.payload=kJ.newBuffer(kJ.base64.length(e.payload)),0):e.payload.length&&(t.payload=e.payload)),null!=e.signature&&("string"===typeof e.signature?kJ.base64.decode(e.signature,t.signature=kJ.newBuffer(kJ.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.publicKey="":(r.publicKey=[],t.bytes!==Array&&(r.publicKey=kJ.newBuffer(r.publicKey))),t.bytes===String?r.payloadType="":(r.payloadType=[],t.bytes!==Array&&(r.payloadType=kJ.newBuffer(r.payloadType))),t.bytes===String?r.payload="":(r.payload=[],t.bytes!==Array&&(r.payload=kJ.newBuffer(r.payload))),t.bytes===String?r.signature="":(r.signature=[],t.bytes!==Array&&(r.signature=kJ.newBuffer(r.signature)))),null!=e.publicKey&&e.hasOwnProperty("publicKey")&&(r.publicKey=t.bytes===String?kJ.base64.encode(e.publicKey,0,e.publicKey.length):t.bytes===Array?Array.prototype.slice.call(e.publicKey):e.publicKey),null!=e.payloadType&&e.hasOwnProperty("payloadType")&&(r.payloadType=t.bytes===String?kJ.base64.encode(e.payloadType,0,e.payloadType.length):t.bytes===Array?Array.prototype.slice.call(e.payloadType):e.payloadType),null!=e.payload&&e.hasOwnProperty("payload")&&(r.payload=t.bytes===String?kJ.base64.encode(e.payload,0,e.payload.length):t.bytes===Array?Array.prototype.slice.call(e.payload):e.payload),null!=e.signature&&e.hasOwnProperty("signature")&&(r.signature=t.bytes===String?kJ.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e})(),PJ=wn.Reader,xJ=wn.Writer,DJ=wn.util,OJ=wn.roots["default"]||(wn.roots["default"]={}),NJ=OJ.PeerRecord=(()=>{function e(e){if(this.addresses=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.peerId=DJ.newBuffer([]),e.prototype.seq=DJ.Long?DJ.Long.fromBits(0,0,!0):0,e.prototype.addresses=DJ.emptyArray,e.encode=function(e,t){if(t||(t=xJ.create()),null!=e.peerId&&Object.hasOwnProperty.call(e,"peerId")&&t.uint32(10).bytes(e.peerId),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(16).uint64(e.seq),null!=e.addresses&&e.addresses.length)for(var r=0;r<e.addresses.length;++r)OJ.PeerRecord.AddressInfo.encode(e.addresses[r],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof PJ||(e=PJ.create(e));var r=void 0===t?e.len:e.pos+t,n=new OJ.PeerRecord;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.peerId=e.bytes();break;case 2:n.seq=e.uint64();break;case 3:n.addresses&&n.addresses.length||(n.addresses=[]),n.addresses.push(OJ.PeerRecord.AddressInfo.decode(e,e.uint32()));break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof OJ.PeerRecord)return e;var t=new OJ.PeerRecord;if(null!=e.peerId&&("string"===typeof e.peerId?DJ.base64.decode(e.peerId,t.peerId=DJ.newBuffer(DJ.base64.length(e.peerId)),0):e.peerId.length&&(t.peerId=e.peerId)),null!=e.seq&&(DJ.Long?(t.seq=DJ.Long.fromValue(e.seq)).unsigned=!0:"string"===typeof e.seq?t.seq=parseInt(e.seq,10):"number"===typeof e.seq?t.seq=e.seq:"object"===typeof e.seq&&(t.seq=new DJ.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.addresses){if(!Array.isArray(e.addresses))throw TypeError(".PeerRecord.addresses: array expected");t.addresses=[];for(var r=0;r<e.addresses.length;++r){if("object"!==typeof e.addresses[r])throw TypeError(".PeerRecord.addresses: object expected");t.addresses[r]=OJ.PeerRecord.AddressInfo.fromObject(e.addresses[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.addresses=[]),t.defaults)if(t.bytes===String?r.peerId="":(r.peerId=[],t.bytes!==Array&&(r.peerId=DJ.newBuffer(r.peerId))),DJ.Long){var n=new DJ.Long(0,0,!0);r.seq=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.seq=t.longs===String?"0":0;if(null!=e.peerId&&e.hasOwnProperty("peerId")&&(r.peerId=t.bytes===String?DJ.base64.encode(e.peerId,0,e.peerId.length):t.bytes===Array?Array.prototype.slice.call(e.peerId):e.peerId),null!=e.seq&&e.hasOwnProperty("seq")&&("number"===typeof e.seq?r.seq=t.longs===String?String(e.seq):e.seq:r.seq=t.longs===String?DJ.Long.prototype.toString.call(e.seq):t.longs===Number?new DJ.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.addresses&&e.addresses.length){r.addresses=[];for(var i=0;i<e.addresses.length;++i)r.addresses[i]=OJ.PeerRecord.AddressInfo.toObject(e.addresses[i],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e.AddressInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.multiaddr=DJ.newBuffer([]),e.encode=function(e,t){return t||(t=xJ.create()),null!=e.multiaddr&&Object.hasOwnProperty.call(e,"multiaddr")&&t.uint32(10).bytes(e.multiaddr),t},e.decode=function(e,t){e instanceof PJ||(e=PJ.create(e));var r=void 0===t?e.len:e.pos+t,n=new OJ.PeerRecord.AddressInfo;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.multiaddr=e.bytes();break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof OJ.PeerRecord.AddressInfo)return e;var t=new OJ.PeerRecord.AddressInfo;return null!=e.multiaddr&&("string"===typeof e.multiaddr?DJ.base64.decode(e.multiaddr,t.multiaddr=DJ.newBuffer(DJ.base64.length(e.multiaddr)),0):e.multiaddr.length&&(t.multiaddr=e.multiaddr)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.multiaddr="":(r.multiaddr=[],t.bytes!==Array&&(r.multiaddr=DJ.newBuffer(r.multiaddr)))),null!=e.multiaddr&&e.hasOwnProperty("multiaddr")&&(r.multiaddr=t.bytes===String?DJ.base64.encode(e.multiaddr,0,e.multiaddr.length):t.bytes===Array?Array.prototype.slice.call(e.multiaddr):e.multiaddr),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e}(),e})();async function LJ(e,t=(()=>{})){t(0,"Storing each peerstore key under a single datastore key"),await e.datastore.open();const r={},n=[];for await(const{key:i,value:s}of e.datastore.query({prefix:"/peers"})){n.push(i);const e=i.toString(),[t,o,a,c,l]=e.split("/");if("peers"===o&&(["protos","addrs","metadata","keys"].includes(a)&&c))if(r[c]=r[c]||{addresses:[],protocols:[],metadata:[]},"protos"===a){const e=pJ.decode(s);r[c].protocols=e.protocols.sort()}else if("addrs"===a){const e=bJ.decode(s);r[c].addresses=e.addrs.sort(((e,t)=>Pp(e.multiaddr).toString().localeCompare(Pp(t.multiaddr).toString()))),e.certifiedRecord&&e.certifiedRecord.raw&&(r[c].peerRecordEnvelope=e.certifiedRecord.raw)}else"metadata"===a?r[c].metadata.push({key:l,value:s}):"keys"===a&&(r[c].pubKey=s)}t(33,"Read peer data from store");for(const i of n)await e.datastore.delete(i);t(66,"Removed existing peer data from store");for(const i of Object.keys(r)){const t=r[i];t.metadata=t.metadata.sort(((e,t)=>e.key.localeCompare(t.key)));const n=AJ.encode(t).finish();await e.datastore.put(new Ew(`/peers/${i}`),n)}await e.datastore.close(),t(100,"Stored each peerstore key under a single datastore key")}async function BJ(e,t=(()=>{})){t(0,"Storing each peerstore key under a multiple datastore keys"),await e.datastore.open();const r={},n=[];for await(const{key:i,value:s}of e.datastore.query({prefix:"/peers"})){n.push(i);const e=i.toString(),[t,o,a]=e.split("/");r[a]=AJ.decode(s)}t(33,"Read peer data from store");for(const i of n)await e.datastore.delete(i);t(66,"Removed existing peer data from store");for(const[i,s]of Object.entries(r)){if(s.protocols&&s.protocols.length>0&&await e.datastore.put(new Ew(`/peers/protos/${i}`),pJ.encode({protocols:s.protocols}).finish()),s.addresses&&s.addresses.length>0){const t=s.peerRecordEnvelope;let r;if(t){const e=RJ.decode(t),n=NJ.decode(e.payload);r={raw:t,seq:n.seq}}await e.datastore.put(new Ew(`/peers/addrs/${i}`),bJ.encode({addrs:s.addresses,certifiedRecord:r}).finish())}if(s.metadata&&s.metadata.length>0)for(const{key:t,value:r}of s.metadata)await e.datastore.put(new Ew(`/peers/metadata/${i}/${t}`),r);s.pubKey&&await e.datastore.put(new Ew(`/peers/keys/${i}`),s.pubKey)}await e.datastore.close(),t(100,"Stored each peerstore key under multiple datastore keys")}wn.util.Long=void 0,wn.configure();const UJ={version:12,description:"Store each peerstore peer under a single datastore key",migrate:LJ,revert:BJ},MJ={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0};var jJ=[Object.assign({version:1},MJ),Object.assign({version:2},MJ),Object.assign({version:3},MJ),Object.assign({version:4},MJ),Object.assign({version:5},MJ),Object.assign({version:6},MJ),Object.assign({version:7},MJ),SY,HY,iJ,lJ,UJ];class VJ extends Error{constructor(e){super(e),this.name="NonReversibleMigrationError",this.code=VJ.code,this.message=e}}VJ.code="ERR_NON_REVERSIBLE_MIGRATION";class zJ extends Error{constructor(e){super(e),this.name="NotInitializedRepoError",this.code=zJ.code,this.message=e}}zJ.code="ERR_NOT_INITIALIZED_REPO";class FJ extends Error{constructor(e){super(e),this.name="RequiredParameterError",this.code=FJ.code,this.message=e}}FJ.code="ERR_REQUIRED_PARAMETER";class $J extends Error{constructor(e){super(e),this.name="InvalidValueError",this.code=$J.code,this.message=e}}$J.code="ERR_INVALID_VALUE";class KJ extends Error{constructor(e){super(e),this.name="MissingRepoOptionsError",this.code=KJ.code,this.message=e}}KJ.code="ERR_MISSING_REPO_OPTIONS";const qJ=Jr("ipfs:repo:migrator:repo:init");async function HJ(e){if(!e)throw new KJ("Please pass repo options when trying to open a repo");const t=e.root;try{await t.open();const e=await t.has(WY),r=await t.has(GY);return!(!e||!r)||(qJ(`Version entry present: ${e}`),qJ(`Config entry present: ${r}`),!1)}catch(r){return qJ("While checking if repo is initialized error was thrown: "+r.message),!1}finally{if(void 0!==t)try{await t.close()}catch{}}}async function GJ(e){if(!await HJ(e))throw new zJ("Repo is not initialized!");const t=e.root;await t.open();try{return parseInt(C_(await t.get(WY)))}finally{await t.close()}}async function WJ(e,t){if(!t)throw new KJ("Please pass repo options when trying to open a repo");const r=t.root;await r.open(),await r.put(WY,Jl(String(e))),await r.close()}const YJ=Jr("ipfs:repo:migrator");function JJ(e){return e=e||jJ,Array.isArray(e)&&0!==e.length?e[e.length-1].version:0}async function QJ(e,t,r,n,i={}){const s=i.ignoreLock??!1,o=i.onProgress,a=i.isDryRun??!1,c=i.migrations??jJ;if(!e)throw new eQ.RequiredParameterError("Path argument is required!");if(!r)throw new eQ.RequiredParameterError("repoOptions argument is required!");if(!n)throw new eQ.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(n)||n<=0)throw new eQ.InvalidValueError("Version has to be positive integer!");t=ZY(t);const l=await GJ(t);if(l===n)return void YJ("Nothing to migrate.");if(l>n)throw new eQ.InvalidValueError(`Current repo's version (${l}) is higher then toVersion (${n}), you probably wanted to revert it?`);let u;ZJ(c,l,n),a||s||(u=await r.repoLock.lock(e));try{for(const e of c){if(void 0!==n&&e.version>n)break;if(!(e.version<=l)){YJ(`Migrating version ${e.version}`);try{if(!a){let r=()=>{};o&&(r=(t,r)=>o(e.version,t.toFixed(2),r)),await e.migrate(t,r)}}catch(h){const r=e.version-1;throw YJ(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${r}`),await WJ(r,t),new Error(`During migration to version ${e.version} exception was raised: ${h.stack||h.message||h}`)}YJ(`Migrating to version ${e.version} finished`)}}a||await WJ(n||JJ(c),t),YJ("Repo successfully migrated",void 0!==n?`to version ${n}!`:"to latest version!")}finally{a||s||!u||await u.close()}}async function XJ(e,t,r,n,i={}){const s=i.ignoreLock??!1,o=i.onProgress,a=i.isDryRun??!1,c=i.migrations??jJ;if(!e)throw new eQ.RequiredParameterError("Path argument is required!");if(!r)throw new eQ.RequiredParameterError("repoOptions argument is required!");if(!n)throw new eQ.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(n)||n<=0)throw new eQ.InvalidValueError("Version has to be positive integer!");t=ZY(t);const l=await GJ(t);if(l===n)return void YJ("Nothing to revert.");if(l<n)throw new eQ.InvalidValueError(`Current repo's version (${l}) is lower then toVersion (${n}), you probably wanted to migrate it?`);let u;ZJ(c,n,l,!0),a||s||(u=await r.repoLock.lock(e)),YJ(`Reverting from version ${l} to ${n}`);try{const e=c.slice().reverse();for(const r of e){if(r.version<=n)break;if(!(r.version>l)){YJ(`Reverting migration version ${r.version}`);try{if(!a){let e=()=>{};o&&(e=(e,t)=>o(r.version,e.toFixed(2),t)),await r.revert(t,e)}}catch(h){const e=r.version;throw YJ(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${e}`),await WJ(e,t),h.message=`During reversion to version ${r.version} exception was raised: ${h.message}`,h}YJ(`Reverting to version ${r.version} finished`)}}a||await WJ(n,t),YJ(`All migrations successfully reverted to version ${n}!`)}finally{a||s||!u||await u.close()}}function ZJ(e,t,r,n=!1){let i=0;for(const s of e){if(s.version>r)break;if(s.version>t){if(n&&!s.revert)throw new eQ.NonReversibleMigrationError(`It is not possible to revert to version ${t} because migration version ${s.version} is not reversible. Cancelling reversion.`);i++}}if(i!==r-t)throw new eQ.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${t} to ${r}`)}const eQ=pt;var tQ=r(9830);class rQ extends Error{constructor(e){super(e),this.name="LockExistsError",this.code=rQ.code}}rQ.code="ERR_LOCK_EXISTS";class nQ extends Error{constructor(e){super(e),this.name="NotFoundError",this.code=nQ.code}}nQ.code="ERR_NOT_FOUND";class iQ extends Error{constructor(e){super(e),this.name="InvalidRepoVersionError",this.code=iQ.code}}iQ.code="ERR_INVALID_REPO_VERSION";const sQ="ERR_REPO_NOT_INITIALIZED",oQ="ERR_REPO_ALREADY_OPEN",aQ="ERR_REPO_ALREADY_CLOSED";async function cQ(e,t,r){const n=await t(e);if(n)return n;const i=uQ(r);return!!i&&new Promise(((t,r)=>{const n=i.store("readonly").get(e.toString());n.transaction.onabort=()=>{r(n.transaction.error)},n.transaction.oncomplete=()=>{t(Boolean(n.result))}}))}async function lQ(e,t,r,n){if(await r(e))return t(e);const i=uQ(n);if(!i)throw new nQ;return new Promise(((t,r)=>{const n=i.store("readonly").get(e.toString());n.transaction.onabort=()=>{r(n.transaction.error)},n.transaction.oncomplete=()=>{if(n.result)return t(n.result);r(new nQ)}}))}function uQ(e){let t=e;while(t.db||t.child)if(t=t.db||t.child,"level-js"===t.type||"Level"===t.constructor.name)return t}const hQ=Jr("ipfs:repo:version"),dQ=new Ew("version");function fQ(e){return{async exists(){return cQ(dQ,e.has.bind(e),e)},async get(){const t=await lQ(dQ,e.get.bind(e),e.has.bind(e),e);return parseInt(C_(t),10)},set(t){return e.put(dQ,Jl(String(t)))},async check(e){const t=await this.get();hQ("comparing version: %s and %s",t,e);const r=6===t&&7===e||6===e&&7===t;return t===e||r}}}const pQ=Lb["default"]?Lb["default"]:Lb,yQ=new Ew("config");function gQ(e){const t=new pQ({concurrency:1}),r={async getAll(t={}){const r=await lQ(yQ,e.get.bind(e),e.has.bind(e),e);return JSON.parse(C_(r))},async get(e,t={}){if(null==e)throw new nQ(`Key ${e} does not exist in config`);const r=await this.getAll(t),n=yY(r,e);if(void 0===n)throw new nQ(`Key ${e} does not exist in config`);return n},set(e,r,i={}){if("string"!==typeof e&&!(e instanceof String))throw mn(new Error("Invalid key type: "+typeof e),"ERR_INVALID_KEY");if(void 0===r||r instanceof Uint8Array)throw mn(new Error("Invalid value type: "+typeof r),"ERR_INVALID_VALUE");return t.add((()=>n({key:e,value:r},i.signal)))},replace(e,r={}){if(!e||e instanceof Uint8Array)throw mn(new Error("Invalid value type: "+typeof e),"ERR_INVALID_VALUE");return t.add((()=>n({key:void 0,value:e},r.signal)))},async exists(){return cQ(yQ,e.has.bind(e),e)}};return r;async function n(e,t){if(t&&t.aborted)return;const n=e.key,s=e.value;if(n){const e=await r.getAll();return"object"===typeof e&&null!==e&&JK(e,n,s),i(e)}return i(s)}function i(t){const r=Jl(JSON.stringify(t,null,2));return e.put(yQ,r)}}function mQ(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function wQ(e,t={}){if(!mQ(e)&&!Array.isArray(e))throw new TypeError("Expected a plain object or array");const{deep:r,compare:n}=t,i=[],s=[],o=e=>{const t=i.indexOf(e);if(-1!==t)return s[t];const r=[];return i.push(e),s.push(r),r.push(...e.map((e=>Array.isArray(e)?o(e):mQ(e)?a(e):e))),r},a=e=>{const t=i.indexOf(e);if(-1!==t)return s[t];const c={},l=Object.keys(e).sort(n);i.push(e),s.push(c);for(const n of l){const t=e[n];let i;i=r&&Array.isArray(t)?o(t):r&&mQ(t)?a(t):t,Object.defineProperty(c,n,{...Object.getOwnPropertyDescriptor(e,n),value:i})}return c};return Array.isArray(e)?r?o(e):e.slice():a(e)}const bQ=new Ew("datastore_spec");function vQ(e){return{exists(){return e.has(bQ)},async get(){const t=await e.get(bQ);return JSON.parse(C_(t))},async set(t){return e.put(bQ,Jl(JSON.stringify(wQ(t,{deep:!0}))))}}}const EQ=new Ew("api");function _Q(e){return{async get(){const t=await e.get(EQ);return t&&t.toString()},set(t){return e.put(EQ,Jl(t.toString()))},delete(){return e.delete(EQ)}}}function SQ(e){return{open(){return e.open()},close(){return e.close()},query(t,r){return e.query(t,r)},queryKeys(t,r){return e.queryKeys(t,r)},async get(t,r){const n=AQ(t);return n.isIdentity?Promise.resolve(n.digest):e.get(t,r)},async*getMany(e,t){for await(const r of e)yield this.get(r,t)},async put(t,r,n){const{isIdentity:i}=AQ(t);i||await e.put(t,r,n)},async*putMany(t,r){const n=LR({objectMode:!0}),i=globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout;i((async()=>{try{await RR(e.putMany(async function*(){for await(const{key:e,value:r}of t)AQ(e).isIdentity||(yield{key:e,value:r}),n.push({key:e,value:r})}())),n.end()}catch(WV){n.end(WV)}})),yield*n},has(t,r){const{isIdentity:n}=AQ(t);return n?Promise.resolve(!0):e.has(t,r)},delete(t,r){const{isIdentity:n}=AQ(t);return n?Promise.resolve():e.delete(t,r)},deleteMany(t,r){return e.deleteMany(PR(t,(e=>!AQ(e).isIdentity)),r)},batch(){const t=e.batch();return{put(e,r){const{isIdentity:n}=AQ(e);n||t.put(e,r)},delete(e){const{isIdentity:r}=AQ(e);r||t.delete(e)},commit:e=>t.commit(e)}}}}function AQ(e){const t=ji.asCID(e);if(null==t)throw mn(new Error("Not a valid cid"),"ERR_INVALID_CID");return t.multihash.code!==il.code?{isIdentity:!1}:{isIdentity:!0,digest:t.multihash.digest}}const IQ=Jr("ipfs:repo:lock:memory"),CQ="repo.lock",kQ={};async function TQ(e){const t=e+"/"+CQ;if(IQ("locking %s",t),!0===kQ[t])throw new rQ(`Lock already being held for file: ${t}`);kQ[t]=!0;const r={async close(){kQ[t]&&delete kQ[t]}};return r}async function RQ(e){const t=e+"/"+CQ;return IQ(`checking lock: ${t}`),Boolean(kQ[t])}const PQ={lock:TQ,locked:RQ};var xQ={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:PQ},DQ={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};function OQ(e){const t=ji.asCID(e);if(null==t)throw mn(new Error("Not a valid cid"),"ERR_INVALID_CID");const r=Pi.encode(t.multihash.bytes);return new Ew("/"+r.slice(1).toUpperCase(),!1)}function NQ(e){return hi(Pi.decode(`b${e.toString().toLowerCase().substring(1)}`))}const LQ=Jr("ipfs:repo:utils:walk-dag");async function*BQ(e,t,r,n){try{const i=await t.get(e,n),s=await r(e.code),o=cq({bytes:i,cid:e,codec:s});for(const[,e]of o.links())yield e,yield*BQ(e,t,r,n)}catch(WV){throw LQ("Could not walk DAG for CID",e.toString(),WV),WV}}class UQ extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"===typeof e.maxAge&&0===e.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if("function"===typeof this.onEviction)for(const[t,r]of e)this.onEviction(t,r.value)}_deleteIfExpired(e,t){return"number"===typeof t.expiry&&t.expiry<=Date.now()&&("function"===typeof this.onEviction&&this.onEviction(e,t.value),this.delete(e))}_getOrDeleteIfExpired(e,t){const r=this._deleteIfExpired(e,t);if(!1===r)return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const r=t.get(e);return this._getItemValue(e,r)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,r]=e;if(!this.cache.has(t)){const n=this._deleteIfExpired(t,r);!1===n&&(yield e)}}for(const e of this.cache){const[t,r]=e,n=this._deleteIfExpired(t,r);!1===n&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(!1===this._deleteIfExpired(e,t))return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:r=this.maxAge}={}){const n="number"===typeof r&&r!==Number.POSITIVE_INFINITY?Date.now()+r:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:n}):this._set(e,{value:t,expiry:n})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}peek(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],r=t.length-e;r<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(r>0&&this._emitEvictions(t.slice(0,r)),this.oldCache=new Map(t.slice(r)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,r]=e,n=this._deleteIfExpired(t,r);!1===n&&(yield[t,r.value])}for(const e of this.oldCache){const[t,r]=e;if(!this.cache.has(t)){const e=this._deleteIfExpired(t,r);!1===e&&(yield[t,r.value])}}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const r=e[t],[n,i]=r,s=this._deleteIfExpired(n,i);!1===s&&(yield[n,i.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const r=e[t],[n,i]=r;if(!this.cache.has(n)){const e=this._deleteIfExpired(n,i);!1===e&&(yield[n,i.value])}}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[r,n]of this.entriesAscending())e.call(t,n,r,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}const MQ=2048;function jQ(e){const t=`Invalid type '${e}', must be one of {direct, indirect, recursive, all}`;return mn(new Error(t),"ERR_INVALID_PIN_TYPE")}class VQ{constructor({pinstore:e,blockstore:t,loadCodec:r}){this.pinstore=e,this.blockstore=t,this.loadCodec=r,this.log=Jr("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,t={}){await this.blockstore.get(e,t);const r={depth:0};return 0!==e.version&&(r.version=e.version),e.code!==Cs&&(r.codec=e.code),t.metadata&&(r.metadata=t.metadata),this.pinstore.put(OQ(e),Ka(r))}unpin(e,t){return this.pinstore.delete(OQ(e),t)}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);const r={depth:1/0};0!==e.version&&(r.version=e.version),e.code!==Cs&&(r.codec=e.code),t.metadata&&(r.metadata=t.metadata),await this.pinstore.put(OQ(e),Ka(r))}async*directKeys(e){for await(const t of this.pinstore.query({filters:[e=>{const t=Xa(e.value);return 0===t.depth}]})){const e=Xa(t.value),r=e.version||0,n=null!=e.codec?e.codec:Cs,i=NQ(t.key);yield{cid:ji.create(r,n,i),metadata:e.metadata}}}async*recursiveKeys(e){for await(const t of this.pinstore.query({filters:[e=>{const t=Xa(e.value);return t.depth===1/0}]})){const e=Xa(t.value),r=e.version||0,n=null!=e.codec?e.codec:Cs,i=NQ(t.key);yield{cid:ji.create(r,n,i),metadata:e.metadata}}}async*indirectKeys(e){for await(const{cid:t}of this.recursiveKeys())for await(const r of BQ(t,this.blockstore,this.loadCodec,e)){const e=[y_.recursive],t=await this.isPinnedWithType(r,e);t.pinned||(yield r)}}async isPinnedWithType(e,t,r){Array.isArray(t)||(t=[t]);const n=t.includes(y_.all),i=t.includes(y_.direct),s=t.includes(y_.recursive),o=t.includes(y_.indirect);if(s||i||n){const r=await Vq(this.pinstore.query({prefix:OQ(e).toString(),filters:[e=>{if(n)return!0;const r=Xa(e.value);return t.includes(0===r.depth?y_.direct:y_.recursive)}],limit:1}));if(r){const t=Xa(r.value);return{cid:e,pinned:!0,reason:0===t.depth?y_.direct:y_.recursive,metadata:t.metadata}}}const a=this;async function*c(e,t){for await(const{cid:r}of t)for await(const t of BQ(r,a.blockstore,a.loadCodec))if(t.equals(e))return void(yield r)}if(n||o){const t=await Vq(c(e,this.recursiveKeys()));if(t)return{cid:e,pinned:!0,reason:y_.indirect,parent:t}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t={}){const r=new UQ({maxSize:t.cidCacheMaxSize??MQ}),n=async(e,t)=>{if(r.has(e.toString()))return;r.set(e.toString(),!0);const i=await this.blockstore.get(e,t),s=await this.loadCodec(e.code),o=cq({bytes:i,cid:e,codec:s});await Promise.all([...o.links()].map((([,e])=>n(e,t))))};await n(e,t)}static checkPinType(e){if("string"!==typeof e||!Object.keys(y_).includes(e))throw jQ(e);return!0}}function zQ(e,t){return{open(){return t.open()},close(){return t.close()},query(e,r){return t.query(e,r)},queryKeys(e,r){return t.queryKeys(e,r)},async get(e,r){return t.get(e,r)},async*getMany(e,r){yield*t.getMany(e,r)},async put(e,r,n){await t.put(e,r,n)},async*putMany(e,r){yield*t.putMany(e,r)},has(e,r){return t.has(e,r)},async delete(r,n){return await FQ(r,e),t.delete(r,n)},deleteMany(r,n){return t.deleteMany(qR(r,(async t=>(await FQ(t,e),t))),n)},batch(){return t.batch()}}}async function FQ(e,t){const{pinned:r,reason:n}=await t.isPinnedWithType(e,y_.all);if(r)throw mn(new Error(`pinned: ${n}`),"ERR_BLOCK_PINNED")}const $Q=Jr("ipfs:repo:gc"),KQ=I_().code,qQ=256,HQ=new Ew("/local/filesroot");function GQ({gcLock:e,pins:t,blockstore:r,root:n,loadCodec:i}){async function*s(){const s=Date.now();$Q("Creating set of marked blocks");const o=await e.writeLock();try{const e=await WQ({pins:t,blockstore:r,root:n,loadCodec:i}),a=r.queryKeys({});yield*YQ({blockstore:r},e,a),$Q(`Complete (${Date.now()-s}ms)`)}finally{o()}}return s}async function WQ({pins:e,blockstore:t,loadCodec:r,root:n}){const i=async function*(){let e;try{e=await n.get(HQ)}catch(WV){if(WV.code===KQ)return void $Q("No blocks in MFS");throw WV}const i=ji.decode(e);yield i,yield*BQ(i,t,r)}(),s=HR(qR(e.recursiveKeys(),(({cid:e})=>e)),e.indirectKeys(),qR(e.directKeys(),(({cid:e})=>e)),i),o=new Set;for await(const a of HR(s,i))o.add(Pi.encode(a.multihash.bytes));return o}async function*YQ({blockstore:e},t,r){let n=0,i=0;const s=async r=>async function(){n++;try{const n=Pi.encode(r.multihash.bytes);if(t.has(n))return null;try{await e.delete(r),i++}catch(WV){return{err:new Error(`Could not delete block with CID ${r}: ${WV.message}`)}}return{cid:r}}catch(WV){const t=`Could delete block with CID ${r}`;return $Q(t,WV),{err:new Error(t+`: ${WV.message}`)}}};yield*QR(Ox(qR(r,s),qQ),(e=>PR(e,Boolean))),$Q(`Marked set has ${t.size} unique blocks. Blockstore has ${n} blocks. Deleted ${i} blocks.`)}const JQ=Jr("ipfs:repo"),QQ=Number.MAX_SAFE_INTEGER,XQ="repoAutoMigrate";class ZQ{constructor(e,t,r,n){if("string"!==typeof e)throw new Error("missing repo path");if("function"!==typeof t)throw new Error("missing codec loader");this.options=Wr(xQ,n),this.closed=!0,this.path=e,this.root=r.root,this.datastore=r.datastore,this.keys=r.keys;const i=r.blocks,s=r.pins;this.pins=new VQ({pinstore:s,blockstore:i,loadCodec:t});const o=zQ(this.pins,i);this.blocks=SQ(o),this.version=fQ(this.root),this.config=gQ(this.root),this.spec=vQ(this.root),this.apiAddr=_Q(this.root),this.gcLock=BH({name:e,singleProcess:!1!==this.options.repoOwner}),this.gc=GQ({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:t})}async init(e){JQ("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(rX(e)),await this.spec.set(nX(e)),await this.version.set(lY)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch(WV){return!1}}async open(){if(!this.closed)throw mn(new Error("repo is already open"),oQ);JQ("opening at: %s",this.path);try{await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),JQ("acquired repo.lock");const e=await this.version.check(lY);if(!e){if(!await this._isAutoMigrationEnabled())throw new iQ("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");await this._migrate(lY,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys})}JQ("creating datastore"),await this.datastore.open(),JQ("creating blocks"),await this.blocks.open(),JQ("creating keystore"),await this.keys.open(),JQ("creating pins"),await this.pins.pinstore.open(),this.closed=!1,JQ("all opened")}catch(WV){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(e){JQ("error removing lock",e)}throw WV}}async _openRoot(){try{await this.root.open()}catch(WV){if("Already open"!==WV.message)throw WV}}async _openLock(){const e=await this.options.repoLock.lock(this.path);if("function"!==typeof e.close)throw mn(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){let e;JQ("init check");try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(WV){if("ERR_NOT_FOUND"===WV.code)throw mn(new Error("repo is not initialized yet"),sQ,{path:this.path});throw WV}if(!e)throw mn(new Error("repo is not initialized yet"),sQ,{path:this.path})}async close(){if(this.closed)throw mn(new Error("repo is already closed"),aQ);JQ("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(WV){if(WV.code!==sQ&&!WV.message.startsWith("ENOENT"))throw WV}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map((e=>e&&e.close()))),JQ("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){const[e,t,r,n,i]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),eX(this.datastore),eX(this.keys)]),s=t.size+n+i;return{repoPath:this.path,storageMax:e,version:r,numObjects:t.count,repoSize:s}}throw mn(new Error("repo is not initialized yet"),sQ,{path:this.path})}async _isAutoMigrationEnabled(){if(void 0!==this.options.autoMigrate)return this.options.autoMigrate;let e;try{e=await this.config.get(XQ)}catch(t){if(t.code!==nQ.code)throw t;e=!0}return e}async _migrate(e,t){const r=await this.version.get();return r>e?(JQ(`reverting to version ${e}`),XJ(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(JQ(`migrating to version ${e}`),QJ(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{const e=await this.config.get("Datastore.StorageMax");return BigInt(tQ(e))}catch(WV){return BigInt(QQ)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(const{key:r,value:n}of this.blocks.query({}))e+=BigInt(1),t+=BigInt(n.byteLength),t+=BigInt(r.bytes.byteLength);return{count:e,size:t}}}async function eX(e){let t=BigInt(0);for await(const r of e.query({}))t+=BigInt(r.value.byteLength),t+=BigInt(r.key.uint8Array().byteLength);return t}function tX(e,t,r,n){return new ZQ(e,t,r,n)}function rX(e){return e.Datastore=Object.assign({},DQ,yY(e,"datastore")),e}function nX(e){const t={...DQ.Spec,...yY(e,"Datastore.Spec")};return{type:t.type,mounts:t.mounts.map((e=>({mountpoint:e.mountpoint,type:e.child.type,path:e.child.path,shardFunc:e.child.shardFunc})))}}async function*iX(e,t){for await(const r of e)await t(r)&&(yield r)}async function*sX(e,t){for await(const r of e)yield t(r)}async function*oX(e,t){let r=0;if(!(t<1))for await(const n of e)if(yield n,r++,r===t)return}async function aX(e){const t=[];for await(const r of e)t.push(r);return t}async function*cX(e,t){const r=await aX(e);yield*r.sort(t)}var lX=r(1301);class uX extends DR{constructor(e,t={}){super(),this.db="string"===typeof e?new lX.Level(e,{...t,keyEncoding:"utf8",valueEncoding:"view"}):e,this.opts={createIfMissing:!0,compression:!1,...t}}async open(){try{await this.db.open(this.opts)}catch(WV){throw __(WV)}}async put(e,t){try{await this.db.put(e.toString(),t)}catch(WV){throw A_(WV)}}async get(e){let t;try{t=await this.db.get(e.toString())}catch(WV){if(WV.notFound)throw I_(WV);throw A_(WV)}return t}async has(e){try{await this.db.get(e.toString())}catch(WV){if(WV.notFound)return!1;throw WV}return!0}async delete(e){try{await this.db.del(e.toString())}catch(WV){throw S_(WV)}}close(){return this.db&&this.db.close()}batch(){const e=[];return{put:(t,r)=>{e.push({type:"put",key:t.toString(),value:r})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce(((e,t)=>iX(e,t)),t)),Array.isArray(e.orders)&&(t=e.orders.reduce(((e,t)=>cX(e,t)),t));const{offset:r,limit:n}=e;if(r){let e=0;t=iX(t,(()=>e++>=r))}return n&&(t=oX(t,n)),t}queryKeys(e){let t=sX(this._query({values:!1,prefix:e.prefix}),(({key:e})=>e));Array.isArray(e.filters)&&(t=e.filters.reduce(((e,t)=>iX(e,t)),t)),Array.isArray(e.orders)&&(t=e.orders.reduce(((e,t)=>cX(e,t)),t));const{offset:r,limit:n}=e;if(r){let e=0;t=iX(t,(()=>e++>=r))}return n&&(t=oX(t,n)),t}_query(e){const t={keys:!0,keyEncoding:"buffer",values:e.values};if(null!=e.prefix){const r=e.prefix.toString();t.gte=r,t.lt=r+"ÿ"}const r=this.db.iterator(t);if(r[Symbol.asyncIterator])return hX(r);if(null!=r.next&&null!=r.end)return dX(r);throw new Error("Level returned incompatible iterator")}}async function*hX(e){for await(const[t,r]of e)yield{key:new Ew(t,!1),value:r};await e.close()}function dX(e){return{[Symbol.asyncIterator](){return{next:()=>new Promise(((t,r)=>{e.next(((n,i,s)=>n?r(n):null==i?e.end((e=>{if(e)return r(e);t({done:!0,value:void 0})})):void t({done:!1,value:{key:new Ew(i,!1),value:s}})))})),return:()=>new Promise(((t,r)=>{e.end((e=>{if(e)return r(e);t({done:!0,value:void 0})}))}))}}}}const fX=(e,t)=>async function*(){const r=await kR(e);yield*r.sort(t)}();class pX{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:r,value:n}of e)await this.put(r,n,t),yield{key:r,value:n}}async*getMany(e,t={}){for await(const r of e)yield this.get(r,t)}async*deleteMany(e,t={}){for await(const r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(t,r){e.push({key:t,value:r})},delete(e){t.push(e)},commit:async r=>{await RR(this.putMany(e,r)),e=[],await RR(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(null!=e.prefix&&(r=PR(r,(t=>t.key.toString().startsWith(e.prefix||"")))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>PR(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>fX(e,t)),r)),null!=e.offset){let t=0;r=PR(r,(()=>t++>=(e.offset||0)))}return null!=e.limit&&(r=xR(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(null!=e.prefix&&(r=PR(r,(t=>t.toString().startsWith(e.prefix||"")))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>PR(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>fX(e,t)),r)),null!=e.offset){let t=0;r=PR(r,(()=>t++>=e.offset))}return null!=e.limit&&(r=xR(r,e.limit)),r}}function yX(e){const t=ji.asCID(e);if(!t)throw mn(new Error("Not a valid cid"),"ERR_INVALID_CID");return new Ew("/"+Pi.encode(t.multihash.bytes).slice(1).toUpperCase(),!1)}function gX(e){return ji.createV1(Sl,hi(Pi.decode("b"+e.toString().slice(1).toLowerCase())))}function mX(e){const t=e.substring(0,1);if("/"===t)return mX(e.substring(1));let r,n;r="b"===t.toLowerCase()?e=>Pi.decode(e.toLowerCase()).subarray(2):"c"===t.toLowerCase()?e=>Di.decode(e.toLowerCase()).subarray(2):"z"===t?e=>Ti.decode(e).subarray(2):"Q"===t?e=>Ti.decode("z"+e):e=>Pi.decode("b"+e.toLowerCase()).subarray(2);for(let s=1;s<e.length;s++)try{n=r(e.substring(0,s))}catch(WV){if("Unexpected end of data"!==WV.message)throw WV}let i="/C";return n&&(i=`/${Pi.encode(n).slice(1,-1).toUpperCase()||"C"}`),i}function wX(e){return{...e,prefix:e.prefix?mX(e.prefix):void 0,filters:e.filters?e.filters.map((e=>t=>e({key:gX(t.key),value:t.value}))):void 0,orders:e.orders?e.orders.map((e=>(t,r)=>e({key:gX(t.key),value:t.value},{key:gX(r.key),value:r.value}))):void 0}}function bX(e){return{...e,prefix:e.prefix?mX(e.prefix):void 0,filters:e.filters?e.filters.map((e=>t=>e(gX(t)))):void 0,orders:e.orders?e.orders.map((e=>(t,r)=>e(gX(t),gX(r)))):void 0}}class vX extends pX{constructor(e){super(),this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,t){for await(const{key:r,value:n}of this.child.query(wX(e),t))yield{key:gX(r),value:n}}async*queryKeys(e,t){for await(const r of this.child.queryKeys(bX(e),t))yield gX(r)}async get(e,t){return this.child.get(yX(e),t)}async*getMany(e,t){for await(const r of e)yield this.get(r,t)}async put(e,t,r){await this.child.put(yX(e),t,r)}async*putMany(e,t){const r=LR({objectMode:!0}),n=globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout;n((async()=>{try{const n=this.child;await RR(this.child.putMany(async function*(){for await(const i of e){const e=yX(i.key),s=await n.has(e,t);s||(yield{key:e,value:i.value}),r.push(i)}}())),r.end()}catch(WV){r.end(WV)}})),yield*r}has(e,t){return this.child.has(yX(e),t)}delete(e,t){return this.child.delete(yX(e),t)}deleteMany(e,t){const r=LR({objectMode:!0});return RR(this.child.deleteMany(async function*(){for await(const t of e)yield yX(t),r.push(t);r.end()}(),t)).catch((e=>{r.end(e)})),r}}function EX(e,t,r){const n=r.path||"ipfs";return tX(n,(e=>t.getCodec(e)),{root:new uX(n,{prefix:"",version:2}),blocks:new vX(new uX(`${n}/blocks`,{prefix:"",version:2})),datastore:new uX(`${n}/datastore`,{prefix:"",version:2}),keys:new uX(`${n}/keys`,{prefix:"",version:2}),pins:new uX(`${n}/pins`,{prefix:"",version:2})},{autoMigrate:r.autoMigrate,onMigrationProgress:r.onMigrationProgress||e,repoLock:PQ})}function _X(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var SX=_X,AX=SX,IX=AX;new Uint8Array(0);const CX=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},kX=e=>(new TextEncoder).encode(e),TX=e=>(new TextDecoder).decode(e);class RX{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class PX{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return DX(this,e)}}class xX{constructor(e){this.decoders=e}or(e){return DX(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const DX=(e,t)=>new xX({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class OX{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new RX(e,t,r),this.decoder=new PX(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const NX=({name:e,prefix:t,encode:r,decode:n})=>new OX(e,t,r,n),LX=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=IX(r,t);return NX({prefix:e,name:t,encode:n,decode:e=>CX(i(e))})},BX=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},UX=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},MX=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>NX({prefix:t,name:e,encode(e){return UX(e,n,r)},decode(t){return BX(t,n,r,e)}}),jX=NX({prefix:"\0",name:"identity",encode:e=>TX(e),decode:e=>kX(e)}),VX=MX({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),zX=MX({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),FX=LX({prefix:"9",name:"base10",alphabet:"0123456789"}),$X=MX({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),KX=MX({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),qX=MX({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),HX=MX({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),GX=MX({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),WX=MX({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),YX=MX({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),JX=MX({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),QX=MX({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),XX=MX({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ZX=MX({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),eZ=LX({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),tZ=LX({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),rZ=LX({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),nZ=LX({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),iZ=MX({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),sZ=MX({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),oZ=MX({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),aZ=MX({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),cZ=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),lZ=cZ.reduce(((e,t,r)=>(e[r]=t,e)),[]),uZ=cZ.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);function hZ(e){return e.reduce(((e,t)=>(e+=lZ[t],e)),"")}function dZ(e){const t=[];for(const r of e){const e=uZ[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}const fZ=NX({prefix:"🚀",name:"base256emoji",encode:hZ,decode:dZ});var pZ=bZ,yZ=128,gZ=127,mZ=~gZ,wZ=Math.pow(2,31);function bZ(e,t,r){t=t||[],r=r||0;var n=r;while(e>=wZ)t[r++]=255&e|yZ,e/=128;while(e&mZ)t[r++]=255&e|yZ,e>>>=7;return t[r]=0|e,bZ.bytes=r-n+1,t}var vZ=SZ,EZ=128,_Z=127;function SZ(e,t){var r,n=0,i=(t=t||0,0),s=t,o=e.length;do{if(s>=o)throw SZ.bytes=0,new RangeError("Could not decode varint");r=e[s++],n+=i<28?(r&_Z)<<i:(r&_Z)*Math.pow(2,i),i+=7}while(r>=EZ);return SZ.bytes=s-t,n}var AZ=Math.pow(2,7),IZ=Math.pow(2,14),CZ=Math.pow(2,21),kZ=Math.pow(2,28),TZ=Math.pow(2,35),RZ=Math.pow(2,42),PZ=Math.pow(2,49),xZ=Math.pow(2,56),DZ=Math.pow(2,63),OZ=function(e){return e<AZ?1:e<IZ?2:e<CZ?3:e<kZ?4:e<TZ?5:e<RZ?6:e<PZ?7:e<xZ?8:e<DZ?9:10},NZ={encode:pZ,decode:vZ,encodingLength:OZ},LZ=NZ,BZ=LZ;const UZ=(e,t,r=0)=>(BZ.encode(e,t,r),t),MZ=e=>BZ.encodingLength(e),jZ=(e,t)=>{const r=t.byteLength,n=MZ(e),i=n+MZ(r),s=new Uint8Array(i+r);return UZ(e,s,0),UZ(r,s,n),s.set(t,i),new VZ(e,r,t,s)};class VZ{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const zZ=({name:e,code:t,encode:r})=>new FZ(e,t,r);class FZ{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?jZ(this.code,t):t.then((e=>jZ(this.code,e)))}throw Error("Unknown type, must be binary type")}}const $Z=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),KZ=zZ({name:"sha2-256",code:18,encode:$Z("SHA-256")}),qZ=zZ({name:"sha2-512",code:19,encode:$Z("SHA-512")}),HZ=0,GZ="identity",WZ=CX,YZ=e=>jZ(HZ,WZ(e)),JZ={code:HZ,name:GZ,encode:WZ,digest:YZ},QZ="raw",XZ=85,ZZ=e=>CX(e),e1=e=>CX(e),t1=new TextEncoder,r1=new TextDecoder,n1="json",i1=512,s1=e=>t1.encode(JSON.stringify(e)),o1=e=>JSON.parse(r1.decode(e));new WeakMap;class a1{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==peer_record_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==peer_record_node_modules_multiformats_src_cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return a1.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return a1.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return a1.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return peer_record_node_modules_multiformats_src_cid_format(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof a1)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new a1(e,r,n,i||peer_record_node_modules_multiformats_src_cid_encodeCID(e,r,n.bytes))}if(!0===t[peer_record_node_modules_multiformats_src_cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,i=Digest.decode(r);return a1.create(e,n,i)}return null}static create(e,t,r){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==peer_record_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${peer_record_node_modules_multiformats_src_cid_DAG_PB_CODE}) block encoding`);return new a1(e,t,r,r.bytes);case 1:{const n=peer_record_node_modules_multiformats_src_cid_encodeCID(e,t,r.bytes);return new a1(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return a1.create(0,peer_record_node_modules_multiformats_src_cid_DAG_PB_CODE,e)}static createV1(e,t){return a1.create(1,e,t)}static decode(e){const[t,r]=a1.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=a1.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Digest.Digest(t.multihashCode,t.digestSize,i,n),o=0===t.version?a1.createV0(s):a1.createV1(t.codec,s);return[o,e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),i=peer_record_node_modules_multiformats_src_cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a,l=c-s;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:l,size:c}}static parse(e,t){const[r,n]=peer_record_node_modules_multiformats_src_cid_parseCIDtoBytes(e,t),i=a1.decode(n);return peer_record_node_modules_multiformats_src_cid_baseCache(i).set(r,e),i}}Symbol.for("@ipld/js-cid/CID");const c1={...yt,...gt,...mt,...wt,...bt,...vt,...Et,..._t,...St,...At};function l1(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function u1(e=0){return null!=globalThis.Buffer?.allocUnsafe?l1(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function h1(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const d1=h1("utf8","u",(e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)}),(e=>{const t=new TextEncoder;return t.encode(e.substring(1))})),f1=h1("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=u1(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),p1={utf8:d1,"utf-8":d1,hex:c1.base16,latin1:f1,ascii:f1,binary:f1,...c1};var y1=p1;function g1(e,t="utf8"){const r=y1[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):l1(globalThis.Buffer.from(e,"utf-8"))}function m1(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}const w1={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};function b1(){O_._configure(),R_._configure(P_),x_._configure(D_)}b1();const v1=["uint64","int64","sint64","fixed64","sfixed64"];function E1(e){for(const t of v1){if(null==e[t])continue;const r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}function _1(e){return E1(new R_(e))}function S1(e){for(const t of v1){if(null==e[t])continue;const r=e[t];e[t]=function(e){return r.call(this,e.toString())}}return e}function A1(){return S1(x_.create())}function I1(e,t){const r=_1(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function C1(e,t){const r=A1();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var k1,T1;function R1(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function P1(e,t){return R1("message",k1.LENGTH_DELIMITED,e,t)}function x1(e){return e instanceof Uint8Array?{get(t){return e[t]},set(t,r){e[t]=r}}:{get(t){return e.get(t)},set(t,r){e.set(t,r)}}}(function(e){e[e["VARINT"]=0]="VARINT",e[e["BIT64"]=1]="BIT64",e[e["LENGTH_DELIMITED"]=2]="LENGTH_DELIMITED",e[e["START_GROUP"]=3]="START_GROUP",e[e["END_GROUP"]=4]="END_GROUP",e[e["BIT32"]=5]="BIT32"})(k1||(k1={})),function(e){let t;e.codec=()=>(null==t&&(t=P1(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.publicKey&&e.publicKey.byteLength>0)&&(t.uint32(10),t.bytes(e.publicKey)),(!0===r.writeDefaults||null!=e.payloadType&&e.payloadType.byteLength>0)&&(t.uint32(18),t.bytes(e.payloadType)),(!0===r.writeDefaults||null!=e.payload&&e.payload.byteLength>0)&&(t.uint32(26),t.bytes(e.payload)),(!0===r.writeDefaults||null!=e.signature&&e.signature.byteLength>0)&&(t.uint32(42),t.bytes(e.signature)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.publicKey=e.bytes();break;case 2:r.payloadType=e.bytes();break;case 3:r.payload=e.bytes();break;case 5:r.signature=e.bytes();break;default:e.skipType(7&t);break}}return r}))),t),e.encode=t=>C1(t,e.codec()),e.decode=t=>I1(t,e.codec())}(T1||(T1={}));const D1=4294967296;class O1{constructor(e=0,t=0){this.hi=e,this.lo=t}toBigInt(e){if(!0===e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!==0){const e=1+~this.lo>>>0;let t=~this.hi>>>0;return 0===e&&(t=t+1>>>0),-(BigInt(e)+(BigInt(t)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(e){return Number(this.toBigInt(e))}zzDecode(){const e=-(1&this.lo),t=((this.lo>>>1|this.hi<<31)^e)>>>0,r=(this.hi>>>1^e)>>>0;return new O1(r,t)}zzEncode(){const e=this.hi>>31,t=((this.hi<<1|this.lo>>>31)^e)>>>0,r=(this.lo<<1^e)>>>0;return new O1(t,r)}toBytes(e,t=0){const r=x1(e);while(this.hi>0)r.set(t++,127&this.lo|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;while(this.lo>127)r.set(t++,127&this.lo|128),this.lo=this.lo>>>7;r.set(t++,this.lo)}static fromBigInt(e){if(0n===e)return new O1;const t=e<0;t&&(e=-e);let r=0|Number(e>>32n),n=0|Number(e-(BigInt(r)<<32n));return t&&(r=~r>>>0,n=~n>>>0,++n>D1&&(n=0,++r>D1&&(r=0))),new O1(r,n)}static fromNumber(e){if(0===e)return new O1;const t=e<0;t&&(e=-e);let r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new O1(n,r)}static fromBytes(e,t=0){const r=x1(e),n=new O1;let i=0;if(e.length-t>4){for(;i<4;++i)if(n.lo=(n.lo|(127&r.get(t))<<7*i)>>>0,r.get(t++)<128)return n;if(n.lo=(n.lo|(127&r.get(t))<<28)>>>0,n.hi=(n.hi|(127&r.get(t))>>4)>>>0,r.get(t++)<128)return n;i=0}else for(;i<4;++i){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(n.lo=(n.lo|(127&r.get(t))<<7*i)>>>0,r.get(t++)<128)return n}if(e.length-t>4){for(;i<5;++i)if(n.hi=(n.hi|(127&r.get(t))<<7*i+3)>>>0,r.get(t++)<128)return n}else if(t<e.byteLength)for(;i<5;++i){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(n.hi=(n.hi|(127&r.get(t))<<7*i+3)>>>0,r.get(t++)<128)return n}throw RangeError("invalid varint encoding")}}function N1(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function L1(e=0){return null!=globalThis.Buffer?.allocUnsafe?N1(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}const B1=Math.pow(2,7),U1=Math.pow(2,14),M1=Math.pow(2,21),j1=Math.pow(2,28),V1=Math.pow(2,35),z1=Math.pow(2,42),F1=Math.pow(2,49),$1=Math.pow(2,56),K1=Math.pow(2,63),q1={encodingLength(e){return e<B1?1:e<U1?2:e<M1?3:e<j1?4:e<V1?5:e<z1?6:e<F1?7:e<$1?8:e<K1?9:10},encode(e,t,r=0){if(null!=Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return null==t&&(t=L1(q1.encodingLength(e))),O1.fromNumber(e).toBytes(t,r),t},decode(e,t=0){return O1.fromBytes(e,t).toNumber(!0)}};class H1{constructor(e){const{peerId:t,payloadType:r,payload:n,signature:i}=e;this.peerId=t,this.payloadType=r,this.payload=n,this.signature=i}marshal(){if(null==this.peerId.publicKey)throw new Error("Missing public key");return null==this.marshaled&&(this.marshaled=T1.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return m1(this.marshal(),e.marshal())}async validate(e){const t=G1(e,this.payloadType,this.payload);if(null==this.peerId.publicKey)throw new Error("Missing public key");const r=hT(this.peerId.publicKey);return await r.verify(t.subarray(),this.signature)}}H1.createFromProtobuf=async e=>{const t=T1.decode(e),r=await c_(t.publicKey);return new H1({peerId:r,payloadType:t.payloadType,payload:t.payload,signature:t.signature})},H1.seal=async(e,t)=>{if(null==t.privateKey)throw new Error("Missing private key");const r=e.domain,n=e.codec,i=e.marshal(),s=G1(r,n,i),o=await fT(t.privateKey),a=await o.sign(s.subarray());return new H1({peerId:t,payloadType:n,payload:i,signature:a})},H1.openAndCertify=async(e,t)=>{const r=await H1.createFromProtobuf(e),n=await r.validate(t);if(!n)throw mn(new Error("envelope signature is not valid for the given domain"),w1.ERR_SIGNATURE_NOT_VALID);return r};const G1=(e,t,r)=>{const n=g1(e),i=q1.encode(n.byteLength),s=q1.encode(t.length),o=q1.encode(r.length);return new XL(i,n,s,t,o,r)};function W1(e,t){const r=(e,t)=>e.toString().localeCompare(t.toString());return e.length===t.length&&(t.sort(r),e.sort(r).every(((e,r)=>t[r].equals(e))))}var Y1;(function(e){let t,r;(function(e){let t;e.codec=()=>(null==t&&(t=P1(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.multiaddr&&e.multiaddr.byteLength>0)&&(t.uint32(10),t.bytes(e.multiaddr)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={multiaddr:new Uint8Array(0)},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.multiaddr=e.bytes();break;default:e.skipType(7&t);break}}return r}))),t),e.encode=t=>C1(t,e.codec()),e.decode=t=>I1(t,e.codec())})(t=e.AddressInfo||(e.AddressInfo={})),e.codec=()=>(null==r&&(r=P1(((t,r,n={})=>{if(!1!==n.lengthDelimited&&r.fork(),(!0===n.writeDefaults||null!=t.peerId&&t.peerId.byteLength>0)&&(r.uint32(10),r.bytes(t.peerId)),!0!==n.writeDefaults&&0n===t.seq||(r.uint32(16),r.uint64(t.seq)),null!=t.addresses)for(const i of t.addresses)r.uint32(26),e.AddressInfo.codec().encode(i,r,{writeDefaults:!0});!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={peerId:new Uint8Array(0),seq:0n,addresses:[]},i=null==r?t.len:t.pos+r;while(t.pos<i){const r=t.uint32();switch(r>>>3){case 1:n.peerId=t.bytes();break;case 2:n.seq=t.uint64();break;case 3:n.addresses.push(e.AddressInfo.codec().decode(t,t.uint32()));break;default:t.skipType(7&r);break}}return n}))),r),e.encode=t=>C1(t,e.codec()),e.decode=t=>I1(t,e.codec())})(Y1||(Y1={}));const J1="libp2p-peer-record",Q1=Uint8Array.from([3,1]);class X1{constructor(e){this.domain=X1.DOMAIN,this.codec=X1.CODEC;const{peerId:t,multiaddrs:r,seqNumber:n}=e;this.peerId=t,this.multiaddrs=r??[],this.seqNumber=n??BigInt(Date.now())}marshal(){return null==this.marshaled&&(this.marshaled=Y1.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map((e=>({multiaddr:e.bytes})))})),this.marshaled}equals(e){return e instanceof X1&&(!!this.peerId.equals(e.peerId)&&(this.seqNumber===e.seqNumber&&!!W1(this.multiaddrs,e.multiaddrs)))}}X1.createFromProtobuf=e=>{const t=Y1.decode(e),r=o_(t.peerId),n=(t.addresses??[]).map((e=>Pp(e.multiaddr))),i=t.seq;return new X1({peerId:r,multiaddrs:n,seqNumber:i})},X1.DOMAIN=J1,X1.CODEC=Q1;const Z1=Symbol.for("@libp2p/topology");function e0(e){return null!=e&&Boolean(e[Z1])}const t0=()=>{};class r0{constructor(e){this.min=e.min??0,this.max=e.max??1/0,this.peers=new Set,this.onConnect=e.onConnect??t0,this.onDisconnect=e.onDisconnect??t0}get[Symbol.toStringTag](){return Z1.toString()}get[Z1](){return!0}async setRegistrar(e){this.registrar=e}disconnect(e){this.onDisconnect(e)}}function n0(e){return new r0(e)}var i0,s0=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};class o0 extends EventTarget{constructor(){super(...arguments),i0.set(this,new Map)}listenerCount(e){const t=s0(this,i0,"f").get(e);return null==t?0:t.length}addEventListener(e,t,r){super.addEventListener(e,t,r);let n=s0(this,i0,"f").get(e);null==n&&(n=[],s0(this,i0,"f").set(e,n)),n.push({callback:t,once:(!0!==r&&!1!==r&&r?.once)??!1})}removeEventListener(e,t,r){super.removeEventListener(e.toString(),t??null,r);let n=s0(this,i0,"f").get(e);null!=n&&(n=n.filter((({callback:e})=>e!==t)),s0(this,i0,"f").set(e,n))}dispatchEvent(e){const t=super.dispatchEvent(e);let r=s0(this,i0,"f").get(e.type);return null==r||(r=r.filter((({once:e})=>!e)),s0(this,i0,"f").set(e.type,r)),t}}i0=new WeakMap;class a0 extends Event{constructor(e,t){super(e,t),this.detail=t?.detail}}const c0=globalThis.CustomEvent??a0;class l0{constructor(e,t,r){this.gossip=e,this.msgs=new Map,this.history=[],this.msgIdToStrFn=r;for(let n=0;n<t;n++)this.history[n]=[]}get size(){return this.msgs.size}put(e,t,r=!1){const{msgIdStr:n}=e;return!this.msgs.has(n)&&(this.msgs.set(n,{message:t,validated:r,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...e,topic:t.topic}),!0)}observeDuplicate(e,t){const r=this.msgs.get(e);r&&!r.validated&&r.originatingPeers.add(t)}get(e){return this.msgs.get(this.msgIdToStrFn(e))?.message}getWithIWantCount(e,t){const r=this.msgs.get(e);if(!r)return null;const n=(r.iwantCounts.get(t)??0)+1;return r.iwantCounts.set(t,n),{msg:r.message,count:n}}getGossipIDs(e){const t=new Map;for(let r=0;r<this.gossip;r++)this.history[r].forEach((r=>{const n=this.msgs.get(r.msgIdStr);if(n&&n.validated&&e.has(r.topic)){let e=t.get(r.topic);e||(e=[],t.set(r.topic,e)),e.push(r.msgId)}}));return t}validate(e){const t=this.msgs.get(e);if(!t)return null;const{message:r,originatingPeers:n}=t;return t.validated=!0,t.originatingPeers=new Set,{message:r,originatingPeers:n}}shift(){const e=this.history[this.history.length-1];e.forEach((e=>{this.msgs.delete(e.msgIdStr)})),this.history.pop(),this.history.unshift([])}remove(e){const t=this.msgs.get(e);return t?(this.msgs.delete(e),t):null}}var u0=r(4482);const{RPC:h0}=u0,d0=1e3,f0=60*d0,p0="/floodsub/1.0.0",y0="/meshsub/1.0.0",g0="/meshsub/1.1.0",m0=6,w0=4,b0=12,v0=4,E0=2,_0=5,S0=3,A0=6,I0=.25,C0=3,k0=100,T0=d0,R0=f0,P0=16,x0=f0,D0=15,O0=300,N0=d0,L0=60,B0=2,U0=10*d0,M0=5e3,j0=10,V0=3*d0,z0=2*f0,F0=12e4,$0="ERR_TOPIC_VALIDATOR_REJECT",K0="ERR_TOPIC_VALIDATOR_IGNORE",q0=0,H0=128,G0=1e3,W0=1e3;function Y0(e=[],t){return{subscriptions:[],messages:e,control:t?{graft:t.graft||[],prune:t.prune||[],ihave:t.ihave||[],iwant:t.iwant||[]}:void 0}}function J0(e){if(e.length<=1)return e;const t=()=>Math.floor(Math.random()*Math.floor(e.length));for(let r=0;r<e.length;r++){const n=t(),i=e[r];e[r]=e[n],e[n]=i}return e}function Q0(e){return C_(e,"base64")}const X0="StrictSign",Z0="StrictNoSign";var e2,t2,r2,n2,i2,s2;function o2(e){switch(e){case r2.Ignore:return n2.Ignore;case r2.Reject:return n2.Reject}}async function a2(e,t){switch(e){case X0:{if(!t)throw Error("Must provide PeerId");if(null==t.privateKey)throw Error("Cannot sign message, no private key present");if(null==t.publicKey)throw Error("Cannot sign message, no public key present");const e=await fT(t.privateKey);return{type:t2.Signing,author:t,key:t.publicKey,privateKey:e}}case Z0:return{type:t2.Anonymous};default:throw new Error(`Unknown signature policy "${e}"`)}}(function(e){e["StrictSign"]="StrictSign",e["StrictNoSign"]="StrictNoSign"})(e2||(e2={})),function(e){e[e["Signing"]=0]="Signing",e[e["Anonymous"]=1]="Anonymous"}(t2||(t2={})),function(e){e["Accept"]="accept",e["Ignore"]="ignore",e["Reject"]="reject"}(r2||(r2={})),function(e){e["Error"]="error",e["Ignore"]="ignore",e["Reject"]="reject",e["Blacklisted"]="blacklisted"}(n2||(n2={})),function(e){e["InvalidSignature"]="invalid_signature",e["InvalidSeqno"]="invalid_seqno",e["InvalidPeerId"]="invalid_peerid",e["SignaturePresent"]="signature_present",e["SeqnoPresent"]="seqno_present",e["FromPresent"]="from_present",e["TransformFailed"]="transform_failed"}(i2||(i2={})),function(e){e["duplicate"]="duplicate",e["invalid"]="invalid",e["valid"]="valid"}(s2||(s2={}));const c2="ERR_INVALID_PEER_SCORE_PARAMS",l2={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:36e5},u2={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function h2(e={}){return{...l2,...e,topics:e.topics?Object.entries(e.topics).reduce(((e,[t,r])=>(e[t]=d2(r),e)),{}):{}}}function d2(e={}){return{...u2,...e}}function f2(e){for(const[r,n]of Object.entries(e.topics))try{p2(n)}catch(t){throw mn(new Error(`invalid score parameters for topic ${r}: ${t.message}`),c2)}if(e.topicScoreCap<0)throw mn(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),c2);if(null===e.appSpecificScore||void 0===e.appSpecificScore)throw mn(new Error("missing application specific score function"),c2);if(e.IPColocationFactorWeight>0)throw mn(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),c2);if(0!==e.IPColocationFactorWeight&&e.IPColocationFactorThreshold<1)throw mn(new Error("invalid IPColocationFactorThreshold; must be at least 1"),c2);if(e.behaviourPenaltyWeight>0)throw mn(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),c2);if(0!==e.behaviourPenaltyWeight&&(e.behaviourPenaltyDecay<=0||e.behaviourPenaltyDecay>=1))throw mn(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),c2);if(e.decayInterval<1e3)throw mn(new Error("invalid DecayInterval; must be at least 1s"),c2);if(e.decayToZero<=0||e.decayToZero>=1)throw mn(new Error("invalid DecayToZero; must be between 0 and 1"),c2)}function p2(e){if(e.topicWeight<0)throw mn(new Error("invalid topic weight; must be >= 0"),c2);if(0===e.timeInMeshQuantum)throw mn(new Error("invalid TimeInMeshQuantum; must be non zero"),c2);if(e.timeInMeshWeight<0)throw mn(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),c2);if(0!==e.timeInMeshWeight&&e.timeInMeshQuantum<=0)throw mn(new Error("invalid TimeInMeshQuantum; must be positive"),c2);if(0!==e.timeInMeshWeight&&e.timeInMeshCap<=0)throw mn(new Error("invalid TimeInMeshCap; must be positive"),c2);if(e.firstMessageDeliveriesWeight<0)throw mn(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),c2);if(0!==e.firstMessageDeliveriesWeight&&(e.firstMessageDeliveriesDecay<=0||e.firstMessageDeliveriesDecay>=1))throw mn(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),c2);if(0!==e.firstMessageDeliveriesWeight&&e.firstMessageDeliveriesCap<=0)throw mn(new Error("invalid FirstMessageDeliveriesCap; must be positive"),c2);if(e.meshMessageDeliveriesWeight>0)throw mn(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),c2);if(0!==e.meshMessageDeliveriesWeight&&(e.meshMessageDeliveriesDecay<=0||e.meshMessageDeliveriesDecay>=1))throw mn(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),c2);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesCap<=0)throw mn(new Error("invalid MeshMessageDeliveriesCap; must be positive"),c2);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesThreshold<=0)throw mn(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),c2);if(e.meshMessageDeliveriesWindow<0)throw mn(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),c2);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesActivation<1e3)throw mn(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),c2);if(e.meshFailurePenaltyWeight>0)throw mn(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),c2);if(0!==e.meshFailurePenaltyWeight&&(e.meshFailurePenaltyDecay<=0||e.meshFailurePenaltyDecay>=1))throw mn(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),c2);if(e.invalidMessageDeliveriesWeight>0)throw mn(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),c2);if(e.invalidMessageDeliveriesDecay<=0||e.invalidMessageDeliveriesDecay>=1)throw mn(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),c2)}const y2={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function g2(e={}){return{...y2,...e}}function m2(e,t,r,n){let i=0;Object.entries(t.topics).forEach((([e,t])=>{const n=r.topics[e];if(void 0===n)return;let s=0;if(t.inMesh){let e=t.meshTime/n.timeInMeshQuantum;e>n.timeInMeshCap&&(e=n.timeInMeshCap),s+=e*n.timeInMeshWeight}let o=t.firstMessageDeliveries;if(o>n.firstMessageDeliveriesCap&&(o=n.firstMessageDeliveriesCap),s+=o*n.firstMessageDeliveriesWeight,t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<n.meshMessageDeliveriesThreshold){const e=n.meshMessageDeliveriesThreshold-t.meshMessageDeliveries,r=e*e;s+=r*n.meshMessageDeliveriesWeight}const a=t.meshFailurePenalty;s+=a*n.meshFailurePenaltyWeight;const c=t.invalidMessageDeliveries*t.invalidMessageDeliveries;s+=c*n.invalidMessageDeliveriesWeight,i+=s*n.topicWeight})),r.topicScoreCap>0&&i>r.topicScoreCap&&(i=r.topicScoreCap);const s=r.appSpecificScore(e);if(i+=s*r.appSpecificWeight,t.ips.forEach((e=>{if(r.IPColocationFactorWhitelist.has(e))return;const t=n.get(e),s=t?t.size:0;if(s>r.IPColocationFactorThreshold){const e=s-r.IPColocationFactorThreshold,t=e*e;i+=t*r.IPColocationFactorWeight}})),t.behaviourPenalty>r.behaviourPenaltyThreshold){const e=t.behaviourPenalty-r.behaviourPenaltyThreshold,n=e*e;i+=n*r.behaviourPenaltyWeight}return i}var w2,b2=r(5001);(function(e){e[e["unknown"]=0]="unknown",e[e["valid"]=1]="valid",e[e["invalid"]=2]="invalid",e[e["ignored"]=3]="ignored"})(w2||(w2={}));class v2{constructor(){this.records=new Map,this.queue=new b2}ensureRecord(e){let t=this.records.get(e);if(t)return t;t={status:w2.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(e,t);const r={msgId:e,expire:Date.now()+F0};return this.queue.push(r),t}gc(){const e=Date.now();let t=this.queue.peekFront();while(t&&t.expire<e)this.records.delete(t.msgId),this.queue.shift(),t=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}}function E2(e){return null!=e&&"function"===typeof e.start&&"function"===typeof e.stop}function _2(e){return null!=e&&"function"===typeof e.init}class S2{constructor(e={}){this.started=!1,null!=e.peerId&&this.setPeerId(e.peerId),null!=e.addressManager&&this.setAddressManager(e.addressManager),null!=e.peerStore&&this.setPeerStore(e.peerStore),null!=e.upgrader&&this.setUpgrader(e.upgrader),null!=e.metrics&&this.setMetrics(e.metrics),null!=e.registrar&&this.setRegistrar(e.registrar),null!=e.connectionManager&&this.setConnectionManager(e.connectionManager),null!=e.transportManager&&this.setTransportManager(e.transportManager),null!=e.connectionGater&&this.setConnectionGater(e.connectionGater),null!=e.contentRouting&&this.setContentRouting(e.contentRouting),null!=e.peerRouting&&this.setPeerRouting(e.peerRouting),null!=e.datastore&&this.setDatastore(e.datastore),null!=e.connectionProtector&&this.setConnectionProtector(e.connectionProtector),null!=e.dht&&this.setDHT(e.dht),null!=e.pubsub&&this.setPubSub(e.pubsub),null!=e.dialer&&this.setDialer(e.dialer)}isStarted(){return this.started}async beforeStart(){await Promise.all(Object.values(this).filter((e=>E2(e))).map((async e=>{null!=e.beforeStart&&await e.beforeStart()})))}async start(){await Promise.all(Object.values(this).filter((e=>E2(e))).map((async e=>{await e.start()}))),this.started=!0}async afterStart(){await Promise.all(Object.values(this).filter((e=>E2(e))).map((async e=>{null!=e.afterStart&&await e.afterStart()})))}async beforeStop(){await Promise.all(Object.values(this).filter((e=>E2(e))).map((async e=>{null!=e.beforeStop&&await e.beforeStop()})))}async stop(){await Promise.all(Object.values(this).filter((e=>E2(e))).map((async e=>{await e.stop()}))),this.started=!1}async afterStop(){await Promise.all(Object.values(this).filter((e=>E2(e))).map((async e=>{null!=e.afterStop&&await e.afterStop()})))}setPeerId(e){return this.peerId=e,e}getPeerId(){if(null==this.peerId)throw mn(new Error("peerId not set"),"ERR_SERVICE_MISSING");return this.peerId}setMetrics(e){return this.metrics=e,_2(e)&&e.init(this),e}getMetrics(){return this.metrics}setAddressManager(e){return this.addressManager=e,_2(e)&&e.init(this),e}getAddressManager(){if(null==this.addressManager)throw mn(new Error("addressManager not set"),"ERR_SERVICE_MISSING");return this.addressManager}setPeerStore(e){return this.peerStore=e,_2(e)&&e.init(this),e}getPeerStore(){if(null==this.peerStore)throw mn(new Error("peerStore not set"),"ERR_SERVICE_MISSING");return this.peerStore}setUpgrader(e){return this.upgrader=e,_2(e)&&e.init(this),e}getUpgrader(){if(null==this.upgrader)throw mn(new Error("upgrader not set"),"ERR_SERVICE_MISSING");return this.upgrader}setRegistrar(e){return this.registrar=e,_2(e)&&e.init(this),e}getRegistrar(){if(null==this.registrar)throw mn(new Error("registrar not set"),"ERR_SERVICE_MISSING");return this.registrar}setConnectionManager(e){return this.connectionManager=e,_2(e)&&e.init(this),e}getConnectionManager(){if(null==this.connectionManager)throw mn(new Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this.connectionManager}setTransportManager(e){return this.transportManager=e,_2(e)&&e.init(this),e}getTransportManager(){if(null==this.transportManager)throw mn(new Error("transportManager not set"),"ERR_SERVICE_MISSING");return this.transportManager}setConnectionGater(e){return this.connectionGater=e,_2(e)&&e.init(this),e}getConnectionGater(){if(null==this.connectionGater)throw mn(new Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this.connectionGater}setContentRouting(e){return this.contentRouting=e,_2(e)&&e.init(this),e}getContentRouting(){if(null==this.contentRouting)throw mn(new Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this.contentRouting}setPeerRouting(e){return this.peerRouting=e,_2(e)&&e.init(this),e}getPeerRouting(){if(null==this.peerRouting)throw mn(new Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this.peerRouting}setDatastore(e){return this.datastore=e,_2(e)&&e.init(this),e}getDatastore(){if(null==this.datastore)throw mn(new Error("datastore not set"),"ERR_SERVICE_MISSING");return this.datastore}setConnectionProtector(e){return this.connectionProtector=e,_2(e)&&e.init(this),e}getConnectionProtector(){return this.connectionProtector}setDHT(e){return this.dht=e,_2(e)&&e.init(this),e}getDHT(){if(null==this.dht)throw mn(new Error("dht not set"),"ERR_SERVICE_MISSING");return this.dht}setPubSub(e){return this.pubsub=e,_2(e)&&e.init(this),e}getPubSub(){if(null==this.pubsub)throw mn(new Error("pubsub not set"),"ERR_SERVICE_MISSING");return this.pubsub}setDialer(e){return this.dialer=e,_2(e)&&e.init(this),e}getDialer(){if(null==this.dialer)throw mn(new Error("dialer not set"),"ERR_SERVICE_MISSING");return this.dialer}}const A2=gn("libp2p:gossipsub:score");class I2{constructor(e,t,r){this.params=e,this.metrics=t,this.peerStats=new Map,this.peerIPs=new Map,this.scoreCache=new Map,this.deliveryRecords=new v2,this.components=new S2,f2(e),this.scoreCacheValidityMs=r.scoreCacheValidityMs,this.computeScore=r.computeScore??m2}init(e){this.components=e}get size(){return this.peerStats.size}start(){this._backgroundInterval?A2("Peer score already running"):(this._backgroundInterval=setInterval((()=>this.background()),this.params.decayInterval),A2("started"))}stop(){this._backgroundInterval?(clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),A2("stopped")):A2("Peer score already stopped")}background(){this.refreshScores(),this.updateIPs(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map((([e,t])=>[e,t])))}refreshScores(){const e=Date.now(),t=this.params.decayToZero;this.peerStats.forEach(((r,n)=>{r.connected?(Object.entries(r.topics).forEach((([r,n])=>{const i=this.params.topics[r];void 0!==i&&(n.firstMessageDeliveries*=i.firstMessageDeliveriesDecay,n.firstMessageDeliveries<t&&(n.firstMessageDeliveries=0),n.meshMessageDeliveries*=i.meshMessageDeliveriesDecay,n.meshMessageDeliveries<t&&(n.meshMessageDeliveries=0),n.meshFailurePenalty*=i.meshFailurePenaltyDecay,n.meshFailurePenalty<t&&(n.meshFailurePenalty=0),n.invalidMessageDeliveries*=i.invalidMessageDeliveriesDecay,n.invalidMessageDeliveries<t&&(n.invalidMessageDeliveries=0),n.inMesh&&(n.meshTime=e-n.graftTime,n.meshTime>i.meshMessageDeliveriesActivation&&(n.meshMessageDeliveriesActive=!0)))})),r.behaviourPenalty*=this.params.behaviourPenaltyDecay,r.behaviourPenalty<t&&(r.behaviourPenalty=0)):e>r.expire&&(this.removeIPs(n,r.ips),this.peerStats.delete(n),this.scoreCache.delete(n))}))}score(e){this.metrics?.scoreFnCalls.inc();const t=this.peerStats.get(e);if(!t)return 0;const r=Date.now(),n=this.scoreCache.get(e);if(n&&n.cacheUntil>r)return n.score;this.metrics?.scoreFnRuns.inc();const i=this.computeScore(e,t,this.params,this.peerIPs),s=r+this.scoreCacheValidityMs;return n?(this.metrics?.scoreCachedDelta.observe(Math.abs(i-n.score)),n.score=i,n.cacheUntil=s):this.scoreCache.set(e,{score:i,cacheUntil:s}),i}addPenalty(e,t,r){const n=this.peerStats.get(e);n&&(n.behaviourPenalty+=t,this.metrics?.onScorePenalty(r))}addPeer(e){const t={connected:!0,expire:0,topics:{},ips:[],behaviourPenalty:0};this.peerStats.set(e,t);const r=this.getIPs(e);this.setIPs(e,r,t.ips),t.ips=r}removePeer(e){const t=this.peerStats.get(e);if(t){if(this.score(e)>0)return this.removeIPs(e,t.ips),void this.peerStats.delete(e);Object.entries(t.topics).forEach((([e,t])=>{t.firstMessageDeliveries=0;const r=this.params.topics[e].meshMessageDeliveriesThreshold;if(t.inMesh&&t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<r){const e=r-t.meshMessageDeliveries;t.meshFailurePenalty+=e*e}t.inMesh=!1,t.meshMessageDeliveriesActive=!1})),t.connected=!1,t.expire=Date.now()+this.params.retainScore}}graft(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);e&&(e.inMesh=!0,e.graftTime=Date.now(),e.meshTime=0,e.meshMessageDeliveriesActive=!1)}}prune(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);if(e){const r=this.params.topics[t].meshMessageDeliveriesThreshold;if(e.meshMessageDeliveriesActive&&e.meshMessageDeliveries<r){const t=r-e.meshMessageDeliveries;e.meshFailurePenalty+=t*t}e.meshMessageDeliveriesActive=!1,e.inMesh=!1}}}validateMessage(e){this.deliveryRecords.ensureRecord(e)}deliverMessage(e,t,r){this.markFirstMessageDelivery(e,r);const n=this.deliveryRecords.ensureRecord(t),i=Date.now();n.status===w2.unknown?(n.status=w2.valid,n.validated=i,n.peers.forEach((t=>{t!==e.toString()&&this.markDuplicateMessageDelivery(t,r)}))):A2("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",e,i-n.firstSeen,w2[n.status])}rejectInvalidMessage(e,t){this.markInvalidMessageDelivery(e,t)}rejectMessage(e,t,r,n){switch(n){case n2.Error:return void this.markInvalidMessageDelivery(e,r);case n2.Blacklisted:return}const i=this.deliveryRecords.ensureRecord(t);if(i.status===w2.unknown){if(n===n2.Ignore)return i.status=w2.ignored,void i.peers.clear();i.status=w2.invalid,this.markInvalidMessageDelivery(e,r),i.peers.forEach((e=>{this.markInvalidMessageDelivery(e,r)})),i.peers.clear()}else A2("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-i.firstSeen,w2[i.status])}duplicateMessage(e,t,r){const n=this.deliveryRecords.ensureRecord(t);if(!n.peers.has(e))switch(n.status){case w2.unknown:n.peers.add(e);break;case w2.valid:n.peers.add(e),this.markDuplicateMessageDelivery(e,r,n.validated);break;case w2.invalid:this.markInvalidMessageDelivery(e,r);break;case w2.ignored:break}}markInvalidMessageDelivery(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);e&&(e.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);if(e){let r=this.params.topics[t].firstMessageDeliveriesCap;e.firstMessageDeliveries=Math.min(r,e.firstMessageDeliveries+1),e.inMesh&&(r=this.params.topics[t].meshMessageDeliveriesCap,e.meshMessageDeliveries=Math.min(r,e.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(e,t,r){const n=this.peerStats.get(e);if(n){const e=void 0!==r?Date.now():0,i=this.getPtopicStats(n,t);if(i&&i.inMesh){const n=this.params.topics[t];if(void 0!==r){const i=e-r,s=i>n.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(t,i,s),s)return}const s=n.meshMessageDeliveriesCap;i.meshMessageDeliveries=Math.min(s,i.meshMessageDeliveries+1)}}}getIPs(e){return this.components.getConnectionManager().getConnections(s_(e)).map((e=>e.remoteAddr.toOptions().host))}setIPs(e,t,r){e:for(const n of t){for(const e of r)if(n===e)continue e;let t=this.peerIPs.get(n);t||(t=new Set,this.peerIPs.set(n,t)),t.add(e)}e:for(const n of r){for(const e of t)if(n===e)continue e;const r=this.peerIPs.get(n);r&&(r.delete(e),r.size||this.peerIPs.delete(n))}}removeIPs(e,t){t.forEach((t=>{const r=this.peerIPs.get(t);r&&(r.delete(e),r.size||this.peerIPs.delete(t))}))}updateIPs(){this.peerStats.forEach(((e,t)=>{const r=this.getIPs(t);this.setIPs(t,r,e.ips),e.ips=r}))}getPtopicStats(e,t){let r=e.topics[t];return void 0!==r?r:void 0!==this.params.topics[t]?(r={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[t]=r,r):null}}class C2{constructor(e,t,r){this.gossipsubIWantFollowupMs=e,this.msgIdToStrFn=t,this.metrics=r,this.promises=new Map,this.requestMsByMsg=new Map,this.requestMsByMsgExpire=10*e}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(e,t){const r=Math.floor(Math.random()*t.length),n=t[r],i=this.msgIdToStrFn(n);let s=this.promises.get(i);s||(s=new Map,this.promises.set(i,s));const o=Date.now();s.has(e)||(s.set(e,o+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(i)||this.requestMsByMsg.set(i,o)))}getBrokenPromises(){const e=Date.now(),t=new Map;let r=0;return this.promises.forEach(((n,i)=>{n.forEach(((i,s)=>{i<e&&(t.set(s,(t.get(s)??0)+1),n.delete(s),r++)})),n.size||this.promises.delete(i)})),this.metrics?.iwantPromiseBroken.inc(r),t}deliverMessage(e){this.trackMessage(e);const t=this.promises.get(e);t&&(this.promises.delete(e),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(t.size)))}rejectMessage(e,t){switch(this.trackMessage(e),t){case n2.Error:return}this.promises.delete(e)}clear(){this.promises.clear()}prune(){const e=Date.now()-this.requestMsByMsgExpire;for(const[t,r]of this.requestMsByMsg.entries()){if(!(r<e))break;this.requestMsByMsg.delete(t)}}trackMessage(e){if(this.metrics){const t=this.requestMsByMsg.get(e);void 0!==t&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-t)/1e3),this.requestMsByMsg.delete(e))}}}class k2{constructor(e){this.entries=new Map,this.validityMs=e.validityMs}get size(){return this.entries.size}put(e,t){this.entries.set(e,{value:t,validUntilMs:Date.now()+this.validityMs})}prune(){const e=Date.now();for(const[t,r]of this.entries.entries()){if(!(r.validUntilMs<e))break;this.entries.delete(t)}}has(e){return this.entries.has(e)}get(e){const t=this.entries.get(e);return t&&t.validUntilMs>=Date.now()?t.value:void 0}clear(){this.entries.clear()}}var T2,R2,P2,x2,D2,O2;function N2(e,t,r){return{protocolsEnabled:e.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:e.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:e.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:e.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEvents:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_total",help:"Number of times we include peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),meshPeerChurnEvents:e.gauge({name:"gossipsub_peer_churn_events_total",help:"Number of times we remove peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),peersPerProtocol:e.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:e.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:e.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),asyncValidationResult:e.gauge({name:"gossipsub_async_validation_result_total",help:"Message validation result for each topic",labelNames:["topic","acceptance"]}),asyncValidationMcacheHit:e.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),rpcRecvBytes:e.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:e.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:e.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:e.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:e.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:e.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:e.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:e.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:e.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcRecvNotAccepted:e.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:e.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:e.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:e.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:e.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:e.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:e.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:e.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:e.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:e.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:e.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeers:e.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),msgPublishPeersByGroup:e.gauge({name:"gossipsub_msg_publish_peers_by_group",help:"Total count of peers (by group) that we publish a msg to",labelNames:["topic","peerGroup"]}),msgPublishBytes:e.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgForwardCount:e.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:e.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:e.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedStatus:e.gauge({name:"gossipsub_msg_received_status_total",help:"Tracks distribution of recv msgs by duplicate, invalid, valid",labelNames:["topic","status"]}),msgReceivedInvalid:e.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["topic","error"]}),duplicateMsgDeliveryDelay:e.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*r.maxMeshMessageDeliveriesWindowSec,.5*r.maxMeshMessageDeliveriesWindowSec,1*r.maxMeshMessageDeliveriesWindowSec,2*r.maxMeshMessageDeliveriesWindowSec,4*r.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:e.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),scoreFnCalls:e.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:e.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:e.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:e.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:e.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores",labelNames:["topic","p"]}),scoreWeights:e.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:e.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:e.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:e.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*r.behaviourPenaltyThreshold,.5*r.behaviourPenaltyThreshold,1*r.behaviourPenaltyThreshold,2*r.behaviourPenaltyThreshold,4*r.behaviourPenaltyThreshold]}),ihaveRcvIgnored:e.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:e.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:e.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:e.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:e.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:e.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:e.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedPeers:e.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:e.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantPromiseDeliveryTime:e.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*r.gossipPromiseExpireSec,1*r.gossipPromiseExpireSec,2*r.gossipPromiseExpireSec,4*r.gossipPromiseExpireSec]}),cacheSize:e.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:e.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),topicStrToLabel:t,toTopic(e){return this.topicStrToLabel.get(e)??e},onJoin(e){this.topicSubscriptionStatus.set({topicStr:e},1),this.meshPeerCounts.set({topicStr:e},0)},onLeave(e){this.topicSubscriptionStatus.set({topicStr:e},0),this.meshPeerCounts.set({topicStr:e},0)},onAddToMesh(e,t,r){const n=this.toTopic(e);this.meshPeerInclusionEvents.inc({topic:n,reason:t},r)},onRemoveFromMesh(e,t,r){const n=this.toTopic(e);this.meshPeerChurnEvents.inc({topic:n,reason:t},r)},onReportValidationMcacheHit(e){this.asyncValidationMcacheHit.inc({hit:e?"hit":"miss"})},onReportValidation(e,t){const r=this.toTopic(e);this.asyncValidationResult.inc({topic:r,acceptance:t})},onScorePenalty(e){this.scoringPenalties.inc({penalty:e},1)},onIhaveRcv(e,t,r){const n=this.toTopic(e);this.ihaveRcvMsgids.inc({topic:n},t),this.ihaveRcvNotSeenMsgids.inc({topic:n},r)},onIwantRcv(e,t){for(const[r,n]of e){const e=this.toTopic(r);this.iwantRcvMsgids.inc({topic:e},n)}this.iwantRcvDonthaveMsgids.inc(t)},onForwardMsg(e,t){const r=this.toTopic(e);this.msgForwardCount.inc({topic:r},1),this.msgForwardPeers.inc({topic:r},t)},onPublishMsg(e,t,r,n){const i=this.toTopic(e);this.msgPublishCount.inc({topic:i},1),this.msgPublishBytes.inc({topic:i},r*n),this.msgPublishPeers.inc({topic:i},r),this.msgPublishPeersByGroup.inc({topic:i,peerGroup:"direct"},t.direct),this.msgPublishPeersByGroup.inc({topic:i,peerGroup:"floodsub"},t.floodsub),this.msgPublishPeersByGroup.inc({topic:i,peerGroup:"mesh"},t.mesh),this.msgPublishPeersByGroup.inc({topic:i,peerGroup:"fanout"},t.fanout)},onMsgRecvPreValidation(e){const t=this.toTopic(e);this.msgReceivedPreValidation.inc({topic:t},1)},onMsgRecvResult(e,t){const r=this.toTopic(e);this.msgReceivedStatus.inc({topic:r,status:t})},onMsgRecvInvalid(e,t){const r=this.toTopic(e),n=t.reason===n2.Error?t.error:t.reason;this.msgReceivedInvalid.inc({topic:r,error:n},1)},onDuplicateMsgDelivery(e,t,r){if(this.duplicateMsgDeliveryDelay.observe(t/1e3),r){const t=this.toTopic(e);this.duplicateMsgLateDelivery.inc({topic:t},1)}},onRpcRecv(e,t){this.rpcRecvBytes.inc(t),this.rpcRecvCount.inc(1),e.subscriptions&&this.rpcRecvSubscription.inc(e.subscriptions.length),e.messages&&this.rpcRecvMessage.inc(e.messages.length),e.control&&(this.rpcRecvControl.inc(1),e.control.ihave&&this.rpcRecvIHave.inc(e.control.ihave.length),e.control.iwant&&this.rpcRecvIWant.inc(e.control.iwant.length),e.control.graft&&this.rpcRecvGraft.inc(e.control.graft.length),e.control.prune&&this.rpcRecvPrune.inc(e.control.prune.length))},onRpcSent(e,t){if(this.rpcSentBytes.inc(t),this.rpcSentCount.inc(1),e.subscriptions&&this.rpcSentSubscription.inc(e.subscriptions.length),e.messages&&this.rpcSentMessage.inc(e.messages.length),e.control){const t=e.control.ihave?.length??0,r=e.control.iwant?.length??0,n=e.control.graft?.length??0,i=e.control.prune?.length??0;t>0&&this.rpcSentIHave.inc(t),r>0&&this.rpcSentIWant.inc(r),n>0&&this.rpcSentGraft.inc(n),i>0&&this.rpcSentPrune.inc(i),(t>0||r>0||n>0||i>0)&&this.rpcSentControl.inc(1)}},registerScores(e,t){let r=0,n=0,i=0,s=0;for(const o of e)o>=t.graylistThreshold&&r++,o>=t.publishThreshold&&n++,o>=t.gossipThreshold&&i++,o>=0&&s++;this.peersByScoreThreshold.set({threshold:O2.graylist},r),this.peersByScoreThreshold.set({threshold:O2.publish},n),this.peersByScoreThreshold.set({threshold:O2.gossip},i),this.peersByScoreThreshold.set({threshold:O2.mesh},s),this.score.set(e)},registerScoreWeights(e){for(const[t,r]of e.byTopic)this.scoreWeights.set({topic:t,p:"p1"},r.p1w),this.scoreWeights.set({topic:t,p:"p2"},r.p2w),this.scoreWeights.set({topic:t,p:"p3"},r.p3w),this.scoreWeights.set({topic:t,p:"p3b"},r.p3bw),this.scoreWeights.set({topic:t,p:"p4"},r.p4w);this.scoreWeights.set({p:"p5"},e.p5w),this.scoreWeights.set({p:"p6"},e.p6w),this.scoreWeights.set({p:"p7"},e.p7w)},registerScorePerMesh(e,t){const r=new Map;e.forEach(((e,t)=>{const n=this.topicStrToLabel.get(t)??"unknown";let i=r.get(n);i||(i=new Set,r.set(n,i)),e.forEach((e=>i?.add(e)))}));for(const[n,i]of r){const e=[];i.forEach((r=>{e.push(t.get(r)??0)})),this.scorePerMesh.set({topic:n},e)}}}}(function(e){e["forward"]="forward",e["publish"]="publish"})(T2||(T2={})),function(e){e["Fanout"]="fanout",e["Random"]="random",e["Subscribed"]="subscribed",e["Outbound"]="outbound",e["NotEnough"]="not_enough",e["Opportunistic"]="opportunistic"}(R2||(R2={})),function(e){e["Dc"]="disconnected",e["BadScore"]="bad_score",e["Prune"]="prune",e["Unsub"]="unsubscribed",e["Excess"]="excess"}(P2||(P2={})),function(e){e["GraftBackoff"]="graft_backoff",e["BrokenPromise"]="broken_promise",e["MessageDeficit"]="message_deficit",e["IPColocation"]="IP_colocation"}(x2||(x2={})),function(e){e["LowScore"]="low_score",e["MaxIhave"]="max_ihave",e["MaxIasked"]="max_iasked"}(D2||(D2={})),function(e){e["graylist"]="graylist",e["publish"]="publish",e["gossip"]="gossip",e["mesh"]="mesh"}(O2||(O2={}));r(8925);var L2=r(8960);const B2={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function U2(e,t,r,n,i){if("sha1"!==i&&"sha2-256"!==i&&"sha2-512"!==i){const e=Object.keys(B2).join(" / ");throw mn(new Error(`Hash '${i}' is unknown or not supported. Must be ${e}`),"ERR_UNSUPPORTED_HASH_TYPE")}const s=B2[i],o=L2(e,t,r,n,s);return WA.encode64(o,null)}const M2=Jl("libp2p-pubsub:");async function j2(e,t,r,n){switch(e.type){case t2.Signing:{const i={from:e.author.toBytes(),data:n,seqno:uC(8),topic:t,signature:void 0,key:void 0},s=(0,UT.concat)([M2,h0.Message.encode(i).finish()]);i.signature=await e.privateKey.sign(s),i.key=e.key;const o={type:"signed",from:e.author,data:r,sequenceNumber:BigInt(`0x${C_(i.seqno,"base16")}`),topic:t,signature:i.signature,key:i.key};return{raw:i,msg:o}}case t2.Anonymous:return{raw:{from:void 0,data:n,seqno:void 0,topic:t,signature:void 0,key:void 0},msg:{type:"unsigned",data:r,topic:t}}}}async function V2(e,t){switch(e){case Z0:return null!=t.signature?{valid:!1,error:i2.SignaturePresent}:null!=t.seqno?{valid:!1,error:i2.SeqnoPresent}:null!=t.key?{valid:!1,error:i2.FromPresent}:{valid:!0,message:{type:"unsigned",topic:t.topic,data:t.data??new Uint8Array(0)}};case X0:{if(null==t.seqno)return{valid:!1,error:i2.InvalidSeqno};if(8!==t.seqno.length)return{valid:!1,error:i2.InvalidSeqno};if(null==t.signature)return{valid:!1,error:i2.InvalidSignature};if(null==t.from)return{valid:!1,error:i2.InvalidPeerId};let e,n;try{e=o_(t.from)}catch(r){return{valid:!1,error:i2.InvalidPeerId}}if(t.key){if(n=hT(t.key),void 0!==e.publicKey&&!k_(n.bytes,e.publicKey))return{valid:!1,error:i2.InvalidPeerId}}else{if(null==e.publicKey)return{valid:!1,error:i2.InvalidPeerId};n=hT(e.publicKey)}const i={from:t.from,data:t.data,seqno:t.seqno,topic:t.topic,signature:void 0,key:void 0},s=(0,UT.concat)([M2,h0.Message.encode(i).finish()]);return await n.verify(s,t.signature)?{valid:!0,message:{type:"signed",from:e,data:t.data??new Uint8Array(0),sequenceNumber:BigInt(`0x${C_(t.seqno,"base16")}`),topic:t.topic,signature:t.signature,key:t.key??dT(n)}}:{valid:!1,error:i2.InvalidSignature}}}}const z2=(e,t)=>{const r=Jl(t.toString(16).padStart(16,"0"),"base16"),n=new Uint8Array(e.length+r.length);return n.set(e,0),n.set(r,e.length),n};function F2(e){if("signed"!==e.type)throw new Error("expected signed message type");if(null==e.sequenceNumber)throw Error("missing seqno field");return z2(e.from.toBytes(),e.sequenceNumber)}async function $2(e){return await vl.encode(e.data)}function K2(e,t,r,n,i){let s=0;const o=new Map;if(Object.entries(t.topics).forEach((([e,t])=>{const n=i.get(e)??"unknown",a=r.topics[e];if(void 0===a)return;let c=o.get(n);c||(c={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},o.set(n,c));let l=0,u=0,h=0,d=0,f=0;if(t.inMesh){const e=Math.max(t.meshTime/a.timeInMeshQuantum,a.timeInMeshCap);l+=e*a.timeInMeshWeight}let p=t.firstMessageDeliveries;if(p>a.firstMessageDeliveriesCap&&(p=a.firstMessageDeliveriesCap),u+=p*a.firstMessageDeliveriesWeight,t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<a.meshMessageDeliveriesThreshold){const e=a.meshMessageDeliveriesThreshold-t.meshMessageDeliveries,r=e*e;h+=r*a.meshMessageDeliveriesWeight}const y=t.meshFailurePenalty;d+=y*a.meshFailurePenaltyWeight;const g=t.invalidMessageDeliveries*t.invalidMessageDeliveries;f+=g*a.invalidMessageDeliveriesWeight,s+=(l+u+h+d+f)*a.topicWeight,c.p1w+=l,c.p2w+=u,c.p3w+=h,c.p3bw+=d,c.p4w+=f})),r.topicScoreCap>0&&s>r.topicScoreCap){s=r.topicScoreCap;const e=r.topicScoreCap/s;for(const t of o.values())t.p1w*=e,t.p2w*=e,t.p3w*=e,t.p3bw*=e,t.p4w*=e}let a=0,c=0,l=0;const u=r.appSpecificScore(e);a+=u*r.appSpecificWeight,t.ips.forEach((e=>{if(r.IPColocationFactorWhitelist.has(e))return;const t=n.get(e),i=t?t.size:0;if(i>r.IPColocationFactorThreshold){const e=i-r.IPColocationFactorThreshold,t=e*e;c+=t*r.IPColocationFactorWeight}}));const h=t.behaviourPenalty*t.behaviourPenalty;return l+=h*r.behaviourPenaltyWeight,s+=a+c+l,{byTopic:o,p5w:a,p6w:c,p7w:l,score:s}}function q2(e,t,r,n,i){const s={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(const o of e){const e=t.get(o);if(e){const t=K2(o,e,r,n,i);for(const[e,r]of t.byTopic){let t=s.byTopic.get(e);t||(t={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},s.byTopic.set(e,t)),t.p1w.push(r.p1w),t.p2w.push(r.p2w),t.p3w.push(r.p3w),t.p3bw.push(r.p3bw),t.p4w.push(r.p4w)}s.p5w.push(t.p5w),s.p6w.push(t.p6w),s.p7w.push(t.p7w),s.score.push(t.score)}else s.p5w.push(0),s.p6w.push(0),s.p7w.push(0),s.score.push(0)}return s}function H2(e,t,r=(()=>!0)){const n=new Set;if(t<=0)return n;for(const i of e){if(n.size>=t)break;r(i)&&(n.add(i),e.delete(i))}return n}function G2(e,t){return H2(e,t,(()=>!0))}class W2 extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function Y2(e){if(null!=e){if("function"===typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"===typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"===typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}function J2(e,t,r){const n=r??{},i=Y2(e);async function*s(){let r;const s=()=>{null!=r&&r()};t.addEventListener("abort",s);while(1){let o;try{if(t.aborted){const{abortMessage:e,abortCode:t}=n;throw new W2(e,t)}const e=new Promise(((e,t)=>{r=()=>{const{abortMessage:e,abortCode:r}=n;t(new W2(e,r))}}));o=await Promise.race([e,i.next()]),r=null}catch(WV){t.removeEventListener("abort",s);const o="aborted"===WV.type&&t.aborted;if(o&&null!=n.onAbort&&await n.onAbort(e),"function"===typeof i.return)try{const e=i.return();e instanceof Promise&&e.catch((e=>{null!=n.onReturnError&&n.onReturnError(e)}))}catch(WV){null!=n.onReturnError&&n.onReturnError(WV)}if(o&&!0===n.returnOnAbort)return;throw WV}if(!0===o.done)break;yield o.value}t.removeEventListener("abort",s)}return s()}function Q2(e,t,r){return n=>e(J2(n,t,r))}function X2(e,t,r){return{sink:Q2(e.sink,t,{...r,onAbort:void 0}),source:J2(e.source,t,r)}}function Z2(e){return null!=globalThis?.Buffer?.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}const e3=e=>{const t=q1.encodingLength(e),r=Z2(t);return q1.encode(e,r),e3.bytes=t,r};function t3(e){e=e??{};const t=e.lengthEncoder??e3,r=async function*(e){for await(const r of e){const e=t(r.byteLength);e instanceof Uint8Array?yield e:yield*e,r instanceof Uint8Array?yield r:yield*r}};return r}e3.bytes=0,t3.single=(e,t)=>{t=t??{};const r=t.lengthEncoder??e3;return new XL(r(e.byteLength),e)};const r3=8,n3=4194304;var i3;(function(e){e[e["LENGTH"]=0]="LENGTH",e[e["DATA"]=1]="DATA"})(i3||(i3={}));const s3=e=>{const t=q1.decode(e);return s3.bytes=q1.encodingLength(t),t};function o3(e){const t=async function*(t){const r=new XL;let n=i3.LENGTH,i=-1;const s=e?.lengthDecoder??s3,o=e?.maxLengthLength??r3,a=e?.maxDataLength??n3;for await(const c of t){r.append(c);while(r.byteLength>0){if(n===i3.LENGTH)try{if(i=s(r),i<0)throw mn(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(i>a)throw mn(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const t=s.bytes;r.consume(t),null!=e?.onLength&&e.onLength(i),n=i3.DATA}catch(WV){if(WV instanceof RangeError){if(r.byteLength>o)throw mn(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw WV}if(n===i3.DATA){if(r.byteLength<i)break;const t=r.sublist(0,i);r.consume(i),null!=e?.onData&&e.onData(t),yield t,n=i3.LENGTH}}}if(r.byteLength>0)throw mn(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")};return t}s3.bytes=0,o3.fromReader=(e,t)=>{let r=1;const n=async function*(){while(1)try{const{done:t,value:n}=await e.next(r);if(!0===t)return;null!=n&&(yield n)}catch(WV){if("ERR_UNDER_READ"===WV.code)return{done:!0,value:null};throw WV}finally{r=1}}(),i=e=>{r=e};return o3({...t??{},onLength:i})(n)};class a3{constructor(e,t,r){this.rawStream=e,this.pushable=LR({objectMode:!1}),this.closeController=new AbortController,this.maxBufferSize=r.maxBufferSize??1/0,QR(J2(this.pushable,this.closeController.signal,{returnOnAbort:!0}),t3(),this.rawStream).catch(t)}get protocol(){return this.rawStream.stat.protocol}push(e){if(this.pushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.pushable.push(e)}close(){this.closeController.abort(),this.pushable.return(),this.rawStream.close()}}class c3{constructor(e){this.rawStream=e,this.closeController=new AbortController,this.source=J2(QR(this.rawStream,o3()),this.closeController.signal,{returnOnAbort:!0})}close(){this.closeController.abort(),this.rawStream.close()}}var l3;(function(e){e[e["started"]=0]="started",e[e["stopped"]=1]="stopped"})(l3||(l3={}));class u3 extends o0{constructor(e={}){super(),this.multicodecs=[g0,y0],this.peers=new Set,this.streamsInbound=new Map,this.streamsOutbound=new Map,this.outboundInflightQueue=LR({objectMode:!0}),this.direct=new Set,this.floodsubPeers=new Set,this.acceptFromWhitelist=new Map,this.topics=new Map,this.subscriptions=new Set,this.mesh=new Map,this.fanout=new Map,this.fanoutLastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.topicValidators=new Map,this.heartbeatTicks=0,this.components=new S2,this.directPeerInitial=null,this.status={code:l3.stopped},this.heartbeatTimer=null,this.runHeartbeat=()=>{const e=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch((e=>{this.log("Error running heartbeat",e)})).finally((()=>{if(null!=e&&e(),this.status.code===l3.started){clearTimeout(this.status.heartbeatTimeout);let e=this.opts.heartbeatInterval-(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;e<.25*this.opts.heartbeatInterval&&(e+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,e)}}))};const t={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:m0,Dlo:w0,Dhi:b0,Dscore:v0,Dout:E0,Dlazy:A0,heartbeatInterval:T0,fanoutTTL:R0,mcacheLength:_0,mcacheGossip:S0,seenTTL:z0,gossipsubIWantFollowupMs:V0,prunePeers:P0,pruneBackoff:x0,graftFloodThreshold:U0,opportunisticGraftPeers:B0,opportunisticGraftTicks:L0,directConnectTicks:O0,...e,scoreParams:h2(e.scoreParams),scoreThresholds:g2(e.scoreThresholds)};if(this.globalSignaturePolicy=t.globalSignaturePolicy??X0,t.fallbackToFloodsub&&this.multicodecs.push(p0),this.log=gn(t.debugName??"libp2p:gossipsub"),this.opts=t,this.direct=new Set(t.directPeers.map((e=>e.id.toString()))),this.seenCache=new k2({validityMs:t.seenTTL}),this.publishedMessageIds=new k2({validityMs:t.seenTTL}),e.msgIdFn)this.msgIdFn=e.msgIdFn;else switch(this.globalSignaturePolicy){case X0:this.msgIdFn=F2;break;case Z0:this.msgIdFn=$2;break}if(e.fastMsgIdFn&&(this.fastMsgIdFn=e.fastMsgIdFn,this.fastMsgIdCache=new k2({validityMs:t.seenTTL})),this.msgIdToStrFn=e.msgIdToStrFn??Q0,this.mcache=e.messageCache||new l0(t.mcacheGossip,t.mcacheLength,this.msgIdToStrFn),e.dataTransform&&(this.dataTransform=e.dataTransform),e.metricsRegister){if(!e.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");const r=Math.max(...Object.values(t.scoreParams.topics).map((e=>e.meshMessageDeliveriesWindow)),W0),n=N2(e.metricsRegister,e.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:t.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:r/1e3});n.mcacheSize.addCollect((()=>this.onScrapeMetrics(n)));for(const e of this.multicodecs)n.protocolsEnabled.set({protocol:e},1);this.metrics=n}else this.metrics=null;this.gossipTracer=new C2(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new I2(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:t.heartbeatInterval}),this.maxInboundStreams=e.maxInboundStreams,this.maxOutboundStreams=e.maxOutboundStreams}getPeers(){return[...this.peers.keys()].map((e=>s_(e)))}isStarted(){return this.status.code===l3.started}async init(e){this.components=e,this.score.init(e)}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await a2(this.globalSignaturePolicy,this.components.getPeerId()),this.outboundInflightQueue=LR({objectMode:!0}),QR(this.outboundInflightQueue,(async e=>{for await(const{peerId:t,connection:r}of e)await this.createOutboundStream(t,r)})).catch((e=>this.log.error("outbound inflight queue error",e))),await Promise.all(this.opts.directPeers.map((async e=>{await this.components.getPeerStore().addressBook.add(e.id,e.addrs)})));const e=this.components.getRegistrar();await Promise.all(this.multicodecs.map((t=>e.handle(t,this.onIncomingStream.bind(this),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))));const t=n0({onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)}),r=await Promise.all(this.multicodecs.map((r=>e.register(r,t)))),n=setTimeout(this.runHeartbeat,k0);this.status={code:l3.started,registrarTopologyIds:r,heartbeatTimeout:n,hearbeatStartMs:Date.now()+k0},this.score.start(),this.directPeerInitial=setTimeout((()=>{Promise.resolve().then((async()=>{await Promise.all(Array.from(this.direct).map((async e=>await this.connect(e))))})).catch((e=>{this.log(e)}))}),N0),this.log("started")}async stop(){if(this.log("stopping"),this.status.code!==l3.started)return;const{registrarTopologyIds:e}=this.status;this.status={code:l3.stopped};const t=this.components.getRegistrar();e.forEach((e=>t.unregister(e))),this.outboundInflightQueue.end();for(const r of this.streamsOutbound.values())r.close();this.streamsOutbound.clear();for(const r of this.streamsInbound.values())r.close();this.streamsInbound.clear(),this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({stream:e,connection:t}){if(!this.isStarted())return;const r=t.remotePeer;this.addPeer(r,t.stat.direction),this.createInboundStream(r,e),this.outboundInflightQueue.push({peerId:r,connection:t})}onPeerConnected(e,t){this.isStarted()&&(this.addPeer(e,t.stat.direction),this.outboundInflightQueue.push({peerId:e,connection:t}))}onPeerDisconnected(e){this.log("connection ended %p",e),this.removePeer(e)}async createOutboundStream(e,t){if(!this.isStarted())return;const r=e.toString();if(this.peers.has(r)&&!this.streamsOutbound.has(r))try{const n=new a3(await t.newStream(this.multicodecs),(e=>this.log.error("outbound pipe error",e)),{maxBufferSize:this.opts.maxOutboundBufferSize});this.log("create outbound stream %p",e),this.streamsOutbound.set(r,n);const i=n.protocol;i===p0&&this.floodsubPeers.add(r),this.metrics?.peersPerProtocol.inc({protocol:i},1),this.subscriptions.size>0&&(this.log("send subscriptions to",r),this.sendSubscriptions(r,Array.from(this.subscriptions),!0))}catch(n){this.log.error("createOutboundStream error",n)}}async createInboundStream(e,t){if(!this.isStarted())return;const r=e.toString();if(!this.peers.has(r))return;const n=this.streamsInbound.get(r);void 0!==n&&(this.log("replacing existing inbound steam %s",r),n.close()),this.log("create inbound stream %s",r);const i=new c3(t);this.streamsInbound.set(r,i),this.pipePeerReadStream(e,i.source).catch((e=>this.log(e)))}addPeer(e,t){const r=e.toString();this.peers.has(r)||(this.log("new peer %p",e),this.peers.add(r),this.score.addPeer(r),this.outbound.has(r)||this.outbound.set(r,"outbound"===t))}removePeer(e){const t=e.toString();if(!this.peers.has(t))return;this.log("delete peer %p",e),this.peers.delete(t);const r=this.streamsOutbound.get(t),n=this.streamsInbound.get(t);r&&this.metrics?.peersPerProtocol.inc({protocol:r.protocol},-1),r?.close(),n?.close(),this.streamsOutbound.delete(t),this.streamsInbound.delete(t);for(const i of this.topics.values())i.delete(t);for(const[i,s]of this.mesh)!0===s.delete(t)&&this.metrics?.onRemoveFromMesh(i,P2.Dc,1);for(const i of this.fanout.values())i.delete(t);this.floodsubPeers.delete(t),this.gossip.delete(t),this.control.delete(t),this.outbound.delete(t),this.score.removePeer(t),this.acceptFromWhitelist.delete(t)}get started(){return this.status.code===l3.started}getMeshPeers(e){const t=this.mesh.get(e);return t?Array.from(t):[]}getSubscribers(e){const t=this.topics.get(e);return(t?Array.from(t):[]).map((e=>s_(e)))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(e,t){try{await QR(t,(async t=>{for await(const n of t)try{const t=n.subarray(),r=h0.decode(t);this.metrics?.onRpcRecv(r,t.length),this.opts.awaitRpcHandler?await this.handleReceivedRpc(e,r):this.handleReceivedRpc(e,r).catch((e=>this.log(e)))}catch(r){this.log(r)}}))}catch(WV){this.log.error(WV),this.onPeerDisconnected(e)}}async handleReceivedRpc(e,t){if(!this.acceptFrom(e.toString()))return this.log("received message from unacceptable peer %p",e),void this.metrics?.rpcRecvNotAccepted.inc();if(this.log("rpc from %p",e),t.subscriptions&&t.subscriptions.length>0&&(t.subscriptions.forEach((t=>{this.handleReceivedSubscription(e,t)})),this.dispatchEvent(new c0("subscription-change",{detail:{peerId:e,subscriptions:t.subscriptions.filter((e=>null!==e.topic)).map((e=>({topic:e.topic??"",subscribe:Boolean(e.subscribe)})))}}))),t.messages)for(const r of t.messages){const t=this.handleReceivedMessage(e,r).catch((e=>this.log(e)));this.opts.awaitRpcMessageHandler&&await t}t.control&&await this.handleControlMessage(e.toString(),t.control)}handleReceivedSubscription(e,t){if(null==t.topic)return;this.log("subscription update from %p topic %s",e,t.topic);let r=this.topics.get(t.topic);null==r&&(r=new Set,this.topics.set(t.topic,r)),t.subscribe?r.add(e.toString()):r.delete(e.toString())}async handleReceivedMessage(e,t){this.metrics?.onMsgRecvPreValidation(t.topic);const r=await this.validateReceivedMessage(e,t);switch(this.metrics?.onMsgRecvResult(t.topic,r.code),r.code){case s2.duplicate:return this.score.duplicateMessage(e.toString(),r.msgIdStr,t.topic),void this.mcache.observeDuplicate(r.msgIdStr,e.toString());case s2.invalid:if(r.msgIdStr){const n=r.msgIdStr;this.score.rejectMessage(e.toString(),n,t.topic,r.reason),this.gossipTracer.rejectMessage(n,r.reason)}else this.score.rejectInvalidMessage(e.toString(),t.topic);return void this.metrics?.onMsgRecvInvalid(t.topic,r);case s2.valid:if(this.score.validateMessage(r.messageId.msgIdStr),this.gossipTracer.deliverMessage(r.messageId.msgIdStr),this.mcache.put(r.messageId,t,!this.opts.asyncValidation),this.subscriptions.has(t.topic)){const t=this.components.getPeerId().equals(e);t&&!this.opts.emitSelf||(super.dispatchEvent(new c0("gossipsub:message",{detail:{propagationSource:e,msgId:r.messageId.msgIdStr,msg:r.msg}})),super.dispatchEvent(new c0("message",{detail:r.msg})))}this.opts.asyncValidation||this.forwardMessage(r.messageId.msgIdStr,t,e.toString())}}async validateReceivedMessage(e,t){const r=this.fastMsgIdFn?.(t),n=r?this.fastMsgIdCache?.get(r):void 0;if(n)return{code:s2.duplicate,msgIdStr:n};const i=await V2(this.globalSignaturePolicy,t);if(!i.valid)return{code:s2.invalid,reason:n2.Error,error:i.error};const s=i.message;try{this.dataTransform&&(s.data=this.dataTransform.inboundTransform(t.topic,s.data))}catch(u){return this.log("Invalid message, transform failed",u),{code:s2.invalid,reason:n2.Error,error:i2.TransformFailed}}const o=await this.msgIdFn(s),a=this.msgIdToStrFn(o),c={msgId:o,msgIdStr:a};if(r&&this.fastMsgIdCache?.put(r,a),this.seenCache.has(a))return{code:s2.duplicate,msgIdStr:a};this.seenCache.put(a);const l=this.topicValidators.get(t.topic);if(null!=l){let t;try{t=await l(s.topic,s,e)}catch(u){const e=u.code;e===K0&&(t=r2.Ignore),t=e===$0?r2.Reject:r2.Ignore}if(t!==r2.Accept)return{code:s2.invalid,reason:o2(t),msgIdStr:a}}return{code:s2.valid,messageId:c,msg:s}}getScore(e){return this.score.score(e)}sendSubscriptions(e,t,r){this.sendRpc(e,{subscriptions:t.map((e=>({topic:e,subscribe:r}))),messages:[]})}async handleControlMessage(e,t){if(void 0===t)return;const r=t.ihave?this.handleIHave(e,t.ihave):[],n=t.iwant?this.handleIWant(e,t.iwant):[],i=t.graft?await this.handleGraft(e,t.graft):[];t.prune&&await this.handlePrune(e,t.prune),(r.length||n.length||i.length)&&this.sendRpc(e,Y0(n,{iwant:r,prune:i}))}acceptFrom(e){if(this.direct.has(e))return!0;const t=Date.now(),r=this.acceptFromWhitelist.get(e);if(r&&r.messagesAccepted<H0&&r.acceptUntil>=t)return r.messagesAccepted+=1,!0;const n=this.score.score(e);return n>=q0?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:t+G0}):this.acceptFromWhitelist.delete(e),n>=this.opts.scoreThresholds.graylistThreshold}handleIHave(e,t){if(!t.length)return[];const r=this.score.score(e);if(r<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,r),this.metrics?.ihaveRcvIgnored.inc({reason:D2.LowScore}),[];const n=(this.peerhave.get(e)??0)+1;if(this.peerhave.set(e,n),n>j0)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,n),this.metrics?.ihaveRcvIgnored.inc({reason:D2.MaxIhave}),[];const i=this.iasked.get(e)??0;if(i>=M0)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,i),this.metrics?.ihaveRcvIgnored.inc({reason:D2.MaxIasked}),[];const s=new Map;if(t.forEach((({topicID:e,messageIDs:t})=>{if(!e||!t||!this.mesh.has(e))return;let r=0;t.forEach((e=>{const t=this.msgIdToStrFn(e);this.seenCache.has(t)||(s.set(t,e),r++)})),this.metrics?.onIhaveRcv(e,t.length,r)})),!s.size)return[];let o=s.size;o+i>M0&&(o=M0-i),this.log("IHAVE: Asking for %d out of %d messages from %s",o,s.size,e);let a=Array.from(s.values());return J0(a),a=a.slice(0,o),this.iasked.set(e,i+o),this.gossipTracer.addPromise(e,a),[{messageIDs:a}]}handleIWant(e,t){if(!t.length)return[];const r=this.score.score(e);if(r<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,r),[];const n=new Map,i=new Map;let s=0;return t.forEach((({messageIDs:t})=>{t&&t.forEach((t=>{const r=this.msgIdToStrFn(t),o=this.mcache.getWithIWantCount(r,e);null!=o?(i.set(o.msg.topic,1+(i.get(o.msg.topic)??0)),o.count>C0?this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,t):n.set(r,o.msg)):s++}))})),this.metrics?.onIwantRcv(i,s),n.size?(this.log("IWANT: Sending %d messages to %s",n.size,e),Array.from(n.values())):(this.log("IWANT: Could not provide any wanted messages to %s",e),[])}async handleGraft(e,t){const r=[],n=this.score.score(e),i=Date.now();let s=this.opts.doPX;return t.forEach((({topicID:t})=>{if(!t)return;const o=this.mesh.get(t);if(!o)return void(s=!1);if(o.has(e))return;if(this.direct.has(e))return this.log("GRAFT: ignoring request from direct peer %s",e),r.push(t),void(s=!1);const a=this.backoff.get(t)?.get(e);if("number"===typeof a&&i<a){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1,x2.GraftBackoff),s=!1;const n=a+this.opts.graftFloodThreshold-this.opts.pruneBackoff;return i<n&&this.score.addPenalty(e,1,x2.GraftBackoff),this.addBackoff(e,t),void r.push(t)}return n<0?(this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,n,t),r.push(t),s=!1,void this.addBackoff(e,t)):o.size>=this.opts.Dhi&&!this.outbound.get(e)?(r.push(t),void this.addBackoff(e,t)):(this.log("GRAFT: Add mesh link from %s in %s",e,t),this.score.graft(e,t),o.add(e),void this.metrics?.onAddToMesh(t,R2.Subscribed,1))})),r.length?await Promise.all(r.map((t=>this.makePrune(e,t,s)))):[]}async handlePrune(e,t){const r=this.score.score(e);for(const{topicID:n,backoff:i,peers:s}of t){if(null==n)continue;const t=this.mesh.get(n);if(!t)return;if(this.log("PRUNE: Remove mesh link to %s in %s",e,n),this.score.prune(e,n),t.has(e)&&(t.delete(e),this.metrics?.onRemoveFromMesh(n,P2.Unsub,1)),"number"===typeof i&&i>0?this.doAddBackoff(e,n,1e3*i):this.addBackoff(e,n),s&&s.length){if(r<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,r,n);continue}await this.pxConnect(s)}}}addBackoff(e,t){this.doAddBackoff(e,t,this.opts.pruneBackoff)}doAddBackoff(e,t,r){let n=this.backoff.get(t);n||(n=new Map,this.backoff.set(t,n));const i=Date.now()+r,s=n.get(e)??0;s<i&&n.set(e,i)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach(((e,t)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",t,e),this.score.addPenalty(t,e,x2.BrokenPromise)}))}clearBackoff(){if(this.heartbeatTicks%D0!==0)return;const e=Date.now();this.backoff.forEach(((t,r)=>{t.forEach(((r,n)=>{r<e&&t.delete(n)})),0===t.size&&this.backoff.delete(r)}))}async directConnect(){const e=[];this.direct.forEach((t=>{this.streamsOutbound.has(t)||e.push(t)})),await Promise.all(e.map((async e=>await this.connect(e))))}async pxConnect(e){e.length>this.opts.prunePeers&&(J0(e),e=e.slice(0,this.opts.prunePeers));const t=[];await Promise.all(e.map((async e=>{if(!e.peerID)return;const r=o_(e.peerID).toString();if(!this.peers.has(r))if(e.signedPeerRecord)try{const n=await H1.openAndCertify(e.signedPeerRecord,"libp2p-peer-record"),i=n.peerId;if(!n.peerId.equals(r))return void this.log("bogus peer record obtained through px: peer ID %p doesn't match expected peer %p",i,r);if(!await this.components.getPeerStore().addressBook.consumePeerRecord(n))return void this.log("bogus peer record obtained through px: could not add peer record to address book");t.push(r)}catch(n){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}else t.push(r)}))),t.length&&await Promise.all(t.map((async e=>await this.connect(e))))}async connect(e){this.log("Initiating connection with %s",e);const t=s_(e),r=await this.components.getConnectionManager().openConnection(t);for(const n of this.multicodecs)for(const e of this.components.getRegistrar().getTopologies(n))e.onConnect(t,r)}subscribe(e){if(this.status.code!==l3.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);for(const t of this.peers.keys())this.sendSubscriptions(t,[e],!0)}this.join(e)}unsubscribe(e){if(this.status.code!==l3.started)throw new Error("Pubsub is not started");const t=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,t),t)for(const r of this.peers.keys())this.sendSubscriptions(r,[e],!1);this.leave(e).catch((e=>{this.log(e)}))}join(e){if(this.status.code!==l3.started)throw new Error("Gossipsub has not started");if(this.mesh.has(e))return;this.log("JOIN %s",e),this.metrics?.onJoin(e);const t=new Set,r=this.fanout.get(e);if(r&&(this.fanout.delete(e),this.fanoutLastpub.delete(e),r.forEach((e=>{!this.direct.has(e)&&this.score.score(e)>=0&&t.add(e)})),this.metrics?.onAddToMesh(e,R2.Fanout,t.size)),t.size<this.opts.D){const r=t.size,n=this.getRandomGossipPeers(e,this.opts.D,(e=>!t.has(e)&&!this.direct.has(e)&&this.score.score(e)>=0));n.forEach((e=>{t.add(e)})),this.metrics?.onAddToMesh(e,R2.Random,t.size-r)}this.mesh.set(e,t),t.forEach((t=>{this.log("JOIN: Add mesh link to %s in %s",t,e),this.sendGraft(t,e)}))}async leave(e){if(this.status.code!==l3.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e),this.metrics?.onLeave(e);const t=this.mesh.get(e);t&&(await Promise.all(Array.from(t).map((async t=>(this.log("LEAVE: Remove mesh link to %s in %s",t,e),await this.sendPrune(t,e))))),this.mesh.delete(e))}selectPeersToForward(e,t,r){const n=new Set,i=this.topics.get(e);i&&(this.direct.forEach((e=>{i.has(e)&&t!==e&&!r?.has(e)&&n.add(e)})),this.floodsubPeers.forEach((e=>{i.has(e)&&t!==e&&!r?.has(e)&&this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&n.add(e)})));const s=this.mesh.get(e);return s&&s.size>0&&s.forEach((e=>{t===e||r?.has(e)||n.add(e)})),n}selectPeersToPublish(e){const t=new Set,r={direct:0,floodsub:0,mesh:0,fanout:0},n=this.topics.get(e);if(n)if(this.opts.floodPublish)n.forEach((e=>{this.direct.has(e)?(t.add(e),r.direct++):this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&(t.add(e),r.floodsub++)}));else{this.direct.forEach((e=>{n.has(e)&&(t.add(e),r.direct++)})),this.floodsubPeers.forEach((e=>{n.has(e)&&this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&(t.add(e),r.floodsub++)}));const i=this.mesh.get(e);if(i&&i.size>0)i.forEach((e=>{t.add(e),r.mesh++}));else{const n=this.fanout.get(e);if(n&&n.size>0)n.forEach((e=>{t.add(e),r.fanout++}));else{const n=this.getRandomGossipPeers(e,this.opts.D,(e=>this.score.score(e)>=this.opts.scoreThresholds.publishThreshold));n.size>0&&(this.fanout.set(e,n),n.forEach((e=>{t.add(e),r.fanout++})))}this.fanoutLastpub.set(e,Date.now())}}return{tosend:t,tosendCount:r}}forwardMessage(e,t,r,n){r&&this.score.deliverMessage(r,e,t.topic);const i=this.selectPeersToForward(t.topic,r,n),s=Y0([t]);i.forEach((e=>{this.sendRpc(e,s)})),this.metrics?.onForwardMsg(t.topic,i.size)}async publish(e,t){const r=this.dataTransform?this.dataTransform.outboundTransform(e,t):t;if(null==this.publishConfig)throw Error("PublishError.Uninitialized");const{raw:n,msg:i}=await j2(this.publishConfig,e,t,r),s=await this.msgIdFn(i),o=this.msgIdToStrFn(s);if(this.seenCache.has(o))throw Error("PublishError.Duplicate");const{tosend:a,tosendCount:c}=this.selectPeersToPublish(e),l=!0===this.opts.emitSelf&&this.subscriptions.has(e);if(0===a.size&&!this.opts.allowPublishToZeroPeers&&!l)throw Error("PublishError.InsufficientPeers");this.seenCache.put(o),this.mcache.put({msgId:s,msgIdStr:o},n,!0),this.publishedMessageIds.put(o);const u=Y0([n]);for(const h of a){const e=this.sendRpc(h,u);e||a.delete(h)}return this.metrics?.onPublishMsg(e,c,a.size,null!=n.data?n.data.length:0),l&&(a.add(this.components.getPeerId().toString()),super.dispatchEvent(new c0("gossipsub:message",{detail:{propagationSource:this.components.getPeerId(),msgId:o,msg:i}})),super.dispatchEvent(new c0("message",{detail:i}))),{recipients:Array.from(a.values()).map((e=>s_(e)))}}reportMessageValidationResult(e,t,r){if(r===r2.Accept){const n=this.mcache.validate(e);if(this.metrics?.onReportValidationMcacheHit(null!==n),null!=n){const{message:i,originatingPeers:s}=n;this.score.deliverMessage(t.toString(),e,i.topic),this.forwardMessage(e,n.message,t.toString(),s),this.metrics?.onReportValidation(i.topic,r)}}else{const n=this.mcache.remove(e);if(this.metrics?.onReportValidationMcacheHit(null!==n),n){const i=o2(r),{message:s,originatingPeers:o}=n;this.score.rejectMessage(t.toString(),e,s.topic,i);for(const t of o)this.score.rejectMessage(t,e,s.topic,i);this.metrics?.onReportValidation(s.topic,r)}}}sendGraft(e,t){const r=[{topicID:t}],n=Y0([],{graft:r});this.sendRpc(e,n)}async sendPrune(e,t){const r=[await this.makePrune(e,t,this.opts.doPX)],n=Y0([],{prune:r});this.sendRpc(e,n)}sendRpc(e,t){const r=this.streamsOutbound.get(e);if(!r)return this.log(`Cannot send RPC to ${e} as there is no open stream to it available`),!1;const n=this.control.get(e);n&&(this.piggybackControl(e,t,n),this.control.delete(e));const i=this.gossip.get(e);i&&(this.piggybackGossip(e,t,i),this.gossip.delete(e));const s=h0.encode(t).finish();try{r.push(s)}catch(o){return this.log.error(`Cannot send rpc to ${e}`,o),n&&this.control.set(e,n),i&&this.gossip.set(e,i),!1}return this.metrics?.onRpcSent(t,s.length),!0}piggybackControl(e,t,r){const n=(r.graft||[]).filter((({topicID:t})=>(t&&this.mesh.get(t)||new Set).has(e))),i=(r.prune||[]).filter((({topicID:t})=>!(t&&this.mesh.get(t)||new Set).has(e)));(n.length||i.length)&&(t.control?(t.control.graft=t.control.graft&&t.control.graft.concat(n),t.control.prune=t.control.prune&&t.control.prune.concat(i)):t.control={graft:n,prune:i,ihave:[],iwant:[]})}piggybackGossip(e,t,r){t.control||(t.control={ihave:[],iwant:[],graft:[],prune:[]}),t.control.ihave=r}async sendGraftPrune(e,t,r){const n=this.opts.doPX;for(const[i,s]of e){const e=s.map((e=>({topicID:e})));let o=[];const a=t.get(i);a&&(o=await Promise.all(a.map((async e=>await this.makePrune(i,e,n&&!r.get(i))))),t.delete(i));const c=Y0([],{graft:e,prune:o});this.sendRpc(i,c)}for(const[i,s]of t){const e=await Promise.all(s.map((async e=>await this.makePrune(i,e,n&&!r.get(i))))),t=Y0([],{prune:e});this.sendRpc(i,t)}}emitGossip(e){const t=this.mcache.getGossipIDs(new Set(e.keys()));for(const[r,n]of e)this.doEmitGossip(r,n,t.get(r)??[])}doEmitGossip(e,t,r){if(!r.length)return;if(J0(r),r.length>M0&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",r.length),!t.size)return;let n=this.opts.Dlazy;const i=I0*t.size;let s=t;i>n&&(n=i),n>s.size?n=s.size:s=J0(Array.from(s)).slice(0,n),s.forEach((t=>{let n=r;r.length>M0&&(n=J0(n.slice()).slice(0,M0)),this.pushGossip(t,{topicID:e,messageIDs:n})}))}flush(){for(const[e,t]of this.gossip.entries())this.gossip.delete(e),this.sendRpc(e,Y0([],{ihave:t}));for(const[e,t]of this.control.entries())this.control.delete(e),this.sendRpc(e,Y0([],{graft:t.graft,prune:t.prune}))}pushGossip(e,t){this.log("Add gossip to %s",e);const r=this.gossip.get(e)||[];this.gossip.set(e,r.concat(t))}async makePrune(e,t,r){if(this.score.prune(e,t),this.streamsOutbound.get(e).protocol===y0)return{topicID:t,peers:[]};const n=this.opts.pruneBackoff/1e3;if(!r)return{topicID:t,peers:[],backoff:n};const i=this.getRandomGossipPeers(t,this.opts.prunePeers,(t=>t!==e&&this.score.score(t)>=0)),s=await Promise.all(Array.from(i).map((async e=>{const t=s_(e);return{peerID:t.toBytes(),signedPeerRecord:await this.components.getPeerStore().addressBook.getRawEnvelope(t)}})));return{topicID:t,peers:s,backoff:n}}async heartbeat(){const{D:e,Dlo:t,Dhi:r,Dscore:n,Dout:i,fanoutTTL:s}=this.opts;this.heartbeatTicks++;const o=new Map,a=e=>{let t=o.get(e);return void 0===t&&(t=this.score.score(e),o.set(e,t)),t},c=new Map,l=new Map,u=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks===0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();const h=new Map;this.mesh.forEach(((s,o)=>{const d=this.topics.get(o),f=new Set,p=new Set;if(h.set(o,p),d){const e=J0(Array.from(d)),t=this.backoff.get(o);for(const r of e){const e=this.streamsOutbound.get(r);if(e&&this.multicodecs.includes(e.protocol)&&!s.has(r)&&!this.direct.has(r)){const e=a(r);t&&t.has(r)||!(e>=0)||f.add(r),e>=this.opts.scoreThresholds.gossipThreshold&&p.add(r)}}}const y=(e,t)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",e,o),this.addBackoff(e,o),s.delete(e),a(e)>=this.opts.scoreThresholds.gossipThreshold&&p.add(e),this.metrics?.onRemoveFromMesh(o,t,1);const r=l.get(e);r?r.push(o):l.set(e,[o])},g=(e,t)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",e,o),this.score.graft(e,o),s.add(e),p.delete(e),this.metrics?.onAddToMesh(o,t,1);const r=c.get(e);r?r.push(o):c.set(e,[o])};if(s.forEach((e=>{const t=a(e);t<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",e,t,o),y(e,P2.BadScore),u.set(e,!0))})),s.size<t){const t=e-s.size,r=G2(f,t);r.forEach((e=>{g(e,R2.NotEnough)}))}if(s.size>r){let t=Array.from(s);t.sort(((e,t)=>a(t)-a(e))),t=t.slice(0,n).concat(J0(t.slice(n)));let r=0;if(t.slice(0,e).forEach((e=>{this.outbound.get(e)&&r++})),r<i){const n=e=>{const r=t[e];for(let n=e;n>0;n--)t[n]=t[n-1];t[0]=r};if(r>0){let i=r;for(let r=1;r<e&&i>0;r++)this.outbound.get(t[r])&&(n(r),i--)}let i=e-r;for(let r=e;r<t.length&&i>0;r++)this.outbound.get(t[r])&&(n(r),i--)}t.slice(e).forEach((e=>{y(e,P2.Excess)}))}if(s.size>=t){let e=0;if(s.forEach((t=>{this.outbound.get(t)&&e++})),e<i){const t=i-e,r=H2(f,t,(e=>!0===this.outbound.get(e)));r.forEach((e=>{g(e,R2.Outbound)}))}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks===0&&s.size>1){const e=Array.from(s).sort(((e,t)=>a(e)-a(t))),t=Math.floor(s.size/2),r=a(e[t]);if(r<this.opts.scoreThresholds.opportunisticGraftThreshold){const e=this.opts.opportunisticGraftPeers,t=H2(f,e,(e=>a(e)>r));for(const r of t)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",r,o),g(r,R2.Opportunistic)}}}));const d=Date.now();this.fanoutLastpub.forEach(((e,t)=>{e+s<d&&(this.fanout.delete(t),this.fanoutLastpub.delete(t))})),this.fanout.forEach(((t,r)=>{const n=this.topics.get(r);t.forEach((e=>{(!n.has(e)||a(e)<this.opts.scoreThresholds.publishThreshold)&&t.delete(e)}));const i=this.topics.get(r),s=[],o=new Set;if(h.set(r,o),i){const e=J0(Array.from(i));for(const r of e){const e=this.streamsOutbound.get(r);if(e&&this.multicodecs.includes(e.protocol)&&!t.has(r)&&!this.direct.has(r)){const e=a(r);e>=this.opts.scoreThresholds.publishThreshold&&s.push(r),e>=this.opts.scoreThresholds.gossipThreshold&&o.add(r)}}}if(t.size<e){const r=e-t.size;s.slice(0,r).forEach((e=>{t.add(e),o?.delete(e)}))}})),this.emitGossip(h),await this.sendGraftPrune(c,l,u),this.flush(),this.mcache.shift(),this.dispatchEvent(new c0("gossipsub:heartbeat"))}getRandomGossipPeers(e,t,r=(()=>!0)){const n=this.topics.get(e);if(!n)return new Set;let i=[];return n.forEach((e=>{const t=this.streamsOutbound.get(e);t&&this.multicodecs.includes(t.protocol)&&r(e)&&i.push(e)})),i=J0(i),t>0&&i.length>t&&(i=i.slice(0,t)),new Set(i)}onScrapeMetrics(e){e.mcacheSize.set(this.mcache.size),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),e.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);let t=0;for(const s of this.backoff.values())t+=s.size;e.cacheSize.set({cache:"backoff"},t);for(const[s,o]of this.topics)e.topicPeersCount.set({topicStr:s},o.size);for(const[s,o]of this.mesh)e.meshPeerCounts.set({topicStr:s},o.size);const r=[],n=new Map;e.behaviourPenalty.reset();for(const s of this.peers.keys()){const t=this.score.score(s);r.push(t),n.set(s,t),e.behaviourPenalty.observe(this.score.peerStats.get(s)?.behaviourPenalty??0)}e.registerScores(r,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,n);const i=q2(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(i)}}u3.multicodec=g0;const h3=()=>({gossipsub:new u3({allowPublishToZeroPeers:!0,fallbackToFloodsub:!0,emitSelf:!0,maxInboundStreams:64,maxOutboundStreams:128})});function d3(){const e={};return e.promise=new Promise(((t,r)=>{e.resolve=t,e.reject=r})),e}const f3=gn("libp2p-delegated-peer-routing"),p3=3e4,y3=4;class g3{constructor(e){if(null==e)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new Lb({concurrency:y3});const{protocol:t,host:r,port:n}=e.getEndpointConfig();f3(`enabled DelegatedPeerRouting via ${t}://${r}:${n}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async findPeer(e,t={}){f3("findPeer starts: %p",e),t.timeout=t.timeout??p3,t.signal=Iw([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const r=d3(),n=d3();this.httpQueue.add((async()=>(r.resolve(),await n.promise)));try{await r.promise;for await(const r of this.client.dht.findPeer(e,t))if("FINAL_PEER"===r.name){const e={id:r.peer.id,multiaddrs:r.peer.multiaddrs,protocols:[]};return e}}catch(WV){throw f3.error("findPeer errored: %o",WV),WV}finally{n.resolve(),f3("findPeer finished: %p",e)}throw mn(new Error("Not found"),"ERR_NOT_FOUND")}async*getClosestPeers(e,t={}){let r;const n=ji.asCID(e);r=null!=n?n:o_(e),f3("getClosestPeers starts: %s",r),t.timeout=t.timeout??p3,t.signal=Iw([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const i=d3(),s=d3();this.httpQueue.add((async()=>(i.resolve(),await s.promise)));try{await i.promise;for await(const e of this.client.dht.query(r,t))"PEER_RESPONSE"===e.name&&(yield*e.closer.map((e=>({id:e.id,multiaddrs:e.multiaddrs,protocols:[]}))))}catch(WV){throw f3.error("getClosestPeers errored:",WV),WV}finally{s.resolve(),f3("getClosestPeers finished: %b",e)}}}const m3=gn("libp2p:delegated-content-routing"),w3=3e4,b3=4,v3=2;class E3{constructor(e){if(null==e)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new Lb({concurrency:b3}),this.httpQueueRefs=new Lb({concurrency:v3});const{protocol:t,host:r,port:n}=e.getEndpointConfig();m3(`enabled DelegatedContentRouting via ${t}://${r}:${n}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.httpQueueRefs.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async*findProviders(e,t={}){m3("findProviders starts: %c",e),t.timeout=t.timeout??w3,t.signal=Iw([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const r=d3(),n=d3();this.httpQueue.add((async()=>(r.resolve(),await n.promise)));try{await r.promise;for await(const r of this.client.dht.findProvs(e,t))"PROVIDER"===r.name&&(yield*r.providers.map((e=>{const t={id:e.id,protocols:[],multiaddrs:e.multiaddrs};return t})))}catch(WV){throw m3.error("findProviders errored:",WV),WV}finally{n.resolve(),m3("findProviders finished: %c",e)}}async provide(e,t={}){m3("provide starts: %c",e),t.timeout=t.timeout??w3,t.signal=Iw([this.abortController.signal].concat(null!=t.signal?[t.signal]:[])),await this.httpQueueRefs.add((async()=>{await this.client.block.stat(e,t),await RR(this.client.dht.provide(e,t))})),m3("provide finished: %c",e)}async put(e,t,r={}){m3("put value start: %b",e),r.timeout=r.timeout??w3,r.signal=Iw([this.abortController.signal].concat(null!=r.signal?[r.signal]:[])),await this.httpQueue.add((async()=>{await RR(this.client.dht.put(e,t,r))})),m3("put value finished: %b",e)}async get(e,t={}){return m3("get value start: %b",e),t.timeout=t.timeout??w3,t.signal=Iw([this.abortController.signal].concat(null!=t.signal?[t.signal]:[])),await this.httpQueue.add((async()=>{for await(const r of this.client.dht.get(e,t))if("VALUE"===r.name)return m3("get value finished: %b",e),r.value;throw mn(new Error("Not found"),"ERR_NOT_FOUND")}))}}const _3=e=>Promise.reject(new Error(`No base found for "${e}"`));class S3{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||_3;for(const t of e.bases)this.addBase(t)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];const t=await this._loadBase(e);return null==this._basesByName[t.name]&&null==this._basesByPrefix[t.prefix]&&this.addBase(t),t}listBases(){return Object.values(this._basesByName)}}const A3=e=>Promise.reject(new Error(`No codec found for "${e}"`));class I3{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||A3;for(const t of e.codecs)this.addCodec(t)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){const t="string"===typeof e?this._codecsByName:this._codecsByCode;if(t[e])return t[e];const r=await this._loadCodec(e);return null==t[e]&&this.addCodec(r),r}listCodecs(){return Object.values(this._codecsByName)}}const C3=e=>Promise.reject(new Error(`No hasher found for "${e}"`));class k3{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||C3;for(const t of e.hashers)this.addHasher(t)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){const t="string"===typeof e?this._hashersByName:this._hashersByCode;if(t[e])return t[e];const r=await this._loadHasher(e);return null==t[e]&&this.addHasher(r),r}listHashers(){return Object.values(this._hashersByName)}}function T3(e){try{e=nH(Pp(e))}catch(WV){}return e=e.toString(),e}var R3=()=>{};const P3=gn("ipfs-http-client:lib:error-handler"),x3=Wr.bind({ignoreUndefined:!0}),D3=Yr.isBrowser||Yr.isWebWorker?location.protocol:"http",O3=Yr.isBrowser||Yr.isWebWorker?location.hostname:"localhost",N3=Yr.isBrowser||Yr.isWebWorker?location.port:"5001",L3=(e={})=>{let t,r,n={};if("string"===typeof e||Tp(e))t=new URL(T3(e));else if(e instanceof URL)t=e;else if("string"===typeof e.url||Tp(e.url))t=new URL(T3(e.url)),n=e;else if(e.url instanceof URL)t=e.url,n=e;else{n=e||{};const r=(n.protocol||D3).replace(":",""),i=(n.host||O3).split(":")[0],s=n.port||N3;t=new URL(`${r}://${i}:${s}`)}if(n.apiPath?t.pathname=n.apiPath:"/"!==t.pathname&&void 0!==t.pathname||(t.pathname="api/v0"),Yr.isNode){const e=R3(t);r=n.agent||new e({keepAlive:!0,maxSockets:6})}return{...n,host:t.host,protocol:t.protocol.replace(":",""),port:Number(t.port),apiPath:t.pathname,url:t,agent:r}},B3=async e=>{let t;try{if((e.headers.get("Content-Type")||"").startsWith("application/json")){const r=await e.json();P3(r),t=r.Message||r.message}else t=await e.text()}catch(WV){P3("Failed to parse error response",WV),t=WV.message}let r=new Bb.HTTPError(e);throw t&&(t.includes("deadline has elapsed")&&(r=new Bb.TimeoutError),t&&t.includes("context deadline exceeded")&&(r=new Bb.TimeoutError)),t&&t.includes("request timed out")&&(r=new Bb.TimeoutError),t&&(r.message=t),r},U3=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,M3=e=>e.replace(U3,(function(e){return"-"+e.toLowerCase()})),j3=e=>"string"===typeof e?Rw(e):e;class V3 extends Bb{constructor(e={}){const t=L3(e);super({timeout:j3(t.timeout||0)||void 0,headers:t.headers,base:`${t.url}`,handleError:B3,transformSearchParams:e=>{const t=new URLSearchParams;for(const[r,n]of e)"undefined"!==n&&"null"!==n&&"signal"!==r&&t.append(M3(r),n),"timeout"!==r||isNaN(n)||t.append(M3(r),n);return t},agent:t.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;const r=this.fetch;this.fetch=(e,n={})=>("string"!==typeof e||e.startsWith("/")||(e=`${t.url}/${e}`),r.call(this,e,x3(n,{method:"POST"})))}}Bb.HTTPError;const z3=e=>t=>e(new V3(t),t);function F3(e){if(null!=e)return"string"===typeof e?e:e.toString(8).padStart(4,"0")}function $3(e){if(null==e)return;let t;if(null!=e.secs&&(t={secs:e.secs,nsecs:e.nsecs}),null!=e.Seconds&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const r=e.getTime(),n=Math.floor(r/1e3);t={secs:n,nsecs:1e3*(r-1e3*n)}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(null!=t&&null!=t.nsecs&&(t.nsecs<0||t.nsecs>999999999))throw mn(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}function K3({arg:e,searchParams:t,hashAlg:r,mtime:n,mode:i,...s}={}){t&&(s={...s,...t}),r&&(s.hash=r),null!=n&&(n=$3(n),s.mtime=n.secs,s.mtimeNsecs=n.nsecs),null!=i&&(s.mode=F3(i)),s.timeout&&!isNaN(s.timeout)&&(s.timeout=`${s.timeout}ms`),void 0===e||null===e?e=[]:Array.isArray(e)||(e=[e]);const o=new URLSearchParams(s);return e.forEach((e=>o.append("arg",e))),o}const q3=z3((e=>{async function t(t={}){const r=await(await e.post("bitswap/wantlist",{signal:t.signal,searchParams:K3(t),headers:t.headers})).json();return(r.Keys||[]).map((e=>ji.parse(e["/"])))}return t})),H3=z3((e=>{async function t(t,r={}){const n=await(await e.post("bitswap/wantlist",{signal:r.signal,searchParams:K3({...r,peer:t.toString()}),headers:r.headers})).json();return(n.Keys||[]).map((e=>ji.parse(e["/"])))}return t})),G3=z3((e=>{async function t(t={}){const r=await e.post("bitswap/stat",{searchParams:K3(t),signal:t.signal,headers:t.headers});return W3(await r.json())}return t}));function W3(e){return{provideBufLen:e.ProvideBufLen,wantlist:(e.Wantlist||[]).map((e=>ji.parse(e["/"]))),peers:(e.Peers||[]).map((e=>s_(e))),blocksReceived:BigInt(e.BlocksReceived),dataReceived:BigInt(e.DataReceived),blocksSent:BigInt(e.BlocksSent),dataSent:BigInt(e.DataSent),dupBlksReceived:BigInt(e.DupBlksReceived),dupDataReceived:BigInt(e.DupDataReceived)}}const Y3=z3((e=>{async function t(t,r={}){const n=await e.post("bitswap/unwant",{signal:r.signal,searchParams:K3({arg:t.toString(),...r}),headers:r.headers});return n.json()}return t}));function J3(e){return{wantlist:q3(e),wantlistForPeer:H3(e),unwant:Y3(e),stat:G3(e)}}const Q3=z3((e=>{async function t(t,r={}){const n=await e.post("block/get",{signal:r.signal,searchParams:K3({arg:t.toString(),...r}),headers:r.headers});return new Uint8Array(await n.arrayBuffer())}return t}));async function X3(e){if(_x(e))return new Blob([e]);if("string"===typeof e||e instanceof String)return new Blob([e.toString()]);if(Sx(e))return e;if(Ix(e)&&(e=bx(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=Ex(e),{value:r,done:n}=await t.peek();if(n)return Z3(t);if(t.push(r),Number.isInteger(r))return new Blob([Uint8Array.from(await kR(t))]);if(_x(r)||"string"===typeof r||r instanceof String)return Z3(t)}throw mn(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}async function Z3(e){const t=[];for await(const r of e)t.push(r);return new Blob(t)}function e5(e){return WN(e,X3,!0)}function t5(e){if(null!=e)return"string"===typeof e?e:e.toString(8).padStart(4,"0")}async function r5(e,t,r={}){const n=[],i=new FormData;let s=0,o=0;for await(const{content:a,path:c,mode:l,mtime:u}of e5(e)){let e="";const t=a?"file":"dir";s>0&&(e=`-${s}`);let r=t+e;const h=[];if(null!==l&&void 0!==l&&h.push(`mode=${t5(l)}`),null!=u){const{secs:e,nsecs:t}=u;h.push(`mtime=${e}`),null!=t&&h.push(`mtime-nsecs=${t}`)}if(h.length&&(r=`${r}?${h.join("&")}`),a){i.set(r,a,null!=c?encodeURIComponent(c):void 0);const e=o+a.size;n.push({name:c,start:o,end:e}),o=e}else{if(null==c)throw new Error("path or content or both must be set");i.set(r,new File([""],encodeURIComponent(c),{type:"application/x-directory"}))}s++}return{total:o,parts:n,headers:r,body:i}}function n5(e){return e.filter(Boolean)}function i5(...e){return(0,Iw.anySignal)(n5(e))}const s5=z3((e=>{async function t(r,n={}){const i=new AbortController,s=i5(i.signal,n.signal);let o;try{const t=await e.post("block/put",{signal:s,searchParams:K3(n),...await r5([r],i,n.headers)});o=await t.json()}catch(WV){if("dag-pb"===n.format)return t(r,{...n,format:"protobuf"});if("dag-cbor"===n.format)return t(r,{...n,format:"cbor"});throw WV}return ji.parse(o.Key)}return t})),o5=z3((e=>{async function*t(t,r={}){Array.isArray(t)||(t=[t]);const n=await e.post("block/rm",{signal:r.signal,searchParams:K3({arg:t.map((e=>e.toString())),"stream-channels":!0,...r}),headers:r.headers});for await(const e of n.ndjson())yield a5(e)}return t}));function a5(e){const t={cid:ji.parse(e.Hash)};return e.Error&&(t.error=new Error(e.Error)),t}const c5=z3((e=>{async function t(t,r={}){const n=await e.post("block/stat",{signal:r.signal,searchParams:K3({arg:t.toString(),...r}),headers:r.headers}),i=await n.json();return{cid:ji.parse(i.Key),size:i.Size}}return t}));function l5(e){return{get:Q3(e),put:s5(e),rm:o5(e),stat:c5(e)}}const u5=z3((e=>{async function t(t,r={}){const n=await e.post("bootstrap/add",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers}),{Peers:i}=await n.json();return{Peers:i.map((e=>Pp(e)))}}return t})),h5=z3((e=>{async function t(t={}){const r=await e.post("bootstrap/rm",{signal:t.signal,searchParams:K3({...t,all:!0}),headers:t.headers}),{Peers:n}=await r.json();return{Peers:n.map((e=>Pp(e)))}}return t})),d5=z3((e=>{async function t(t={}){const r=await e.post("bootstrap/list",{signal:t.signal,searchParams:K3(t),headers:t.headers}),{Peers:n}=await r.json();return{Peers:n.map((e=>Pp(e)))}}return t})),f5=z3((e=>{async function t(t={}){const r=await e.post("bootstrap/add",{signal:t.signal,searchParams:K3({...t,default:!0}),headers:t.headers}),{Peers:n}=await r.json();return{Peers:n.map((e=>Pp(e)))}}return t})),p5=z3((e=>{async function t(t,r={}){const n=await e.post("bootstrap/rm",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers}),{Peers:i}=await n.json();return{Peers:i.map((e=>Pp(e)))}}return t}));function y5(e){return{add:u5(e),clear:h5(e),list:d5(e),reset:f5(e),rm:p5(e)}}const g5=z3((e=>{async function t(t,r={}){const n=await e.post("config/profile/apply",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers}),i=await n.json();return{original:i.OldCfg,updated:i.NewCfg}}return t}));function m5(e){if(null==e)return e;const t=/^[A-Z]+$/,r={};return Object.keys(e).reduce(((r,n)=>(t.test(n)?r[n.toLowerCase()]=e[n]:t.test(n[0])?r[n[0].toLowerCase()+n.slice(1)]=e[n]:r[n]=e[n],r)),r)}const w5=z3((e=>{async function t(t={}){const r=await e.post("config/profile/list",{signal:t.signal,searchParams:K3(t),headers:t.headers}),n=await r.json();return n.map((e=>m5(e)))}return t}));function b5(e){return{apply:g5(e),list:w5(e)}}const v5=z3((e=>{const t=async(t,r={})=>{if(!t)throw new Error("key argument is required");const n=await e.post("config",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers}),i=await n.json();return i.Value};return t})),E5=z3((e=>{const t=async(t={})=>{const r=await e.post("config/show",{signal:t.signal,searchParams:K3({...t}),headers:t.headers}),n=await r.json();return n};return t})),_5=z3((e=>{const t=async(t,r={})=>{const n=new AbortController,i=i5(n.signal,r.signal),s=await e.post("config/replace",{signal:i,searchParams:K3(r),...await r5([Jl(JSON.stringify(t))],n,r.headers)});await s.text()};return t})),S5=z3((e=>{const t=async(t,r,n={})=>{if("string"!==typeof t)throw new Error("Invalid key type");const i={...n,...A5(t,r)},s=await e.post("config",{signal:n.signal,searchParams:K3(i),headers:n.headers});await s.text()};return t})),A5=(e,t)=>{switch(typeof t){case"boolean":return{arg:[e,t.toString()],bool:!0};case"string":return{arg:[e,t]};default:return{arg:[e,JSON.stringify(t)],json:!0}}};function I5(e){return{getAll:E5(e),get:v5(e),set:S5(e),replace:_5(e),profiles:b5(e)}}const C5=z3((e=>{async function*t(t,r={}){const n=await e.post("dag/export",{signal:r.signal,searchParams:K3({arg:t.toString()}),headers:r.headers});yield*n.iterator()}return t}));async function*k5(e,t,r,n,i){const s=async e=>{const t=await r.getCodec(e.code),s=await n(e,i);return t.decode(s)},o=t.split("/").filter(Boolean);let a=await s(e),c=e;while(o.length){const e=o.shift();if(!e)throw mn(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(!Object.prototype.hasOwnProperty.call(a,e))throw mn(new Error(`no link named "${e}" under ${c}`),"ERR_NO_LINK");a=a[e],yield{value:a,remainderPath:o.join("/")};const r=ji.asCID(a);r&&(c=r,a=await s(a))}yield{value:a,remainderPath:""}}const T5=(e,t)=>{const r=z3(((t,r)=>{const n=Q3(r),i=async(t,r={})=>{if(r.path){const i=r.localResolve?await Vq(k5(t,r.path,e,n,r)):await h_(k5(t,r.path,e,n,r)),s=i;if(!s)throw mn(new Error("Not found"),"ERR_NOT_FOUND");return s}const i=await e.getCodec(t.code),s=await n(t,r),o=i.decode(s);return{value:o,remainderPath:""}};return i}));return r(t)},R5=z3((e=>{async function*t(t,r={}){const n=new AbortController,i=i5(n.signal,r.signal),{headers:s,body:o}=await r5(t,n,r.headers),a=await e.post("dag/import",{signal:i,headers:s,body:o,searchParams:K3({"pin-roots":r.pinRoots})});for await(const{Root:e}of a.ndjson())if(void 0!==e){const{Cid:{"/":t},PinErrorMsg:r}=e;yield{root:{cid:ji.parse(t),pinErrorMsg:r}}}}return t})),P5=(e,t)=>{const r=z3((t=>{const r=async(r,n={})=>{const i={storeCodec:"dag-cbor",hashAlg:"sha2-256",...n};let s;if(i.inputCodec){if(!(r instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");s=r}else{const t=await e.getCodec(i.storeCodec);s=t.encode(r),i.inputCodec=i.storeCodec}const o=new AbortController,a=i5(o.signal,i.signal),c=await t.post("dag/put",{timeout:i.timeout,signal:a,searchParams:K3(i),...await r5([s],o,i.headers)}),l=await c.json();return ji.parse(l.Cid["/"])};return r}));return r(t)},x5=z3((e=>{const t=async(t,r={})=>{const n=await e.post("dag/resolve",{signal:r.signal,searchParams:K3({arg:`${t}${r.path?`/${r.path}`.replace(/\/[/]+/g,"/"):""}`,...r}),headers:r.headers}),i=await n.json();return{cid:ji.parse(i.Cid["/"]),remainderPath:i.RemPath}};return t}));function D5(e,t){return{export:C5(t),get:T5(e,t),import:R5(t),put:P5(e,t),resolve:x5(t)}}const O5=0,N5=1,L5=2,B5=3,U5=4,M5=5,j5=6,V5=7,z5=e=>{if(e.Type===O5)return{name:"SENDING_QUERY",type:e.Type};if(e.Type===N5)return{from:s_(e.ID),name:"PEER_RESPONSE",type:e.Type,messageType:0,messageName:"PUT_VALUE",closer:(e.Responses||[]).map((({ID:e,Addrs:t})=>({id:s_(e),multiaddrs:t.map((e=>Pp(e))),protocols:[]}))),providers:(e.Responses||[]).map((({ID:e,Addrs:t})=>({id:s_(e),multiaddrs:t.map((e=>Pp(e))),protocols:[]})))};if(e.Type===L5){let t={id:e.ID??s_(e.ID),multiaddrs:[],protocols:[]};return e.Responses&&e.Responses.length&&(t={id:s_(e.Responses[0].ID),multiaddrs:e.Responses[0].Addrs.map((e=>Pp(e))),protocols:[]}),{name:"FINAL_PEER",type:e.Type,peer:t}}if(e.Type===B5)return{name:"QUERY_ERROR",type:e.Type,error:new Error(e.Extra)};if(e.Type===U5)return{name:"PROVIDER",type:e.Type,providers:e.Responses.map((({ID:e,Addrs:t})=>({id:s_(e),multiaddrs:t.map((e=>Pp(e))),protocols:[]})))};if(e.Type===M5)return{name:"VALUE",type:e.Type,value:Jl(e.Extra,"base64pad")};if(e.Type===j5){const t=e.Responses.map((({ID:e})=>s_(e)));if(!t.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:e.Type,peer:t[0]}}if(e.Type===V5)return{name:"DIALING_PEER",type:e.Type,peer:s_(e.ID)};throw new Error("Unknown DHT event type")},F5=z3((e=>{async function*t(t,r={}){const n=await e.post("dht/findpeer",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers});for await(const e of n.ndjson())yield z5(e)}return t})),$5=z3((e=>{async function*t(t,r={}){const n=await e.post("dht/findprovs",{signal:r.signal,searchParams:K3({arg:t.toString(),...r}),headers:r.headers});for await(const e of n.ndjson())yield z5(e)}return t})),K5=z3((e=>{async function*t(t,r={}){const n=await e.post("dht/get",{signal:r.signal,searchParams:K3({arg:t instanceof Uint8Array?C_(t):t.toString(),...r}),headers:r.headers});for await(const e of n.ndjson())yield z5(e)}return t})),q5=z3((e=>{async function*t(t,r={recursive:!1}){const n=Array.isArray(t)?t:[t],i=await e.post("dht/provide",{signal:r.signal,searchParams:K3({arg:n.map((e=>e.toString())),...r}),headers:r.headers});for await(const e of i.ndjson())yield z5(e)}return t})),H5=z3((e=>{async function*t(t,r,n={}){const i=new AbortController,s=i5(i.signal,n.signal),o=await e.post("dht/put",{signal:s,searchParams:K3({arg:t instanceof Uint8Array?C_(t):t.toString(),...n}),...await r5([r],i,n.headers)});for await(const e of o.ndjson())yield z5(e)}return t})),G5=z3((e=>{async function*t(t,r={}){const n=await e.post("dht/query",{signal:r.signal,searchParams:K3({arg:t.toString(),...r}),headers:r.headers});for await(const e of n.ndjson())yield z5(e)}return t}));function W5(e){return{findPeer:F5(e),findProvs:$5(e),get:K5(e),provide:q5(e),put:H5(e),query:G5(e)}}const Y5=z3((e=>{async function t(t={}){const r=await e.post("diag/cmds",{signal:t.signal,searchParams:K3(t),headers:t.headers});return r.json()}return t})),J5=z3((e=>{async function t(t={}){const r=await e.post("diag/net",{signal:t.signal,searchParams:K3(t),headers:t.headers});return r.json()}return t})),Q5=z3((e=>{async function t(t={}){const r=await e.post("diag/sys",{signal:t.signal,searchParams:K3(t),headers:t.headers});return r.json()}return t}));function X5(e){return{cmds:Y5(e),net:J5(e),sys:Q5(e)}}const Z5=z3((e=>{async function t(t,r,n={}){const i=await e.post("files/chmod",{signal:n.signal,searchParams:K3({arg:t,mode:r,...n}),headers:n.headers});await i.text()}return t})),e6=z3((e=>{async function t(t,r,n={}){const i=Array.isArray(t)?t:[t],s=await e.post("files/cp",{signal:n.signal,searchParams:K3({arg:i.concat(r).map((e=>ji.asCID(e)?`/ipfs/${e}`:e)),...n}),headers:n.headers});await s.text()}return t})),t6=z3((e=>{async function t(t,r={}){if(!t||"string"!==typeof t)throw new Error("ipfs.files.flush requires a path");const n=await e.post("files/flush",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers}),i=await n.json();return ji.parse(i.Cid)}return t}));function r6(e){const t=m5(e);return Object.prototype.hasOwnProperty.call(t,"mode")&&(t.mode=parseInt(t.mode,8)),Object.prototype.hasOwnProperty.call(t,"mtime")&&(t.mtime={secs:t.mtime,nsecs:t.mtimeNsecs||0},delete t.mtimeNsecs),t}const n6=z3((e=>{async function*t(t,r={}){if(!t)throw new Error("ipfs.files.ls requires a path");const n=await e.post("files/ls",{signal:r.signal,searchParams:K3({arg:ji.asCID(t)?`/ipfs/${t}`:t,long:!0,...r,stream:!0}),headers:r.headers});for await(const e of n.ndjson())if("Entries"in e)for(const t of e.Entries||[])yield i6(r6(t));else yield i6(r6(e))}return t}));function i6(e){return e.hash&&(e.cid=ji.parse(e.hash)),delete e.hash,e.type=1===e.type?"directory":"file",e}const s6=z3((e=>{async function t(t,r={}){const n=await e.post("files/mkdir",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers});await n.text()}return t})),o6=z3((e=>{async function t(t,r,n={}){Array.isArray(t)||(t=[t]);const i=await e.post("files/mv",{signal:n.signal,searchParams:K3({arg:t.concat(r),...n}),headers:n.headers});await i.text()}return t}));var a6=r(590);const c6=z3((e=>{async function*t(t,r={}){const n=await e.post("files/read",{signal:r.signal,searchParams:K3({arg:t,count:r.length,...r}),headers:r.headers});yield*a6(n.body)}return t})),l6=z3((e=>{async function t(t,r={}){const n=await e.post("files/rm",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers}),i=await n.text();if(""!==i){const e=new Bb.HTTPError(n);throw e.message=i,e}}return t})),u6=z3((e=>{async function t(t,r={}){const n=await e.post("files/stat",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers}),i=await n.json();return i.WithLocality=i.WithLocality||!1,h6(r6(i))}return t}));function h6(e){return e.cid=ji.parse(e.hash),delete e.hash,e}const d6=z3((e=>{async function t(t,r={}){const n=await e.post("files/touch",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers});await n.text()}return t})),f6=z3((e=>{async function t(t,r,n={}){const i=new AbortController,s=i5(i.signal,n.signal),o=await e.post("files/write",{signal:s,searchParams:K3({arg:t,streamChannels:!0,count:n.length,...n}),...await r5([{content:r,path:"arg",mode:F3(n.mode),mtime:$3(n.mtime)}],i,n.headers)});await o.text()}return t}));function p6(e){return{chmod:Z5(e),cp:e6(e),flush:t6(e),ls:n6(e),mkdir:s6(e),mv:o6(e),read:c6(e),rm:l6(e),stat:u6(e),touch:d6(e),write:f6(e)}}const y6=z3((e=>{const t=async(e,t,r={})=>{throw mn(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};return t})),g6=z3((e=>{async function t(t,r={type:"Ed25519"}){const n=await e.post("key/gen",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers}),i=await n.json();return m5(i)}return t})),m6=z3((e=>{async function t(t,r,n,i={}){const s=await e.post("key/import",{signal:i.signal,searchParams:K3({arg:t,pem:r,password:n,...i}),headers:i.headers}),o=await s.json();return m5(o)}return t})),w6=z3((e=>{const t=async(e,t={})=>{throw mn(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};return t})),b6=z3((e=>{async function t(t={}){const r=await e.post("key/list",{signal:t.signal,searchParams:K3(t),headers:t.headers}),n=await r.json();return(n.Keys||[]).map((e=>m5(e)))}return t})),v6=z3((e=>{async function t(t,r,n={}){const i=await e.post("key/rename",{signal:n.signal,searchParams:K3({arg:[t,r],...n}),headers:n.headers});return m5(await i.json())}return t})),E6=z3((e=>{async function t(t,r={}){const n=await e.post("key/rm",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers}),i=await n.json();return m5(i.Keys[0])}return t}));function _6(e){return{export:y6(e),gen:g6(e),import:m6(e),info:w6(e),list:b6(e),rename:v6(e),rm:E6(e)}}const S6=z3((e=>{async function t(t,r,n={}){const i=await e.post("log/level",{signal:n.signal,searchParams:K3({arg:[t,r],...n}),headers:n.headers});return m5(await i.json())}return t})),A6=z3((e=>{async function t(t={}){const r=await e.post("log/ls",{signal:t.signal,searchParams:K3(t),headers:t.headers}),n=await r.json();return n.Strings}return t})),I6=z3((e=>{async function*t(t={}){const r=await e.post("log/tail",{signal:t.signal,searchParams:K3(t),headers:t.headers});yield*r.ndjson()}return t}));function C6(e){return{level:S6(e),ls:A6(e),tail:I6(e)}}const k6=z3((e=>{async function t(t,r={}){const n=await e.post("name/publish",{signal:r.signal,searchParams:K3({arg:`${t}`,...r}),headers:r.headers});return m5(await n.json())}return t})),T6=z3((e=>{async function*t(t,r={}){const n=await e.post("name/resolve",{signal:r.signal,searchParams:K3({arg:t,stream:!0,...r}),headers:r.headers});for await(const e of n.ndjson())yield e.Path}return t})),R6=z3((e=>{async function t(t,r={}){const n=await e.post("name/pubsub/cancel",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers});return m5(await n.json())}return t})),P6=z3((e=>{async function t(t={}){const r=await e.post("name/pubsub/state",{signal:t.signal,searchParams:K3(t),headers:t.headers});return m5(await r.json())}return t})),x6=z3((e=>{async function t(t={}){const r=await e.post("name/pubsub/subs",{signal:t.signal,searchParams:K3(t),headers:t.headers}),n=await r.json();return n.Strings||[]}return t}));function D6(e){return{cancel:R6(e),state:P6(e),subs:x6(e)}}function O6(e){return{publish:k6(e),resolve:T6(e),pubsub:D6(e)}}const N6=z3((e=>{async function t(t,r={}){const n=await e.post("object/data",{signal:r.signal,searchParams:K3({arg:`${t instanceof Uint8Array?ji.decode(t):t}`,...r}),headers:r.headers}),i=await n.arrayBuffer();return new Uint8Array(i,0,i.byteLength)}return t})),L6=z3((e=>{async function t(t,r={}){const n=await e.post("object/get",{signal:r.signal,searchParams:K3({arg:`${t instanceof Uint8Array?ji.decode(t):t}`,dataEncoding:"base64",...r}),headers:r.headers}),i=await n.json();return{Data:Jl(i.Data,"base64pad"),Links:(i.Links||[]).map((e=>({Name:e.Name,Hash:ji.parse(e.Hash),Tsize:e.Size})))}}return t})),B6=z3((e=>{async function t(t,r={}){const n=await e.post("object/links",{signal:r.signal,searchParams:K3({arg:`${t instanceof Uint8Array?ji.decode(t):t}`,...r}),headers:r.headers}),i=await n.json();return(i.Links||[]).map((e=>({Name:e.Name,Tsize:e.Size,Hash:ji.parse(e.Hash)})))}return t})),U6=z3((e=>{async function t(t={}){const r=await e.post("object/new",{signal:t.signal,searchParams:K3({arg:t.template,...t}),headers:t.headers}),{Hash:n}=await r.json();return ji.parse(n)}return t})),M6=(e,t)=>{const r=z3((r=>{const n=P5(e,t);async function i(e,t={}){return n(e,{...t,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}return i}));return r(t)},j6=z3((e=>{async function t(t,r={}){const n=await e.post("object/stat",{signal:r.signal,searchParams:K3({arg:`${t}`,...r}),headers:r.headers}),i=await n.json();return{...i,Hash:ji.parse(i.Hash)}}return t})),V6=z3((e=>{async function t(t,r,n={}){const i=await e.post("object/patch/add-link",{signal:n.signal,searchParams:K3({arg:[`${t}`,r.Name||r.name||"",(r.Hash||r.cid||"").toString()||null],...n}),headers:n.headers}),{Hash:s}=await i.json();return ji.parse(s)}return t})),z6=z3((e=>{async function t(t,r,n={}){const i=new AbortController,s=i5(i.signal,n.signal),o=await e.post("object/patch/append-data",{signal:s,searchParams:K3({arg:`${t}`,...n}),...await r5([r],i,n.headers)}),{Hash:a}=await o.json();return ji.parse(a)}return t})),F6=z3((e=>{async function t(t,r,n={}){const i=await e.post("object/patch/rm-link",{signal:n.signal,searchParams:K3({arg:[`${t}`,r.Name||r.name||null],...n}),headers:n.headers}),{Hash:s}=await i.json();return ji.parse(s)}return t})),$6=z3((e=>{async function t(t,r,n={}){const i=new AbortController,s=i5(i.signal,n.signal),o=await e.post("object/patch/set-data",{signal:s,searchParams:K3({arg:[`${t}`],...n}),...await r5([r],i,n.headers)}),{Hash:a}=await o.json();return ji.parse(a)}return t}));function K6(e){return{addLink:V6(e),appendData:z6(e),rmLink:F6(e),setData:$6(e)}}function q6(e,t){return{data:N6(t),get:L6(t),links:B6(t),new:U6(t),put:M6(e,t),stat:j6(t),patch:K6(t)}}const H6=z3((e=>{async function*t(t,r={}){for await(const{path:n,recursive:i,metadata:s}of f_(t)){const t=await e.post("pin/add",{signal:r.signal,searchParams:K3({...r,arg:n,recursive:i,metadata:s?JSON.stringify(s):void 0,stream:!0}),headers:r.headers});for await(const e of t.ndjson())if(e.Pins)for(const t of e.Pins)yield ji.parse(t);else yield ji.parse(e)}}return t}));function G6(e){const t=H6(e);return z3((()=>{async function e(e,r={}){return h_(t([{path:e,...r}],r))}return e}))(e)}function W6(e,t,r){const n={type:e,cid:ji.parse(t)};return r&&(n.metadata=r),n}const Y6=z3((e=>{async function*t(t={}){let r=[];t.paths&&(r=Array.isArray(t.paths)?t.paths:[t.paths]);const n=await e.post("pin/ls",{signal:t.signal,searchParams:K3({...t,arg:r.map((e=>`${e}`)),stream:!0}),headers:t.headers});for await(const e of n.ndjson()){if(e.Keys){for(const t of Object.keys(e.Keys))yield W6(e.Keys[t].Type,t,e.Keys[t].Metadata);return}yield W6(e.Type,e.Cid,e.Metadata)}}return t})),J6=z3((e=>{async function*t(t,r={}){for await(const{path:n,recursive:i}of f_(t)){const t=new URLSearchParams(r.searchParams);t.append("arg",`${n}`),null!=i&&t.set("recursive",String(i));const s=await e.post("pin/rm",{signal:r.signal,headers:r.headers,searchParams:K3({...r,arg:`${n}`,recursive:i})});for await(const e of s.ndjson())e.Pins?yield*e.Pins.map((e=>ji.parse(e))):yield ji.parse(e)}}return t})),Q6=e=>{const t=J6(e);return z3((()=>{async function e(e,r={}){return h_(t([{path:e,...r}],r))}return e}))(e)},X6=({Name:e,Status:t,Cid:r})=>({cid:ji.parse(r),name:e,status:t}),Z6=e=>{if("string"===typeof e&&""!==e)return e;throw new TypeError("service name must be passed")},e4=e=>{if(ji.asCID(e))return e.toString();throw new TypeError("CID instance expected instead of "+typeof e)},t4=({service:e,cid:t,name:r,status:n,all:i})=>{const s=K3({service:Z6(e),name:r,force:!!i||void 0});if(t)for(const o of t)s.append("cid",e4(o));if(n)for(const o of n)s.append("status",o);return s},r4=({cid:e,service:t,background:r,name:n,origins:i})=>{const s=K3({arg:e4(e),service:Z6(t),name:n,background:!!r||void 0});if(i)for(const o of i)s.append("origin",o.toString());return s};function n4(e){async function t(t,{timeout:r,signal:n,headers:i,...s}){const o=await e.post("pin/remote/add",{timeout:r,signal:n,headers:i,searchParams:r4({cid:t,...s})});return X6(await o.json())}return t}function i4(e){async function*t({timeout:t,signal:r,headers:n,...i}){const s=await e.post("pin/remote/ls",{timeout:t,signal:r,headers:n,searchParams:t4(i)});for await(const e of s.ndjson())yield X6(e)}return t}function s4(e){async function t({timeout:t,signal:r,headers:n,...i}){await e.post("pin/remote/rm",{timeout:t,signal:r,headers:n,searchParams:t4({...i,all:!1})})}return t}function o4(e){async function t({timeout:t,signal:r,headers:n,...i}){await e.post("pin/remote/rm",{timeout:t,signal:r,headers:n,searchParams:t4({...i,all:!0})})}return t}function a4(e){const t=String(e);if("undefined"===t)throw Error("endpoint is required");return"/"===t[t.length-1]?t.slice(0,-1):t}function c4(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:l4(e.Stat)}}}function l4(e){switch(e.Status){case"valid":{const{Pinning:t,Pinned:r,Queued:n,Failed:i}=e.PinCount;return{status:"valid",pinCount:{queued:n,pinning:t,pinned:r,failed:i}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}function u4(e){async function t(t,r){const{endpoint:n,key:i,headers:s,timeout:o,signal:a}=r;await e.post("pin/remote/service/add",{timeout:o,signal:a,searchParams:K3({arg:[t,a4(n),i]}),headers:s})}return t}function h4(e){async function t(t={}){const{stat:r,headers:n,timeout:i,signal:s}=t,o=await e.post("pin/remote/service/ls",{timeout:i,signal:s,headers:n,searchParams:!0===r?K3({stat:r}):void 0}),{RemoteServices:a}=await o.json();return a.map(c4)}return t}function d4(e){async function t(t,r={}){await e.post("pin/remote/service/rm",{signal:r.signal,headers:r.headers,searchParams:K3({arg:t})})}return t}function f4(e){const t=new V3(e);return{add:u4(t),ls:h4(t),rm:d4(t)}}function p4(e){const t=new V3(e);return{add:n4(t),ls:i4(t),rm:s4(t),rmAll:o4(t),service:f4(e)}}function y4(e){return{addAll:H6(e),add:G6(e),ls:Y6(e),rmAll:J6(e),rm:Q6(e),remote:p4(e)}}const g4=e=>Array.isArray(e)?e.map(m4):e,m4=e=>C_(w4(e)),w4=e=>pc.decode(e),b4=e=>BigInt(`0x${C_(pc.decode(e),"base16")}`),v4=e=>pc.encode(Jl(e)),E4=z3((e=>{async function t(t={}){const{Strings:r}=await(await e.post("pubsub/ls",{signal:t.signal,searchParams:K3(t),headers:t.headers})).json();return g4(r)||[]}return t})),_4=z3((e=>{async function t(t,r={}){const n=await e.post("pubsub/peers",{signal:r.signal,searchParams:K3({arg:v4(t),...r}),headers:r.headers}),{Strings:i}=await n.json();return i||[]}return t})),S4=z3((e=>{async function t(t,r,n={}){const i=K3({arg:v4(t),...n}),s=new AbortController,o=i5(s.signal,n.signal),a=await e.post("pubsub/pub",{signal:o,searchParams:i,...await r5([r],s,n.headers)});await a.text()}return t})),A4=gn("ipfs-http-client:pubsub:subscribe"),I4=(e,t)=>z3((e=>{async function r(r,n,i={}){let s,o;i.signal=t.subscribe(r,n,i.signal);const a=new Promise(((e,t)=>{s=e,o=t})),c=setTimeout((()=>s()),1e3);return e.post("pubsub/sub",{signal:i.signal,searchParams:K3({arg:v4(r),...i}),headers:i.headers}).catch((e=>{t.unsubscribe(r,n),o(e)})).then((e=>{clearTimeout(c),e&&(C4(e,{onMessage:e=>{n&&("function"!==typeof n?"function"===typeof n.handleEvent&&n.handleEvent(e):n(e))},onEnd:()=>t.unsubscribe(r,n),onError:i.onError}),s())})),a}return r}))(e);async function C4(e,{onMessage:t,onEnd:r,onError:n}){n=n||A4;try{for await(const r of e.ndjson())try{if(!r.from)continue;null!=r.from&&null!=r.seqno?t({type:"signed",from:s_(r.from),data:w4(r.data),sequenceNumber:b4(r.seqno),topic:m4(r.topicIDs[0]),key:w4(r.key??"u"),signature:w4(r.signature??"u")}):t({type:"unsigned",data:w4(r.data),topic:m4(r.topicIDs[0])})}catch(WV){WV.message=`Failed to parse pubsub message: ${WV.message}`,n(WV,!1,r)}}catch(WV){k4(WV)||n(WV,!0)}finally{r()}}const k4=e=>{switch(e.type){case"aborted":return!0;case"abort":return!0;default:return"AbortError"===e.name}},T4=(e,t)=>{async function r(e,r){t.unsubscribe(e,r)}return r};class R4{constructor(){this._subs=new Map}subscribe(e,t,r){const n=this._subs.get(e)||[];if(n.find((e=>e.handler===t)))throw new Error(`Already subscribed to ${e} with this handler`);const i=new AbortController;return this._subs.set(e,[{handler:t,controller:i}].concat(n)),r&&r.addEventListener("abort",(()=>this.unsubscribe(e,t))),i.signal}unsubscribe(e,t){const r=this._subs.get(e)||[];let n;t?(this._subs.set(e,r.filter((e=>e.handler!==t))),n=r.filter((e=>e.handler===t))):(this._subs.set(e,[]),n=r),(this._subs.get(e)||[]).length||this._subs.delete(e),n.forEach((e=>e.controller.abort()))}}function P4(e){const t=new R4;return{ls:E4(e),peers:_4(e),publish:S4(e),subscribe:I4(e,t),unsubscribe:T4(e,t)}}const x4=z3((e=>{async function*t(t={}){const r=await e.post("refs/local",{signal:t.signal,transform:m5,searchParams:K3(t),headers:t.headers});yield*r.ndjson()}return t})),D4=z3(((e,t)=>{const r=async function*(t,r={}){const n=Array.isArray(t)?t:[t],i=await e.post("refs",{signal:r.signal,searchParams:K3({arg:n.map((e=>`${e instanceof Uint8Array?ji.decode(e):e}`)),...r}),headers:r.headers,transform:m5});yield*i.ndjson()};return Object.assign(r,{local:x4(t)})})),O4=z3((e=>{async function*t(t={}){const r=await e.post("repo/gc",{signal:t.signal,searchParams:K3(t),headers:t.headers,transform:e=>({err:e.Error?new Error(e.Error):null,cid:(e.Key||{})["/"]?ji.parse(e.Key["/"]):null})});yield*r.ndjson()}return t})),N4=z3((e=>{async function t(t={}){const r=await e.post("repo/stat",{signal:t.signal,searchParams:K3(t),headers:t.headers}),n=await r.json();return{numObjects:BigInt(n.NumObjects),repoSize:BigInt(n.RepoSize),repoPath:n.RepoPath,version:n.Version,storageMax:BigInt(n.StorageMax)}}return t})),L4=z3((e=>{async function t(t={}){const r=await(await e.post("repo/version",{signal:t.signal,searchParams:K3(t),headers:t.headers})).json();return r.Version}return t}));function B4(e){return{gc:O4(e),stat:N4(e),version:L4(e)}}const U4=z3((e=>{async function*t(t={}){const r=await e.post("stats/bw",{signal:t.signal,searchParams:K3(t),headers:t.headers,transform:e=>({totalIn:BigInt(e.TotalIn),totalOut:BigInt(e.TotalOut),rateIn:parseFloat(e.RateIn),rateOut:parseFloat(e.RateOut)})});yield*r.ndjson()}return t}));function M4(e){return{bitswap:G3(e),repo:N4(e),bw:U4(e)}}const j4=z3((e=>{async function t(t={}){const r=await e.post("swarm/addrs",{signal:t.signal,searchParams:K3(t),headers:t.headers}),{Addrs:n}=await r.json();return Object.keys(n).map((e=>({id:s_(e),addrs:(n[e]||[]).map((e=>Pp(e)))})))}return t})),V4=z3((e=>{async function t(t,r={}){const n=await e.post("swarm/connect",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers}),{Strings:i}=await n.json();return i||[]}return t})),z4=z3((e=>{async function t(t,r={}){const n=await e.post("swarm/disconnect",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers}),{Strings:i}=await n.json();return i||[]}return t})),F4=z3((e=>{async function t(t={}){const r=await e.post("swarm/addrs/local",{signal:t.signal,searchParams:K3(t),headers:t.headers}),{Strings:n}=await r.json();return(n||[]).map((e=>Pp(e)))}return t})),$4=z3((e=>{async function t(t={}){const r=await e.post("swarm/peers",{signal:t.signal,searchParams:K3(t),headers:t.headers}),{Peers:n}=await r.json();return(n||[]).map((e=>({addr:Pp(e.Addr),peer:s_(e.Peer),muxer:e.Muxer,latency:e.Latency,streams:e.Streams,direction:null==e.Direction?void 0:0===e.Direction?"inbound":"outbound"})))}return t}));function K4(e){return{addrs:j4(e),connect:V4(e),disconnect:z4(e),localAddrs:F4(e),peers:$4(e)}}const q4=z3((e=>{async function*t(t,r={}){const n=new AbortController,i=i5(n.signal,r.signal),{headers:s,body:o,total:a,parts:c}=await r5(t,n,r.headers),[l,u]="function"===typeof r.progress?H4(a,c,r.progress):[void 0,void 0],h=await e.post("add",{searchParams:K3({"stream-channels":!0,...r,progress:Boolean(l)}),onUploadProgress:u,signal:i,headers:s,body:o});for await(let e of h.ndjson())e=m5(e),void 0!==e.hash?yield W4(e):l&&l(e.bytes||0,e.name)}return t})),H4=(e,t,r)=>t?[void 0,G4(e,t,r)]:[r,void 0],G4=(e,t,r)=>{let n=0;const i=t.length;return({loaded:s,total:o})=>{const a=Math.floor(s/o*e);while(n<i){const{start:e,end:i,name:s}=t[n];if(a<i){r(a-e,s);break}r(i-e,s),n+=1}}};function W4({name:e,hash:t,size:r,mode:n,mtime:i,mtimeNsecs:s}){const o={path:e,cid:ji.parse(t),size:parseInt(r)};return null!=n&&(o.mode=parseInt(n,8)),null!=i&&(o.mtime={secs:i,nsecs:s||0}),o}function Y4(e){const t=q4(e);return z3((()=>{async function e(e,r={}){return await h_(t(xx(e),r))}return e}))(e)}const J4=z3((e=>{async function*t(t,r={}){const n=await e.post("cat",{signal:r.signal,searchParams:K3({arg:t.toString(),...r}),headers:r.headers});yield*n.iterator()}return t})),Q4=z3((e=>{const t=async(t={})=>{const r=await e.post("commands",{signal:t.signal,searchParams:K3(t),headers:t.headers});return r.json()};return t})),X4=z3((e=>{const t=async(t,r={})=>{const n=await e.post("dns",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers}),i=await n.json();return i.Path};return t})),Z4=z3((e=>()=>{const t=new URL(e.opts.base||"");return{host:t.hostname,port:t.port,protocol:t.protocol,pathname:t.pathname,"api-path":t.pathname}})),e8=z3((e=>{async function*t(t,r={}){const n={arg:`${t instanceof Uint8Array?ji.decode(t):t}`,...r};n.compressionLevel&&(n["compression-level"]=n.compressionLevel,delete n.compressionLevel);const i=await e.post("get",{signal:r.signal,searchParams:K3(n),headers:r.headers});yield*i.iterator()}return t})),t8=z3((e=>{async function t(t={}){const r=await e.post("id",{signal:t.signal,searchParams:K3({arg:t.peerId?t.peerId.toString():void 0,...t}),headers:t.headers}),n=await r.json(),i={...m5(n)};return i.id=s_(i.id),i.addresses&&(i.addresses=i.addresses.map((e=>Pp(e)))),i}return t})),r8=e=>{const t=t8(e);async function r(e={}){const r=await t(e);return Boolean(r&&r.addresses&&r.addresses.length)}return r},n8=z3(((e,t)=>{async function*r(r,n={}){const i=`${r instanceof Uint8Array?ji.decode(r):r}`;async function s(e){let r=e.Hash;if(r.includes("/")){const e=r.startsWith("/ipfs/")?r:`/ipfs/${r}`,n=await u6(t)(e);r=n.cid}else r=ji.parse(r);const n={name:e.Name,path:i+(e.Name?`/${e.Name}`:""),size:e.Size,cid:r,type:i8(e)};return e.Mode&&(n.mode=parseInt(e.Mode,8)),void 0!==e.Mtime&&null!==e.Mtime&&(n.mtime={secs:e.Mtime},void 0!==e.MtimeNsecs&&null!==e.MtimeNsecs&&(n.mtime.nsecs=e.MtimeNsecs)),n}const o=await e.post("ls",{signal:n.signal,searchParams:K3({arg:i,...n}),headers:n.headers});for await(let e of o.ndjson()){if(e=e.Objects,!e)throw new Error("expected .Objects in results");if(e=e[0],!e)throw new Error("expected one array in results.Objects");const t=e.Links;if(!Array.isArray(t))throw new Error("expected one array in results.Objects[0].Links");if(!t.length)return void(yield s(e));yield*t.map(s)}}return r}));function i8(e){switch(e.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}const s8=z3((e=>{async function t(t={}){const r=await e.post("dns",{signal:t.signal,searchParams:K3(t),headers:t.headers});return m5(await r.json())}return t})),o8=z3((e=>{async function*t(t,r={}){const n=await e.post("ping",{signal:r.signal,searchParams:K3({arg:`${t}`,...r}),headers:r.headers,transform:m5});yield*n.ndjson()}return t})),a8=z3((e=>{async function t(t,r={}){const n=await e.post("resolve",{signal:r.signal,searchParams:K3({arg:t,...r}),headers:r.headers}),{Path:i}=await n.json();return i}return t})),c8=z3((e=>{const t=async(e={})=>{throw mn(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};return t})),l8=z3((e=>{async function t(t={}){const r=await e.post("shutdown",{signal:t.signal,searchParams:K3(t),headers:t.headers});await r.text()}return t})),u8=z3((e=>{async function t(t={}){const r=await e.post("version",{signal:t.signal,searchParams:K3(t),headers:t.headers});return{...m5(await r.json()),"ipfs-http-client":"1.0.0"}}return t}));r(3897);var h8=r(749);function d8(e={}){const t={name:il.name,code:il.code,encode:e=>e,decode:e=>e},r=Object.values(Dl);(e.ipld&&e.ipld.bases?e.ipld.bases:[]).forEach((e=>r.push(e)));const n=new S3({bases:r,loadBase:e.ipld&&e.ipld.loadBase}),i=Object.values(Nl);[s,o,c,l,t].concat(e.ipld&&e.ipld.codecs||[]).forEach((e=>i.push(e)));const a=new I3({codecs:i,loadCodec:e.ipld&&e.ipld.loadCodec}),u=Object.values(Ol);(e.ipld&&e.ipld.hashers?e.ipld.hashers:[]).forEach((e=>u.push(e)));const h=new k3({hashers:u,loadHasher:e.ipld&&e.ipld.loadHasher}),d={add:Y4(e),addAll:q4(e),bitswap:J3(e),block:l5(e),bootstrap:y5(e),cat:J4(e),commands:Q4(e),config:I5(e),dag:D5(a,e),dht:W5(e),diag:X5(e),dns:X4(e),files:p6(e),get:e8(e),getEndpointConfig:Z4(e),id:t8(e),isOnline:r8(e),key:_6(e),log:C6(e),ls:n8(e),mount:s8(e),name:O6(e),object:q6(a,e),pin:y4(e),ping:o8(e),pubsub:P4(e),refs:D4(e),repo:B4(e),resolve:a8(e),start:c8(e),stats:M4(e),stop:l8(e),swarm:K4(e),version:u8(e),bases:n,codecs:a,hashers:h};return d}const f8=421,p8=290,y8=2e3,g8=Object.create(null);g8["open"]="0",g8["close"]="1",g8["ping"]="2",g8["pong"]="3",g8["message"]="4",g8["upgrade"]="5",g8["noop"]="6";const m8=Object.create(null);Object.keys(g8).forEach((e=>{m8[g8[e]]=e}));const w8={type:"error",data:"parser error"},b8="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),v8="function"===typeof ArrayBuffer,E8=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,_8=({type:e,data:t},r,n)=>b8&&t instanceof Blob?r?n(t):S8(t,n):v8&&(t instanceof ArrayBuffer||E8(t))?r?n(t):S8(new Blob([t]),n):n(g8[e]+(t||"")),S8=(e,t)=>{const r=new FileReader;return r.onload=function(){const e=r.result.split(",")[1];t("b"+e)},r.readAsDataURL(e)};var A8=_8;const I8="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",C8="undefined"===typeof Uint8Array?[]:new Uint8Array(256);for(let Xbe=0;Xbe<I8.length;Xbe++)C8[I8.charCodeAt(Xbe)]=Xbe;const k8=e=>{let t,r,n,i,s,o=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);const l=new ArrayBuffer(o),u=new Uint8Array(l);for(t=0;t<a;t+=4)r=C8[e.charCodeAt(t)],n=C8[e.charCodeAt(t+1)],i=C8[e.charCodeAt(t+2)],s=C8[e.charCodeAt(t+3)],u[c++]=r<<2|n>>4,u[c++]=(15&n)<<4|i>>2,u[c++]=(3&i)<<6|63&s;return l},T8="function"===typeof ArrayBuffer,R8=(e,t)=>{if("string"!==typeof e)return{type:"message",data:x8(e,t)};const r=e.charAt(0);if("b"===r)return{type:"message",data:P8(e.substring(1),t)};const n=m8[r];return n?e.length>1?{type:m8[r],data:e.substring(1)}:{type:m8[r]}:w8},P8=(e,t)=>{if(T8){const r=k8(e);return x8(r,t)}return{base64:!0,data:e}},x8=(e,t)=>{switch(t){case"blob":return e instanceof ArrayBuffer?new Blob([e]):e;case"arraybuffer":default:return e}};var D8=R8;const O8=String.fromCharCode(30),N8=(e,t)=>{const r=e.length,n=new Array(r);let i=0;e.forEach(((e,s)=>{A8(e,!1,(e=>{n[s]=e,++i===r&&t(n.join(O8))}))}))},L8=(e,t)=>{const r=e.split(O8),n=[];for(let i=0;i<r.length;i++){const e=D8(r[i],t);if(n.push(e),"error"===e.type)break}return n},B8=4;function U8(e){if(e)return M8(e)}function M8(e){for(var t in U8.prototype)e[t]=U8.prototype[t];return e}U8.prototype.on=U8.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},U8.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},U8.prototype.off=U8.prototype.removeListener=U8.prototype.removeAllListeners=U8.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<n.length;i++)if(r=n[i],r===t||r.fn===t){n.splice(i,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},U8.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){r=r.slice(0);n=0;for(var i=r.length;n<i;++n)r[n].apply(this,t)}return this},U8.prototype.emitReserved=U8.prototype.emit,U8.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},U8.prototype.hasListeners=function(e){return!!this.listeners(e).length};const j8=(()=>"undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")())();function V8(e,...t){return t.reduce(((t,r)=>(e.hasOwnProperty(r)&&(t[r]=e[r]),t)),{})}const z8=setTimeout,F8=clearTimeout;function $8(e,t){t.useNativeTimers?(e.setTimeoutFn=z8.bind(j8),e.clearTimeoutFn=F8.bind(j8)):(e.setTimeoutFn=setTimeout.bind(j8),e.clearTimeoutFn=clearTimeout.bind(j8))}const K8=1.33;function q8(e){return"string"===typeof e?H8(e):Math.ceil((e.byteLength||e.size)*K8)}function H8(e){let t=0,r=0;for(let n=0,i=e.length;n<i;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}class G8 extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class W8 extends U8{constructor(e){super(),this.writable=!1,$8(this,e),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,t,r){return super.emitReserved("error",new G8(e,t,r)),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=D8(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}}const Y8="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),J8=64,Q8={};let X8,Z8=0,e7=0;function t7(e){let t="";do{t=Y8[e%J8]+t,e=Math.floor(e/J8)}while(e>0);return t}function r7(){const e=t7(+new Date);return e!==X8?(Z8=0,X8=e):e+"."+t7(Z8++)}for(;e7<J8;e7++)Q8[Y8[e7]]=e7;function n7(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function i7(e){let t={},r=e.split("&");for(let n=0,i=r.length;n<i;n++){let e=r[n].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return t}let s7=!1;try{s7="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(WV){}const o7=s7;function a7(e){const t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||o7))return new XMLHttpRequest}catch(r){}if(!t)try{return new(j8[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(r){}}function c7(){}const l7=function(){const e=new a7({xdomain:!1});return null!=e.responseType}();class u7 extends W8{constructor(e){if(super(e),this.polling=!1,"undefined"!==typeof location){const t="https:"===location.protocol;let r=location.port;r||(r=t?"443":"80"),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||r!==e.port,this.xs=e.secure!==t}const t=e&&e.forceBase64;this.supportsBinary=l7&&!t}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(e++,this.once("pollComplete",(function(){--e||t()}))),this.writable||(e++,this.once("drain",(function(){--e||t()})))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)};L8(e,this.socket.binaryType).forEach(t),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,N8(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){let e=this.query||{};const t=this.opts.secure?"https":"http";let r="";!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=r7()),this.supportsBinary||e.sid||(e.b64=1),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(r=":"+this.opts.port);const n=n7(e),i=-1!==this.opts.hostname.indexOf(":");return t+"://"+(i?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new h7(this.uri(),e)}doWrite(e,t){const r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}class h7 extends U8{constructor(e,t){super(),$8(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.create()}create(){const e=V8(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;const t=this.xhr=new a7(e);try{t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&t.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(r){}if("POST"===this.method)try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(r){}try{t.setRequestHeader("Accept","*/*")}catch(r){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),t.onreadystatechange=()=>{4===t.readyState&&(200===t.status||1223===t.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"===typeof t.status?t.status:0)}),0))},t.send(this.data)}catch(r){return void this.setTimeoutFn((()=>{this.onError(r)}),0)}"undefined"!==typeof document&&(this.index=h7.requestsCount++,h7.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=c7,e)try{this.xhr.abort()}catch(t){}"undefined"!==typeof document&&delete h7.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(h7.requestsCount=0,h7.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",d7);else if("function"===typeof addEventListener){const e="onpagehide"in j8?"pagehide":"unload";addEventListener(e,d7,!1)}function d7(){for(let e in h7.requests)h7.requests.hasOwnProperty(e)&&h7.requests[e].abort()}const f7=(()=>{const e="function"===typeof Promise&&"function"===typeof Promise.resolve;return e?e=>Promise.resolve().then(e):(e,t)=>t(e,0)})(),p7=j8.WebSocket||j8.MozWebSocket,y7=!0,g7="arraybuffer",m7="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class w7 extends W8{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,r=m7?{}:V8(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=y7&&!m7?t?new p7(e,t):new p7(e):new p7(e,t,r)}catch(WV){return this.emitReserved("error",WV)}this.ws.binaryType=this.socket.binaryType||g7,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],n=t===e.length-1;A8(r,this.supportsBinary,(e=>{const t={};if(!y7&&(r.options&&(t.compress=r.options.compress),this.opts.perMessageDeflate)){const r="string"===typeof e?Buffer.byteLength(e):e.length;r<this.opts.perMessageDeflate.threshold&&(t.compress=!1)}try{y7?this.ws.send(e):this.ws.send(e,t)}catch(i){}n&&f7((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){"undefined"!==typeof this.ws&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{};const t=this.opts.secure?"wss":"ws";let r="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(r=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=r7()),this.supportsBinary||(e.b64=1);const n=n7(e),i=-1!==this.opts.hostname.indexOf(":");return t+"://"+(i?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}check(){return!!p7}}const b7={websocket:w7,polling:u7},v7=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,E7=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function _7(e){const t=e,r=e.indexOf("["),n=e.indexOf("]");-1!=r&&-1!=n&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let i=v7.exec(e||""),s={},o=14;while(o--)s[E7[o]]=i[o]||"";return-1!=r&&-1!=n&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=S7(s,s["path"]),s.queryKey=A7(s,s["query"]),s}function S7(e,t){const r=/\/{2,9}/g,n=t.replace(r,"/").split("/");return"/"!=t.slice(0,1)&&0!==t.length||n.splice(0,1),"/"==t.slice(-1)&&n.splice(n.length-1,1),n}function A7(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,n){t&&(r[t]=n)})),r}class I7 extends U8{constructor(e,t={}){super(),e&&"object"===typeof e&&(t=e,e=null),e?(e=_7(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=_7(t.host).host),$8(this,t),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"===typeof this.opts.query&&(this.opts.query=i7(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"===typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=B8,t.transport=e,this.id&&(t.sid=this.id);const r=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new b7[e](r)}open(){let e;if(this.opts.rememberUpgrade&&I7.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(t){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(e){let t=this.createTransport(e),r=!1;I7.priorWebsocketSuccess=!1;const n=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",(e=>{if(!r)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;I7.priorWebsocketSuccess="websocket"===t.name,this.transport.pause((()=>{r||"closed"!==this.readyState&&(l(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}})))};function i(){r||(r=!0,l(),t.close(),t=null)}const s=e=>{const r=new Error("probe error: "+e);r.transport=t.name,i(),this.emitReserved("upgradeError",r)};function o(){s("transport closed")}function a(){s("socket closed")}function c(e){t&&e.name!==t.name&&i()}const l=()=>{t.removeListener("open",n),t.removeListener("error",s),t.removeListener("close",o),this.off("close",a),this.off("upgrading",c)};t.once("open",n),t.once("error",s),t.once("close",o),this.once("close",a),this.once("upgrading",c),t.open()}onOpen(){if(this.readyState="open",I7.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){const e=this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1;if(!e)return this.writeBuffer;let t=1;for(let r=0;r<this.writeBuffer.length;r++){const e=this.writeBuffer[r].data;if(e&&(t+=q8(e)),r>0&&t>this.maxPayload)return this.writeBuffer.slice(0,r);t+=2}return this.writeBuffer}write(e,t,r){return this.sendPacket("message",e,t,r),this}send(e,t,r){return this.sendPacket("message",e,t,r),this}sendPacket(e,t,r,n){if("function"===typeof t&&(n=t,t=void 0),"function"===typeof r&&(n=r,r=null),"closing"===this.readyState||"closed"===this.readyState)return;r=r||{},r.compress=!1!==r.compress;const i={type:e,data:t,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?r():e()})):this.upgrading?r():e()),this}onError(e){I7.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"===typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let r=0;const n=e.length;for(;r<n;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}I7.protocol=B8;I7.protocol;function C7(e,t="",r){let n=e;r=r||"undefined"!==typeof location&&location,null==e&&(e=r.protocol+"//"+r.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof r?r.protocol+"//"+e:"https://"+e),n=_7(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=-1!==n.host.indexOf(":"),s=i?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+t,n.href=n.protocol+"://"+s+(r&&r.port===n.port?"":":"+n.port),n}const k7="function"===typeof ArrayBuffer,T7=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,R7=Object.prototype.toString,P7="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===R7.call(Blob),x7="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===R7.call(File);function D7(e){return k7&&(e instanceof ArrayBuffer||T7(e))||P7&&e instanceof Blob||x7&&e instanceof File}function O7(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(let t=0,r=e.length;t<r;t++)if(O7(e[t]))return!0;return!1}if(D7(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return O7(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&O7(e[r]))return!0;return!1}function N7(e){const t=[],r=e.data,n=e;return n.data=L7(r,t),n.attachments=t.length,{packet:n,buffers:t}}function L7(e,t){if(!e)return e;if(D7(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}if(Array.isArray(e)){const r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=L7(e[n],t);return r}if("object"===typeof e&&!(e instanceof Date)){const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=L7(e[n],t));return r}return e}function B7(e,t){return e.data=U7(e.data,t),e.attachments=void 0,e}function U7(e,t){if(!e)return e;if(e&&!0===e._placeholder){const r="number"===typeof e.num&&e.num>=0&&e.num<t.length;if(r)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=U7(e[r],t);else if("object"===typeof e)for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=U7(e[r],t));return e}const M7=5;var j7;(function(e){e[e["CONNECT"]=0]="CONNECT",e[e["DISCONNECT"]=1]="DISCONNECT",e[e["EVENT"]=2]="EVENT",e[e["ACK"]=3]="ACK",e[e["CONNECT_ERROR"]=4]="CONNECT_ERROR",e[e["BINARY_EVENT"]=5]="BINARY_EVENT",e[e["BINARY_ACK"]=6]="BINARY_ACK"})(j7||(j7={}));class V7{constructor(e){this.replacer=e}encode(e){return e.type!==j7.EVENT&&e.type!==j7.ACK||!O7(e)?[this.encodeAsString(e)]:(e.type=e.type===j7.EVENT?j7.BINARY_EVENT:j7.BINARY_ACK,this.encodeAsBinary(e))}encodeAsString(e){let t=""+e.type;return e.type!==j7.BINARY_EVENT&&e.type!==j7.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=N7(e),r=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(r),n}}class z7 extends U8{constructor(e){super(),this.reviver=e}add(e){let t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e),t.type===j7.BINARY_EVENT||t.type===j7.BINARY_ACK?(this.reconstructor=new F7(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!D7(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const r={type:Number(e.charAt(0))};if(void 0===j7[r.type])throw new Error("unknown packet type "+r.type);if(r.type===j7.BINARY_EVENT||r.type===j7.BINARY_ACK){const n=t+1;while("-"!==e.charAt(++t)&&t!=e.length);const i=e.substring(n,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");r.attachments=Number(i)}if("/"===e.charAt(t+1)){const n=t+1;while(++t){const r=e.charAt(t);if(","===r)break;if(t===e.length)break}r.nsp=e.substring(n,t)}else r.nsp="/";const n=e.charAt(t+1);if(""!==n&&Number(n)==n){const n=t+1;while(++t){const r=e.charAt(t);if(null==r||Number(r)!=r){--t;break}if(t===e.length)break}r.id=Number(e.substring(n,t+1))}if(e.charAt(++t)){const n=this.tryParse(e.substr(t));if(!z7.isPayloadValid(r.type,n))throw new Error("invalid payload");r.data=n}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(t){return!1}}static isPayloadValid(e,t){switch(e){case j7.CONNECT:return"object"===typeof t;case j7.DISCONNECT:return void 0===t;case j7.CONNECT_ERROR:return"string"===typeof t||"object"===typeof t;case j7.EVENT:case j7.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case j7.ACK:case j7.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class F7{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=B7(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function $7(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const K7=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class q7 extends U8{constructor(e,t,r){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[$7(e,"open",this.onopen.bind(this)),$7(e,"packet",this.onpacket.bind(this)),$7(e,"error",this.onerror.bind(this)),$7(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io["_reconnecting"]||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(K7.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');t.unshift(e);const r={type:j7.EVENT,data:t,options:{}};if(r.options.compress=!1!==this.flags.compress,"function"===typeof t[t.length-1]){const e=this.ids++,n=t.pop();this._registerAckCallback(e,n),r.id=e}const n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,i=this.flags.volatile&&(!n||!this.connected);return i||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(e,t){const r=this.flags.timeout;if(void 0===r)return void(this.acks[e]=t);const n=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),r);this.acks[e]=(...e)=>{this.io.clearTimeoutFn(n),t.apply(this,[null,...e])}}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this.packet({type:j7.CONNECT,data:e})})):this.packet({type:j7.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){const t=e.nsp===this.nsp;if(t)switch(e.type){case j7.CONNECT:if(e.data&&e.data.sid){const t=e.data.sid;this.onconnect(t)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case j7.EVENT:case j7.BINARY_EVENT:this.onevent(e);break;case j7.ACK:case j7.BINARY_ACK:this.onack(e);break;case j7.DISCONNECT:this.ondisconnect();break;case j7.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t);break}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const r of t)r.apply(this,e)}super.emit.apply(this,e)}ack(e){const t=this;let r=!1;return function(...n){r||(r=!0,t.packet({type:j7.ACK,id:e,data:n}))}}onack(e){const t=this.acks[e.id];"function"===typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e){this.id=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io["_destroy"](this)}disconnect(){return this.connected&&this.packet({type:j7.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const r of t)r.apply(this,e.data)}}}function H7(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}H7.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},H7.prototype.reset=function(){this.attempts=0},H7.prototype.setMin=function(e){this.ms=e},H7.prototype.setMax=function(e){this.max=e},H7.prototype.setJitter=function(e){this.jitter=e};class G7 extends U8{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&"object"===typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,$8(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(r=t.randomizationFactor)&&void 0!==r?r:.5),this.backoff=new H7({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const n=t.parser||Rt;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new I7(this.uri,this.opts);const t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const n=$7(t,"open",(function(){r.onopen(),e&&e()})),i=$7(t,"error",(t=>{r.cleanup(),r._readyState="closed",this.emitReserved("error",t),e?e(t):r.maybeReconnectOnOpen()}));if(!1!==this._timeout){const e=this._timeout;0===e&&n();const r=this.setTimeoutFn((()=>{n(),t.close(),t.emit("error",new Error("timeout"))}),e);this.opts.autoUnref&&r.unref(),this.subs.push((function(){clearTimeout(r)}))}return this.subs.push(n),this.subs.push(i),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push($7(e,"ping",this.onping.bind(this)),$7(e,"data",this.ondata.bind(this)),$7(e,"error",this.onerror.bind(this)),$7(e,"close",this.onclose.bind(this)),$7(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){f7((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r||(r=new q7(this,e,t),this.nsps[e]=r),r}_destroy(e){const t=Object.keys(this.nsps);for(const r of t){const e=this.nsps[r];if(e.active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()})))}),t);this.opts.autoUnref&&r.unref(),this.subs.push((function(){clearTimeout(r)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const W7={};function Y7(e,t){"object"===typeof e&&(t=e,e=void 0),t=t||{};const r=C7(e,t.path||"/socket.io"),n=r.source,i=r.id,s=r.path,o=W7[i]&&s in W7[i]["nsps"],a=t.forceNew||t["force new connection"]||!1===t.multiplex||o;let c;return a?c=new G7(n,t):(W7[i]||(W7[i]=new G7(n,t)),c=W7[i]),r.query&&!t.query&&(t.query=r.queryKey),c.socket(r.path,t)}Object.assign(Y7,{Manager:G7,Socket:q7,io:Y7,connect:Y7});var J7=r(1914);function Q7(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var X7=Q7,Z7=X7,e9=Z7;new Uint8Array(0);const t9=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},r9=e=>(new TextEncoder).encode(e),n9=e=>(new TextDecoder).decode(e);class i9{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class s9{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return a9(this,e)}}class o9{constructor(e){this.decoders=e}or(e){return a9(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const a9=(e,t)=>new o9({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class c9{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new i9(e,t,r),this.decoder=new s9(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const l9=({name:e,prefix:t,encode:r,decode:n})=>new c9(e,t,r,n),u9=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=e9(r,t);return l9({prefix:e,name:t,encode:n,decode:e=>t9(i(e))})},h9=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},d9=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},f9=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>l9({prefix:t,name:e,encode(e){return d9(e,n,r)},decode(t){return h9(t,n,r,e)}}),p9=l9({prefix:"\0",name:"identity",encode:e=>n9(e),decode:e=>r9(e)}),y9=f9({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),g9=f9({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),m9=u9({prefix:"9",name:"base10",alphabet:"0123456789"}),w9=f9({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),b9=f9({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),v9=f9({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),E9=f9({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_9=f9({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),S9=f9({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),A9=f9({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),I9=f9({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),C9=f9({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),k9=f9({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),T9=f9({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),R9=u9({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),P9=u9({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),x9=u9({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),D9=u9({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),O9=f9({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),N9=f9({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),L9=f9({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),B9=f9({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),U9=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),M9=U9.reduce(((e,t,r)=>(e[r]=t,e)),[]),j9=U9.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);function V9(e){return e.reduce(((e,t)=>(e+=M9[t],e)),"")}function z9(e){const t=[];for(const r of e){const e=j9[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}const F9=l9({prefix:"🚀",name:"base256emoji",encode:V9,decode:z9});var $9=W9,K9=128,q9=127,H9=~q9,G9=Math.pow(2,31);function W9(e,t,r){t=t||[],r=r||0;var n=r;while(e>=G9)t[r++]=255&e|K9,e/=128;while(e&H9)t[r++]=255&e|K9,e>>>=7;return t[r]=0|e,W9.bytes=r-n+1,t}var Y9=X9,J9=128,Q9=127;function X9(e,t){var r,n=0,i=(t=t||0,0),s=t,o=e.length;do{if(s>=o)throw X9.bytes=0,new RangeError("Could not decode varint");r=e[s++],n+=i<28?(r&Q9)<<i:(r&Q9)*Math.pow(2,i),i+=7}while(r>=J9);return X9.bytes=s-t,n}var Z9=Math.pow(2,7),eee=Math.pow(2,14),tee=Math.pow(2,21),ree=Math.pow(2,28),nee=Math.pow(2,35),iee=Math.pow(2,42),see=Math.pow(2,49),oee=Math.pow(2,56),aee=Math.pow(2,63),cee=function(e){return e<Z9?1:e<eee?2:e<tee?3:e<ree?4:e<nee?5:e<iee?6:e<see?7:e<oee?8:e<aee?9:10},lee={encode:$9,decode:Y9,encodingLength:cee},uee=lee,hee=uee;const dee=(e,t,r=0)=>(hee.encode(e,t,r),t),fee=e=>hee.encodingLength(e),pee=(e,t)=>{const r=t.byteLength,n=fee(e),i=n+fee(r),s=new Uint8Array(i+r);return dee(e,s,0),dee(r,s,n),s.set(t,i),new yee(e,r,t,s)};class yee{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const gee=({name:e,code:t,encode:r})=>new mee(e,t,r);class mee{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?pee(this.code,t):t.then((e=>pee(this.code,e)))}throw Error("Unknown type, must be binary type")}}const wee=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),bee=gee({name:"sha2-256",code:18,encode:wee("SHA-256")}),vee=gee({name:"sha2-512",code:19,encode:wee("SHA-512")}),Eee=0,_ee="identity",See=t9,Aee=e=>pee(Eee,See(e)),Iee={code:Eee,name:_ee,encode:See,digest:Aee},Cee="raw",kee=85,Tee=e=>t9(e),Ree=e=>t9(e),Pee=new TextEncoder,xee=new TextDecoder,Dee="json",Oee=512,Nee=e=>Pee.encode(JSON.stringify(e)),Lee=e=>JSON.parse(xee.decode(e));new WeakMap;class Bee{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==webrtc_peer_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==webrtc_peer_node_modules_multiformats_src_cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Bee.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return Bee.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Bee.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return webrtc_peer_node_modules_multiformats_src_cid_format(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Bee)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new Bee(e,r,n,i||webrtc_peer_node_modules_multiformats_src_cid_encodeCID(e,r,n.bytes))}if(!0===t[webrtc_peer_node_modules_multiformats_src_cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,i=Digest.decode(r);return Bee.create(e,n,i)}return null}static create(e,t,r){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==webrtc_peer_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${webrtc_peer_node_modules_multiformats_src_cid_DAG_PB_CODE}) block encoding`);return new Bee(e,t,r,r.bytes);case 1:{const n=webrtc_peer_node_modules_multiformats_src_cid_encodeCID(e,t,r.bytes);return new Bee(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Bee.create(0,webrtc_peer_node_modules_multiformats_src_cid_DAG_PB_CODE,e)}static createV1(e,t){return Bee.create(1,e,t)}static decode(e){const[t,r]=Bee.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Bee.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Digest.Digest(t.multihashCode,t.digestSize,i,n),o=0===t.version?Bee.createV0(s):Bee.createV1(t.codec,s);return[o,e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),i=webrtc_peer_node_modules_multiformats_src_cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a,l=c-s;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:l,size:c}}static parse(e,t){const[r,n]=webrtc_peer_node_modules_multiformats_src_cid_parseCIDtoBytes(e,t),i=Bee.decode(n);return webrtc_peer_node_modules_multiformats_src_cid_baseCache(i).set(r,e),i}}Symbol.for("@ipld/js-cid/CID");const Uee={...Pt,...xt,...Dt,...Ot,...Nt,...Lt,...Bt,...Ut,...Mt,...jt};function Mee(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function jee(e=0){return null!=globalThis.Buffer?.allocUnsafe?Mee(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Vee(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const zee=Vee("utf8","u",(e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)}),(e=>{const t=new TextEncoder;return t.encode(e.substring(1))})),Fee=Vee("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=jee(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),$ee={utf8:zee,"utf-8":zee,hex:Uee.base16,latin1:Fee,ascii:Fee,binary:Fee,...Uee};var Kee=$ee;function qee(e,t="utf8"){const r=Kee[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}const Hee=65536,Gee=5e3;class Wee{constructor(e,t){this.label=e.label,this.open=d3(),this.channel=e,this.channel.binaryType="arraybuffer",this.log=t.log,"number"===typeof this.channel.bufferedAmountLowThreshold&&(this.channel.bufferedAmountLowThreshold=Hee),e.addEventListener("message",(e=>{t.onMessage(e)})),e.addEventListener("bufferedamountlow",(()=>{this.log("stop backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open.resolve()})),e.addEventListener("open",(()=>{this.open.resolve(),t.onOpen()})),e.addEventListener("close",(()=>{t.onClose()})),e.addEventListener("error",(r=>{if("Transport channel closed"===r.error?.message)return this.close();t.log.error('channel encounter an error in state "%s" message: "%s" detail: "%s',e.readyState,r.error?.message,r.error?.errorDetail);const n=r.error instanceof Error?r.error:new Error(`datachannel error: ${r.error?.message} ${r.error?.errorDetail}`);t.onError(mn(n,"ERR_DATA_CHANNEL"))}));let r=!1;this.closingInterval=setInterval((()=>{"closing"===e.readyState?(r&&t.onClose(),r=!0):r=!1}),Gee)}async send(e){await this.open.promise,this.channel.send(e),this.channel.bufferedAmount>Hee&&(this.log("start backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open=d3())}close(){clearInterval(this.closingInterval),this.channel.close()}get bufferedAmount(){return this.channel.bufferedAmount}}var Yee=r(5780);const Jee={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}]};function Qee(){if("undefined"===typeof globalThis)throw mn(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");const e={RTCPeerConnection:globalThis.RTCPeerConnection??globalThis.mozRTCPeerConnection??globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription??globalThis.mozRTCSessionDescription??globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate??globalThis.mozRTCIceCandidate??globalThis.webkitRTCIceCandidate};if(null==e.RTCPeerConnection)throw mn(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");return e}class Xee extends o0{constructor(e){super(),this.id=e.id??qee(J7(4),"hex").slice(0,7),this.log=gn(`libp2p:webrtc-peer:${e.logPrefix}:${this.id}`),this.wrtc=e.wrtc??Qee(),this.peerConnection=new this.wrtc.RTCPeerConnection(Object.assign({},Jee,e.peerConnectionConfig)),this.closed=!1,this.connected=d3(),this.source=LR(),this.sink=async e=>{if(await this.connected.promise,null==this.channel)throw mn(new Error("Connected but no channel?!"),"ERR_DATA_CHANNEL");for await(const t of e)await this.channel.send(t);await this.close()}}handleDataChannelEvent(e){const t=e.channel;null!=t?this.channel=new Wee(t,{log:this.log,onMessage:e=>{this.source.push(new Uint8Array(e.data))},onOpen:()=>{this.connected.resolve(),this.dispatchEvent(new c0("ready"))},onClose:()=>{this.close().catch((e=>{this.log("error closing connection after channel close",e)}))},onError:e=>{this.close(e).catch((e=>{this.log("error closing connection after channel error",e)}))}}):this.close(mn(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL")).catch((e=>{this.log("Error closing after event channel was found to be null",e)}))}async close(e){if(this.closed=!0,null==e&&null!=this.channel)while(this.channel.bufferedAmount>0)await Yee(100);this.channel?.close(),this.peerConnection.close(),this.source.end(e),this.dispatchEvent(new c0("close"))}}class Zee extends o0{constructor(e){super(),this.log=e.log,this.peerConnection=e.peerConnection,this.wrtc=e.wrtc,this.status="idle",this.peerConnection.addEventListener("negotiationneeded",(()=>{this.log("peer connection negotiation needed"),this.handleRenegotiate({type:"renegotiate"}).catch((e=>{this.log.error("could not renegotiate %o",e)}))}))}async handleSignal(e){return this.log('incoming signal "%s"',e.type),"offer"===e.type?await this.handleOffer(e):"answer"===e.type?await this.handleAnswer(e):"candidate"===e.type?await this.handleCandidate(e):"renegotiate"===e.type?await this.handleRenegotiate(e):"goodbye"===e.type?await this.handleGoodye(e):void this.log(`Unknown signal type ${e.type}`)}async handleOffer(e){}async handleAnswer(e){}async handleRenegotiate(e){}async handleGoodye(e){this.peerConnection.close()}async handleCandidate(e){const t=new this.wrtc.RTCIceCandidate(e.candidate);try{await this.peerConnection.addIceCandidate(t)}catch(WV){if(null!=t.address&&!t.address.endsWith(".local"))throw mn(WV,"ERR_ADD_ICE_CANDIDATE");this.log("ignoring unsupported ICE candidate.")}}}const ete=gn("libp2p:webrtc-peer:receiver");class tte extends Xee{constructor(e={}){super({...e,logPrefix:"receiver"}),this.handshake=new rte({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,answerOptions:e.answerOptions}),this.handshake.addEventListener("signal",(e=>this.dispatchEvent(new c0("signal",{detail:e.detail})))),this.peerConnection.addEventListener("datachannel",(e=>{this.handleDataChannelEvent(e)}))}handleSignal(e){this.handshake.handleSignal(e).catch((t=>{this.log("error handling signal %o %o",e,t)}))}}class rte extends Zee{constructor(e){super(e),this.options=e,this.status="idle",this.iceCandidates=[]}async handleRenegotiate(){ete.trace("renegotiate"),this.dispatchEvent(new c0("signal",{detail:{type:"renegotiate"}}))}async handleOffer(e){await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(e));for(const r of this.iceCandidates)await this.handleCandidate(r);this.iceCandidates=[];const t=await this.peerConnection.createAnswer(this.options.answerOptions);await this.peerConnection.setLocalDescription(t),ete.trace("handle offer",this.peerConnection.localDescription),this.dispatchEvent(new c0("signal",{detail:this.peerConnection.localDescription??t}))}async handleCandidate(e){null!=this.peerConnection.remoteDescription&&null!=this.peerConnection.remoteDescription.type?await super.handleCandidate(e):this.iceCandidates.push(e)}}const nte=e=>{const t=e.on||e.addListener||e.addEventListener,r=e.off||e.removeListener||e.removeEventListener;if(!t||!r)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:r.bind(e)}};function ite(e,t,r){let n;const i=new Promise(((i,s)=>{if(r={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...r},!(r.count>=0)||r.count!==Number.POSITIVE_INFINITY&&!Number.isInteger(r.count))throw new TypeError("The `count` option should be at least 0 or more");const o=[t].flat(),a=[],{addListener:c,removeListener:l}=nte(e),u=(...e)=>{const t=r.multiArgs?e:e[0];r.filter&&!r.filter(t)||(a.push(t),r.count===a.length&&(n(),i(a)))},h=e=>{n(),s(e)};n=()=>{for(const e of o)l(e,u);for(const e of r.rejectionEvents)l(e,h)};for(const e of o)c(e,u);for(const e of r.rejectionEvents)c(e,h);r.resolveImmediately&&i(a)}));if(i.cancel=n,"number"===typeof r.timeout){const e=eb(i,r.timeout);return e.cancel=n,e}return i}function ste(e,t,r){"function"===typeof r&&(r={filter:r}),r={...r,count:1,resolveImmediately:!1};const n=ite(e,t,r),i=n.then((e=>e[0]));return i.cancel=n.cancel,i}const ote=gn("libp2p:webrtc-peer:initator"),ate=1e3;class cte extends Xee{constructor(e={}){super({...e,logPrefix:"initiator"}),this.handleDataChannelEvent({channel:this.peerConnection.createDataChannel(e.dataChannelLabel??qee(J7(20),"hex").slice(0,7),e.dataChannelInit)}),this.handshake=new lte({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,offerOptions:e.offerOptions}),this.handshake.addEventListener("signal",(e=>{this.dispatchEvent(new c0("signal",{detail:e.detail}))}))}handleSignal(e){this.handshake.handleSignal(e).catch((t=>{this.log("error handling signal %o %o",e,t)}))}}class lte extends Zee{constructor(e){super(e),this.options=e,this.status="idle",this.peerConnection.addEventListener("icecandidate",(e=>{if(null==e.candidate)return;const t={type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}};ote.trace("create candidate",t),this.dispatchEvent(new c0("signal",{detail:t})),this.dispatchEvent(new c0("ice-candidate"))}))}async handleRenegotiate(){if("negotiating"===this.status)return void this.log("already negotiating, queueing");this.status="negotiating";const e=await this.peerConnection.createOffer(this.options.offerOptions);await this.peerConnection.setLocalDescription(e),await ste(this,"ice-candidate"),await Yee(ate),ote.trace("renegotiate",this.peerConnection.localDescription),this.dispatchEvent(new c0("signal",{detail:this.peerConnection.localDescription??e}))}async handleAnswer(e){ote.trace("handle answer",e),await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(e)),this.status="idle"}}const ute=gn("libp2p:webrtc-star:socket");function hte(e,t){const{sink:r,source:n}=e,i={remoteAddr:t.remoteAddr,async sink(e){null!=t.signal&&(e=J2(e,t.signal));try{await r(e)}catch(WV){"aborted"!==WV.type&&ute.error(WV)}},source:null!=t.signal?J2(n,t.signal):n,timeline:{open:Date.now()},async close(){if(e.closed)return;const t=Date.now(),r=setTimeout((()=>{if(null!=i.remoteAddr){const{host:e,port:r}=i.remoteAddr.toOptions();ute("timeout closing socket to %s:%s after %dms, destroying it manually",e,r,Date.now()-t)}e.closed||e.close().catch((e=>{ute.error("could not close socket",e)}))}),y8);try{await e.close()}finally{clearTimeout(r)}}};return e.addEventListener("close",(()=>{null==i.timeline.close&&(i.timeline.close=Date.now())}),{once:!0}),i}function dte(e){const t=e.toString().split("/"),r=e.protos()[1].name,n=e.protos()[2].name,i=e.stringTuples()[1][1];if("tcp"!==r||"ws"!==n&&"wss"!==n)throw new Error(`invalid multiaddr: ${e.toString()}`);if(!kp(e))return`http://${t[2]}:${t[4]}`;if("ws"===n)return`http://${t[2]}${null==i||"80"===i?"":`:${i}`}`;if("wss"===n)return`https://${t[2]}${null==i||"443"===i?"":`:${i}`}`;throw new Error("invalid multiaddr: "+e.toString())}function fte(e){const t="/libp2p-webrtc-star";if(e.startsWith(t)){e=e.substring(t.length,e.length);let r=Pp(e);const n=r.stringTuples().filter((e=>421===e[0]))[0];if(null==n[1])throw new Error("invalid multiaddr: "+e);r=r.decapsulate("p2p"),r=r.encapsulate("/p2p-webrtc-star"),r=r.encapsulate(`/p2p/${n[1]}`),e=r.toString()}return e}const pte=gn("libp2p:webrtc-star:listener"),yte={transports:["websocket"],path:"/socket.io-next/"};class gte extends o0{constructor(e,t,r,n,i){super(),this.signallingAddr=t,this.socket=Y7(e,yte),this.connections=[],this.channels=new Map,this.pendingSignals=new Map,this.upgrader=r,this.handler=n,this.channelOptions=i,this.handleWsHandshake=this.handleWsHandshake.bind(this);let s=!1;this.socket.on("connect_error",(e=>{s&&"TransportError"===e.type||this.dispatchEvent(new c0("error",{detail:e}))})),this.socket.on("error",(e=>{this.dispatchEvent(new c0("error",{detail:e}))})),this.socket.on("ws-handshake",this.handleWsHandshake),this.socket.on("ws-peer",(e=>{this.dispatchEvent(new c0("peer",{detail:e}))})),this.socket.on("connect",(()=>{this.socket.emit("ss-join",this.signallingAddr.toString()),s&&this.dispatchEvent(new c0("reconnect"))})),this.socket.once("connect",(()=>{s=!0,this.dispatchEvent(new c0("listening"))})),this.socket.on("disconnect",(()=>{this.dispatchEvent(new c0("disconnect"))}))}_createChannel(e,t,r){const n={...this.channelOptions},i=new tte(n),s=e=>{const t=e.detail;pte.error("incoming connection errored",t)};return i.addEventListener("error",s),i.addEventListener("close",(()=>{i.removeEventListener("error",s)}),{once:!0}),i.addEventListener("signal",(n=>{const i=n.detail;this.socket.emit("ss-handshake",{intentId:e,srcMultiaddr:t,dstMultiaddr:r,answer:!0,signal:i})})),i.addEventListener("ready",(()=>{const t=hte(i,{remoteAddr:this.signallingAddr});pte("new inbound connection %s",t.remoteAddr);try{this.upgrader.upgradeInbound(t).then((r=>{pte("inbound connection %s upgraded",t.remoteAddr),this.connections.push(t);const n=()=>{this.connections=this.connections.filter((e=>e!==t)),this.channels.delete(e),this.pendingSignals.delete(e)};i.addEventListener("close",n,{once:!0}),this.dispatchEvent(new c0("connection",{detail:r})),this.handler(r)})).catch((e=>{pte.error("inbound connection failed to upgrade",e),t.close().catch((e=>{pte.error("inbound connection failed to close after failing to upgrade",e)}))}))}catch(WV){pte.error("inbound connection failed to upgrade",WV),t.close().catch((e=>{pte.error("inbound connection failed to close after failing to upgrade",e)}))}}),{once:!0}),i}handleWsHandshake(e){if(pte('incoming handshake. signal type "%s" is answer %s',e.signal.type,e.answer),!0===e.answer||null!=e.err||null==e.intentId)return;const t=e.intentId;let r=this.pendingSignals.get(t);null==r&&(r=[],this.pendingSignals.set(t,r)),r.push(e);let n=this.channels.get(t);if(null==n){if("offer"!==e.signal.type)return void pte("handshake is not an offer and channel does not exist, buffering until we receive an offer");pte("creating new channel to handle offer handshake"),n=this._createChannel(e.intentId,e.srcMultiaddr,e.dstMultiaddr),this.channels.set(t,n)}else pte("channel already exists, using it to handle handshake");while(r.length>0){const e=r.shift();null!=e?.signal&&n.handleSignal(e.signal)}}async close(){this.socket.emit("ss-leave",this.signallingAddr.toString()),this.socket.removeAllListeners(),this.socket.close(),await Promise.all([...this.connections.map((async e=>await e.close())),...Array.from(this.channels.values()).map((async e=>await e.close()))]),this.dispatchEvent(new c0("close"))}}class mte extends o0{constructor(e,t,r,n,i){super(),this.upgrader=e,this.handler=t,this.peerId=r,this.transport=n,this.options=i}async listen(e){if(null!=this.listeningAddr)throw mn(new Error("listener already in use"),"ERR_ALREADY_LISTENING");const t=d3();let r;this.listeningAddr=e,r=e.protoCodes().includes(f8)?e:e.encapsulate(`/p2p/${this.peerId.toString()}`);const n=this.signallingUrl=dte(e);pte("connecting to signalling server on: %s",this.signallingUrl);const i=new gte(this.signallingUrl,r,this.upgrader,this.handler,this.options.channelOptions);return i.addEventListener("error",(e=>{const r=e.detail;pte("error connecting to signalling server %o",r),i.close().catch((e=>{pte.error("error closing server after error",e)})),t.reject(r)})),i.addEventListener("listening",(()=>{pte("connected to signalling server"),this.dispatchEvent(new c0("listening")),t.resolve()})),i.addEventListener("peer",(e=>{this.transport.peerDiscovered(e.detail)})),i.addEventListener("connection",(t=>{const r=t.detail;if(null==r.remoteAddr)try{r.remoteAddr=e.decapsulateCode(f8).encapsulate(`/p2p/${r.remotePeer.toString()}`)}catch(WV){pte.error("could not determine remote address",WV)}this.dispatchEvent(new c0("connection",{detail:r}))})),i.addEventListener("disconnect",(()=>{this.transport.sigServers.delete(n)})),i.addEventListener("reconnect",(()=>{this.transport.sigServers.set(n,i)})),this.transport.sigServers.set(this.signallingUrl,i),await t.promise}async close(){if(null!=this.signallingUrl){const e=this.transport.sigServers.get(this.signallingUrl);null!=e&&(await e.close(),this.transport.sigServers.delete(this.signallingUrl))}this.dispatchEvent(new c0("close")),this.listeningAddr=void 0}getAddrs(){return null!=this.listeningAddr?[this.listeningAddr]:[]}}function wte(e,t,r,n,i){return new mte(e,t,r,n,i)}const bte=Symbol.for("@libp2p/transport");const vte=Symbol.for("@libp2p/peer-discovery");const Ete="RTCPeerConnection"in globalThis,_te=gn("libp2p:webrtc-star"),Ste=()=>{};class Ate extends o0{constructor(){super(...arguments),this.started=!1}get[vte](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star-discovery"}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}dispatchEvent(e){return!!this.isStarted()&&super.dispatchEvent(e)}}class Ite{constructor(e){this.components=new S2,null!=e?.wrtc&&(this.wrtc=e.wrtc),this.sigServers=new Map,this.discovery=new Ate,this.peerDiscovered=this.peerDiscovered.bind(this)}get[bte](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star"}init(e){this.components=e}async dial(e,t){const r=await this._connect(e,t),n=hte(r,{remoteAddr:e,signal:t.signal});_te("new outbound connection %s",n.remoteAddr);const i=await t.upgrader.upgradeOutbound(n);return _te("outbound connection %s upgraded",n.remoteAddr),i}async _connect(e,t){if(!0===t.signal?.aborted)throw new W2;const r={...t.channelOptions??{}};null!=this.wrtc&&(r.wrtc=this.wrtc);const n=e.toOptions(),i=C_(J7(36),"hex");return await new Promise(((s,o)=>{const a=this.sigServers.get(dte(e));if(null==a?.socket)return o(mn(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let c=!1;_te("dialing %s:%s",n.host,n.port);const l=new cte(r),u=e=>{const t=e.detail;if(!c){const e=`connection error ${n.host}:${n.port}: ${t.message}`;_te.error(e),f(t)}},h=()=>{c=!0,_te("connection opened %s:%s",n.host,n.port),f()},d=()=>{_te.error("connection aborted %s:%s",n.host,n.port),l.close().finally((()=>{f(new W2)}))},f=e=>{l.removeEventListener("ready",h),t.signal?.removeEventListener("abort",d),null==e?s(l):o(e)};l.addEventListener("ready",h,{once:!0}),l.addEventListener("close",(()=>{l.removeEventListener("error",u)})),t.signal?.addEventListener("abort",d),l.addEventListener("signal",(t=>{const r=t.detail;a.socket.emit("ss-handshake",{intentId:i,srcMultiaddr:a.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:r})})),a.socket.on("ws-handshake",(e=>{e.intentId===i&&null!=e.err&&l.close().finally((()=>{o(mn(new Error(e.err),"ERR_SIGNALLING_FAILED"))})),e.intentId!==i||null==e.answer||l.closed||l.handleSignal(e.signal)}))}))}createListener(e){if(!Ete&&null==this.wrtc)throw mn(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");return e.channelOptions=e.channelOptions??{},null!=this.wrtc&&(e.channelOptions.wrtc=this.wrtc),wte(e.upgrader,e.handler??Ste,this.components.getPeerId(),this,e)}filter(e){return e=Array.isArray(e)?e:[e],e.filter((e=>!e.protoCodes().includes(p8)&&Kp.matches(e)))}peerDiscovered(e){_te("peer discovered: %s",e),e=fte(e);const t=Pp(e),r=t.getPeerId();if(null==r)return;const n=s_(r);this.discovery.dispatchEvent(new c0("peer",{detail:{id:n,multiaddrs:[t],protocols:[]}}))}}function Cte(){const e=new Ite,t={transports:[e],peerDiscovery:[e.discovery],connectionManager:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4,autoDial:!0},nat:{enabled:!1},metrics:{enabled:!0}};return t}var kte,Tte;async function*Rte(e,t){yield*qR(e,(async e=>(await t.addressBook.add(e.id,e.multiaddrs),e)))}function Pte(e){const t=new Set;return PR(e,(e=>!t.has(e.id.toString())&&(t.add(e.id.toString()),!0)))}async function*xte(e,t=1){let r=0;for await(const n of e)r++,yield n;if(r<t)throw mn(new Error("not found"),"NOT_FOUND")}(function(e){e["NOT_STARTED_YET"]="The libp2p node is not started yet",e["DHT_DISABLED"]="DHT is not available",e["PUBSUB_DISABLED"]="PubSub is not available",e["CONN_ENCRYPTION_REQUIRED"]="At least one connection encryption module is required",e["ERR_TRANSPORTS_REQUIRED"]="At least one transport module is required",e["ERR_PROTECTOR_REQUIRED"]="Private network is enforced, but no protector was provided",e["NOT_FOUND"]="Not found"})(kte||(kte={})),function(e){e["DHT_DISABLED"]="ERR_DHT_DISABLED",e["ERR_PUBSUB_DISABLED"]="ERR_PUBSUB_DISABLED",e["PUBSUB_NOT_STARTED"]="ERR_PUBSUB_NOT_STARTED",e["DHT_NOT_STARTED"]="ERR_DHT_NOT_STARTED",e["CONN_ENCRYPTION_REQUIRED"]="ERR_CONN_ENCRYPTION_REQUIRED",e["ERR_TRANSPORTS_REQUIRED"]="ERR_TRANSPORTS_REQUIRED",e["ERR_PROTECTOR_REQUIRED"]="ERR_PROTECTOR_REQUIRED",e["ERR_PEER_DIAL_INTERCEPTED"]="ERR_PEER_DIAL_INTERCEPTED",e["ERR_CONNECTION_INTERCEPTED"]="ERR_CONNECTION_INTERCEPTED",e["ERR_INVALID_PROTOCOLS_FOR_STREAM"]="ERR_INVALID_PROTOCOLS_FOR_STREAM",e["ERR_CONNECTION_ENDED"]="ERR_CONNECTION_ENDED",e["ERR_CONNECTION_FAILED"]="ERR_CONNECTION_FAILED",e["ERR_NODE_NOT_STARTED"]="ERR_NODE_NOT_STARTED",e["ERR_ALREADY_ABORTED"]="ERR_ALREADY_ABORTED",e["ERR_TOO_MANY_ADDRESSES"]="ERR_TOO_MANY_ADDRESSES",e["ERR_NO_VALID_ADDRESSES"]="ERR_NO_VALID_ADDRESSES",e["ERR_RELAYED_DIAL"]="ERR_RELAYED_DIAL",e["ERR_DIALED_SELF"]="ERR_DIALED_SELF",e["ERR_DISCOVERED_SELF"]="ERR_DISCOVERED_SELF",e["ERR_DUPLICATE_TRANSPORT"]="ERR_DUPLICATE_TRANSPORT",e["ERR_ENCRYPTION_FAILED"]="ERR_ENCRYPTION_FAILED",e["ERR_HOP_REQUEST_FAILED"]="ERR_HOP_REQUEST_FAILED",e["ERR_INVALID_KEY"]="ERR_INVALID_KEY",e["ERR_INVALID_MESSAGE"]="ERR_INVALID_MESSAGE",e["ERR_INVALID_PARAMETERS"]="ERR_INVALID_PARAMETERS",e["ERR_INVALID_PEER"]="ERR_INVALID_PEER",e["ERR_MUXER_UNAVAILABLE"]="ERR_MUXER_UNAVAILABLE",e["ERR_NOT_FOUND"]="ERR_NOT_FOUND",e["ERR_TIMEOUT"]="ERR_TIMEOUT",e["ERR_TRANSPORT_UNAVAILABLE"]="ERR_TRANSPORT_UNAVAILABLE",e["ERR_TRANSPORT_DIAL_FAILED"]="ERR_TRANSPORT_DIAL_FAILED",e["ERR_UNSUPPORTED_PROTOCOL"]="ERR_UNSUPPORTED_PROTOCOL",e["ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED"]="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",e["ERR_INVALID_MULTIADDR"]="ERR_INVALID_MULTIADDR",e["ERR_SIGNATURE_NOT_VALID"]="ERR_SIGNATURE_NOT_VALID",e["ERR_FIND_SELF"]="ERR_FIND_SELF",e["ERR_NO_ROUTERS_AVAILABLE"]="ERR_NO_ROUTERS_AVAILABLE",e["ERR_CONNECTION_NOT_MULTIPLEXED"]="ERR_CONNECTION_NOT_MULTIPLEXED",e["ERR_NO_DIAL_TOKENS"]="ERR_NO_DIAL_TOKENS",e["ERR_KEYCHAIN_REQUIRED"]="ERR_KEYCHAIN_REQUIRED",e["ERR_INVALID_CMS"]="ERR_INVALID_CMS",e["ERR_MISSING_KEYS"]="ERR_MISSING_KEYS",e["ERR_NO_KEY"]="ERR_NO_KEY",e["ERR_INVALID_KEY_NAME"]="ERR_INVALID_KEY_NAME",e["ERR_INVALID_KEY_TYPE"]="ERR_INVALID_KEY_TYPE",e["ERR_KEY_ALREADY_EXISTS"]="ERR_KEY_ALREADY_EXISTS",e["ERR_INVALID_KEY_SIZE"]="ERR_INVALID_KEY_SIZE",e["ERR_KEY_NOT_FOUND"]="ERR_KEY_NOT_FOUND",e["ERR_OLD_KEY_NAME_INVALID"]="ERR_OLD_KEY_NAME_INVALID",e["ERR_NEW_KEY_NAME_INVALID"]="ERR_NEW_KEY_NAME_INVALID",e["ERR_PASSWORD_REQUIRED"]="ERR_PASSWORD_REQUIRED",e["ERR_PEM_REQUIRED"]="ERR_PEM_REQUIRED",e["ERR_CANNOT_READ_KEY"]="ERR_CANNOT_READ_KEY",e["ERR_MISSING_PRIVATE_KEY"]="ERR_MISSING_PRIVATE_KEY",e["ERR_MISSING_PUBLIC_KEY"]="ERR_MISSING_PUBLIC_KEY",e["ERR_INVALID_OLD_PASS_TYPE"]="ERR_INVALID_OLD_PASS_TYPE",e["ERR_INVALID_NEW_PASS_TYPE"]="ERR_INVALID_NEW_PASS_TYPE",e["ERR_INVALID_PASS_LENGTH"]="ERR_INVALID_PASS_LENGTH",e["ERR_NOT_IMPLEMENTED"]="ERR_NOT_IMPLEMENTED",e["ERR_WRONG_PING_ACK"]="ERR_WRONG_PING_ACK",e["ERR_INVALID_RECORD"]="ERR_INVALID_RECORD",e["ERR_ALREADY_SUCCEEDED"]="ERR_ALREADY_SUCCEEDED",e["ERR_NO_HANDLER_FOR_PROTOCOL"]="ERR_NO_HANDLER_FOR_PROTOCOL",e["ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS"]="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS",e["ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS"]="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS"}(Tte||(Tte={}));var Dte=r(7695),Ote=r(7187);const Nte=gn("libp2p:peer-routing");class Lte{constructor(e,t){this.components=e,this.routers=t.routers,this.refreshManagerInit=t.refreshManager??{},this.started=!1,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}isStarted(){return this.started}async start(){this.started||0===this.routers.length||null!=this.timeoutId||!1===this.refreshManagerInit.enabled||(this.timeoutId=(0,Dte.setDelayedInterval)(this._findClosestPeersTask,this.refreshManagerInit.interval,this.refreshManagerInit.bootDelay),this.started=!0)}async _findClosestPeersTask(){if(null==this.abortController)try{this.abortController=new Ql.TimeoutController(this.refreshManagerInit.timeout??1e4);try{(0,Ote.setMaxListeners)?.(1/0,this.abortController.signal)}catch{}await RR(this.getClosestPeers(this.components.getPeerId().toBytes(),{signal:this.abortController.signal}))}catch(WV){Nte.error(WV)}finally{this.abortController?.clear(),this.abortController=void 0}}async stop(){(0,Dte.clearDelayedInterval)(this.timeoutId),this.abortController?.abort(),this.started=!1}async findPeer(e,t){if(0===this.routers.length)throw mn(new Error("No peer routers available"),Tte.ERR_NO_ROUTERS_AVAILABLE);if(e.toString()===this.components.getPeerId().toString())throw mn(new Error("Should not try to find self"),Tte.ERR_FIND_SELF);const r=await QR(HR(...this.routers.map((r=>async function*(){try{yield await r.findPeer(e,t)}catch(WV){Nte.error(WV)}}()))),(e=>PR(e,Boolean)),(e=>Rte(e,this.components.getPeerStore())),(async e=>await Vq(e)));if(null!=r)return r;throw mn(new Error(kte.NOT_FOUND),Tte.ERR_NOT_FOUND)}async*getClosestPeers(e,t){if(0===this.routers.length)throw mn(new Error("No peer routers available"),Tte.ERR_NO_ROUTERS_AVAILABLE);yield*QR(HR(...this.routers.map((r=>r.getClosestPeers(e,t)))),(e=>Rte(e,this.components.getPeerStore())),(e=>Pte(e)),(e=>xte(e)))}}class Bte{constructor(e,t){this.routers=t.routers??[],this.started=!1,this.components=e}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}async*findProviders(e,t={}){if(0===this.routers.length)throw mn(new Error("No content this.routers available"),Tte.ERR_NO_ROUTERS_AVAILABLE);yield*QR(HR(...this.routers.map((r=>r.findProviders(e,t)))),(e=>Rte(e,this.components.getPeerStore())),(e=>Pte(e)),(e=>xte(e)))}async provide(e,t={}){if(0===this.routers.length)throw mn(new Error("No content routers available"),Tte.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map((async r=>await r.provide(e,t))))}async put(e,t,r){if(!this.isStarted())throw mn(new Error(kte.NOT_STARTED_YET),Tte.DHT_NOT_STARTED);const n=this.components.getDHT();null!=n&&await RR(n.put(e,t,r))}async get(e,t){if(!this.isStarted())throw mn(new Error(kte.NOT_STARTED_YET),Tte.DHT_NOT_STARTED);const r=this.components.getDHT();if(null!=r)for await(const n of r.get(e,t))if("VALUE"===n.name)return n.value;throw mn(new Error(kte.NOT_FOUND),Tte.ERR_NOT_FOUND)}async*getMany(e,t,r){if(!this.isStarted())throw mn(new Error(kte.NOT_STARTED_YET),Tte.DHT_NOT_STARTED);if(null==t||0===t)return;let n=0;const i=this.components.getDHT();if(null!=i)for await(const s of i.get(e,r))if("VALUE"===s.name&&(yield{from:s.from,val:s.value},n++,n===t))break;if(0===n)throw mn(new Error(kte.NOT_FOUND),Tte.ERR_NOT_FOUND)}}function Ute(e){const t=e.getPeerId();if(null==t)throw mn(new Error(`${e.toString()} does not have a valid peer type`),Tte.ERR_INVALID_MULTIADDR);try{return s_(t)}catch(WV){throw mn(new Error(`${e.toString()} is not a valid peer type`),Tte.ERR_INVALID_MULTIADDR)}}function Mte(e){if(YE(e))return{id:e,multiaddrs:[],protocols:[]};let t;return"string"===typeof e&&(e=Pp(e)),Tp(e)&&(t=e,e=Ute(e)),{id:e,multiaddrs:null!=t?[t]:[],protocols:[]}}const jte=e=>e;class Vte extends o0{constructor(e,t){super();const{listen:r=[],announce:n=[]}=t;this.components=e,this.listen=new Set(r.map((e=>e.toString()))),this.announce=new Set(n.map((e=>e.toString()))),this.observed=new Set,this.announceFilter=t.announceFilter??jte}getListenAddrs(){return Array.from(this.listen).map((e=>Pp(e)))}getAnnounceAddrs(){return Array.from(this.announce).map((e=>Pp(e)))}getObservedAddrs(){return Array.from(this.observed).map((e=>Pp(e)))}addObservedAddr(e){let t=Pp(e);const r=t.getPeerId();if(null!=r){const e=s_(r);e.equals(this.components.getPeerId())&&(t=t.decapsulate(Pp(`/p2p/${this.components.getPeerId().toString()}`)))}const n=t.toString();this.observed.has(n)||(this.observed.add(n),this.dispatchEvent(new c0("change:addresses")))}getAddresses(){let e=this.getAnnounceAddrs().map((e=>e.toString()));0===e.length&&(e=this.components.getTransportManager().getAddrs().map((e=>e.toString()))),e=e.concat(this.getObservedAddrs().map((e=>e.toString())));const t=new Set(e);return this.announceFilter(Array.from(t).map((e=>Pp(e)))).map((e=>e.getPeerId()===this.components.getPeerId().toString()?e:e.encapsulate(`/p2p/${this.components.getPeerId().toString()}`)))}}const zte=gn("libp2p:connection-manager:latency-monitor:visibility-change-emitter");class Fte extends o0{constructor(){super(),this.hidden="hidden",this.visibilityChange="visibilityChange",null!=globalThis.document&&(this._initializeVisibilityVarNames(),this._addVisibilityChangeListener())}_initializeVisibilityVarNames(){let e="hidden",t="visibilitychange";"undefined"!==typeof globalThis.document.hidden?(e="hidden",t="visibilitychange"):"undefined"!==typeof globalThis.document.mozHidden?(e="mozHidden",t="mozvisibilitychange"):"undefined"!==typeof globalThis.document.msHidden?(e="msHidden",t="msvisibilitychange"):"undefined"!==typeof globalThis.document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),this.hidden=e,this.visibilityChange=t}_addVisibilityChangeListener(){"undefined"===typeof globalThis.document.addEventListener||"undefined"===typeof document[this.hidden]?zte("Checking page visibility requires a browser that supports the Page Visibility API."):globalThis.document.addEventListener(this.visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(void 0!==this.hidden&&void 0!==document[this.hidden])return null==document[this.hidden]}_handleVisibilityChange(){const e=!1===globalThis.document[this.hidden];zte(e?"Page Visible":"Page Hidden"),this.dispatchEvent(new c0("visibilityChange",{detail:e}))}}const $te=gn("libp2p:connection-manager:latency-monitor");class Kte extends o0{constructor(e={}){super();const{latencyCheckIntervalMs:t,dataEmitIntervalMs:r,asyncTestFn:n,latencyRandomPercentage:i}=e;this.latencyCheckIntervalMs=t??500,this.latencyRandomPercentage=i??10,this.latencyCheckMultiply=this.latencyRandomPercentage/100*2*this.latencyCheckIntervalMs,this.latencyCheckSubtract=this.latencyCheckMultiply/2,this.dataEmitIntervalMs=null===r||0===r?void 0:r??5e3,$te("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",this.latencyCheckIntervalMs,this.dataEmitIntervalMs),null!=this.dataEmitIntervalMs?$te("Expecting ~%s events per summary",this.latencyCheckIntervalMs/this.dataEmitIntervalMs):$te("Not emitting summaries"),this.asyncTestFn=n,null!=globalThis.process?.hrtime?($te("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{const t=this.now(e);return 1e3*t[0]+t[1]/1e6}):"undefined"!==typeof window&&null!=window.performance?.now?($te("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):($te("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this.latencyData=this.initLatencyData()}start(){qte()&&(this.visibilityChangeEmitter=new Fte,this.visibilityChangeEmitter.addEventListener("visibilityChange",(e=>{const{detail:t}=e;t?this._startTimers():(this._emitSummary(),this._stopTimers())}))),!0===this.visibilityChangeEmitter?.isVisible()&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){null==this.checkLatencyID&&(this.checkLatency(),null!=this.dataEmitIntervalMs&&(this.emitIntervalID=setInterval((()=>this._emitSummary()),this.dataEmitIntervalMs),"function"===typeof this.emitIntervalID.unref&&this.emitIntervalID.unref()))}_stopTimers(){null!=this.checkLatencyID&&(clearTimeout(this.checkLatencyID),this.checkLatencyID=void 0),null!=this.emitIntervalID&&(clearInterval(this.emitIntervalID),this.emitIntervalID=void 0)}_emitSummary(){const e=this.getSummary();e.events>0&&this.dispatchEvent(new c0("data",{detail:e}))}getSummary(){const e={events:this.latencyData.events,minMs:this.latencyData.minMs,maxMs:this.latencyData.maxMs,avgMs:this.latencyData.events>0?this.latencyData.totalMs/this.latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this.latencyData.startTime)};return this.latencyData=this.initLatencyData(),$te.trace("Summary: %O",e),e}checkLatency(){const e=Math.random()*this.latencyCheckMultiply-this.latencyCheckSubtract,t={deltaOffset:Math.ceil(this.latencyCheckIntervalMs+e),startTime:this.now()},r=()=>{if(null==this.checkLatencyID)return;const e=this.getDeltaMS(t.startTime)-t.deltaOffset;this.checkLatency(),this.latencyData.events++,this.latencyData.minMs=Math.min(this.latencyData.minMs,e),this.latencyData.maxMs=Math.max(this.latencyData.maxMs,e),this.latencyData.totalMs+=e,$te.trace("MS: %s Data: %O",e,this.latencyData)};$te.trace("localData: %O",t),this.checkLatencyID=setTimeout((()=>{null!=this.asyncTestFn?(t.deltaOffset=0,t.startTime=this.now(),this.asyncTestFn(r)):(t.deltaOffset-=1,r())}),t.deltaOffset),"function"===typeof this.checkLatencyID.unref&&this.checkLatencyID.unref()}initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}}function qte(){return"undefined"!==typeof globalThis.window}var Hte=r(2916);const Gte="OPEN",Wte="CLOSING",Yte="CLOSED";function Jte(e,t){const r={[Symbol.iterator]:()=>r,next:()=>{const r=e.next(),n=r.value;if(!0===r.done||null==n){const e={done:!0,value:void 0};return e}return{done:!1,value:t(n)}}};return r}class Qte{constructor(e){if(this.map=new Map,null!=e)for(const[t,r]of e.entries())this.map.set(t.toString(),r)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(e){this.map.delete(e.toString())}entries(){return Jte(this.map.entries(),(e=>[s_(e[0]),e[1]]))}forEach(e){this.map.forEach(((t,r)=>{e(t,s_(r),this)}))}get(e){return this.map.get(e.toString())}has(e){return this.map.has(e.toString())}set(e,t){this.map.set(e.toString(),t)}keys(){return Jte(this.map.keys(),(e=>s_(e)))}values(){return this.map.values()}get size(){return this.map.size}}class Xte{constructor(e){if(this.set=new Set,null!=e)for(const t of e)this.set.add(t.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(e){this.set.add(e.toString())}clear(){this.set.clear()}delete(e){this.set.delete(e.toString())}entries(){return Jte(this.set.entries(),(e=>{const t=s_(e[0]);return[t,t]}))}forEach(e){this.set.forEach((t=>{const r=s_(t);e(r,r,this)}))}has(e){return this.set.has(e.toString())}values(){return Jte(this.set.values(),(e=>s_(e)))}intersection(e){const t=new Xte;for(const r of e)this.has(r)&&t.add(r);return t}difference(e){const t=new Xte;for(const r of this)e.has(r)||t.add(r);return t}union(e){const t=new Xte;for(const r of e)t.add(r);for(const r of this)t.add(r);return t}}class Zte{constructor(e){if(this.list=[],null!=e)for(const t of e)this.list.push(t.toString())}[Symbol.iterator](){return mapIterable(this.list.entries(),(e=>peerIdFromString(e[1])))}concat(e){const t=new Zte(this);for(const r of e)t.push(r);return t}entries(){return mapIterable(this.list.entries(),(e=>[e[0],peerIdFromString(e[1])]))}every(e){return this.list.every(((t,r)=>e(peerIdFromString(t),r,this)))}filter(e){const t=new Zte;return this.list.forEach(((r,n)=>{const i=peerIdFromString(r);e(i,n,this)&&t.push(i)})),t}find(e){const t=this.list.find(((t,r)=>e(peerIdFromString(t),r,this)));if(null!=t)return peerIdFromString(t)}findIndex(e){return this.list.findIndex(((t,r)=>e(peerIdFromString(t),r,this)))}forEach(e){this.list.forEach(((t,r)=>{e(peerIdFromString(t),r,this)}))}includes(e){return this.list.includes(e.toString())}indexOf(e){return this.list.indexOf(e.toString())}pop(){const e=this.list.pop();if(null!=e)return peerIdFromString(e)}push(...e){for(const t of e)this.list.push(t.toString())}shift(){const e=this.list.shift();if(null!=e)return peerIdFromString(e)}unshift(...e){let t=this.list.length;for(let r=e.length-1;r>-1;r--)this.list.unshift(e[r].toString());return t}get length(){return this.list.length}}const ere="keep-alive",tre=gn("libp2p:connection-manager"),rre={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4},nre="libp2p",ire="connection-manager",sre=6e4;class ore extends o0{constructor(e){if(super(),this.components=new S2,this.opts=Wr.call({ignoreUndefined:!0},rre,e),this.opts.maxConnections<this.opts.minConnections)throw mn(new Error("Connection Manager maxConnections must be greater than minConnections"),Tte.ERR_INVALID_PARAMETERS);tre("options: %o",this.opts),this.connections=new Map,this.started=!1,this._checkMetrics=this._checkMetrics.bind(this),this.latencyMonitor=new Kte({latencyCheckIntervalMs:e.pollInterval,dataEmitIntervalMs:e.pollInterval});try{(0,Ote.setMaxListeners)?.(1/0,this)}catch{}this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.startupReconnectTimeout=e.startupReconnectTimeout??sre,this.dialTimeout=e.dialTimeout??3e4}init(e){this.components=e,this.components.getMetrics()?.updateComponentMetric({system:nre,component:ire,metric:"connections",label:"direction",value:()=>{const e={inbound:0,outbound:0};for(const t of this.connections.values())for(const r of t)"inbound"===r.stat.direction?e.inbound++:e.outbound++;return e}}),this.components.getMetrics()?.updateComponentMetric({system:nre,component:ire,metric:"protocol-streams-total",label:"protocol",value:()=>{const e={};for(const t of this.connections.values())for(const r of t)for(const t of r.streams){const r=`${t.stat.direction} ${t.stat.protocol??"unnegotiated"}`;e[r]=(e[r]??0)+1}return e}}),this.components.getMetrics()?.updateComponentMetric({system:nre,component:ire,metric:"protocol-streams-per-connection-90th-percentile",label:"protocol",value:()=>{const e={};for(const r of this.connections.values())for(const t of r){const r={};for(const e of t.streams){const t=`${e.stat.direction} ${e.stat.protocol??"unnegotiated"}`;r[t]=(r[t]??0)+1}for(const[t,n]of Object.entries(r))e[t]=e[t]??[],e[t].push(n)}const t={};for(let[r,n]of Object.entries(e)){n=n.sort(((e,t)=>e-t));const e=Math.floor(.9*n.length);t[r]=n[e]}return t}})}isStarted(){return this.started}async start(){null!=this.components.getMetrics()&&(this.timer=this.timer??Hte(this._checkMetrics,this.opts.pollInterval)),this.latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this.latencyMonitor.addEventListener("data",this._onLatencyMeasure),this.started=!0,tre("started")}async afterStart(){this.components.getUpgrader().addEventListener("connection",this.onConnect),this.components.getUpgrader().addEventListener("connectionEnd",this.onDisconnect),Promise.resolve().then((async()=>{const e=[];for(const t of await this.components.getPeerStore().all()){const r=await this.components.getPeerStore().getTags(t.id),n=r.filter((e=>e.name===ere)).length>0;n&&e.push(t.id)}this.connectOnStartupController?.clear(),this.connectOnStartupController=new Ql.TimeoutController(this.startupReconnectTimeout);try{(0,Ote.setMaxListeners)?.(1/0,this.connectOnStartupController.signal)}catch{}await Promise.all(e.map((async e=>{await this.openConnection(e,{signal:this.connectOnStartupController?.signal}).catch((e=>{tre.error(e)}))})))})).catch((e=>{tre.error(e)})).finally((()=>{this.connectOnStartupController?.clear()}))}async beforeStop(){this.connectOnStartupController?.abort(),this.components.getUpgrader().removeEventListener("connection",this.onConnect),this.components.getUpgrader().removeEventListener("connectionEnd",this.onDisconnect)}async stop(){this.timer?.clear(),this.latencyMonitor.removeEventListener("data",this._onLatencyMeasure),this.latencyMonitor.stop(),this.started=!1,await this._close(),tre("stopped")}async _close(){const e=[];for(const t of this.connections.values())for(const r of t)e.push((async()=>{try{await r.close()}catch(WV){tre.error(WV)}})());tre("closing %d connections",e.length),await Promise.all(e),this.connections.clear()}async _checkMetrics(){const e=this.components.getMetrics();if(null!=e)try{const t=e.getGlobal().getMovingAverages(),r=t.dataReceived[this.opts.movingAverageInterval].movingAverage;await this._checkMaxLimit("maxReceivedData",r);const n=t.dataSent[this.opts.movingAverageInterval].movingAverage;await this._checkMaxLimit("maxSentData",n);const i=r+n;await this._checkMaxLimit("maxData",i),tre.trace("metrics update",i)}finally{this.timer=Hte(this._checkMetrics,this.opts.pollInterval)}}onConnect(e){this._onConnect(e).catch((e=>{tre.error(e)}))}async _onConnect(e){const{detail:t}=e;if(!this.started)return void await t.close();const r=t.remotePeer,n=r.toString(),i=this.connections.get(n);null!=i?i.push(t):this.connections.set(n,[t]),null!=r.publicKey&&await this.components.getPeerStore().keyBook.set(r,r.publicKey);const s=this.getConnections().length,o=s-this.opts.maxConnections;await this._checkMaxLimit("maxConnections",s,o),this.dispatchEvent(new c0("peer:connect",{detail:t}))}onDisconnect(e){const{detail:t}=e;if(!this.started)return;const r=t.remotePeer.toString();let n=this.connections.get(r);null!=n&&n.length>1?(n=n.filter((e=>e.id!==t.id)),this.connections.set(r,n)):null!=n&&(this.connections.delete(r),this.dispatchEvent(new c0("peer:disconnect",{detail:t})),this.components.getMetrics()?.onPeerDisconnected(t.remotePeer))}getConnections(e){if(null!=e)return this.connections.get(e.toString())??[];let t=[];for(const r of this.connections.values())t=t.concat(r);return t}async openConnection(e,t={}){tre("dial to %p",e);const r=this.getConnections(e);if(r.length>0)return tre("had an existing connection to %p",e),r[0];let n;if(null==t?.signal){n=new Ql.TimeoutController(this.dialTimeout),t.signal=n.signal;try{(0,Ote.setMaxListeners)?.(1/0,n.signal)}catch{}}try{const r=await this.components.getDialer().dial(e,t);let i=this.connections.get(e.toString());null==i&&(i=[],this.connections.set(e.toString(),i));let s=!1;for(const e of i)e.id===r.id&&(s=!0);return s||i.push(r),r}finally{null!=n&&n.clear()}}async closeConnections(e){const t=this.connections.get(e.toString())??[];await Promise.all(t.map((async e=>await e.close())))}getAll(e){if(!YE(e))throw mn(new Error("peerId must be an instance of peer-id"),Tte.ERR_INVALID_PARAMETERS);const t=e.toString(),r=this.connections.get(t);return null!=r?r.filter((e=>e.stat.status===Gte)):[]}_onLatencyMeasure(e){const{detail:t}=e;this._checkMaxLimit("maxEventLoopDelay",t.avgMs,1).catch((e=>{tre.error(e)}))}async _checkMaxLimit(e,t,r=1){const n=this.opts[e];tre.trace("checking limit of %s. current value: %d of %d",e,t,n),t>n&&(tre("%s: limit exceeded: %p, %d/%d, pruning %d connection(s)",this.components.getPeerId(),e,t,n,r),await this._maybePruneConnections(r))}async _maybePruneConnections(e){const t=this.getConnections();if(t.length<=this.opts.minConnections||e<1)return;const r=new Qte;for(const s of t){const e=s.remotePeer;if(r.has(e))continue;const t=await this.components.getPeerStore().getTags(e);r.set(e,t.reduce(((e,t)=>e+t.value),0))}const n=t.sort(((e,t)=>{const n=r.get(e.remotePeer)??0,i=r.get(t.remotePeer)??0;return n>i?1:n<i?-1:0})),i=[];for(const s of n)if(tre("too many connections open - closing a connection to %p",s.remotePeer),i.push(s),i.length===e)break;await Promise.all(i.map((async e=>{try{await e.close()}catch(WV){tre.error(WV)}this.onDisconnect(new c0("connectionEnd",{detail:e}))})))}async acceptIncomingConnection(e){return!0}}var are=r(1114);const cre=gn("libp2p:connection-manager:auto-dialler"),lre={enabled:!0,minConnections:0,autoDialInterval:1e4};class ure{constructor(e,t){this.components=e,this.options=Wr.call({ignoreUndefined:!0},lre,t),this.running=!1,this._autoDial=this._autoDial.bind(this),cre("options: %j",this.options)}isStarted(){return this.running}async start(){this.options.enabled?(this.running=!0,this._autoDial().catch((e=>{cre.error("could start autodial",e)})),cre("started")):cre("not enabled")}async stop(){this.options.enabled?(this.running=!1,null!=this.autoDialTimeout&&this.autoDialTimeout.clear(),cre("stopped")):cre("not enabled")}async _autoDial(){null!=this.autoDialTimeout&&this.autoDialTimeout.clear();const e=this.options.minConnections;if(this.components.getConnectionManager().getConnections().length>=e)return void(this.autoDialTimeout=Hte(this._autoDial,this.options.autoDialInterval));const t=await this.components.getPeerStore().all(),r=await QR(t.sort((()=>Math.random()>.5?1:-1)),(e=>PR(e,(e=>!e.id.equals(this.components.getPeerId())))),(e=>are(e,((e,t)=>t.protocols.length>e.protocols.length||null!=t.id.publicKey&&null==e.id.publicKey?1:-1))),(async e=>await kR(e)));for(let n=0;this.running&&n<r.length&&this.components.getConnectionManager().getConnections().length<e;n++){if(!this.running)return;const e=r[n];if(0===this.components.getConnectionManager().getConnections(e.id).length){cre("connecting to a peerStore stored peer %p",e.id);try{await this.components.getConnectionManager().openConnection(e.id)}catch(WV){cre.error("could not connect to peerStore stored peer",WV)}}}this.running&&(this.autoDialTimeout=Hte(this._autoDial,this.options.autoDialInterval))}}var hre;(function(e){let t,r,n,i,s,o;(function(e){e["SUCCESS"]="SUCCESS",e["HOP_SRC_ADDR_TOO_LONG"]="HOP_SRC_ADDR_TOO_LONG",e["HOP_DST_ADDR_TOO_LONG"]="HOP_DST_ADDR_TOO_LONG",e["HOP_SRC_MULTIADDR_INVALID"]="HOP_SRC_MULTIADDR_INVALID",e["HOP_DST_MULTIADDR_INVALID"]="HOP_DST_MULTIADDR_INVALID",e["HOP_NO_CONN_TO_DST"]="HOP_NO_CONN_TO_DST",e["HOP_CANT_DIAL_DST"]="HOP_CANT_DIAL_DST",e["HOP_CANT_OPEN_DST_STREAM"]="HOP_CANT_OPEN_DST_STREAM",e["HOP_CANT_SPEAK_RELAY"]="HOP_CANT_SPEAK_RELAY",e["HOP_CANT_RELAY_TO_SELF"]="HOP_CANT_RELAY_TO_SELF",e["STOP_SRC_ADDR_TOO_LONG"]="STOP_SRC_ADDR_TOO_LONG",e["STOP_DST_ADDR_TOO_LONG"]="STOP_DST_ADDR_TOO_LONG",e["STOP_SRC_MULTIADDR_INVALID"]="STOP_SRC_MULTIADDR_INVALID",e["STOP_DST_MULTIADDR_INVALID"]="STOP_DST_MULTIADDR_INVALID",e["STOP_RELAY_REFUSED"]="STOP_RELAY_REFUSED",e["MALFORMED_MESSAGE"]="MALFORMED_MESSAGE"})(t=e.Status||(e.Status={})),function(e){e[e["SUCCESS"]=100]="SUCCESS",e[e["HOP_SRC_ADDR_TOO_LONG"]=220]="HOP_SRC_ADDR_TOO_LONG",e[e["HOP_DST_ADDR_TOO_LONG"]=221]="HOP_DST_ADDR_TOO_LONG",e[e["HOP_SRC_MULTIADDR_INVALID"]=250]="HOP_SRC_MULTIADDR_INVALID",e[e["HOP_DST_MULTIADDR_INVALID"]=251]="HOP_DST_MULTIADDR_INVALID",e[e["HOP_NO_CONN_TO_DST"]=260]="HOP_NO_CONN_TO_DST",e[e["HOP_CANT_DIAL_DST"]=261]="HOP_CANT_DIAL_DST",e[e["HOP_CANT_OPEN_DST_STREAM"]=262]="HOP_CANT_OPEN_DST_STREAM",e[e["HOP_CANT_SPEAK_RELAY"]=270]="HOP_CANT_SPEAK_RELAY",e[e["HOP_CANT_RELAY_TO_SELF"]=280]="HOP_CANT_RELAY_TO_SELF",e[e["STOP_SRC_ADDR_TOO_LONG"]=320]="STOP_SRC_ADDR_TOO_LONG",e[e["STOP_DST_ADDR_TOO_LONG"]=321]="STOP_DST_ADDR_TOO_LONG",e[e["STOP_SRC_MULTIADDR_INVALID"]=350]="STOP_SRC_MULTIADDR_INVALID",e[e["STOP_DST_MULTIADDR_INVALID"]=351]="STOP_DST_MULTIADDR_INVALID",e[e["STOP_RELAY_REFUSED"]=390]="STOP_RELAY_REFUSED",e[e["MALFORMED_MESSAGE"]=400]="MALFORMED_MESSAGE"}(r||(r={})),function(e){e.codec=()=>LT(r)}(t=e.Status||(e.Status={})),function(e){e["HOP"]="HOP",e["STOP"]="STOP",e["STATUS"]="STATUS",e["CAN_HOP"]="CAN_HOP"}(n=e.Type||(e.Type={})),function(e){e[e["HOP"]=1]="HOP",e[e["STOP"]=2]="STOP",e[e["STATUS"]=3]="STATUS",e[e["CAN_HOP"]=4]="CAN_HOP"}(i||(i={})),function(e){e.codec=()=>LT(i)}(n=e.Type||(e.Type={})),function(e){let t;e.codec=()=>(null==t&&(t=BT(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null==e.id)throw new Error('Protocol error: required field "id" was not found in object');if(t.uint32(10),t.bytes(e.id),null==e.addrs)throw new Error('Protocol error: required field "addrs" was not found in object');for(const n of e.addrs)t.uint32(18),t.bytes(n);!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.id=e.bytes();break;case 2:r.addrs=r.addrs??[],r.addrs.push(e.bytes());break;default:e.skipType(7&t);break}}if(r.addrs=r.addrs??[],null==r.id)throw new Error('Protocol error: value for required field "id" was not found in protobuf');if(null==r.addrs)throw new Error('Protocol error: value for required field "addrs" was not found in protobuf');return r}))),t),e.encode=t=>xT(t,e.codec()),e.decode=t=>TT(t,e.codec())}(s=e.Peer||(e.Peer={})),e.codec=()=>(null==o&&(o=BT(((t,r,n={})=>{!1!==n.lengthDelimited&&r.fork(),null!=t.type&&(r.uint32(8),e.Type.codec().encode(t.type,r)),null!=t.srcPeer&&(r.uint32(18),e.Peer.codec().encode(t.srcPeer,r)),null!=t.dstPeer&&(r.uint32(26),e.Peer.codec().encode(t.dstPeer,r)),null!=t.code&&(r.uint32(32),e.Status.codec().encode(t.code,r)),!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={},i=null==r?t.len:t.pos+r;while(t.pos<i){const r=t.uint32();switch(r>>>3){case 1:n.type=e.Type.codec().decode(t);break;case 2:n.srcPeer=e.Peer.codec().decode(t,t.uint32());break;case 3:n.dstPeer=e.Peer.codec().decode(t,t.uint32());break;case 4:n.code=e.Status.codec().decode(t);break;default:t.skipType(7&r);break}}return n}))),o),e.encode=t=>xT(t,e.codec()),e.decode=t=>TT(t,e.codec())})(hre||(hre={}));const dre=gn("libp2p:stream:converter");function fre(e,t={}){const{stream:r,remoteAddr:n}=e,{sink:i,source:s}=r,o=async function*(){for await(const e of s)yield*e}(),a={async sink(e){null!=t.signal&&(e=J2(e,t.signal));try{await i(e),await c()}catch(WV){"aborted"!==WV.type&&dre(WV)}},source:null!=t.signal?J2(o,t.signal):o,remoteAddr:n,timeline:{open:Date.now(),close:void 0},async close(){await i(async function*(){yield new Uint8Array(0)}()),await c()}};async function c(){return null==a.timeline.close&&(a.timeline.close=Date.now()),await Promise.resolve()}return a}const pre="/libp2p/circuit/relay/0.1.0";function yre(e){const t=new Map;async function r(r){const n=r.toString().split("/p2p-circuit").find((e=>""!==e)),s=Pp(n),o=s.getPeerId();if(null==o)throw new Error("Could not determine relay peer from multiaddr");const a=s_(o);await e.peerStore.addressBook.add(a,[s]);const c=await e.connectionManager.openConnection(a),l=c.remoteAddr.encapsulate("/p2p-circuit");t.set(c.remotePeer.toString(),l),i.dispatchEvent(new c0("listening"))}function n(){const e=[];for(const r of t.values())e.push(r);return e}const i=Object.assign(new o0,{close:async()=>await Promise.resolve(),listen:r,getAddrs:n});return e.connectionManager.addEventListener("peer:disconnect",(e=>{const{detail:r}=e,n=t.delete(r.remotePeer.toString());n&&i.dispatchEvent(new c0("close"))})),i}function gre(e,t){e.write({type:hre.Type.STATUS,code:t})}function mre(e,t){try{null!=e.dstPeer?.addrs&&e.dstPeer.addrs.forEach((e=>Pp(e)))}catch(WV){throw gre(t,e.type===hre.Type.HOP?hre.Status.HOP_DST_MULTIADDR_INVALID:hre.Status.STOP_DST_MULTIADDR_INVALID),WV}try{null!=e.srcPeer?.addrs&&e.srcPeer.addrs.forEach((e=>Pp(e)))}catch(WV){throw gre(t,e.type===hre.Type.HOP?hre.Status.HOP_SRC_MULTIADDR_INVALID:hre.Status.STOP_SRC_MULTIADDR_INVALID),WV}}function wre(e){const t=LR(),r=YU(e.source),n=d3();let i;const s=e.sink(async function*(){yield*t;const e=await n.promise;yield*e}());s.catch((e=>{i=e}));const o={sink:async e=>null!=i?await Promise.reject(i):(n.resolve(e),await s),source:r};return{reader:r,writer:t,stream:o,rest:()=>t.end(),write:t.push,read:async()=>{const e=await r.next();if(null!=e.value)return e.value}}}const bre=gn("libp2p:circuit:stream-handler");class vre{constructor(e){const{stream:t,maxLength:r=4096}=e;this.stream=t,this.shake=wre(this.stream),this.decoder=o3.fromReader(this.shake.reader,{maxDataLength:r})}async read(){const e=await this.decoder.next();if(null!=e.value){const t=hre.decode(e.value);return bre("read message type",t.type),t}bre("read received no value, closing stream"),this.close()}write(e){bre("write message type %s",e.type),this.shake.write(t3.single(hre.encode(e)))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){bre("closing the stream"),this.rest().sink([]).catch((e=>{bre.error(e)}))}}const Ere=gn("libp2p:circuit:stop");function _re(e){const{connection:t,request:r,streamHandler:n}=e;try{mre(r,n)}catch(WV){return void Ere.error("invalid stop request via peer %p %o",t.remotePeer,WV)}return Ere("stop request is valid"),n.write({type:hre.Type.STATUS,code:hre.Status.SUCCESS}),n.rest()}async function Sre(e){const{connection:t,request:r,signal:n}=e,i=await t.newStream(pre,{signal:n});Ere("starting stop request to %p",t.remotePeer);const s=new vre({stream:i});s.write(r);const o=await s.read();if(null!=o){if(o.code===hre.Status.SUCCESS)return Ere("stop request to %p was successful",t.remotePeer),s.rest();Ere("stop request failed with code %d",o.code),s.close()}else s.close()}const Are=gn("libp2p:circuit:hop");async function Ire(e){const{connection:t,request:r,streamHandler:n,circuit:i,connectionManager:s}=e;if(!i.hopEnabled())return Are("HOP request received but we are not acting as a relay"),n.end({type:hre.Type.STATUS,code:hre.Status.HOP_CANT_SPEAK_RELAY});try{mre(r,n)}catch(WV){return void Are.error("invalid hop request via peer %p %o",t.remotePeer,WV)}if(null==r.dstPeer)return void Are("HOP request received but we do not receive a dstPeer");const o=o_(r.dstPeer.id),a=s.getConnections(o);if(0===a.length&&!i.hopActive())return Are("HOP request received but we are not connected to the destination peer"),n.end({type:hre.Type.STATUS,code:hre.Status.HOP_NO_CONN_TO_DST});if(0===a.length)return Are("did not have connection to remote peer"),n.end({type:hre.Type.STATUS,code:hre.Status.HOP_NO_CONN_TO_DST});const c={type:hre.Type.STOP,dstPeer:r.dstPeer,srcPeer:r.srcPeer};let l;try{Are("performing STOP request");const e=await Sre({connection:a[0],request:c});if(null==e)throw new Error("Could not stop");l=e}catch(WV){return void Are.error(WV)}Are("hop request from %p is valid",t.remotePeer),n.write({type:hre.Type.STATUS,code:hre.Status.SUCCESS});const u=n.rest();return Are("creating related connections"),await QR(u,l,u)}async function Cre(e){const{connection:t,request:r,signal:n}=e,i=await t.newStream(pre,{signal:n}),s=new vre({stream:i});s.write(r);const o=await s.read();if(null==o)throw mn(new Error("HOP request had no response"),Tte.ERR_HOP_REQUEST_FAILED);if(o.code===hre.Status.SUCCESS)return Are("hop request was successful"),s.rest();throw Are("hop request failed with code %d, closing stream",o.code),s.close(),mn(new Error(`HOP request failed with code "${o.code??"unknown"}"`),Tte.ERR_HOP_REQUEST_FAILED)}async function kre(e){const{connection:t,signal:r}=e,n=await t.newStream(pre,{signal:r}),i=new vre({stream:n});i.write({type:hre.Type.CAN_HOP});const s=await i.read();return await i.close(),null!=s&&s.code===hre.Status.SUCCESS}function Tre(e){const{connection:t,streamHandler:r,circuit:n}=e,i=n.hopEnabled();Are("can hop (%s) request from %p",i,t.remotePeer),r.end({type:hre.Type.STATUS,code:i?hre.Status.SUCCESS:hre.Status.HOP_CANT_SPEAK_RELAY})}const Rre=gn("libp2p:circuit");class Pre{constructor(e){this.components=new S2,this._init=e}init(e){this.components=e,this.components.getRegistrar().handle(pre,(e=>{this._onProtocol(e).catch((e=>{Rre.error(e)}))})).catch((e=>{Rre.error(e)}))}hopEnabled(){return!0}hopActive(){return!0}get[bte](){return!0}get[Symbol.toStringTag](){return"libp2p/circuit-relay-v1"}async _onProtocol(e){const{connection:t,stream:r}=e,n=new Ql.TimeoutController(this._init.hop.timeout);try{(0,Ote.setMaxListeners)?.(1/0,n.signal)}catch{}try{const e=X2(r,n.signal),i=new vre({stream:{...r,...e}}),s=await i.read();if(null==s)return Rre("request was invalid, could not read from stream"),i.write({type:hre.Type.STATUS,code:hre.Status.MALFORMED_MESSAGE}),void i.close();let o;switch(s.type){case hre.Type.CAN_HOP:Rre("received CAN_HOP request from %p",t.remotePeer),await Tre({circuit:this,connection:t,streamHandler:i});break;case hre.Type.HOP:Rre("received HOP request from %p",t.remotePeer),await Ire({connection:t,request:s,streamHandler:i,circuit:this,connectionManager:this.components.getConnectionManager()});break;case hre.Type.STOP:Rre("received STOP request from %p",t.remotePeer),o=await _re({connection:t,request:s,streamHandler:i});break;default:return Rre("Request of type %s not supported",s.type),i.write({type:hre.Type.STATUS,code:hre.Status.MALFORMED_MESSAGE}),void i.close()}if(null!=o){const e=t.remoteAddr.encapsulate("/p2p-circuit").encapsulate(Pp(s.dstPeer?.addrs[0])),r=Pp(s.srcPeer?.addrs[0]),n=fre({stream:o,remoteAddr:e,localAddr:r}),i=s.type===hre.Type.HOP?"relay":"inbound";Rre("new %s connection %s",i,n.remoteAddr);const a=await this.components.getUpgrader().upgradeInbound(n);Rre("%s connection %s upgraded",i,n.remoteAddr),null!=this.handler&&this.handler(a)}}finally{n.clear()}}async dial(e,t={}){const r=e.toString().split("/p2p-circuit"),n=Pp(r[0]),i=Pp(r[r.length-1]),s=n.getPeerId(),o=i.getPeerId();if(null==s||null==o){const e="Circuit relay dial failed as addresses did not have peer id";throw Rre.error(e),mn(new Error(e),Tte.ERR_RELAYED_DIAL)}const a=s_(s),c=s_(o);let l=!1;const u=this.components.getConnectionManager().getConnections(a);let h=u[0];null==h&&(await this.components.getPeerStore().addressBook.add(a,[n]),h=await this.components.getConnectionManager().openConnection(a,t),l=!0);try{const r=await Cre({...t,connection:h,request:{type:hre.Type.HOP,srcPeer:{id:this.components.getPeerId().toBytes(),addrs:this.components.getAddressManager().getAddresses().map((e=>e.bytes))},dstPeer:{id:c.toBytes(),addrs:[Pp(i).bytes]}}}),s=n.encapsulate(`/p2p-circuit/p2p/${this.components.getPeerId().toString()}`),o=fre({stream:r,remoteAddr:e,localAddr:s});return Rre("new outbound connection %s",o.remoteAddr),await this.components.getUpgrader().upgradeOutbound(o)}catch(WV){throw Rre.error("Circuit relay dial failed",WV),l&&await h.close(),WV}}createListener(e){return this.handler=e.handler,yre({connectionManager:this.components.getConnectionManager(),peerStore:this.components.getPeerStore()})}filter(e){return e=Array.isArray(e)?e:[e],e.filter((e=>Jp.matches(e)))}}async function xre(e){const t=(new TextEncoder).encode(e),r=await vl.digest(t);return ji.createV0(r)}const Dre=6e4,Ore=15*Dre,Nre=30*Dre,Lre=290,Bre="hop_relay",Ure="true",Mre="/libp2p/relay";var jre=r(290);function Vre(e){const{address:t}=e.nodeAddress();return Boolean(jre(t))}function zre(e,t){const r=Vre(e.multiaddr),n=Vre(t.multiaddr);return r&&!n?1:!r&&n||e.isCertified&&!t.isCertified?-1:!e.isCertified&&t.isCertified?1:0}const Fre=gn("libp2p:auto-relay"),$re=()=>{};class Kre{constructor(e,t){this.components=e,this.addressSorter=t.addressSorter??zre,this.maxListeners=t.maxListeners??1,this.listenRelays=new Set,this.onError=t.onError??$re,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this.components.getPeerStore().addEventListener("change:protocols",(e=>{this._onProtocolChange(e).catch((e=>{Fre.error(e)}))})),this.components.getConnectionManager().addEventListener("peer:disconnect",this._onPeerDisconnected)}async _onProtocolChange(e){const{peerId:t,protocols:r}=e.detail,n=t.toString(),i=r.find((e=>e===pre));if(null!=i){if(!this.listenRelays.has(n))try{const e=this.components.getConnectionManager().getConnections(t);if(0===e.length)return;const r=e[0];if(r.remoteAddr.protoCodes().includes(Lre))return void Fre(`relayed connection to ${n} will not be used to hop on`);const i=await kre({connection:r});i&&(await this.components.getPeerStore().metadataBook.setValue(t,Bre,Jl(Ure)),await this._addListenRelay(r,n))}catch(WV){this.onError(WV)}}else this.listenRelays.has(n)&&await this._removeListenRelay(n)}_onPeerDisconnected(e){const t=e.detail,r=t.remotePeer,n=r.toString();this.listenRelays.has(n)&&this._removeListenRelay(n).catch((e=>{Fre.error(e)}))}async _addListenRelay(e,t){try{if(this.listenRelays.size>=this.maxListeners)return;const r=await QR(await this.components.getPeerStore().addressBook.get(e.remotePeer),(e=>are(e,this.addressSorter)),(async e=>await kR(e))),n=await Promise.all(r.map((async t=>{try{let r=t.multiaddr;return null==r.getPeerId()&&(r=r.encapsulate(`/p2p/${e.remotePeer.toString()}`)),r=r.encapsulate("/p2p-circuit"),await this.components.getTransportManager().listen([r]),!0}catch(WV){Fre.error("error listening on circuit address",WV),this.onError(WV)}return!1})));n.includes(!0)&&this.listenRelays.add(t)}catch(WV){this.onError(WV),this.listenRelays.delete(t)}}async _removeListenRelay(e){this.listenRelays.delete(e)&&await this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this.listenRelays.size>=this.maxListeners)return;const t=[],r=await this.components.getPeerStore().all();for(const{id:n,metadata:i}of r){const r=n.toString();if(this.listenRelays.has(r))continue;if(e.includes(r))continue;const s=i.get(Bre);if(null==s||C_(s)!==Ure)continue;const o=this.components.getConnectionManager().getConnections(n);if(0!==o.length){if(await this._addListenRelay(o[0],r),this.listenRelays.size>=this.maxListeners)return}else t.push(n)}for(const n of t)if(await this._tryToListenOnRelay(n),this.listenRelays.size>=this.maxListeners)return;try{const e=await xre(Mre);for await(const t of this.components.getContentRouting().findProviders(e)){if(0===t.multiaddrs.length)continue;const e=t.id;if(!e.equals(this.components.getPeerId())&&(await this.components.getPeerStore().addressBook.add(e,t.multiaddrs),await this._tryToListenOnRelay(e),this.listenRelays.size>=this.maxListeners))return}}catch(WV){this.onError(WV)}}async _tryToListenOnRelay(e){try{const t=await this.components.getConnectionManager().openConnection(e);await this._addListenRelay(t,e.toString())}catch(WV){Fre.error("Could not use %p as relay",e,WV),this.onError(WV,`could not connect and listen on known hop relay ${e.toString()}`)}}}const qre=gn("libp2p:relay");class Hre{constructor(e,t){this.components=e,this.autoRelay=!1!==t.autoRelay?.enabled?new Kre(e,{addressSorter:t.addressSorter,...t.autoRelay}):void 0,this.started=!1,this.init=t,this._advertiseService=this._advertiseService.bind(this)}isStarted(){return this.started}async start(){!1!==this.init.hop.enabled&&!1!==this.init.advertise.enabled&&(this.timeout=(0,Dte.setDelayedInterval)(this._advertiseService,this.init.advertise.ttl,this.init.advertise.bootDelay)),this.started=!0}async stop(){null!=this.timeout&&(0,Dte.clearDelayedInterval)(this.timeout),this.started=!1}async _advertiseService(){try{const e=await xre(Mre);await this.components.getContentRouting().provide(e)}catch(WV){WV.code===Tte.ERR_NO_ROUTERS_AVAILABLE?(qre.error("a content router, such as a DHT, must be provided in order to advertise the relay service",WV),await this.stop()):qre.error(WV)}}}var Gre=r(202);r(9437),r(5414);const Wre=J_.pki,Yre=(e,t)=>{const r=Wre.rsa.setPublicKey(t.n,t.e),n=Wre.createCertificate();n.publicKey=r,n.serialNumber="01",n.validity.notBefore=new Date,n.validity.notAfter=new Date,n.validity.notAfter.setFullYear(n.validity.notBefore.getFullYear()+10);const i=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:e.id}];return n.setSubject(i),n.setIssuer(i),n.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),n.sign(t),n};async function Jre(e,t){const r=e.map(t),n=await Promise.all(r),i=n.findIndex((e=>e));return e[i]}const Qre=gn("libp2p:keychain:cms"),Xre=new WeakMap;class Zre{constructor(e,t){if(null==e)throw mn(new Error("keychain is required"),Tte.ERR_KEYCHAIN_REQUIRED);this.keychain=e,Xre.set(this,{dek:t})}async encrypt(e,t){if(!(t instanceof Uint8Array))throw mn(new Error("Plain data must be a Uint8Array"),Tte.ERR_INVALID_PARAMETERS);const r=await this.keychain.findKeyByName(e),n=await this.keychain.getPrivateKey(e),i=Xre.get(this);if(null==i)throw mn(new Error("dek missing"),Tte.ERR_INVALID_PARAMETERS);const s=i.dek,o=J_.pki.decryptRsaPrivateKey(n,s),a=await Yre(r,o),c=J_.pkcs7.createEnvelopedData();c.addRecipient(a),c.content=J_.util.createBuffer(t),c.encrypt();const l=J_.asn1.toDer(c.toAsn1()).getBytes();return Jl(l,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw mn(new Error("CMS data is required"),Tte.ERR_INVALID_PARAMETERS);let t;try{const r=J_.util.createBuffer(C_(e,"ascii")),n=J_.asn1.fromDer(r);t=J_.pkcs7.messageFromAsn1(n)}catch(WV){throw Qre.error(WV),mn(new Error("Invalid CMS"),Tte.ERR_INVALID_CMS)}const r=t.recipients.filter((e=>e.issuer.find((e=>"O"===e.shortName&&"ipfs"===e.value)))).filter((e=>e.issuer.find((e=>"CN"===e.shortName)))).map((e=>({recipient:e,keyId:e.issuer.find((e=>"CN"===e.shortName)).value}))),n=await Jre(r,(async e=>{try{const t=await this.keychain.findKeyById(e.keyId);if(null!=t)return!0}catch(WV){return!1}return!1}));if(null==n){const e=r.map((e=>e.keyId));throw mn(new Error(`Decryption needs one of the key(s): ${e.join(", ")}`),Tte.ERR_MISSING_KEYS,{missingKeys:e})}const i=await this.keychain.findKeyById(n.keyId);if(null==i)throw mn(new Error("No key available to decrypto"),Tte.ERR_NO_KEY);const s=await this.keychain.getPrivateKey(i.name),o=Xre.get(this);if(null==o)throw mn(new Error("dek missing"),Tte.ERR_INVALID_PARAMETERS);const a=o.dek,c=J_.pki.decryptRsaPrivateKey(s,a);return t.decrypt(n.recipient,c),Jl(t.content.getBytes(),"ascii")}}const ene=gn("libp2p:keychain"),tne="/pkcs8/",rne="/info/",nne=new WeakMap,ine={minKeyLength:14,minSaltLength:16,minIterationCount:1e3},sne={dek:{keyLength:64,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function one(e){return null!=e&&("string"===typeof e&&(e===Gre(e.trim())&&e.length>0))}async function ane(){const e=200,t=1e3,r=Math.random()*(t-e)+e;await new Promise((e=>setTimeout(e,r)))}function cne(e){return new Ew(tne+e)}function lne(e){return new Ew(rne+e)}class une{constructor(e,t){if(this.components=e,this.init=Wr(sne,t),null!=this.init.pass&&this.init.pass?.length<20)throw new Error("pass must be least 20 characters");if(null!=this.init.dek?.keyLength&&this.init.dek.keyLength<ine.minKeyLength)throw new Error(`dek.keyLength must be least ${ine.minKeyLength} bytes`);if(null!=this.init.dek?.salt?.length&&this.init.dek.salt.length<ine.minSaltLength)throw new Error(`dek.saltLength must be least ${ine.minSaltLength} bytes`);if(null!=this.init.dek?.iterationCount&&this.init.dek.iterationCount<ine.minIterationCount)throw new Error(`dek.iterationCount must be least ${ine.minIterationCount}`);const r=null!=this.init.pass&&null!=this.init.dek?.salt?U2(this.init.pass,this.init.dek?.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";nne.set(this,{dek:r}),this.started=!1}isStarted(){return this.started}async start(){const e=lne("self");await this.components.getDatastore().has(e)||await this.importPeer("self",this.components.getPeerId()),this.started=!0}stop(){this.started=!1}get cms(){const e=nne.get(this);if(null==e)throw mn(new Error("dek missing"),Tte.ERR_INVALID_PARAMETERS);const t=e.dek;return new Zre(this,t)}static generateOptions(){const e=Object.assign({},sne),t=3*Math.ceil(ine.minSaltLength/3);return e.dek.salt=C_(uC(t),"base64"),e}static get options(){return sne}async createKey(e,t,r=2048){if(!one(e)||"self"===e)throw await ane(),mn(new Error("Invalid key name"),Tte.ERR_INVALID_KEY_NAME);if("string"!==typeof t)throw await ane(),mn(new Error("Invalid key type"),Tte.ERR_INVALID_KEY_TYPE);const n=cne(e),i=await this.components.getDatastore().has(n);if(i)throw await ane(),mn(new Error("Key name already exists"),Tte.ERR_KEY_ALREADY_EXISTS);switch(t.toLowerCase()){case"rsa":if(!Number.isSafeInteger(r)||r<2048)throw await ane(),mn(new Error("Invalid RSA key size"),Tte.ERR_INVALID_KEY_SIZE);break;default:break}let s;try{const i=await uT(t,r),o=await i.id(),a=nne.get(this);if(null==a)throw mn(new Error("dek missing"),Tte.ERR_INVALID_PARAMETERS);const c=a.dek,l=await i.export(c);s={name:e,id:o};const u=this.components.getDatastore().batch();u.put(n,Jl(l)),u.put(lne(e),Jl(JSON.stringify(s))),await u.commit()}catch(WV){throw await ane(),WV}return s}async listKeys(){const e={prefix:rne},t=[];for await(const r of this.components.getDatastore().query(e))t.push(JSON.parse(C_(r.value)));return t}async findKeyById(e){try{const t=await this.listKeys();return t.find((t=>t.id===e))}catch(WV){throw await ane(),WV}}async findKeyByName(e){if(!one(e))throw await ane(),mn(new Error(`Invalid key name '${e}'`),Tte.ERR_INVALID_KEY_NAME);const t=lne(e);try{const e=await this.components.getDatastore().get(t);return JSON.parse(C_(e))}catch(WV){throw await ane(),ene.error(WV),mn(new Error(`Key '${e}' does not exist.`),Tte.ERR_KEY_NOT_FOUND)}}async removeKey(e){if(!one(e)||"self"===e)throw await ane(),mn(new Error(`Invalid key name '${e}'`),Tte.ERR_INVALID_KEY_NAME);const t=cne(e),r=await this.findKeyByName(e),n=this.components.getDatastore().batch();return n.delete(t),n.delete(lne(e)),await n.commit(),r}async renameKey(e,t){if(!one(e)||"self"===e)throw await ane(),mn(new Error(`Invalid old key name '${e}'`),Tte.ERR_OLD_KEY_NAME_INVALID);if(!one(t)||"self"===t)throw await ane(),mn(new Error(`Invalid new key name '${t}'`),Tte.ERR_NEW_KEY_NAME_INVALID);const r=cne(e),n=cne(t),i=lne(e),s=lne(t),o=await this.components.getDatastore().has(n);if(o)throw await ane(),mn(new Error(`Key '${t}' already exists`),Tte.ERR_KEY_ALREADY_EXISTS);try{const e=await this.components.getDatastore().get(r),o=await this.components.getDatastore().get(i),a=JSON.parse(C_(o));a.name=t;const c=this.components.getDatastore().batch();return c.put(n,e),c.put(s,Jl(JSON.stringify(a))),c.delete(r),c.delete(i),await c.commit(),a}catch(WV){throw await ane(),WV}}async exportKey(e,t){if(!one(e))throw await ane(),mn(new Error(`Invalid key name '${e}'`),Tte.ERR_INVALID_KEY_NAME);if(null==t)throw await ane(),mn(new Error("Password is required"),Tte.ERR_PASSWORD_REQUIRED);const r=cne(e);try{const e=await this.components.getDatastore().get(r),n=C_(e),i=nne.get(this);if(null==i)throw mn(new Error("dek missing"),Tte.ERR_INVALID_PARAMETERS);const s=i.dek,o=await yT(n,s);return await o.export(t)}catch(WV){throw await ane(),WV}}async importKey(e,t,r){if(!one(e)||"self"===e)throw await ane(),mn(new Error(`Invalid key name '${e}'`),Tte.ERR_INVALID_KEY_NAME);if(null==t)throw await ane(),mn(new Error("PEM encoded key is required"),Tte.ERR_PEM_REQUIRED);const n=cne(e),i=await this.components.getDatastore().has(n);if(i)throw await ane(),mn(new Error(`Key '${e}' already exists`),Tte.ERR_KEY_ALREADY_EXISTS);let s,o;try{s=await yT(t,r)}catch(WV){throw await ane(),mn(new Error("Cannot read the key, most likely the password is wrong"),Tte.ERR_CANNOT_READ_KEY)}try{o=await s.id();const e=nne.get(this);if(null==e)throw mn(new Error("dek missing"),Tte.ERR_INVALID_PARAMETERS);const r=e.dek;t=await s.export(r)}catch(WV){throw await ane(),WV}const a={name:e,id:o},c=this.components.getDatastore().batch();return c.put(n,Jl(t)),c.put(lne(e),Jl(JSON.stringify(a))),await c.commit(),a}async importPeer(e,t){try{if(!one(e))throw mn(new Error(`Invalid key name '${e}'`),Tte.ERR_INVALID_KEY_NAME);if(null==t)throw mn(new Error("PeerId is required"),Tte.ERR_MISSING_PRIVATE_KEY);if(null==t.privateKey)throw mn(new Error("PeerId.privKey is required"),Tte.ERR_MISSING_PRIVATE_KEY);const r=await fT(t.privateKey),n=cne(e),i=await this.components.getDatastore().has(n);if(i)throw await ane(),mn(new Error(`Key '${e}' already exists`),Tte.ERR_KEY_ALREADY_EXISTS);const s=nne.get(this);if(null==s)throw mn(new Error("dek missing"),Tte.ERR_INVALID_PARAMETERS);const o=s.dek,a=await r.export(o),c={name:e,id:t.toString()},l=this.components.getDatastore().batch();return l.put(n,Jl(a)),l.put(lne(e),Jl(JSON.stringify(c))),await l.commit(),c}catch(WV){throw await ane(),WV}}async getPrivateKey(e){if(!one(e))throw await ane(),mn(new Error(`Invalid key name '${e}'`),Tte.ERR_INVALID_KEY_NAME);try{const t=cne(e),r=await this.components.getDatastore().get(t);return C_(r)}catch(WV){throw await ane(),ene.error(WV),mn(new Error(`Key '${e}' does not exist.`),Tte.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(e,t){if("string"!==typeof e)throw await ane(),mn(new Error(`Invalid old pass type '${typeof e}'`),Tte.ERR_INVALID_OLD_PASS_TYPE);if("string"!==typeof t)throw await ane(),mn(new Error(`Invalid new pass type '${typeof t}'`),Tte.ERR_INVALID_NEW_PASS_TYPE);if(t.length<20)throw await ane(),mn(new Error(`Invalid pass length ${t.length}`),Tte.ERR_INVALID_PASS_LENGTH);ene("recreating keychain");const r=nne.get(this);if(null==r)throw mn(new Error("dek missing"),Tte.ERR_INVALID_PARAMETERS);const n=r.dek;this.init.pass=t;const i=null!=t&&null!=this.init.dek?.salt?U2(t,this.init.dek.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";nne.set(this,{dek:i});const s=await this.listKeys();for(const o of s){const e=await this.components.getDatastore().get(cne(o.name)),t=C_(e),r=await yT(t,n),s=i.toString(),a=await r.export(s),c=this.components.getDatastore().batch(),l={name:o.name,id:o.id};c.put(cne(o.name),Jl(a)),c.put(lne(o.name),Jl(JSON.stringify(l))),await c.commit()}ene("keychain reconstructed")}}var hne=r(4321);const dne=3e4,fne=3e4,pne=100,yne=4,gne=25,mne={computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[6e4,3e5,9e5],maxOldPeersRetention:50};class wne{constructor(e){if("number"!==typeof e)throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");this.timespan=e,this.movingAverage=0,this.variance=0,this.deviation=0,this.forecast=0}alpha(e,t){return 1-Math.exp(-(e-t)/this.timespan)}push(e,t){if(null!=this.previousTime){const r=this.alpha(e,this.previousTime),n=t-this.movingAverage,i=r*n;this.movingAverage=r*t+(1-r)*this.movingAverage,this.variance=(1-r)*(this.variance+n*i),this.deviation=Math.sqrt(this.variance),this.forecast=this.movingAverage+r*n}else this.movingAverage=t;this.previousTime=e}}function bne(e){return new wne(e)}class vne extends o0{constructor(e){super(),this.enabled=e.enabled,this.queue=[],this.stats={dataReceived:0n,dataSent:0n},this.frequencyLastTime=Date.now(),this.frequencyAccumulators={},this.movingAverages={dataReceived:[],dataSent:[]},this.computeThrottleMaxQueueSize=e.computeThrottleMaxQueueSize,this.computeThrottleTimeout=e.computeThrottleTimeout,this._update=this._update.bind(this),this.movingAverageIntervals=e.movingAverageIntervals;for(let t=0;t<e.initialCounters.length;t++){const r=e.initialCounters[t];this.stats[r]=0n,this.movingAverages[r]=[];for(let e=0;e<this.movingAverageIntervals.length;e++){const t=this.movingAverageIntervals[e],n=this.movingAverages[r][t]=bne(t);n.push(this.frequencyLastTime,0)}}}start(){this.enabled&&this.queue.length>0&&this._resetComputeTimeout()}stop(){null!=this.timeout&&(this.timeout.clear(),this.timeout=null)}getSnapshot(){return Object.assign({},this.stats)}getMovingAverages(){return Object.assign({},this.movingAverages)}push(e,t){this.queue.push([e,t,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this.timeout=Hte(this._update,this._nextTimeout())}_nextTimeout(){const e=this.queue.length/this.computeThrottleMaxQueueSize,t=Math.max(this.computeThrottleTimeout*(1-e),0);return t}_update(){if(this.timeout=null,this.queue.length>0){let e=["",0,0];for(e of this.queue)this._applyOp(e);this.queue=[],e.length>2&&""!==e[0]&&this._updateFrequency(e[2]),this.dispatchEvent(new c0("update",{detail:this.stats}))}}_updateFrequency(e){const t=e-this.frequencyLastTime;this._updateFrequencyFor("dataReceived",t,e),this._updateFrequencyFor("dataSent",t,e),this.frequencyLastTime=e}_updateFrequencyFor(e,t,r){const n=this.frequencyAccumulators[e]??0;this.frequencyAccumulators[e]=0;const i=t??1,s=n/i*1e3;let o=this.movingAverages[e];null==o&&(o=this.movingAverages[e]=[]);const a=this.movingAverageIntervals;for(let c=0;c<a.length;c++){const e=a[c];let t=o[e];null==t&&(t=o[e]=bne(e)),t.push(r,s)}}_applyOp(e){const t=e[0],r=e[1];if("number"!==typeof r)throw new Error("invalid increment number");let n;n=Object.prototype.hasOwnProperty.call(this.stats,t)?this.stats[t]:this.stats[t]=0n,this.stats[t]=n+BigInt(r),null==this.frequencyAccumulators[t]&&(this.frequencyAccumulators[t]=0),this.frequencyAccumulators[t]+=r}}const Ene=["dataReceived","dataSent"],_ne={in:"dataReceived",out:"dataSent"};class Sne{constructor(e){this.enabled=e.enabled,this.statsInit={...e,initialCounters:Ene},this.globalStats=new vne(this.statsInit),this.peerStats=new Map,this.protocolStats=new Map,this.oldPeers=Gw(e.maxOldPeersRetention??mne.maxOldPeersRetention),this.running=!1,this._onMessage=this._onMessage.bind(this),this.systems=new Map}isStarted(){return this.running}async start(){this.enabled&&(this.running=!0)}async stop(){if(this.running){this.running=!1,this.globalStats.stop();for(const e of this.peerStats.values())e.stop();for(const e of this.protocolStats.values())e.stop()}}getGlobal(){return this.globalStats}getPeers(){return Array.from(this.peerStats.keys())}getComponentMetrics(){return this.systems}updateComponentMetric(e){const{system:t="libp2p",component:r,metric:n,value:i,label:s,help:o}=e;this.systems.has(t)||this.systems.set(t,new Map);const a=this.systems.get(t);if(null==a)throw new Error("Unknown metric system");a.has(r)||a.set(r,new Map);const c=a.get(r);if(null==c)throw new Error("Unknown metric component");c.set(n,{label:s,help:o,calculate:"function"!==typeof i?()=>i:i})}forPeer(e){const t=e.toString();return this.peerStats.get(t)??this.oldPeers.get(t)}getProtocols(){return Array.from(this.protocolStats.keys())}forProtocol(e){return this.protocolStats.get(e)}onPeerDisconnected(e){const t=e.toString(),r=this.peerStats.get(t);null!=r&&(r.stop(),this.peerStats.delete(t),this.oldPeers.set(t,r))}_onMessage(e){if(!this.running)return;const{remotePeer:t,protocol:r,direction:n,dataLength:i}=e,s=_ne[n];let o=this.forPeer(t);if(null==o){const e=new vne(this.statsInit);this.peerStats.set(t.toString(),e),o=e}if(o.push(s,i),this.globalStats.push(s,i),null!=r){let e=this.forProtocol(r);if(null==e){const t=new vne(this.statsInit);this.protocolStats.set(r,t),e=t}e.push(s,i)}}updatePlaceholder(e,t){if(!this.running)return;const r=e.toString(),n=this.peerStats.get(r)??this.oldPeers.get(r),i=t.toString(),s=this.peerStats.get(i)??this.oldPeers.get(i);let o=n;null!=s&&(o=Ane(s,o),this.oldPeers.remove(i)),this.peerStats.delete(e.toString()),this.peerStats.set(i,o),o.start()}trackStream(e){const{stream:t,remotePeer:r,protocol:n}=e;if(!this.running)return;const i=t.source;t.source=hne(i,(e=>this._onMessage({remotePeer:r,protocol:n,direction:"in",dataLength:e.byteLength})));const s=t.sink;t.sink=async e=>await QR(e,(e=>hne(e,(e=>{this._onMessage({remotePeer:r,protocol:n,direction:"out",dataLength:e.byteLength})}))),s)}}function Ane(e,t){return e.stop(),t.stop(),e.queue=[...e.queue,...t.queue],e}async function Ine(e){try{const t=await e;return{status:"fulfilled",value:t,isFulfilled:!0,isRejected:!1}}catch(t){return{status:"rejected",reason:t,isFulfilled:!1,isRejected:!0}}}class Cne{value;next;constructor(e){this.value=e}}class kne{#e;#t;#r;constructor(){this.clear()}enqueue(e){const t=new Cne(e);this.#e?(this.#t.next=t,this.#t=t):(this.#e=t,this.#t=t),this.#r++}dequeue(){const e=this.#e;if(e)return this.#e=this.#e.next,this.#r--,e.value}clear(){this.#e=void 0,this.#t=void 0,this.#r=0}get size(){return this.#r}*[Symbol.iterator](){let e=this.#e;while(e)yield e.value,e=e.next}}function Tne(e){if(!Number.isInteger(e)&&e!==Number.POSITIVE_INFINITY||!(e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const t=new kne;let r=0;const n=()=>{r--,t.size>0&&t.dequeue()()},i=async(e,t,i)=>{r++;const s=(async()=>e(...i))();t(s);try{await s}catch{}n()},s=(n,s,o)=>{t.enqueue(i.bind(void 0,n,s,o)),(async()=>{await Promise.resolve(),r<e&&t.size>0&&t.dequeue()()})()},o=(e,...t)=>new Promise((r=>{s(e,r,t)}));return Object.defineProperties(o,{activeCount:{get:()=>r},pendingCount:{get:()=>t.size},clearQueue:{value:()=>{t.clear()}}}),o}async function Rne(e,t={}){const{concurrency:r=Number.POSITIVE_INFINITY}=t,n=Tne(r);return Promise.all(e.map((e=>e&&"function"===typeof e.then?Ine(e):Ine("function"===typeof e?n((()=>e())):Promise.resolve(e)))))}class Pne extends Map{constructor(e){super();const{system:t,component:r,metric:n,metrics:i}=e;this.system=t??"libp2p",this.component=r,this.metric=n,this.metrics=i,this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){const t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metrics.updateComponentMetric({system:this.system,component:this.component,metric:this.metric,value:this.size})}}function xne(e){const{system:t,component:r,metric:n,metrics:i}=e;let s;return s=null!=i?new Pne({system:t,component:r,metric:n,metrics:i}):new Map,s}const Dne=gn("libp2p:transports");class One extends o0{constructor(e,t={}){super(),this.components=e,this.started=!1,this.transports=new Map,this.listeners=xne({component:"transport-manager",metric:"listeners",metrics:this.components.getMetrics()}),this.faultTolerance=t.faultTolerance??Nne.FATAL_ALL}add(e){const t=e[Symbol.toStringTag];if(null==t)throw mn(new Error("Transport must have a valid tag"),Tte.ERR_INVALID_KEY);if(this.transports.has(t))throw mn(new Error("There is already a transport with this tag"),Tte.ERR_DUPLICATE_TRANSPORT);Dne("adding transport %s",t),this.transports.set(t,e),this.listeners.has(t)||this.listeners.set(t,[])}isStarted(){return this.started}async start(){const e=this.components.getAddressManager().getListenAddrs();await this.listen(e),this.started=!0}async stop(){const e=[];for(const[t,r]of this.listeners){Dne("closing listeners for %s",t);while(r.length>0){const t=r.pop();null!=t&&e.push(t.close())}}await Promise.all(e),Dne("all listeners closed");for(const t of this.listeners.keys())this.listeners.set(t,[]);this.started=!1}async dial(e,t){const r=this.transportForMultiaddr(e);if(null==r)throw mn(new Error(`No transport available for address ${String(e)}`),Tte.ERR_TRANSPORT_UNAVAILABLE);try{return await r.dial(e,{...t,upgrader:this.components.getUpgrader()})}catch(WV){throw null==WV.code&&(WV.code=Tte.ERR_TRANSPORT_DIAL_FAILED),WV}}getAddrs(){let e=[];for(const t of this.listeners.values())for(const r of t)e=[...e,...r.getAddrs()];return e}getTransports(){return Array.of(...this.transports.values())}transportForMultiaddr(e){for(const t of this.transports.values()){const r=t.filter([e]);if(r.length>0)return t}}async listen(e){if(null==e||0===e.length)return void Dne("no addresses were provided for listening, this node is dial only");const t=[];for(const[r,n]of this.transports.entries()){const i=n.filter(e),s=[];for(const e of i){Dne("creating listener for %s on %s",r,e);const t=n.createListener({upgrader:this.components.getUpgrader()});let i=this.listeners.get(r);null==i&&(i=[],this.listeners.set(r,i)),i.push(t),t.addEventListener("listening",(()=>{this.dispatchEvent(new c0("listener:listening",{detail:t}))})),t.addEventListener("close",(()=>{this.dispatchEvent(new c0("listener:close",{detail:t}))})),s.push(t.listen(e))}if(0===s.length){t.push(r);continue}const o=await Rne(s),a=o.find((e=>e.isFulfilled));if(null==a&&this.faultTolerance!==Nne.NO_FATAL)throw mn(new Error(`Transport (${r}) could not listen on any available address`),Tte.ERR_NO_VALID_ADDRESSES)}if(t.length===this.transports.size){const e=`no valid addresses were provided for transports [${t.join(", ")}]`;if(this.faultTolerance===Nne.FATAL_ALL)throw mn(new Error(e),Tte.ERR_NO_VALID_ADDRESSES);Dne(`libp2p in dial mode only: ${e}`)}}async remove(e){Dne("removing %s",e);for(const t of this.listeners.get(e)??[])await t.close();this.transports.delete(e),this.listeners.delete(e)}async removeAll(){const e=[];for(const t of this.transports.keys())e.push(this.remove(t));await Promise.all(e)}}var Nne;(function(e){e[e["FATAL_ALL"]=0]="FATAL_ALL",e[e["NO_FATAL"]=1]="NO_FATAL"})(Nne||(Nne={}));const Lne="/multistream/1.0.0",Bne=1024;function Une(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var Mne=Une,jne=Mne,Vne=jne;new Uint8Array(0);const zne=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},Fne=e=>(new TextEncoder).encode(e),$ne=e=>(new TextDecoder).decode(e);class Kne{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class qne{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Gne(this,e)}}class Hne{constructor(e){this.decoders=e}or(e){return Gne(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Gne=(e,t)=>new Hne({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Wne{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Kne(e,t,r),this.decoder=new qne(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Yne=({name:e,prefix:t,encode:r,decode:n})=>new Wne(e,t,r,n),Jne=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=Vne(r,t);return Yne({prefix:e,name:t,encode:n,decode:e=>zne(i(e))})},Qne=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Xne=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},Zne=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Yne({prefix:t,name:e,encode(e){return Xne(e,n,r)},decode(t){return Qne(t,n,r,e)}}),eie=Yne({prefix:"\0",name:"identity",encode:e=>$ne(e),decode:e=>Fne(e)}),tie=Zne({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),rie=Zne({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),nie=Jne({prefix:"9",name:"base10",alphabet:"0123456789"}),iie=Zne({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),sie=Zne({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),oie=Zne({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),aie=Zne({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),cie=Zne({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),lie=Zne({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),uie=Zne({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hie=Zne({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),die=Zne({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),fie=Zne({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),pie=Zne({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),yie=Jne({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),gie=Jne({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),mie=Jne({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),wie=Jne({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),bie=Zne({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),vie=Zne({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Eie=Zne({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),_ie=Zne({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Sie=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Aie=Sie.reduce(((e,t,r)=>(e[r]=t,e)),[]),Iie=Sie.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);function Cie(e){return e.reduce(((e,t)=>(e+=Aie[t],e)),"")}function kie(e){const t=[];for(const r of e){const e=Iie[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}const Tie=Yne({prefix:"🚀",name:"base256emoji",encode:Cie,decode:kie});var Rie=Nie,Pie=128,xie=127,Die=~xie,Oie=Math.pow(2,31);function Nie(e,t,r){t=t||[],r=r||0;var n=r;while(e>=Oie)t[r++]=255&e|Pie,e/=128;while(e&Die)t[r++]=255&e|Pie,e>>>=7;return t[r]=0|e,Nie.bytes=r-n+1,t}var Lie=Mie,Bie=128,Uie=127;function Mie(e,t){var r,n=0,i=(t=t||0,0),s=t,o=e.length;do{if(s>=o)throw Mie.bytes=0,new RangeError("Could not decode varint");r=e[s++],n+=i<28?(r&Uie)<<i:(r&Uie)*Math.pow(2,i),i+=7}while(r>=Bie);return Mie.bytes=s-t,n}var jie=Math.pow(2,7),Vie=Math.pow(2,14),zie=Math.pow(2,21),Fie=Math.pow(2,28),$ie=Math.pow(2,35),Kie=Math.pow(2,42),qie=Math.pow(2,49),Hie=Math.pow(2,56),Gie=Math.pow(2,63),Wie=function(e){return e<jie?1:e<Vie?2:e<zie?3:e<Fie?4:e<$ie?5:e<Kie?6:e<qie?7:e<Hie?8:e<Gie?9:10},Yie={encode:Rie,decode:Lie,encodingLength:Wie},Jie=Yie,Qie=Jie;const Xie=(e,t,r=0)=>(Qie.encode(e,t,r),t),Zie=e=>Qie.encodingLength(e),ese=(e,t)=>{const r=t.byteLength,n=Zie(e),i=n+Zie(r),s=new Uint8Array(i+r);return Xie(e,s,0),Xie(r,s,n),s.set(t,i),new tse(e,r,t,s)};class tse{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const rse=({name:e,code:t,encode:r})=>new nse(e,t,r);class nse{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?ese(this.code,t):t.then((e=>ese(this.code,e)))}throw Error("Unknown type, must be binary type")}}const ise=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),sse=rse({name:"sha2-256",code:18,encode:ise("SHA-256")}),ose=rse({name:"sha2-512",code:19,encode:ise("SHA-512")}),ase=0,cse="identity",lse=zne,use=e=>ese(ase,lse(e)),hse={code:ase,name:cse,encode:lse,digest:use},dse="raw",fse=85,pse=e=>zne(e),yse=e=>zne(e),gse=new TextEncoder,mse=new TextDecoder,wse="json",bse=512,vse=e=>gse.encode(JSON.stringify(e)),Ese=e=>JSON.parse(mse.decode(e));new WeakMap;class _se{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==multistream_select_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==multistream_select_node_modules_multiformats_src_cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return _se.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return _se.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return _se.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return multistream_select_node_modules_multiformats_src_cid_format(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof _se)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new _se(e,r,n,i||multistream_select_node_modules_multiformats_src_cid_encodeCID(e,r,n.bytes))}if(!0===t[multistream_select_node_modules_multiformats_src_cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,i=Digest.decode(r);return _se.create(e,n,i)}return null}static create(e,t,r){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==multistream_select_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${multistream_select_node_modules_multiformats_src_cid_DAG_PB_CODE}) block encoding`);return new _se(e,t,r,r.bytes);case 1:{const n=multistream_select_node_modules_multiformats_src_cid_encodeCID(e,t,r.bytes);return new _se(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return _se.create(0,multistream_select_node_modules_multiformats_src_cid_DAG_PB_CODE,e)}static createV1(e,t){return _se.create(1,e,t)}static decode(e){const[t,r]=_se.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=_se.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Digest.Digest(t.multihashCode,t.digestSize,i,n),o=0===t.version?_se.createV0(s):_se.createV1(t.codec,s);return[o,e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),i=multistream_select_node_modules_multiformats_src_cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a,l=c-s;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:l,size:c}}static parse(e,t){const[r,n]=multistream_select_node_modules_multiformats_src_cid_parseCIDtoBytes(e,t),i=_se.decode(n);return multistream_select_node_modules_multiformats_src_cid_baseCache(i).set(r,e),i}}Symbol.for("@ipld/js-cid/CID");const Sse={...Kt,...qt,...Ht,...Gt,...Wt,...Yt,...Jt,...Qt,...Xt,...Zt};function Ase(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Ise(e=0){return null!=globalThis.Buffer?.allocUnsafe?Ase(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Cse(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const kse=Cse("utf8","u",(e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)}),(e=>{const t=new TextEncoder;return t.encode(e.substring(1))})),Tse=Cse("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=Ise(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Rse={utf8:kse,"utf-8":kse,hex:Sse.base16,latin1:Tse,ascii:Tse,binary:Tse,...Sse};var Pse=Rse;function xse(e,t="utf8"){const r=Pse[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Ase(globalThis.Buffer.from(e,"utf-8"))}function Dse(e,t="utf8"){const r=Pse[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}const Ose=xse("\n");function Nse(e){const t=new XL(e,Ose);return t3.single(t)}function Lse(e,t,r={}){const n=Nse(t);!0===r.writeBytes?e.push(n.subarray()):e.push(n)}function Bse(e,t,r={}){const n=new XL;for(const i of t)n.append(Nse(i));!0===r.writeBytes?e.push(n.subarray()):e.push(n)}async function Use(e,t){let r=1;const n={[Symbol.asyncIterator]:()=>n,next:async()=>await e.next(r)};let i=n;null!=t?.signal&&(i=J2(n,t.signal));const s=e=>{r=e},o=await QR(i,o3({onLength:s,maxDataLength:Bne}),(async e=>await Vq(e)));if(null==o||0===o.length)throw mn(new Error("no buffer returned"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");if(o.get(o.byteLength-1)!==Ose[0])throw mn(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return o.sublist(0,-1)}async function Mse(e,t){const r=await Use(e,t);return Dse(r.subarray())}const jse=gn("libp2p:mss:select");async function Vse(e,t,r={}){t=Array.isArray(t)?[...t]:[t];const{reader:n,writer:i,rest:s,stream:o}=wre(e),a=t.shift();if(null==a)throw new Error("At least one protocol must be specified");jse('select: write ["%s", "%s"]',Lne,a);const c=xse(Lne),l=xse(a);Bse(i,[c,l],r);let u=await Mse(n,r);if(jse('select: read "%s"',u),u===Lne&&(u=await Mse(n,r),jse('select: read "%s"',u)),u===a)return s(),{stream:o,protocol:a};for(const h of t){jse('select: write "%s"',h),Lse(i,xse(h),r);const e=await Mse(n,r);if(jse('select: read "%s" for "%s"',e,h),e===h)return s(),{stream:o,protocol:h}}throw s(),mn(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}const zse=gn("libp2p:mss:handle");async function Fse(e,t,r){t=Array.isArray(t)?t:[t];const{writer:n,reader:i,rest:s,stream:o}=wre(e);while(1){const e=await Mse(i,r);if(zse('read "%s"',e),e!==Lne){if(t.includes(e))return Lse(n,xse(e),r),zse('respond with "%s" for "%s"',e,e),s(),{stream:o,protocol:e};"ls"!==e?(Lse(n,xse("na"),r),zse('respond with "na" for "%s"',e)):(Lse(n,new XL(...t.map((e=>Nse(xse(e))))),r),zse('respond with "%s" for %s',t,e))}else zse('respond with "%s" for "%s"',Lne,e),Lse(n,xse(Lne),r)}}var $se=r(9633);const Kse=Symbol.for("@libp2p/connection");const qse=gn("libp2p:connection");class Hse{constructor(e){const{remoteAddr:t,remotePeer:r,newStream:n,close:i,getStreams:s,stat:o}=e;this.id=`${parseInt(String(1e9*Math.random())).toString(36)}${Date.now()}`,this.remoteAddr=t,this.remotePeer=r,this.stat={...o,status:Gte},this._newStream=n,this._close=i,this._getStreams=s,this.tags=[],this._closing=!1}get[Symbol.toStringTag](){return"Connection"}get[Kse](){return!0}get streams(){return this._getStreams()}async newStream(e,t){if(this.stat.status===Wte)throw mn(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===Yte)throw mn(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);const r=await this._newStream(e,t);return r.stat.direction="outbound",r}addStream(e){e.stat.direction="inbound"}removeStream(e){}async close(){if(this.stat.status!==Yte&&!this._closing){this.stat.status=Wte;try{this.streams.forEach((e=>e.close()))}catch(WV){qse.error(WV)}this._closing=!0,await this._close(),this._closing=!1,this.stat.timeline.close=Date.now(),this.stat.status=Yte}}}function Gse(e){return new Hse(e)}const Wse=gn("libp2p:registrar"),Yse=32,Jse=64;class Qse{constructor(e){this.topologies=new Map,this.handlers=new Map,this.components=e,this._onDisconnect=this._onDisconnect.bind(this),this._onProtocolChange=this._onProtocolChange.bind(this),this.components.getConnectionManager().addEventListener("peer:disconnect",this._onDisconnect),this.components.getPeerStore().addEventListener("change:protocols",this._onProtocolChange)}getProtocols(){return Array.from(new Set([...this.topologies.keys(),...this.handlers.keys()])).sort()}getHandler(e){const t=this.handlers.get(e);if(null==t)throw mn(new Error(`No handler registered for protocol ${e}`),Tte.ERR_NO_HANDLER_FOR_PROTOCOL);return t}getTopologies(e){const t=this.topologies.get(e);return null==t?[]:[...t.values()]}async handle(e,t,r){if(this.handlers.has(e))throw mn(new Error(`Handler already registered for protocol ${e}`),Tte.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);const n=Wr.bind({ignoreUndefined:!0})({maxInboundStreams:Yse,maxOutboundStreams:Jse},r);this.handlers.set(e,{handler:t,options:n}),await this.components.getPeerStore().protoBook.add(this.components.getPeerId(),[e])}async unhandle(e){const t=Array.isArray(e)?e:[e];t.forEach((e=>{this.handlers.delete(e)})),await this.components.getPeerStore().protoBook.remove(this.components.getPeerId(),t)}async register(e,t){if(!e0(t))throw Wse.error("topology must be an instance of interfaces/topology"),mn(new Error("topology must be an instance of interfaces/topology"),Tte.ERR_INVALID_PARAMETERS);const r=`${(1e9*Math.random()).toString(36)}${Date.now()}`;let n=this.topologies.get(e);return null==n&&(n=new Map,this.topologies.set(e,n)),n.set(r,t),await t.setRegistrar(this),r}unregister(e){for(const[t,r]of this.topologies.entries())r.has(e)&&(r.delete(e),0===r.size&&this.topologies.delete(t))}_onDisconnect(e){const t=e.detail;this.components.getPeerStore().protoBook.get(t.remotePeer).then((e=>{for(const r of e){const e=this.topologies.get(r);if(null!=e)for(const r of e.values())r.onDisconnect(t.remotePeer)}})).catch((e=>{Wse.error(e)}))}_onProtocolChange(e){const{peerId:t,protocols:r,oldProtocols:n}=e.detail,i=n.filter((e=>!r.includes(e))),s=r.filter((e=>!n.includes(e)));for(const o of i){const e=this.topologies.get(o);if(null!=e)for(const r of e.values())r.onDisconnect(t)}for(const o of s){const e=this.topologies.get(o);if(null!=e)for(const r of e.values()){const e=this.components.getConnectionManager().getConnections(t)[0];null!=e&&r.onConnect(t,e)}}}}const Xse=gn("libp2p:upgrader");function Zse(e,t){try{const{options:r}=t.getHandler(e);return r.maxInboundStreams}catch(WV){if(WV.code!==Tte.ERR_NO_HANDLER_FOR_PROTOCOL)throw WV}return Yse}function eoe(e,t){try{const{options:r}=t.getHandler(e);return r.maxOutboundStreams}catch(WV){if(WV.code!==Tte.ERR_NO_HANDLER_FOR_PROTOCOL)throw WV}return Jse}function toe(e,t,r){let n=0;return r.streams.forEach((r=>{r.stat.direction===t&&r.stat.protocol===e&&n++})),n}class roe extends o0{constructor(e,t){super(),this.components=e,this.connectionEncryption=new Map,t.connectionEncryption.forEach((e=>{this.connectionEncryption.set(e.protocol,e)})),this.muxers=new Map,t.muxers.forEach((e=>{this.muxers.set(e.protocol,e)})),this.inboundUpgradeTimeout=t.inboundUpgradeTimeout}async upgradeInbound(e){let t,r,n,i,s,o,a;const c=this.components.getMetrics(),l=new Ql.TimeoutController(this.inboundUpgradeTimeout);try{(0,Ote.setMaxListeners)?.(1/0,l.signal)}catch{}try{const u=X2(e,l.signal);if(e.source=u.source,e.sink=u.sink,await this.components.getConnectionGater().denyInboundConnection(e))throw mn(new Error("The multiaddr connection is blocked by gater.acceptConnection"),Tte.ERR_CONNECTION_INTERCEPTED);if(null!=c){({setTarget:o,proxy:a}=$se());const t=`${(1e9*Math.random()).toString(36)}${Date.now()}`;o({toString:()=>t}),c.trackStream({stream:e,remotePeer:a})}Xse("starting the inbound connection upgrade");let h=e;const d=this.components.getConnectionProtector();null!=d&&(Xse("protecting the inbound connection"),h=await d.protect(e));try{if(({conn:t,remotePeer:r,protocol:s}=await this._encryptInbound(h)),await this.components.getConnectionGater().denyInboundEncryptedConnection(r,{...h,...t}))throw mn(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Tte.ERR_CONNECTION_INTERCEPTED);if(this.muxers.size>0){const e=await this._multiplexInbound({...h,...t},this.muxers);i=e.muxerFactory,n=e.stream}else n=t}catch(WV){throw Xse.error("Failed to upgrade inbound connection",WV),await e.close(WV),WV}if(await this.components.getConnectionGater().denyInboundUpgradedConnection(r,{...h,...t}))throw mn(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Tte.ERR_CONNECTION_INTERCEPTED);return null!=c&&(c.updatePlaceholder(a,r),o(r)),Xse("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:s,direction:"inbound",maConn:e,upgradedConn:n,muxerFactory:i,remotePeer:r})}finally{l.clear()}}async upgradeOutbound(e){const t=e.remoteAddr.getPeerId();if(null==t)throw mn(new Error("outbound connection must have a peer id"),Tte.ERR_INVALID_MULTIADDR);const r=s_(t);if(await this.components.getConnectionGater().denyOutboundConnection(r,e))throw mn(new Error("The multiaddr connection is blocked by connectionGater.denyOutboundConnection"),Tte.ERR_CONNECTION_INTERCEPTED);let n,i,s,o,a,c,l;const u=this.components.getMetrics();if(null!=u){({setTarget:c,proxy:l}=$se());const t=`${(1e9*Math.random()).toString(36)}${Date.now()}`;c({toB58String:()=>t}),u.trackStream({stream:e,remotePeer:l})}Xse("Starting the outbound connection upgrade");let h=e;const d=this.components.getConnectionProtector();null!=d&&(h=await d.protect(e));try{if(({conn:n,remotePeer:i,protocol:o}=await this._encryptOutbound(h,r)),await this.components.getConnectionGater().denyOutboundEncryptedConnection(i,{...h,...n}))throw mn(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Tte.ERR_CONNECTION_INTERCEPTED);if(this.muxers.size>0){const e=await this._multiplexOutbound({...h,...n},this.muxers);a=e.muxerFactory,s=e.stream}else s=n}catch(WV){throw Xse.error("Failed to upgrade outbound connection",WV),await e.close(WV),WV}if(await this.components.getConnectionGater().denyOutboundUpgradedConnection(i,{...h,...n}))throw mn(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),Tte.ERR_CONNECTION_INTERCEPTED);return null!=u&&(u.updatePlaceholder(l,i),c(i)),Xse("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:o,direction:"outbound",maConn:e,upgradedConn:s,muxerFactory:a,remotePeer:i})}_createConnection(e){const{cryptoProtocol:t,direction:r,maConn:n,upgradedConn:i,remotePeer:s,muxerFactory:o}=e;let a,c,l;null!=o&&(a=o.createStreamMuxer({direction:r,onIncomingStream:e=>{null!=l&&Promise.resolve().then((async()=>{const t=this.components.getRegistrar().getProtocols(),{stream:n,protocol:i}=await Fse(e,t);Xse("%s: incoming stream opened on %s",r,i);const o=this.components.getMetrics();if(null!=o&&o.trackStream({stream:n,remotePeer:s,protocol:i}),null==l)return;const a=Zse(i,this.components.getRegistrar()),c=toe(i,"inbound",l);c!==a?(e.source=n.source,e.sink=n.sink,e.stat.protocol=i,this.components.getPeerStore().protoBook.add(s,[i]).catch((e=>Xse.error(e))),l.addStream(e),this._onStream({connection:l,stream:e,protocol:i})):e.abort(mn(new Error(`Too many inbound protocol streams for protocol "${i}" - limit ${a}`),Tte.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS))})).catch((t=>{Xse.error(t),null==e.stat.timeline.close&&e.close()}))},onStreamEnd:e=>{l?.removeStream(e.id)}}),_2(a)&&a.init(this.components),c=async(e,t={})=>{if(null==a)throw mn(new Error("Stream is not multiplexed"),Tte.ERR_MUXER_UNAVAILABLE);Xse("%s: starting new stream on %s",r,e);const n=a.newStream(),i=this.components.getMetrics();let o;try{if(null==t.signal){Xse("No abort signal was passed while trying to negotiate protocols %s falling back to default timeout",e),o=new Ql.TimeoutController(3e4),t.signal=o.signal;try{(0,Ote.setMaxListeners)?.(1/0,o.signal)}catch{}}const{stream:r,protocol:a}=await Vse(n,e,t);null!=i&&i.trackStream({stream:r,remotePeer:s,protocol:a});const c=eoe(a,this.components.getRegistrar()),u=toe(a,"outbound",l);if(u===c){const e=mn(new Error(`Too many outbound protocol streams for protocol "${a}" - limit ${c}`),Tte.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS);throw n.abort(e),e}return this.components.getPeerStore().protoBook.add(s,[a]).catch((e=>Xse.error(e))),n.source=r.source,n.sink=r.sink,n.stat.protocol=a,n}catch(WV){if(Xse.error("could not create new stream",WV),null==n.stat.timeline.close&&n.close(),null!=WV.code)throw WV;throw mn(WV,Tte.ERR_UNSUPPORTED_PROTOCOL)}finally{null!=o&&o.clear()}},QR(i,a,i).catch(Xse.error));const u=n.timeline;n.timeline=new Proxy(u,{set:(...e)=>(null!=l&&"close"===e[1]&&null!=e[2]&&null==u.close&&(async()=>{try{"OPEN"===l.stat.status&&await l.close()}catch(WV){Xse.error(WV)}finally{this.dispatchEvent(new c0("connectionEnd",{detail:l}))}})().catch((e=>{Xse.error(e)})),Reflect.set(...e))}),n.timeline.upgraded=Date.now();const h=()=>{throw mn(new Error("connection is not multiplexed"),Tte.ERR_CONNECTION_NOT_MULTIPLEXED)};return l=Gse({remoteAddr:n.remoteAddr,remotePeer:s,stat:{status:"OPEN",direction:r,timeline:n.timeline,multiplexer:a?.protocol,encryption:t},newStream:c??h,getStreams:()=>null!=a?a.streams:h(),close:async()=>{await n.close(),null!=a&&a.close()}}),this.dispatchEvent(new c0("connection",{detail:l})),l}_onStream(e){const{connection:t,stream:r,protocol:n}=e,{handler:i}=this.components.getRegistrar().getHandler(n);i({connection:t,stream:r})}async _encryptInbound(e){const t=Array.from(this.connectionEncryption.keys());Xse("handling inbound crypto protocol selection",t);try{const{stream:r,protocol:n}=await Fse(e,t,{writeBytes:!0}),i=this.connectionEncryption.get(n);if(null==i)throw new Error(`no crypto module found for ${n}`);return Xse("encrypting inbound connection..."),{...await i.secureInbound(this.components.getPeerId(),r),protocol:n}}catch(WV){throw mn(WV,Tte.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,t){const r=Array.from(this.connectionEncryption.keys());Xse("selecting outbound crypto protocol",r);try{const{stream:n,protocol:i}=await Vse(e,r,{writeBytes:!0}),s=this.connectionEncryption.get(i);if(null==s)throw new Error(`no crypto module found for ${i}`);return Xse("encrypting outbound connection to %p",t),{...await s.secureOutbound(this.components.getPeerId(),n,t),protocol:i}}catch(WV){throw mn(WV,Tte.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,t){const r=Array.from(t.keys());Xse("outbound selecting muxer %s",r);try{const{stream:n,protocol:i}=await Vse(e,r,{writeBytes:!0});Xse("%s selected as muxer protocol",i);const s=t.get(i);return{stream:n,muxerFactory:s}}catch(WV){throw Xse.error("error multiplexing outbound stream",WV),mn(WV,Tte.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,t){const r=Array.from(t.keys());Xse("inbound handling muxers %s",r);try{const{stream:n,protocol:i}=await Fse(e,r,{writeBytes:!0}),s=t.get(i);return{stream:n,muxerFactory:s}}catch(WV){throw Xse.error("error multiplexing inbound stream",WV),mn(WV,Tte.ERR_MUXER_UNAVAILABLE)}}}var noe;(function(e){let t;e.codec=()=>(null==t&&(t=BT(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null!=e.protocolVersion&&(t.uint32(42),t.string(e.protocolVersion)),null!=e.agentVersion&&(t.uint32(50),t.string(e.agentVersion)),null!=e.publicKey&&(t.uint32(10),t.bytes(e.publicKey)),null==e.listenAddrs)throw new Error('Protocol error: required field "listenAddrs" was not found in object');for(const n of e.listenAddrs)t.uint32(18),t.bytes(n);if(null!=e.observedAddr&&(t.uint32(34),t.bytes(e.observedAddr)),null==e.protocols)throw new Error('Protocol error: required field "protocols" was not found in object');for(const n of e.protocols)t.uint32(26),t.string(n);null!=e.signedPeerRecord&&(t.uint32(66),t.bytes(e.signedPeerRecord)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 5:r.protocolVersion=e.string();break;case 6:r.agentVersion=e.string();break;case 1:r.publicKey=e.bytes();break;case 2:r.listenAddrs=r.listenAddrs??[],r.listenAddrs.push(e.bytes());break;case 4:r.observedAddr=e.bytes();break;case 3:r.protocols=r.protocols??[],r.protocols.push(e.string());break;case 8:r.signedPeerRecord=e.bytes();break;default:e.skipType(7&t);break}}if(r.listenAddrs=r.listenAddrs??[],r.protocols=r.protocols??[],null==r.listenAddrs)throw new Error('Protocol error: value for required field "listenAddrs" was not found in protobuf');if(null==r.protocols)throw new Error('Protocol error: value for required field "protocols" was not found in protobuf');return r}))),t),e.encode=t=>xT(t,e.codec()),e.decode=t=>TT(t,e.codec())})(noe||(noe={}));const ioe="0.0.0",soe="libp2p",ooe=`js-libp2p/${ioe}`,aoe="0.1.0",coe="id",loe="id/push",uoe="1.0.0",hoe="1.0.0",doe=gn("libp2p:identify"),foe=8192;class poe{constructor(e,t){this.components=e,this.started=!1,this.init=t,this.identifyProtocolStr=`/${t.protocolPrefix}/${coe}/${uoe}`,this.identifyPushProtocolStr=`/${t.protocolPrefix}/${loe}/${hoe}`,this.host={protocolVersion:`${t.protocolPrefix}/${aoe}`,...t.host},this.components.getConnectionManager().addEventListener("peer:connect",(e=>{const t=e.detail;this.identify(t).catch(doe.error)})),this.components.getPeerStore().addEventListener("change:multiaddrs",(e=>{const{peerId:t}=e.detail;this.components.getPeerId().equals(t)&&this.pushToPeerStore().catch((e=>doe.error(e)))})),this.components.getPeerStore().addEventListener("change:protocols",(e=>{const{peerId:t}=e.detail;this.components.getPeerId().equals(t)&&this.pushToPeerStore().catch((e=>doe.error(e)))}))}isStarted(){return this.started}async start(){this.started||(await this.components.getPeerStore().metadataBook.setValue(this.components.getPeerId(),"AgentVersion",Jl(this.host.agentVersion)),await this.components.getPeerStore().metadataBook.setValue(this.components.getPeerId(),"ProtocolVersion",Jl(this.host.protocolVersion)),await this.components.getRegistrar().handle(this.identifyProtocolStr,(e=>{this._handleIdentify(e).catch((e=>{doe.error(e)}))}),{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),await this.components.getRegistrar().handle(this.identifyPushProtocolStr,(e=>{this._handlePush(e).catch((e=>{doe.error(e)}))}),{maxInboundStreams:this.init.maxPushIncomingStreams,maxOutboundStreams:this.init.maxPushOutgoingStreams}),this.started=!0)}async stop(){await this.components.getRegistrar().unhandle(this.identifyProtocolStr),await this.components.getRegistrar().unhandle(this.identifyPushProtocolStr),this.started=!1}async push(e){const t=await this.components.getPeerStore().addressBook.getRawEnvelope(this.components.getPeerId()),r=this.components.getAddressManager().getAddresses().map((e=>e.bytes)),n=await this.components.getPeerStore().protoBook.get(this.components.getPeerId()),i=e.map((async e=>{let i;const s=new Ql.TimeoutController(this.init.timeout);try{(0,Ote.setMaxListeners)?.(1/0,s.signal)}catch{}try{i=await e.newStream([this.identifyPushProtocolStr],{signal:s.signal});const o=X2(i,s.signal);await QR([noe.encode({listenAddrs:r,signedPeerRecord:t,protocols:n})],t3(),o,RR)}catch(WV){doe.error("could not push identify update to peer",WV)}finally{null!=i&&i.close(),s.clear()}}));await Promise.all(i)}async pushToPeerStore(){if(!this.isStarted())return;const e=[];for(const t of this.components.getConnectionManager().getConnections()){const r=t.remotePeer,n=await this.components.getPeerStore().get(r);n.protocols.includes(this.identifyPushProtocolStr)&&e.push(t)}await this.push(e)}async _identify(e,t={}){let r,n,i=t.signal;if(null==i){r=new Ql.TimeoutController(this.init.timeout),i=r.signal;try{(0,Ote.setMaxListeners)?.(1/0,r.signal)}catch{}}try{n=await e.newStream([this.identifyProtocolStr],{signal:i});const t=X2(n,i),s=await QR([],t,o3({maxDataLength:this.init.maxIdentifyMessageSize??foe}),(async e=>await Vq(e)));if(null==s)throw mn(new Error("No data could be retrieved"),Tte.ERR_CONNECTION_ENDED);try{return noe.decode(s)}catch(WV){throw mn(WV,Tte.ERR_INVALID_MESSAGE)}}finally{null!=r&&r.clear(),null!=n&&n.close()}}async identify(e,t={}){const r=await this._identify(e,t),{publicKey:n,listenAddrs:i,protocols:s,observedAddr:o,signedPeerRecord:a,agentVersion:c,protocolVersion:l}=r;if(null==n)throw mn(new Error("public key was missing from identify message"),Tte.ERR_MISSING_PUBLIC_KEY);const u=await c_(n);if(!e.remotePeer.equals(u))throw mn(new Error("identified peer does not match the expected peer"),Tte.ERR_INVALID_PEER);if(this.components.getPeerId().equals(u))throw mn(new Error("identified peer is our own peer id?"),Tte.ERR_INVALID_PEER);const h=poe.getCleanMultiaddr(o);if(null!=a){doe("received signed peer record from %p",u);try{const e=await H1.openAndCertify(a,X1.DOMAIN);if(!e.peerId.equals(u))throw mn(new Error("identified peer does not match the expected peer"),Tte.ERR_INVALID_PEER);if(await this.components.getPeerStore().addressBook.consumePeerRecord(e))return await this.components.getPeerStore().protoBook.set(u,s),null!=c&&await this.components.getPeerStore().metadataBook.setValue(u,"AgentVersion",Jl(c)),null!=l&&await this.components.getPeerStore().metadataBook.setValue(u,"ProtocolVersion",Jl(l)),void doe("identify completed for peer %p and protocols %o",u,s)}catch(WV){doe("received invalid envelope, discard it and fallback to listenAddrs is available",WV)}}else doe("no signed peer record received from %p",u);doe("falling back to legacy addresses from %p",u);try{await this.components.getPeerStore().addressBook.set(u,i.map((e=>Pp(e))))}catch(WV){doe.error("received invalid addrs",WV)}await this.components.getPeerStore().protoBook.set(u,s),null!=c&&await this.components.getPeerStore().metadataBook.setValue(u,"AgentVersion",Jl(c)),null!=l&&await this.components.getPeerStore().metadataBook.setValue(u,"ProtocolVersion",Jl(l)),doe("identify completed for peer %p and protocols %o",u,s),doe("received observed address of %s",h?.toString())}async _handleIdentify(e){const{connection:t,stream:r}=e,n=new Ql.TimeoutController(this.init.timeout);try{(0,Ote.setMaxListeners)?.(1/0,n.signal)}catch{}try{const e=this.components.getPeerId().publicKey??new Uint8Array(0),i=await this.components.getPeerStore().get(this.components.getPeerId()),s=this.components.getAddressManager().getAddresses().map((e=>e.decapsulateCode(Df("p2p").code)));let o=i.peerRecordEnvelope;if(s.length>0&&null==o){const e=new X1({peerId:this.components.getPeerId(),multiaddrs:s}),t=await H1.seal(e,this.components.getPeerId());await this.components.getPeerStore().addressBook.consumePeerRecord(t),o=t.marshal().subarray()}const a=noe.encode({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:e,listenAddrs:s.map((e=>e.bytes)),signedPeerRecord:o,observedAddr:t.remoteAddr.bytes,protocols:i.protocols}),c=X2(r,n.signal);await QR([a],t3(),c,RR)}catch(WV){doe.error("could not respond to identify request",WV)}finally{r.close(),n.clear()}}async _handlePush(e){const{connection:t,stream:r}=e,n=new Ql.TimeoutController(this.init.timeout);try{(0,Ote.setMaxListeners)?.(1/0,n.signal)}catch{}let i;try{const e=X2(r,n.signal),t=await QR([],e,o3({maxDataLength:this.init.maxIdentifyMessageSize??foe}),(async e=>await Vq(e)));null!=t&&(i=noe.decode(t))}catch(WV){return doe.error("received invalid message",WV)}finally{r.close(),n.clear()}if(null==i)return doe.error("received invalid message");const s=t.remotePeer;if(this.components.getPeerId().equals(s))doe("received push from ourselves?");else{if(doe("received push from %p",s),null!=i.signedPeerRecord){doe("received signedPeerRecord in push");try{const e=await H1.openAndCertify(i.signedPeerRecord,X1.DOMAIN);if(await this.components.getPeerStore().addressBook.consumePeerRecord(e))return doe("consumed signedPeerRecord sent in push"),void await this.components.getPeerStore().protoBook.set(s,i.protocols);doe("failed to consume signedPeerRecord sent in push")}catch(WV){doe("received invalid envelope, discard it and fallback to listenAddrs is available",WV)}}else doe("did not receive signedPeerRecord in push");try{await this.components.getPeerStore().addressBook.set(s,i.listenAddrs.map((e=>Pp(e))))}catch(WV){doe.error("received invalid addrs",WV)}try{await this.components.getPeerStore().protoBook.set(s,i.protocols)}catch(WV){doe.error("received invalid protocols",WV)}doe("handled push from %p",s)}}static getCleanMultiaddr(e){if(null!=e&&e.length>0)try{return Pp(e)}catch{}}}var yoe,goe;(function(e){let t;e.codec=()=>(null==t&&(t=BT(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null==e.identifier)throw new Error('Protocol error: required field "identifier" was not found in object');t.uint32(10),t.string(e.identifier),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.identifier=e.string();break;default:e.skipType(7&t);break}}if(null==r.identifier)throw new Error('Protocol error: value for required field "identifier" was not found in protobuf');return r}))),t),e.encode=t=>xT(t,e.codec()),e.decode=t=>TT(t,e.codec())})(yoe||(yoe={})),function(e){let t,r,n;(function(e){e["OK"]="OK",e["NOT_FOUND"]="NOT_FOUND",e["ERROR"]="ERROR"})(t=e.StatusCode||(e.StatusCode={})),function(e){e[e["OK"]=0]="OK",e[e["NOT_FOUND"]=1]="NOT_FOUND",e[e["ERROR"]=2]="ERROR"}(r||(r={})),function(e){e.codec=()=>LT(r)}(t=e.StatusCode||(e.StatusCode={})),e.codec=()=>(null==n&&(n=BT(((t,r,n={})=>{if(!1!==n.lengthDelimited&&r.fork(),null==t.status)throw new Error('Protocol error: required field "status" was not found in object');if(r.uint32(8),e.StatusCode.codec().encode(t.status,r),null==t.data)throw new Error('Protocol error: required field "data" was not found in object');r.uint32(18),r.bytes(t.data),!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={},i=null==r?t.len:t.pos+r;while(t.pos<i){const r=t.uint32();switch(r>>>3){case 1:n.status=e.StatusCode.codec().decode(t);break;case 2:n.data=t.bytes();break;default:t.skipType(7&r);break}}if(null==n.status)throw new Error('Protocol error: value for required field "status" was not found in protobuf');if(null==n.data)throw new Error('Protocol error: value for required field "data" was not found in protobuf');return n}))),n),e.encode=t=>xT(t,e.codec()),e.decode=t=>TT(t,e.codec())}(goe||(goe={}));const moe="0.0.1",woe="fetch",boe=gn("libp2p:fetch");class voe{constructor(e,t){this.started=!1,this.components=e,this.protocol=`/${t.protocolPrefix??"libp2p"}/${woe}/${moe}`,this.lookupFunctions=new Map,this.handleMessage=this.handleMessage.bind(this),this.init=t}async start(){await this.components.getRegistrar().handle(this.protocol,(e=>{this.handleMessage(e).catch((e=>{boe.error(e)})).finally((()=>{e.stream.close()}))}),{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),this.started=!0}async stop(){await this.components.getRegistrar().unhandle(this.protocol),this.started=!1}isStarted(){return this.started}async fetch(e,t,r={}){boe("dialing %s to %p",this.protocol,e);const n=await this.components.getConnectionManager().openConnection(e,r);let i,s,o=r.signal;if(null==o){i=new Ql.TimeoutController(this.init.timeout),o=i.signal;try{(0,Ote.setMaxListeners)?.(1/0,i.signal)}catch{}}try{s=await n.newStream([this.protocol],{signal:o});const e=X2(s,o),r=await QR([yoe.encode({identifier:t})],t3(),e,o3(),(async function(e){const t=await Vq(e);if(null==t)throw mn(new Error("No data received"),Tte.ERR_INVALID_MESSAGE);const r=goe.decode(t);switch(r.status){case goe.StatusCode.OK:return r.data;case goe.StatusCode.NOT_FOUND:return null;case goe.StatusCode.ERROR:{const e=(new TextDecoder).decode(r.data);throw mn(new Error("Error in fetch protocol response: "+e),Tte.ERR_INVALID_PARAMETERS)}default:throw mn(new Error("Unknown response status"),Tte.ERR_INVALID_MESSAGE)}}));return r??null}finally{null!=i&&i.clear(),null!=s&&s.close()}}async handleMessage(e){const{stream:t}=e,r=this;await QR(t,o3(),(async function*(e){const t=await Vq(e);if(null==t)throw mn(new Error("No data received"),Tte.ERR_INVALID_MESSAGE);const n=yoe.decode(t);let i;const s=r._getLookupFunction(n.identifier);if(null!=s){const e=await s(n.identifier);i=null!=e?{status:goe.StatusCode.OK,data:e}:{status:goe.StatusCode.NOT_FOUND,data:new Uint8Array(0)}}else{const e=(new TextEncoder).encode("No lookup function registered for key: "+n.identifier);i={status:goe.StatusCode.ERROR,data:e}}yield goe.encode(i)}),t3(),t)}_getLookupFunction(e){for(const t of this.lookupFunctions.keys())if(e.startsWith(t))return this.lookupFunctions.get(t)}registerLookupFunction(e,t){if(this.lookupFunctions.has(e))throw mn(new Error("Fetch protocol handler for key prefix '"+e+"' already registered"),Tte.ERR_KEY_ALREADY_EXISTS);this.lookupFunctions.set(e,t)}unregisterLookupFunction(e,t){if(null!=t){const r=this.lookupFunctions.get(e);if(r!==t)return}this.lookupFunctions.delete(e)}}const Eoe=32,_oe="1.0.0",Soe="ping",Aoe=gn("libp2p:ping");class Ioe{constructor(e,t){this.components=e,this.started=!1,this.protocol=`/${t.protocolPrefix}/${Soe}/${_oe}`,this.init=t}async start(){await this.components.getRegistrar().handle(this.protocol,this.handleMessage,{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),this.started=!0}async stop(){await this.components.getRegistrar().unhandle(this.protocol),this.started=!1}isStarted(){return this.started}handleMessage(e){const{stream:t}=e;QR(t,t).catch((e=>{Aoe.error(e)}))}async ping(e,t={}){Aoe("dialing %s to %p",this.protocol,e);const r=Date.now(),n=uC(Eoe),i=await this.components.getConnectionManager().openConnection(e,t);let s,o,a=t.signal;if(null==a){s=new Ql.TimeoutController(this.init.timeout),a=s.signal;try{(0,Ote.setMaxListeners)?.(1/0,s.signal)}catch{}}try{o=await i.newStream([this.protocol],{signal:a});const e=X2(o,a),t=await QR([n],e,(async e=>await Vq(e))),c=Date.now();if(null==t||!k_(n,t.subarray()))throw mn(new Error("Received wrong ping ack"),Tte.ERR_WRONG_PING_ACK);return c-r}finally{null!=s&&s.clear(),null!=o&&o.close()}}}async function Coe(){throw new Error("Not supported in browsers")}var koe=r(9134);const Toe="object"===typeof window&&"object"===typeof document&&9===document.nodeType,Roe=koe(),Poe=Toe&&!Roe,xoe=Roe&&!Toe,Doe=Roe&&Toe,Ooe="undefined"!==typeof globalThis.process&&"undefined"!==typeof globalThis.process.release&&"node"===globalThis.process.release.name&&!Roe,Noe="function"===typeof importScripts&&"undefined"!==typeof self&&"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,Loe=("undefined"!==typeof globalThis.process&&"undefined"!==typeof globalThis.process.env&&globalThis.process.env["NODE"+(()=>"_")()+"ENV"],"undefined"!==typeof navigator&&"ReactNative"===navigator.product);function Boe(e){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^::1$/.test(e)}function Uoe(e){const{address:t}=e.nodeAddress();return Boe(t)}const Moe=gn("libp2p:nat"),joe=7200;function Voe(e=1024,t=65535){return Math.floor(Math.random()*(t-e+1)+e)}class zoe{constructor(e,t){if(this.components=e,this.started=!1,this.enabled=t.enabled,this.externalAddress=t.externalAddress,this.localAddress=t.localAddress,this.description=t.description??`${soe}@${ioe} ${this.components.getPeerId().toString()}`,this.ttl=t.ttl??joe,this.keepAlive=t.keepAlive??!0,this.gateway=t.gateway,this.ttl<joe)throw mn(new Error(`NatManager ttl should be at least ${joe} seconds`),Tte.ERR_INVALID_PARAMETERS)}isStarted(){return this.started}start(){}afterStart(){Poe||!this.enabled||this.started||(this.started=!0,this._start().catch((e=>{Moe.error(e)})))}async _start(){const e=this.components.getTransportManager().getAddrs();for(const t of e){const{family:e,host:r,port:n,transport:i}=t.toOptions();if(!t.isThinWaistAddress()||"tcp"!==i)continue;if(Uoe(t))continue;if(4!==e)continue;const s=await this._getClient(),o=this.externalAddress??await s.externalIp();if(jre(o))throw new Error(`${o} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);const a=Voe();Moe(`opening uPnP connection from ${o}:${a} to ${r}:${n}`),await s.map({publicPort:a,localPort:n,localAddress:this.localAddress,protocol:"TCP"===i.toUpperCase()?"TCP":"UDP"}),this.components.getAddressManager().addObservedAddr(Cp({family:4,address:o,port:a},i))}}async _getClient(){return null!=this.client||(this.client=await Coe({description:this.description,ttl:this.ttl,keepAlive:this.keepAlive,gateway:this.gateway})),this.client}async stop(){if(!Poe&&null!=this.client)try{await this.client.close(),this.client=void 0}catch(WV){Moe.error(WV)}}}const Foe=gn("libp2p:peer-record-updater");class $oe{constructor(e){this.components=e,this.started=!1,this.update=this.update.bind(this)}isStarted(){return this.started}async start(){this.started=!0,this.components.getTransportManager().addEventListener("listener:listening",this.update),this.components.getTransportManager().addEventListener("listener:close",this.update),this.components.getAddressManager().addEventListener("change:addresses",this.update)}async stop(){this.started=!1,this.components.getTransportManager().removeEventListener("listener:listening",this.update),this.components.getTransportManager().removeEventListener("listener:close",this.update),this.components.getAddressManager().removeEventListener("change:addresses",this.update)}update(){Promise.resolve().then((async()=>{const e=new X1({peerId:this.components.getPeerId(),multiaddrs:this.components.getAddressManager().getAddresses().map((e=>e.decapsulateCode(Df("p2p").code)))}),t=await H1.seal(e,this.components.getPeerId());await this.components.getPeerStore().addressBook.consumePeerRecord(t)})).catch((e=>{Foe.error("Could not update self peer record: %o",e)}))}}class Koe{constructor(e){this.dht=e}async findPeer(e,t={}){for await(const r of this.dht.findPeer(e,t))if("FINAL_PEER"===r.name)return r.peer;throw mn(new Error(kte.NOT_FOUND),Tte.ERR_NOT_FOUND)}async*getClosestPeers(e,t={}){for await(const r of this.dht.getClosestPeers(e,t))"FINAL_PEER"===r.name&&(yield r.peer)}}const qoe={ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_NOT_FOUND:"ERR_NOT_FOUND"},Hoe=gn("libp2p:peer-store:address-book"),Goe="change:multiaddrs";async function Woe(){return!0}class Yoe{constructor(e,t,r){this.dispatchEvent=e,this.store=t,this.addressFilter=r??Woe}async consumePeerRecord(e){Hoe.trace("consumePeerRecord await write lock");const t=await this.store.lock.writeLock();let r,n,i;Hoe.trace("consumePeerRecord got write lock");try{let s;try{s=X1.createFromProtobuf(e.payload)}catch(WV){return Hoe.error("invalid peer record received"),!1}r=s.peerId;const o=s.multiaddrs;if(!r.equals(e.peerId))return Hoe("signing key does not match PeerId in the PeerRecord"),!1;if(null==o||0===o.length)return!1;if(await this.store.has(r)&&(n=await this.store.load(r),null!=n.peerRecordEnvelope)){const e=await H1.createFromProtobuf(n.peerRecordEnvelope),t=X1.createFromProtobuf(e.payload);if(t.seqNumber>=s.seqNumber)return Hoe("sequence number was lower or equal to existing sequence number - stored: %d received: %d",t.seqNumber,s.seqNumber),!1}const a=await Joe(r,o,this.addressFilter,!0);i=await this.store.patchOrCreate(r,{addresses:a,peerRecordEnvelope:e.marshal().subarray()}),Hoe("stored provided peer record for %p",s.peerId)}finally{Hoe.trace("consumePeerRecord release write lock"),t()}return this.dispatchEvent(new c0(Goe,{detail:{peerId:r,multiaddrs:i.addresses.map((({multiaddr:e})=>e)),oldMultiaddrs:null==n?[]:n.addresses.map((({multiaddr:e})=>e))}})),!0}async getRawEnvelope(e){Hoe.trace("getRawEnvelope await read lock");const t=await this.store.lock.readLock();Hoe.trace("getRawEnvelope got read lock");try{const r=await this.store.load(e);return r.peerRecordEnvelope}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}finally{Hoe.trace("getRawEnvelope release read lock"),t()}}async getPeerRecord(e){const t=await this.getRawEnvelope(e);if(null!=t)return await H1.createFromProtobuf(t)}async get(e){e=i_(e),Hoe.trace("get wait for read lock");const t=await this.store.lock.readLock();Hoe.trace("get got read lock");try{const r=await this.store.load(e);return r.addresses}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}finally{Hoe.trace("get release read lock"),t()}return[]}async set(e,t){if(e=i_(e),!Array.isArray(t))throw Hoe.error("multiaddrs must be an array of Multiaddrs"),mn(new Error("multiaddrs must be an array of Multiaddrs"),qoe.ERR_INVALID_PARAMETERS);Hoe.trace("set await write lock");const r=await this.store.lock.writeLock();Hoe.trace("set got write lock");let n,i,s=!1;try{const o=await Joe(e,t,this.addressFilter);if(0===o.length)return;try{if(n=await this.store.load(e),s=!0,new Set([...o.map((({multiaddr:e})=>e.toString())),...n.addresses.map((({multiaddr:e})=>e.toString()))]).size===n.addresses.length&&o.length===n.addresses.length)return}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}i=await this.store.patchOrCreate(e,{addresses:o}),Hoe("set multiaddrs for %p",e)}finally{Hoe.trace("set multiaddrs for %p",e),Hoe("set release write lock"),r()}this.dispatchEvent(new c0(Goe,{detail:{peerId:e,multiaddrs:i.addresses.map((e=>e.multiaddr)),oldMultiaddrs:null==n?[]:n.addresses.map((({multiaddr:e})=>e))}})),s||this.dispatchEvent(new c0("peer",{detail:{id:e,multiaddrs:i.addresses.map((e=>e.multiaddr)),protocols:i.protocols}}))}async add(e,t){if(e=i_(e),!Array.isArray(t))throw Hoe.error("multiaddrs must be an array of Multiaddrs"),mn(new Error("multiaddrs must be an array of Multiaddrs"),qoe.ERR_INVALID_PARAMETERS);Hoe.trace("add await write lock");const r=await this.store.lock.writeLock();let n,i,s;Hoe.trace("add got write lock");try{const o=await Joe(e,t,this.addressFilter);if(0===o.length)return;try{if(i=await this.store.load(e),n=!0,new Set([...o.map((({multiaddr:e})=>e.toString())),...i.addresses.map((({multiaddr:e})=>e.toString()))]).size===i.addresses.length)return}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}s=await this.store.mergeOrCreate(e,{addresses:o}),Hoe("added multiaddrs for %p",e)}finally{Hoe.trace("set release write lock"),r()}this.dispatchEvent(new c0(Goe,{detail:{peerId:e,multiaddrs:s.addresses.map((e=>e.multiaddr)),oldMultiaddrs:null==i?[]:i.addresses.map((({multiaddr:e})=>e))}})),!0===n&&this.dispatchEvent(new c0("peer",{detail:{id:e,multiaddrs:s.addresses.map((e=>e.multiaddr)),protocols:s.protocols}}))}async delete(e){e=i_(e),Hoe.trace("delete await write lock");const t=await this.store.lock.writeLock();let r;Hoe.trace("delete got write lock");try{try{r=await this.store.load(e)}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}await this.store.patchOrCreate(e,{addresses:[]})}finally{Hoe.trace("delete release write lock"),t()}null!=r&&this.dispatchEvent(new c0(Goe,{detail:{peerId:e,multiaddrs:[],oldMultiaddrs:null==r?[]:r.addresses.map((({multiaddr:e})=>e))}}))}}async function Joe(e,t,r,n=!1){return await QR(t,(e=>hne(e,(e=>{if(!Tp(e))throw Hoe.error("multiaddr must be an instance of Multiaddr"),mn(new Error("multiaddr must be an instance of Multiaddr"),qoe.ERR_INVALID_PARAMETERS)}))),(t=>PR(t,(async t=>await r(e,t)))),(e=>qR(e,(e=>({multiaddr:e,isCertified:n})))),(async e=>await kR(e)))}const Qoe=gn("libp2p:peer-store:key-book"),Xoe="change:pubkey";class Zoe{constructor(e,t){this.dispatchEvent=e,this.store=t}async set(e,t){if(e=i_(e),!(t instanceof Uint8Array))throw Qoe.error("publicKey must be an instance of Uint8Array to store data"),mn(new Error("publicKey must be an instance of PublicKey"),qoe.ERR_INVALID_PARAMETERS);Qoe.trace("set await write lock");const r=await this.store.lock.writeLock();Qoe.trace("set got write lock");let n,i=!1;try{try{if(n=await this.store.load(e),null!=n.pubKey&&k_(n.pubKey,t))return}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}await this.store.patchOrCreate(e,{pubKey:t}),i=!0}finally{Qoe.trace("set release write lock"),r()}i&&this.dispatchEvent(new c0(Xoe,{detail:{peerId:e,publicKey:t,oldPublicKey:null==n?void 0:n.pubKey}}))}async get(e){e=i_(e),Qoe.trace("get await write lock");const t=await this.store.lock.readLock();Qoe.trace("get got write lock");try{const r=await this.store.load(e);return r.pubKey}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}finally{Qoe("get release write lock"),t()}}async delete(e){e=i_(e),Qoe.trace("delete await write lock");const t=await this.store.lock.writeLock();let r;Qoe.trace("delete got write lock");try{try{r=await this.store.load(e)}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}await this.store.patchOrCreate(e,{pubKey:void 0})}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}finally{Qoe.trace("delete release write lock"),t()}this.dispatchEvent(new c0(Xoe,{detail:{peerId:e,publicKey:void 0,oldPublicKey:null==r?void 0:r.pubKey}}))}}const eae=gn("libp2p:peer-store:metadata-book"),tae="change:metadata";class rae{constructor(e,t){this.dispatchEvent=e,this.store=t}async get(e){e=i_(e),eae.trace("get await read lock");const t=await this.store.lock.readLock();eae.trace("get got read lock");try{const r=await this.store.load(e);return r.metadata}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}finally{eae.trace("get release read lock"),t()}return new Map}async getValue(e,t){e=i_(e),eae.trace("getValue await read lock");const r=await this.store.lock.readLock();eae.trace("getValue got read lock");try{const n=await this.store.load(e);return n.metadata.get(t)}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}finally{eae.trace("getValue release write lock"),r()}}async set(e,t){if(e=i_(e),!(t instanceof Map))throw eae.error("valid metadata must be provided to store data"),mn(new Error("valid metadata must be provided"),qoe.ERR_INVALID_PARAMETERS);eae.trace("set await write lock");const r=await this.store.lock.writeLock();let n;eae.trace("set got write lock");try{try{n=await this.store.load(e)}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}await this.store.mergeOrCreate(e,{metadata:t})}finally{eae.trace("set release write lock"),r()}this.dispatchEvent(new c0(tae,{detail:{peerId:e,metadata:t,oldMetadata:null==n?new Map:n.metadata}}))}async setValue(e,t,r){if(e=i_(e),"string"!==typeof t||!(r instanceof Uint8Array))throw eae.error("valid key and value must be provided to store data"),mn(new Error("valid key and value must be provided"),qoe.ERR_INVALID_PARAMETERS);eae.trace("setValue await write lock");const n=await this.store.lock.writeLock();let i,s;eae.trace("setValue got write lock");try{try{i=await this.store.load(e);const n=i.metadata.get(t);if(null!=n&&k_(r,n))return}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}s=await this.store.mergeOrCreate(e,{metadata:new Map([[t,r]])})}finally{eae.trace("setValue release write lock"),n()}this.dispatchEvent(new c0(tae,{detail:{peerId:e,metadata:s.metadata,oldMetadata:null==i?new Map:i.metadata}}))}async delete(e){e=i_(e),eae.trace("delete await write lock");const t=await this.store.lock.writeLock();let r;eae.trace("delete got write lock");try{try{r=await this.store.load(e)}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}null!=r&&await this.store.patch(e,{metadata:new Map})}finally{eae.trace("delete release write lock"),t()}null!=r&&this.dispatchEvent(new c0(tae,{detail:{peerId:e,metadata:new Map,oldMetadata:r.metadata}}))}async deleteValue(e,t){e=i_(e),eae.trace("deleteValue await write lock");const r=await this.store.lock.writeLock();let n,i;eae.trace("deleteValue got write lock");try{i=await this.store.load(e),n=i.metadata,n.delete(t),await this.store.patch(e,{metadata:n})}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}finally{eae.trace("deleteValue release write lock"),r()}null!=n&&this.dispatchEvent(new c0(tae,{detail:{peerId:e,metadata:n,oldMetadata:null==i?new Map:i.metadata}}))}}const nae=gn("libp2p:peer-store:proto-book"),iae="change:protocols";class sae{constructor(e,t){this.dispatchEvent=e,this.store=t}async get(e){nae.trace("get wait for read lock");const t=await this.store.lock.readLock();nae.trace("get got read lock");try{const r=await this.store.load(e);return r.protocols}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}finally{nae.trace("get release read lock"),t()}return[]}async set(e,t){if(e=i_(e),!Array.isArray(t))throw nae.error("protocols must be provided to store data"),mn(new Error("protocols must be provided"),qoe.ERR_INVALID_PARAMETERS);nae.trace("set await write lock");const r=await this.store.lock.writeLock();let n,i;nae.trace("set got write lock");try{try{if(n=await this.store.load(e),new Set([...t]).size===n.protocols.length)return}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}i=await this.store.patchOrCreate(e,{protocols:t}),nae("stored provided protocols for %p",e)}finally{nae.trace("set release write lock"),r()}this.dispatchEvent(new c0(iae,{detail:{peerId:e,protocols:i.protocols,oldProtocols:null==n?[]:n.protocols}}))}async add(e,t){if(e=i_(e),!Array.isArray(t))throw nae.error("protocols must be provided to store data"),mn(new Error("protocols must be provided"),qoe.ERR_INVALID_PARAMETERS);nae.trace("add await write lock");const r=await this.store.lock.writeLock();let n,i;nae.trace("add got write lock");try{try{if(n=await this.store.load(e),new Set([...n.protocols,...t]).size===n.protocols.length)return}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}i=await this.store.mergeOrCreate(e,{protocols:t}),nae("added provided protocols for %p",e)}finally{nae.trace("add release write lock"),r()}this.dispatchEvent(new c0(iae,{detail:{peerId:e,protocols:i.protocols,oldProtocols:null==n?[]:n.protocols}}))}async remove(e,t){if(e=i_(e),!Array.isArray(t))throw nae.error("protocols must be provided to store data"),mn(new Error("protocols must be provided"),qoe.ERR_INVALID_PARAMETERS);nae.trace("remove await write lock");const r=await this.store.lock.writeLock();let n,i;nae.trace("remove got write lock");try{try{n=await this.store.load(e);const r=new Set(n.protocols);for(const e of t)r.delete(e);if(n.protocols.length===r.size)return;t=Array.from(r)}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}i=await this.store.patchOrCreate(e,{protocols:t})}finally{nae.trace("remove release write lock"),r()}this.dispatchEvent(new c0(iae,{detail:{peerId:e,protocols:i.protocols,oldProtocols:null==n?[]:n.protocols}}))}async delete(e){e=i_(e),nae.trace("delete await write lock");const t=await this.store.lock.writeLock();let r;nae.trace("delete got write lock");try{try{r=await this.store.load(e)}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV}await this.store.patchOrCreate(e,{protocols:[]})}finally{nae.trace("delete release write lock"),t()}null!=r&&this.dispatchEvent(new c0(iae,{detail:{peerId:e,protocols:[],oldProtocols:r.protocols}}))}}var oae,aae,cae;(function(e){let t;e.codec=()=>(null==t&&(t=BT(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null==e.addresses)throw new Error('Protocol error: required field "addresses" was not found in object');for(const n of e.addresses)t.uint32(10),aae.codec().encode(n,t);if(null==e.protocols)throw new Error('Protocol error: required field "protocols" was not found in object');for(const n of e.protocols)t.uint32(18),t.string(n);if(null==e.metadata)throw new Error('Protocol error: required field "metadata" was not found in object');for(const n of e.metadata)t.uint32(26),cae.codec().encode(n,t);null!=e.pubKey&&(t.uint32(34),t.bytes(e.pubKey)),null!=e.peerRecordEnvelope&&(t.uint32(42),t.bytes(e.peerRecordEnvelope)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={addresses:[],protocols:[],metadata:[]},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.addresses.push(aae.codec().decode(e,e.uint32()));break;case 2:r.protocols.push(e.string());break;case 3:r.metadata.push(cae.codec().decode(e,e.uint32()));break;case 4:r.pubKey=e.bytes();break;case 5:r.peerRecordEnvelope=e.bytes();break;default:e.skipType(7&t);break}}return r}))),t),e.encode=t=>xT(t,e.codec()),e.decode=t=>TT(t,e.codec())})(oae||(oae={})),function(e){let t;e.codec=()=>(null==t&&(t=BT(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null==e.multiaddr)throw new Error('Protocol error: required field "multiaddr" was not found in object');t.uint32(10),t.bytes(e.multiaddr),null!=e.isCertified&&(t.uint32(16),t.bool(e.isCertified)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={multiaddr:new Uint8Array(0)},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.multiaddr=e.bytes();break;case 2:r.isCertified=e.bool();break;default:e.skipType(7&t);break}}if(null==r.multiaddr)throw new Error('Protocol error: value for required field "multiaddr" was not found in protobuf');return r}))),t),e.encode=t=>xT(t,e.codec()),e.decode=t=>TT(t,e.codec())}(aae||(aae={})),function(e){let t;e.codec=()=>(null==t&&(t=BT(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null==e.key)throw new Error('Protocol error: required field "key" was not found in object');if(t.uint32(10),t.string(e.key),null==e.value)throw new Error('Protocol error: required field "value" was not found in object');t.uint32(18),t.bytes(e.value),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={key:"",value:new Uint8Array(0)},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.key=e.string();break;case 2:r.value=e.bytes();break;default:e.skipType(7&t);break}}if(null==r.key)throw new Error('Protocol error: value for required field "key" was not found in protobuf');if(null==r.value)throw new Error('Protocol error: value for required field "value" was not found in protobuf');return r}))),t),e.encode=t=>xT(t,e.codec()),e.decode=t=>TT(t,e.codec())}(cae||(cae={}));const lae=gn("libp2p:peer-store:store"),uae="/peers/";class hae{constructor(){this.components=new S2,this.lock=BH({name:"peer-store",singleProcess:!0})}init(e){this.components=e}_peerIdToDatastoreKey(e){if(null==e.type)throw lae.error("peerId must be an instance of peer-id to store data"),mn(new Error("peerId must be an instance of peer-id"),qoe.ERR_INVALID_PARAMETERS);const t=e.toCID().toString();return new Ew(`${uae}${t}`)}async has(e){return await this.components.getDatastore().has(this._peerIdToDatastoreKey(e))}async delete(e){await this.components.getDatastore().delete(this._peerIdToDatastoreKey(e))}async load(e){const t=await this.components.getDatastore().get(this._peerIdToDatastoreKey(e)),r=oae.decode(t),n=new Map;for(const i of r.metadata)n.set(i.key,i.value);return{...r,id:e,addresses:r.addresses.map((({multiaddr:e,isCertified:t})=>({multiaddr:Pp(e),isCertified:t??!1}))),metadata:n,pubKey:r.pubKey??void 0,peerRecordEnvelope:r.peerRecordEnvelope??void 0}}async save(e){if(null!=e.pubKey&&null!=e.id.publicKey&&!k_(e.pubKey,e.id.publicKey))throw lae.error("peer publicKey bytes do not match peer id publicKey bytes"),mn(new Error("publicKey bytes do not match peer id publicKey bytes"),qoe.ERR_INVALID_PARAMETERS);const t=new Set,r=e.addresses.filter((e=>!t.has(e.multiaddr.toString())&&(t.add(e.multiaddr.toString()),!0))).sort(((e,t)=>e.multiaddr.toString().localeCompare(t.multiaddr.toString()))).map((({multiaddr:e,isCertified:t})=>({multiaddr:e.bytes,isCertified:t}))),n=[];[...e.metadata.keys()].sort().forEach((t=>{const r=e.metadata.get(t);null!=r&&n.push({key:t,value:r})}));const i=oae.encode({addresses:r,protocols:e.protocols.sort(),pubKey:e.pubKey,metadata:n,peerRecordEnvelope:e.peerRecordEnvelope});return await this.components.getDatastore().put(this._peerIdToDatastoreKey(e.id),i.subarray()),await this.load(e.id)}async patch(e,t){const r=await this.load(e);return await this._patch(e,t,r)}async patchOrCreate(e,t){let r;try{r=await this.load(e)}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV;r={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._patch(e,t,r)}async _patch(e,t,r){return await this.save({...r,...t,id:e})}async merge(e,t){const r=await this.load(e);return await this._merge(e,t,r)}async mergeOrCreate(e,t){let r;try{r=await this.load(e)}catch(WV){if(WV.code!==qoe.ERR_NOT_FOUND)throw WV;r={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._merge(e,t,r)}async _merge(e,t,r){const n=new Map;return r.addresses.forEach((e=>{n.set(e.multiaddr.toString(),e.isCertified)})),(t.addresses??[]).forEach((e=>{const t=e.multiaddr.toString(),r=Boolean(n.get(t)),i=r||e.isCertified;n.set(t,i)})),await this.save({id:e,addresses:Array.from(n.entries()).map((([e,t])=>({multiaddr:Pp(e),isCertified:t}))),protocols:Array.from(new Set([...r.protocols??[],...t.protocols??[]])),metadata:new Map([...r.metadata?.entries()??[],...t.metadata?.entries()??[]]),pubKey:t.pubKey??(null!=r?r.pubKey:void 0),peerRecordEnvelope:t.peerRecordEnvelope??(null!=r?r.peerRecordEnvelope:void 0)})}async*all(){for await(const e of this.components.getDatastore().queryKeys({prefix:uae})){const t=e.toString().split("/")[2],r=Pi.decode(t);yield this.load(o_(r))}}}var dae,fae;(function(e){let t;e.codec=()=>(null==t&&(t=BT(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null==e.tags)throw new Error('Protocol error: required field "tags" was not found in object');for(const n of e.tags)t.uint32(10),fae.codec().encode(n,t);!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={tags:[]},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.tags.push(fae.codec().decode(e,e.uint32()));break;default:e.skipType(7&t);break}}return r}))),t),e.encode=t=>xT(t,e.codec()),e.decode=t=>TT(t,e.codec())})(dae||(dae={})),function(e){let t;e.codec=()=>(null==t&&(t=BT(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null==e.name)throw new Error('Protocol error: required field "name" was not found in object');t.uint32(10),t.string(e.name),null!=e.value&&(t.uint32(16),t.uint32(e.value)),null!=e.expiry&&(t.uint32(24),t.uint64(e.expiry)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={name:""},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.name=e.string();break;case 2:r.value=e.uint32();break;case 3:r.expiry=e.uint64();break;default:e.skipType(7&t);break}}if(null==r.name)throw new Error('Protocol error: value for required field "name" was not found in protobuf');return r}))),t),e.encode=t=>xT(t,e.codec()),e.decode=t=>TT(t,e.codec())}(fae||(fae={}));const pae=gn("libp2p:peer-store");class yae extends o0{constructor(e={}){super(),this.components=new S2,this.store=new hae,this.addressBook=new Yoe(this.dispatchEvent.bind(this),this.store,e.addressFilter),this.keyBook=new Zoe(this.dispatchEvent.bind(this),this.store),this.metadataBook=new rae(this.dispatchEvent.bind(this),this.store),this.protoBook=new sae(this.dispatchEvent.bind(this),this.store)}init(e){this.components=e,this.store.init(e)}async forEach(e){pae.trace("getPeers await read lock");const t=await this.store.lock.readLock();pae.trace("getPeers got read lock");try{for await(const t of this.store.all())t.id.equals(this.components.getPeerId())||e(t)}finally{pae.trace("getPeers release read lock"),t()}}async all(){const e=[];return await this.forEach((t=>{e.push(t)})),e}async delete(e){pae.trace("delete await write lock");const t=await this.store.lock.writeLock();pae.trace("delete got write lock");try{await this.store.delete(e)}finally{pae.trace("delete release write lock"),t()}}async get(e){pae.trace("get await read lock");const t=await this.store.lock.readLock();pae.trace("get got read lock");try{return await this.store.load(e)}finally{pae.trace("get release read lock"),t()}}async has(e){pae.trace("has await read lock");const t=await this.store.lock.readLock();pae.trace("has got read lock");try{return await this.store.has(e)}finally{pae.trace("has release read lock"),t()}}async tagPeer(e,t,r={}){const n=r.value??0,i=Math.round(n),s=r.ttl??void 0;if(i!==n||i<0||i>100)throw mn(new Error("Tag value must be between 0-100"),"ERR_TAG_VALUE_OUT_OF_BOUNDS");const o=await this.metadataBook.getValue(e,"tags");let a=[];null!=o&&(a=dae.decode(o).tags);for(const c of a)if(c.name===t)throw mn(new Error("Peer already tagged"),"ERR_DUPLICATE_TAG");a.push({name:t,value:i,expiry:null==s?void 0:BigInt(Date.now()+s)}),await this.metadataBook.setValue(e,"tags",dae.encode({tags:a}).subarray())}async unTagPeer(e,t){const r=await this.metadataBook.getValue(e,"tags");let n=[];null!=r&&(n=dae.decode(r).tags),n=n.filter((e=>e.name!==t)),await this.metadataBook.setValue(e,"tags",dae.encode({tags:n}).subarray())}async getTags(e){const t=await this.metadataBook.getValue(e,"tags");let r=[];null!=t&&(r=dae.decode(t).tags);const n=BigInt(Date.now()),i=r.filter((e=>null==e.expiry||e.expiry>n));return i.length!==r.length&&await this.metadataBook.setValue(e,"tags",dae.encode({tags:i}).subarray()),i.map((e=>({name:e.name,value:e.value??0})))}}class gae{constructor(e){this.dht=e}async provide(e){await RR(this.dht.provide(e))}async*findProviders(e,t={}){for await(const r of this.dht.findProviders(e,t))"PROVIDER"===r.name&&(yield*r.providers)}async put(e,t,r){await RR(this.dht.put(e,t,r))}async get(e,t){for await(const r of this.dht.get(e,t))if("VALUE"===r.name)return r.value;throw mn(new Error("Not found"),"ERR_NOT_FOUND")}}const mae=gn("libp2p:dialer:auto-dialer");class wae{constructor(e,t){this.components=e,this.enabled=t.enabled,this.minConnections=t.minConnections,this.dialTimeout=t.dialTimeout}handle(e){const{detail:t}=e;if(!this.enabled)return;const r=this.components.getConnectionManager().getConnections(t.id);if(0===r.length){const e=this.minConnections??0,r=this.components.getConnectionManager().getConnections();if(e>r.length){mae("auto-dialing discovered peer %p with timeout %d",t.id,this.dialTimeout);const e=new Ql.TimeoutController(this.dialTimeout);try{(0,Ote.setMaxListeners)?.(1/0,e.signal)}catch{}this.components.getConnectionManager().openConnection(t.id,{signal:e.signal}).catch((e=>{mae.error("could not connect to discovered peer %p with %o",t.id,e)})).finally((()=>{e.clear()}))}}}}var bae=r(3692);const vae=globalThis.fetch,Eae=globalThis.Headers;globalThis.Request,globalThis.Response;function _ae(e,t,r){return`${e}?name=${t}&type=${r}`}async function Sae(e,t){const r=await vae(e,{headers:new Eae({accept:"application/dns-json"}),signal:t}),n=await r.json();return n}function Aae(e,t){return`${t}_${e}`}const Iae=Object.assign(Jr("dns-over-http-resolver"),{error:Jr("dns-over-http-resolver:error")});class Cae{constructor(e={}){this._cache=new bae({max:e?.maxCache??100}),this._TXTcache=new bae({max:e?.maxCache??100}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"],this._request=e.request??Sae,this._abortControllers=[]}cancel(){this._abortControllers.forEach((e=>e.abort()))}getServers(){return this._servers}_getShuffledServers(){const e=[...this._servers];for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*t),n=e[t];e[t]=e[r],e[r]=n}return e}setServers(e){this._servers=e}async resolve(e,t="A"){switch(t){case"A":return await this.resolve4(e);case"AAAA":return await this.resolve6(e);case"TXT":return await this.resolveTxt(e);default:throw new Error(`${t} is not supported`)}}async resolve4(e){const t="A",r=this._cache.get(Aae(e,t));if(null!=r)return r;let n=!1;for(const i of this._getShuffledServers()){const r=new AbortController;this._abortControllers.push(r);try{const n=await this._request(_ae(i,e,t),r.signal),s=n.Answer.map((e=>e.data)),o=Math.min(...n.Answer.map((e=>e.TTL)));return this._cache.set(Aae(e,t),s,{ttl:o}),s}catch(WV){r.signal.aborted&&(n=!0),Iae.error(`${i} could not resolve ${e} record ${t}`)}finally{this._abortControllers=this._abortControllers.filter((e=>e!==r))}}if(n)throw Object.assign(new Error("queryA ECANCELLED"),{code:"ECANCELLED"});throw new Error(`Could not resolve ${e} record ${t}`)}async resolve6(e){const t="AAAA",r=this._cache.get(Aae(e,t));if(null!=r)return r;let n=!1;for(const i of this._getShuffledServers()){const r=new AbortController;this._abortControllers.push(r);try{const n=await this._request(_ae(i,e,t),r.signal),s=n.Answer.map((e=>e.data)),o=Math.min(...n.Answer.map((e=>e.TTL)));return this._cache.set(Aae(e,t),s,{ttl:o}),s}catch(WV){r.signal.aborted&&(n=!0),Iae.error(`${i} could not resolve ${e} record ${t}`)}finally{this._abortControllers=this._abortControllers.filter((e=>e!==r))}}if(n)throw Object.assign(new Error("queryAaaa ECANCELLED"),{code:"ECANCELLED"});throw new Error(`Could not resolve ${e} record ${t}`)}async resolveTxt(e){const t="TXT",r=this._TXTcache.get(Aae(e,t));if(null!=r)return r;let n=!1;for(const i of this._getShuffledServers()){const r=new AbortController;this._abortControllers.push(r);try{const n=await this._request(_ae(i,e,t),r.signal),s=n.Answer.map((e=>[e.data.replace(/['"]+/g,"")])),o=Math.min(...n.Answer.map((e=>e.TTL)));return this._TXTcache.set(Aae(e,t),s,{ttl:o}),s}catch(WV){r.signal.aborted&&(n=!0),Iae.error(`${i} could not resolve ${e} record ${t}`)}finally{this._abortControllers=this._abortControllers.filter((e=>e!==r))}}if(n)throw Object.assign(new Error("queryTxt ECANCELLED"),{code:"ECANCELLED"});throw new Error(`Could not resolve ${e} record ${t}`)}clearCache(){this._cache.clear(),this._TXTcache.clear()}}var kae=Cae,Tae=kae;const{code:Rae}=Df("dnsaddr");async function Pae(e,t={}){const r=new Tae;null!=t.signal&&t.signal.addEventListener("abort",(()=>{r.cancel()}));const n=e.getPeerId(),[,i]=e.stringTuples().find((([e])=>e===Rae))??[];if(null==i)throw new Error("No hostname found in multiaddr");const s=await r.resolveTxt(`_dnsaddr.${i}`);let o=s.flat().map((e=>e.split("=")[1]));return null!=n&&(o=o.filter((e=>e.includes(n)))),o}const xae={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:e=>e},connectionManager:{maxConnections:300,minConnections:50,autoDial:!0,autoDialInterval:1e4,maxParallelDials:pne,maxDialsPerPeer:yne,dialTimeout:dne,inboundUpgradeTimeout:fne,resolvers:{dnsaddr:Pae},addressSorter:zre},connectionGater:{},transportManager:{faultTolerance:Nne.FATAL_ALL},metrics:{enabled:!1,computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[6e4,3e5,9e5],maxOldPeersRetention:50},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0},relay:{enabled:!0,advertise:{bootDelay:Ore,enabled:!1,ttl:Nre},hop:{enabled:!1,active:!1,timeout:3e4},autoRelay:{enabled:!1,maxListeners:2}},identify:{protocolPrefix:"ipfs",host:{agentVersion:ooe},timeout:6e4,maxInboundStreams:1,maxOutboundStreams:1,maxPushIncomingStreams:1,maxPushOutgoingStreams:1},ping:{protocolPrefix:"ipfs",maxInboundStreams:1,maxOutboundStreams:1,timeout:1e4},fetch:{protocolPrefix:"libp2p",maxInboundStreams:1,maxOutboundStreams:1,timeout:1e4}};function Dae(e){const t=Wr(xae,e);if(null==t.transports||t.transports.length<1)throw mn(new Error(kte.ERR_TRANSPORTS_REQUIRED),Tte.ERR_TRANSPORTS_REQUIRED);if(null==t.connectionEncryption||0===t.connectionEncryption.length)throw mn(new Error(kte.CONN_ENCRYPTION_REQUIRED),Tte.CONN_ENCRYPTION_REQUIRED);if(null===t.connectionProtector&&null!=globalThis.process?.env?.LIBP2P_FORCE_PNET)throw mn(new Error(kte.ERR_PROTECTOR_REQUIRED),Tte.ERR_PROTECTOR_REQUIRED);return t.identify.host.agentVersion===ooe&&(Ooe||xoe?t.identify.host.agentVersion+=` UserAgent=${globalThis.process.version}`:(Poe||Noe||Doe||Loe)&&(t.identify.host.agentVersion+=` UserAgent=${globalThis.navigator.userAgent}`)),t}function Oae(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var Nae=Oae,Lae=Nae,Bae=Lae;new Uint8Array(0);const Uae=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},Mae=e=>(new TextEncoder).encode(e),jae=e=>(new TextDecoder).decode(e);class Vae{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class zae{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return $ae(this,e)}}class Fae{constructor(e){this.decoders=e}or(e){return $ae(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const $ae=(e,t)=>new Fae({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Kae{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Vae(e,t,r),this.decoder=new zae(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const qae=({name:e,prefix:t,encode:r,decode:n})=>new Kae(e,t,r,n),Hae=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=Bae(r,t);return qae({prefix:e,name:t,encode:n,decode:e=>Uae(i(e))})},Gae=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Wae=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},Yae=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>qae({prefix:t,name:e,encode(e){return Wae(e,n,r)},decode(t){return Gae(t,n,r,e)}}),Jae=qae({prefix:"\0",name:"identity",encode:e=>jae(e),decode:e=>Mae(e)}),Qae=Yae({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Xae=Yae({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Zae=Hae({prefix:"9",name:"base10",alphabet:"0123456789"}),ece=Yae({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),tce=Yae({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),rce=Yae({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),nce=Yae({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ice=Yae({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),sce=Yae({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),oce=Yae({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ace=Yae({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),cce=Yae({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),lce=Yae({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),uce=Yae({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),hce=Hae({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),dce=Hae({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),fce=Hae({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),pce=Hae({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),yce=Yae({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),gce=Yae({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),mce=Yae({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),wce=Yae({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),bce=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),vce=bce.reduce(((e,t,r)=>(e[r]=t,e)),[]),Ece=bce.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);function _ce(e){return e.reduce(((e,t)=>(e+=vce[t],e)),"")}function Sce(e){const t=[];for(const r of e){const e=Ece[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}const Ace=qae({prefix:"🚀",name:"base256emoji",encode:_ce,decode:Sce});var Ice=Pce,Cce=128,kce=127,Tce=~kce,Rce=Math.pow(2,31);function Pce(e,t,r){t=t||[],r=r||0;var n=r;while(e>=Rce)t[r++]=255&e|Cce,e/=128;while(e&Tce)t[r++]=255&e|Cce,e>>>=7;return t[r]=0|e,Pce.bytes=r-n+1,t}var xce=Nce,Dce=128,Oce=127;function Nce(e,t){var r,n=0,i=(t=t||0,0),s=t,o=e.length;do{if(s>=o)throw Nce.bytes=0,new RangeError("Could not decode varint");r=e[s++],n+=i<28?(r&Oce)<<i:(r&Oce)*Math.pow(2,i),i+=7}while(r>=Dce);return Nce.bytes=s-t,n}var Lce=Math.pow(2,7),Bce=Math.pow(2,14),Uce=Math.pow(2,21),Mce=Math.pow(2,28),jce=Math.pow(2,35),Vce=Math.pow(2,42),zce=Math.pow(2,49),Fce=Math.pow(2,56),$ce=Math.pow(2,63),Kce=function(e){return e<Lce?1:e<Bce?2:e<Uce?3:e<Mce?4:e<jce?5:e<Vce?6:e<zce?7:e<Fce?8:e<$ce?9:10},qce={encode:Ice,decode:xce,encodingLength:Kce},Hce=qce,Gce=Hce;const Wce=(e,t,r=0)=>(Gce.encode(e,t,r),t),Yce=e=>Gce.encodingLength(e),Jce=(e,t)=>{const r=t.byteLength,n=Yce(e),i=n+Yce(r),s=new Uint8Array(i+r);return Wce(e,s,0),Wce(r,s,n),s.set(t,i),new Qce(e,r,t,s)};class Qce{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Xce=({name:e,code:t,encode:r})=>new Zce(e,t,r);class Zce{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Jce(this.code,t):t.then((e=>Jce(this.code,e)))}throw Error("Unknown type, must be binary type")}}const ele=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),tle=Xce({name:"sha2-256",code:18,encode:ele("SHA-256")}),rle=Xce({name:"sha2-512",code:19,encode:ele("SHA-512")}),nle=0,ile="identity",sle=Uae,ole=e=>Jce(nle,sle(e)),ale={code:nle,name:ile,encode:sle,digest:ole},cle="raw",lle=85,ule=e=>Uae(e),hle=e=>Uae(e),dle=new TextEncoder,fle=new TextDecoder,ple="json",yle=512,gle=e=>dle.encode(JSON.stringify(e)),mle=e=>JSON.parse(fle.decode(e));new WeakMap;class wle{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==peer_id_factory_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==peer_id_factory_node_modules_multiformats_src_cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return wle.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return wle.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return wle.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return peer_id_factory_node_modules_multiformats_src_cid_format(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof wle)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new wle(e,r,n,i||peer_id_factory_node_modules_multiformats_src_cid_encodeCID(e,r,n.bytes))}if(!0===t[peer_id_factory_node_modules_multiformats_src_cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,i=Digest.decode(r);return wle.create(e,n,i)}return null}static create(e,t,r){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==peer_id_factory_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${peer_id_factory_node_modules_multiformats_src_cid_DAG_PB_CODE}) block encoding`);return new wle(e,t,r,r.bytes);case 1:{const n=peer_id_factory_node_modules_multiformats_src_cid_encodeCID(e,t,r.bytes);return new wle(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return wle.create(0,peer_id_factory_node_modules_multiformats_src_cid_DAG_PB_CODE,e)}static createV1(e,t){return wle.create(1,e,t)}static decode(e){const[t,r]=wle.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=wle.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Digest.Digest(t.multihashCode,t.digestSize,i,n),o=0===t.version?wle.createV0(s):wle.createV1(t.codec,s);return[o,e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),i=peer_id_factory_node_modules_multiformats_src_cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a,l=c-s;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:l,size:c}}static parse(e,t){const[r,n]=peer_id_factory_node_modules_multiformats_src_cid_parseCIDtoBytes(e,t),i=wle.decode(n);return peer_id_factory_node_modules_multiformats_src_cid_baseCache(i).set(r,e),i}}Symbol.for("@ipld/js-cid/CID");const ble={...ir,...sr,...or,...ar,...cr,...lr,...ur,...hr,...dr,...fr};function vle(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Ele(e=0){return null!=globalThis.Buffer?.allocUnsafe?vle(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function _le(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Sle=_le("utf8","u",(e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)}),(e=>{const t=new TextEncoder;return t.encode(e.substring(1))})),Ale=_le("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=Ele(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}));ble.base16;function Ile(){O_._configure(),R_._configure(P_),x_._configure(D_)}Ile();const Cle=["uint64","int64","sint64","fixed64","sfixed64"];function kle(e){for(const t of Cle){if(null==e[t])continue;const r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}function Tle(e){return kle(new R_(e))}function Rle(e){for(const t of Cle){if(null==e[t])continue;const r=e[t];e[t]=function(e){return r.call(this,e.toString())}}return e}function Ple(){return Rle(x_.create())}function xle(e,t){const r=Tle(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function Dle(e,t){const r=Ple();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var Ole,Nle;function Lle(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function Ble(e,t){return Lle("message",Ole.LENGTH_DELIMITED,e,t)}(function(e){e[e["VARINT"]=0]="VARINT",e[e["BIT64"]=1]="BIT64",e[e["LENGTH_DELIMITED"]=2]="LENGTH_DELIMITED",e[e["START_GROUP"]=3]="START_GROUP",e[e["END_GROUP"]=4]="END_GROUP",e[e["BIT32"]=5]="BIT32"})(Ole||(Ole={})),function(e){let t;e.codec=()=>(null==t&&(t=Ble(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.id&&e.id.byteLength>0)&&(t.uint32(10),t.bytes(e.id)),null!=e.pubKey&&(t.uint32(18),t.bytes(e.pubKey)),null!=e.privKey&&(t.uint32(26),t.bytes(e.privKey)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={id:new Uint8Array(0)},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.id=e.bytes();break;case 2:r.pubKey=e.bytes();break;case 3:r.privKey=e.bytes();break;default:e.skipType(7&t);break}}return r}))),t),e.encode=t=>Dle(t,e.codec()),e.decode=t=>xle(t,e.codec())}(Nle||(Nle={}));const Ule=async()=>{const e=await uT("Ed25519"),t=await jle(e);if("Ed25519"===t.type)return t;throw new Error(`Generated unexpected PeerId type "${t.type}"`)},Mle=async e=>{const t=await uT("RSA",e?.bits??2048),r=await jle(t);if("RSA"===r.type)return r;throw new Error(`Generated unexpected PeerId type "${r.type}"`)};async function jle(e){return await c_(dT(e.public),pT(e))}class Vle extends o0{get[vte](){return!0}get[Symbol.toStringTag](){return"@libp2p/dummy-dht"}get wan(){throw mn(new Error(kte.DHT_DISABLED),Tte.DHT_DISABLED)}get lan(){throw mn(new Error(kte.DHT_DISABLED),Tte.DHT_DISABLED)}get(){throw mn(new Error(kte.DHT_DISABLED),Tte.DHT_DISABLED)}findProviders(){throw mn(new Error(kte.DHT_DISABLED),Tte.DHT_DISABLED)}findPeer(){throw mn(new Error(kte.DHT_DISABLED),Tte.DHT_DISABLED)}getClosestPeers(){throw mn(new Error(kte.DHT_DISABLED),Tte.DHT_DISABLED)}provide(){throw mn(new Error(kte.DHT_DISABLED),Tte.DHT_DISABLED)}put(){throw mn(new Error(kte.DHT_DISABLED),Tte.DHT_DISABLED)}async getMode(){throw mn(new Error(kte.DHT_DISABLED),Tte.DHT_DISABLED)}async setMode(){throw mn(new Error(kte.DHT_DISABLED),Tte.DHT_DISABLED)}async refreshRoutingTable(){throw mn(new Error(kte.DHT_DISABLED),Tte.DHT_DISABLED)}}class zle extends o0{isStarted(){return!1}start(){}stop(){}get globalSignaturePolicy(){throw mn(new Error(kte.PUBSUB_DISABLED),Tte.ERR_PUBSUB_DISABLED)}get multicodecs(){throw mn(new Error(kte.PUBSUB_DISABLED),Tte.ERR_PUBSUB_DISABLED)}getPeers(){throw mn(new Error(kte.PUBSUB_DISABLED),Tte.ERR_PUBSUB_DISABLED)}getTopics(){throw mn(new Error(kte.PUBSUB_DISABLED),Tte.ERR_PUBSUB_DISABLED)}subscribe(){throw mn(new Error(kte.PUBSUB_DISABLED),Tte.ERR_PUBSUB_DISABLED)}unsubscribe(){throw mn(new Error(kte.PUBSUB_DISABLED),Tte.ERR_PUBSUB_DISABLED)}getSubscribers(){throw mn(new Error(kte.PUBSUB_DISABLED),Tte.ERR_PUBSUB_DISABLED)}async publish(){throw mn(new Error(kte.PUBSUB_DISABLED),Tte.ERR_PUBSUB_DISABLED)}}class Fle extends Error{constructor(e="The operation was aborted"){super(e),this.code=Fle.code,this.type=Fle.type}static get code(){return"ABORT_ERR"}static get type(){return"aborted"}}var $le=r(5103);const Kle=gn("libp2p:dialer:dial-request");class qle{constructor(e){const{addrs:t,dialAction:r,dialer:n}=e;this.addrs=t,this.dialer=n,this.dialAction=r}async run(e={}){const t=this.dialer.getTokens(this.addrs.length);if(t.length<1)throw mn(new Error("No dial tokens available"),Tte.ERR_NO_DIAL_TOKENS);const r=new $le;for(const o of t)r.push(o).catch((e=>{Kle.error(e)}));const n=this.addrs.map((()=>{const e=new AbortController;try{(0,Ote.setMaxListeners)?.(1/0,e.signal)}catch{}return e}));if(null!=e.signal)try{(0,Ote.setMaxListeners)?.(1/0,e.signal)}catch{}let i=0,s=!1;try{return await Promise.any(this.addrs.map((async(o,a)=>{const c=await r.shift();if(s)throw this.dialer.releaseToken(t.splice(t.indexOf(c),1)[0]),mn(new Error("dialAction already succeeded"),Tte.ERR_ALREADY_SUCCEEDED);const l=n[a];if(null==l)throw mn(new Error("dialAction did not come with an AbortController"),Tte.ERR_INVALID_PARAMETERS);let u;try{const s=l.signal;u=await this.dialAction(o,{...e,signal:null!=e.signal?(0,Iw.anySignal)([s,e.signal]):s}),n[a]=void 0}finally{i++,this.addrs.length-i>=t.length?r.push(c).catch((e=>{Kle.error(e)})):this.dialer.releaseToken(t.splice(t.indexOf(c),1)[0])}if(null==u)throw mn(new Error("dialAction led to empty object"),Tte.ERR_TRANSPORT_DIAL_FAILED);return s=!0,u})))}finally{n.forEach((e=>{void 0!==e&&e.abort()})),t.forEach((e=>this.dialer.releaseToken(e)))}}}const Hle=gn("libp2p:dialer"),Gle="dialler",Wle="pending-dials",Yle="pending-dial-targets";class Jle{constructor(e,t={}){this.started=!1,this.addressSorter=t.addressSorter??zre,this.maxAddrsToDial=t.maxAddrsToDial??gne,this.timeout=t.dialTimeout??dne,this.maxDialsPerPeer=t.maxDialsPerPeer??yne,this.tokens=[...new Array(t.maxParallelDials??pne)].map(((e,t)=>t)),this.components=e,this.pendingDials=xne({component:Gle,metric:Wle,metrics:t.metrics}),this.pendingDialTargets=xne({component:Gle,metric:Yle,metrics:e.getMetrics()});for(const[r,n]of Object.entries(t.resolvers??{}))Ap.set(r,n)}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1;for(const e of this.pendingDials.values())try{e.controller.abort()}catch(WV){Hle.error(WV)}this.pendingDials.clear();for(const e of this.pendingDialTargets.values())e.reject(new Fle("Dialer was destroyed"));this.pendingDialTargets.clear()}async dial(e,t={}){const{id:r,multiaddrs:n}=Mte(e);if(this.components.getPeerId().equals(r))throw mn(new Error("Tried to dial self"),Tte.ERR_DIALED_SELF);if(Hle("check multiaddrs %p",r),null!=n&&n.length>0&&(Hle("storing multiaddrs %p",r,n),await this.components.getPeerStore().addressBook.add(r,n)),await this.components.getConnectionGater().denyDialPeer(r))throw mn(new Error("The dial request is blocked by gater.allowDialPeer"),Tte.ERR_PEER_DIAL_INTERCEPTED);Hle("creating dial target for %p",r);const i=await this._createCancellableDialTarget(r,t);if(0===i.addrs.length)throw mn(new Error("The dial request has no valid addresses"),Tte.ERR_NO_VALID_ADDRESSES);const s=this.pendingDials.get(i.id)??this._createPendingDial(i,t);try{const e=await s.promise;return Hle("dial succeeded to %s",i.id),e}catch(WV){throw Hle("dial failed to %s",i.id,WV),s.controller.signal.aborted&&(WV.code=Tte.ERR_TIMEOUT),Hle.error(WV),WV}finally{s.destroy()}}async _createCancellableDialTarget(e,t){const r=`${parseInt(String(1e9*Math.random()),10).toString()}${Date.now()}`,n=new Promise(((e,t)=>{this.pendingDialTargets.set(r,{resolve:e,reject:t})}));try{const i=await Promise.race([this._createDialTarget(e,t),n]);return i}finally{this.pendingDialTargets.delete(r)}}async _createDialTarget(e,t){const r=this._resolve.bind(this),n=await QR(await this.components.getPeerStore().addressBook.get(e),(t=>PR(t,(async t=>!await this.components.getConnectionGater().denyDialMultiaddr(e,t.multiaddr)))),(e=>are(e,this.addressSorter)),(async function*(e){for await(const n of e)yield*await r(n.multiaddr,t)}),(e=>PR(e,(e=>Boolean(this.components.getTransportManager().transportForMultiaddr(e))))),(t=>qR(t,(t=>e.toString()===t.getPeerId()?t:t.encapsulate(`/p2p/${e.toString()}`)))),(async e=>await kR(e)));if(n.length>this.maxAddrsToDial)throw await this.components.getPeerStore().delete(e),mn(new Error("dial with more addresses than allowed"),Tte.ERR_TOO_MANY_ADDRESSES);return{id:e.toString(),addrs:n}}_createPendingDial(e,t={}){const r=async(e,t={})=>{if(!0===t.signal?.aborted)throw mn(new Error("already aborted"),Tte.ERR_ALREADY_ABORTED);return await this.components.getTransportManager().dial(e,t).catch((t=>{throw Hle.error("dial to %s failed",e,t),t}))},n=new qle({addrs:e.addrs,dialAction:r,dialer:this}),i=new Ql.TimeoutController(this.timeout),s=[i.signal];null!=t.signal&&s.push(t.signal);const o=(0,Iw.anySignal)(s);try{(0,Ote.setMaxListeners)?.(1/0,o)}catch{}const a={dialRequest:n,controller:i,promise:n.run({...t,signal:o}),destroy:()=>{i.clear(),this.pendingDials.delete(e.id)}};return this.pendingDials.set(e.id,a),a}getTokens(e){const t=Math.min(e,this.maxDialsPerPeer,this.tokens.length),r=this.tokens.splice(0,t);return Hle("%d tokens request, returning %d, %d remaining",e,t,this.tokens.length),r}releaseToken(e){this.tokens.includes(e)||(Hle("token %d released",e),this.tokens.push(e))}async _resolve(e,t){const r=e.protoNames().includes("dnsaddr");if(!r)return[e];const n=await this._resolveRecord(e,t),i=await Promise.all(n.map((async e=>await this._resolve(e,t)))),s=i.flat();return s.reduce(((e,t)=>(null==e.find((e=>e.equals(t)))&&e.push(t),e)),[])}async _resolveRecord(e,t){try{e=Pp(e.toString());const r=await e.resolve(t);return r}catch(WV){return Hle.error(`multiaddr ${e.toString()} could not be resolved`,WV),[]}}}const Qle=gn("libp2p");class Xle extends o0{constructor(e){super(),this.initializables=[],this.started=!1,this.peerId=e.peerId,this.components=new S2({peerId:e.peerId,datastore:e.datastore??new KR,connectionGater:{denyDialPeer:async()=>await Promise.resolve(!1),denyDialMultiaddr:async()=>await Promise.resolve(!1),denyInboundConnection:async()=>await Promise.resolve(!1),denyOutboundConnection:async()=>await Promise.resolve(!1),denyInboundEncryptedConnection:async()=>await Promise.resolve(!1),denyOutboundEncryptedConnection:async()=>await Promise.resolve(!1),denyInboundUpgradedConnection:async()=>await Promise.resolve(!1),denyOutboundUpgradedConnection:async()=>await Promise.resolve(!1),filterMultiaddrForPeer:async()=>await Promise.resolve(!0),...e.connectionGater}}),this.components.setPeerStore(new yae({addressFilter:this.components.getConnectionGater().filterMultiaddrForPeer,...e.peerStore})),this.services=[this.components],e.metrics.enabled&&(this.metrics=this.components.setMetrics(new Sne(e.metrics))),this.peerStore=this.components.getPeerStore(),this.peerStore.addEventListener("peer",(e=>{const{detail:t}=e;this.dispatchEvent(new c0("peer:discovery",{detail:t}))})),null!=e.connectionProtector&&this.components.setConnectionProtector(e.connectionProtector),this.components.setUpgrader(new roe(this.components,{connectionEncryption:(e.connectionEncryption??[]).map((e=>this.configureComponent(e))),muxers:(e.streamMuxers??[]).map((e=>this.configureComponent(e))),inboundUpgradeTimeout:e.connectionManager.inboundUpgradeTimeout})),this.components.setDialer(new Jle(this.components,e.connectionManager)),this.connectionManager=this.components.setConnectionManager(new ore(e.connectionManager)),this.registrar=this.components.setRegistrar(new Qse(this.components)),this.components.setTransportManager(new One(this.components,e.transportManager)),this.components.setAddressManager(new Vte(this.components,e.addresses)),this.configureComponent(new $oe(this.components)),this.configureComponent(new ure(this.components,{enabled:e.connectionManager.autoDial,minConnections:e.connectionManager.minConnections,autoDialInterval:e.connectionManager.autoDialInterval}));const t=une.generateOptions();this.keychain=this.configureComponent(new une(this.components,{...t,...e.keychain})),this.services.push(new zoe(this.components,e.nat)),e.transports.forEach((e=>{this.components.getTransportManager().add(this.configureComponent(e))})),null!=e.streamMuxers&&e.streamMuxers.length>0&&(this.identifyService=new poe(this.components,{...e.identify}),this.configureComponent(this.identifyService)),null!=e.dht?this.dht=this.components.setDHT(e.dht):this.dht=new Vle,null!=e.pubsub?this.pubsub=this.components.setPubSub(e.pubsub):this.pubsub=new zle;const r=(e.peerRouters??[]).map((e=>this.configureComponent(e)));null!=e.dht&&(r.push(this.configureComponent(new Koe(this.dht))),this.dht.addEventListener("peer",(e=>{this.onDiscoveryPeer(e)}))),this.peerRouting=this.components.setPeerRouting(this.configureComponent(new Lte(this.components,{...e.peerRouting,routers:r})));const n=(e.contentRouters??[]).map((e=>this.configureComponent(e)));null!=e.dht&&n.push(this.configureComponent(new gae(this.dht))),this.contentRouting=this.components.setContentRouting(this.configureComponent(new Bte(this.components,{routers:n}))),e.relay.enabled&&(this.components.getTransportManager().add(this.configureComponent(new Pre(e.relay))),this.configureComponent(new Hre(this.components,{addressSorter:e.connectionManager.addressSorter,...e.relay}))),this.fetchService=this.configureComponent(new voe(this.components,{...e.fetch})),this.pingService=this.configureComponent(new Ioe(this.components,{...e.ping}));const i=this.configureComponent(new wae(this.components,{enabled:!1!==e.connectionManager.autoDial,minConnections:e.connectionManager.minConnections,dialTimeout:e.connectionManager.dialTimeout??3e4}));this.addEventListener("peer:discovery",(e=>{this.isStarted()&&i.handle(e)}));for(const s of e.peerDiscovery??[])this.configureComponent(s),s.addEventListener("peer",(e=>{this.onDiscoveryPeer(e)}))}configureComponent(e){return E2(e)&&this.services.push(e),_2(e)&&this.initializables.push(e),e}async start(){if(!this.started){this.started=!0,Qle("libp2p is starting");try{this.initializables.forEach((e=>{e.init(this.components)})),await Promise.all(this.services.map((async e=>{null!=e.beforeStart&&await e.beforeStart()}))),await Promise.all(this.services.map((e=>e.start()))),await Promise.all(this.services.map((async e=>{null!=e.afterStart&&await e.afterStart()}))),Qle("libp2p has started")}catch(WV){throw Qle.error("An error occurred starting libp2p",WV),await this.stop(),WV}}}async stop(){this.started&&(Qle("libp2p is stopping"),this.started=!1,await Promise.all(this.services.map((async e=>{null!=e.beforeStop&&await e.beforeStop()}))),await Promise.all(this.services.map((e=>e.stop()))),await Promise.all(this.services.map((async e=>{null!=e.afterStop&&await e.afterStop()}))),Qle("libp2p has stopped"))}isStarted(){return this.started}getConnections(e){return this.components.getConnectionManager().getConnections(e)}getPeers(){const e=new Xte;for(const t of this.components.getConnectionManager().getConnections())e.add(t.remotePeer);return Array.from(e)}async dial(e,t={}){const{id:r,multiaddrs:n}=Mte(e);return await this.components.getPeerStore().addressBook.add(r,n),await this.components.getConnectionManager().openConnection(r,t)}async dialProtocol(e,t,r={}){if(null==t)throw mn(new Error("no protocols were provided to open a stream"),Tte.ERR_INVALID_PROTOCOLS_FOR_STREAM);if(t=Array.isArray(t)?t:[t],0===t.length)throw mn(new Error("no protocols were provided to open a stream"),Tte.ERR_INVALID_PROTOCOLS_FOR_STREAM);const n=await this.dial(e,r);return await n.newStream(t,r)}getMultiaddrs(){return this.components.getAddressManager().getAddresses()}async hangUp(e){const{id:t}=Mte(e);await this.components.getConnectionManager().closeConnections(t)}async getPublicKey(e,t={}){if(Qle("getPublicKey %p",e),null!=e.publicKey)return e.publicKey;const r=await this.peerStore.get(e);if(null!=r.pubKey)return r.pubKey;if(null==this.dht)throw mn(new Error("Public key was not in the peer store and the DHT is not enabled"),Tte.ERR_NO_ROUTERS_AVAILABLE);const n=(0,UT.concat)([Jl("/pk/"),e.multihash.digest]);for await(const i of this.dht.get(n,t))if("VALUE"===i.name){const t=hT(i.value);return await this.peerStore.keyBook.set(e,i.value),t.bytes}throw mn(new Error(`Node not responding with its public key: ${e.toString()}`),Tte.ERR_INVALID_RECORD)}async fetch(e,t,r={}){const{id:n,multiaddrs:i}=Mte(e);return null!=i&&await this.components.getPeerStore().addressBook.add(n,i),await this.fetchService.fetch(n,t,r)}async ping(e,t={}){const{id:r,multiaddrs:n}=Mte(e);return n.length>0&&await this.components.getPeerStore().addressBook.add(r,n),await this.pingService.ping(r,t)}async handle(e,t,r){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.getRegistrar().handle(e,t,r)})))}async unhandle(e){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.getRegistrar().unhandle(e)})))}onDiscoveryPeer(e){const{detail:t}=e;t.id.toString()!==this.peerId.toString()?(t.multiaddrs.length>0&&this.components.getPeerStore().addressBook.add(t.id,t.multiaddrs).catch((e=>Qle.error(e))),t.protocols.length>0&&this.components.getPeerStore().protoBook.set(t.id,t.protocols).catch((e=>Qle.error(e))),this.dispatchEvent(new c0("peer:discovery",{detail:t}))):Qle.error(new Error(Tte.ERR_DISCOVERED_SELF))}}async function Zle(e){return null==e.peerId&&(e.peerId=await Ule()),new Xle(Dae(e))}async function eue(e){return await Zle(e)}var tue=r(9507);const rue=1e3,nue=60*rue,iue=60*nue,sue=36*iue,oue="/lan",aue="/ipfs",cue="/kad/1.0.0",lue="/dht/record",uue="/dht/provider",hue=256,due=24*iue,fue=iue,pue=20,yue=3,gue=Number(5*nue),mue=Number(30*rue),wue=Number(5*nue),bue=Number(30*rue),vue=Number(30*rue),Eue=Jl("/pk/");function _ue(e){return{...e,multiaddrs:e.multiaddrs.filter((e=>{const[[t,r]]=e.stringTuples();return(4===t||6===t)&&(null!=r&&!jre(r))}))}}function Sue(e){return{...e,multiaddrs:e.multiaddrs.filter((e=>{const[[t,r]]=e.stringTuples();return(4===t||6===t)&&(null!=r&&jre(r))}))}}async function Aue(e){const t=await vl.digest(e);return t.digest}async function Iue(e){return await Aue(e.toBytes())}function Cue(e){return new Ew(`${lue}/${C_(e,"base32")}`,!1)}function kue(e){return(0,UT.concat)([Eue,e.toBytes()])}function Tue(e){return"/pk/"===C_(e.subarray(0,4))}function Rue(e){return o_(e.subarray(4))}function Pue(e,t){const r=new Date,n=new vP(e,t,r);return n.serialize()}function xue(e,t=100){let r;return()=>{clearTimeout(r),r=setTimeout((()=>e()),t)}}const Due="kad-close",Oue=50,Nue=20,Lue=1e4,Bue=10,Uue="routing-table-size",Mue="ping-queue-size",jue="ping-running";class Vue{constructor(e){this.components=new S2;const{kBucketSize:t,pingTimeout:r,lan:n,pingConcurrency:i,protocol:s,tagName:o,tagValue:a}=e;this.log=gn(`libp2p:kad-dht:${n?"lan":"wan"}:routing-table`),this.kBucketSize=t??Nue,this.pingTimeout=r??Lue,this.pingConcurrency=i??Bue,this.lan=n,this.running=!1,this.protocol=s,this.tagName=o??Due,this.tagValue=a??Oue;const c=()=>{this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:Mue,value:this.pingQueue.size}),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:jue,value:this.pingQueue.pending})};this.pingQueue=new Lb({concurrency:this.pingConcurrency}),this.pingQueue.addListener("add",c),this.pingQueue.addListener("next",c),this._onPing=this._onPing.bind(this)}init(e){this.components=e}isStarted(){return this.running}async start(){this.running=!0;const e=new tue({localNodeId:await Iue(this.components.getPeerId()),numberOfNodesPerKBucket:this.kBucketSize,numberOfNodesToPing:1});this.kb=e,e.on("ping",this._onPing),this._tagPeers(e)}async stop(){this.running=!1,this.pingQueue.clear(),this.kb=void 0}_tagPeers(e){let t=new Xte;const r=xue((()=>{const r=new Xte(e.closest(e.localNodeId,Nue).map((e=>e.peer))),n=r.difference(t),i=t.difference(r);Promise.resolve().then((async()=>{for(const e of n)await this.components.getPeerStore().tagPeer(e,this.tagName,{value:this.tagValue});for(const e of i)await this.components.getPeerStore().unTagPeer(e,this.tagName)})).catch((e=>{this.log.error("Could not update peer tags",e)})),t=r}));e.on("added",(()=>{r()})),e.on("removed",(()=>{r()}))}_onPing(e,t){this.pingQueue.add((async()=>{if(!this.running)return;let r=0;try{await Promise.all(e.map((async e=>{let t;try{t=new Ql.TimeoutController(this.pingTimeout);const n={signal:t.signal};this.log("pinging old contact %p",e.peer);const i=await this.components.getConnectionManager().openConnection(e.peer,n),s=await i.newStream(this.protocol,n);s.close(),r++}catch(WV){this.running&&null!=this.kb&&(this.log.error("could not ping peer %p",e.peer,WV),this.log("evicting old contact after ping failed %p",e),this.kb.remove(e.id))}finally{null!=t&&t.clear(),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:Uue,value:this.size})}}))),this.running&&r<e.length&&null!=this.kb&&(this.log("adding new contact %p",t.peer),this.kb.add(t))}catch(WV){this.log.error("could not process k-bucket ping event",WV)}})).catch((e=>{this.log.error("could not process k-bucket ping event",e)}))}get size(){return null==this.kb?0:this.kb.count()}async find(e){const t=await Iue(e),r=this.closestPeer(t);if(null!=r&&e.equals(r))return r}closestPeer(e){const t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e,t=this.kBucketSize){if(null==this.kb)return[];const r=this.kb.closest(e,t);return r.map((e=>e.peer))}async add(e){if(null==this.kb)throw new Error("RoutingTable is not started");const t=await Iue(e);this.kb.add({id:t,peer:e}),this.log("added %p with kad id %b",e,t),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:Uue,value:this.size})}async remove(e){if(null==this.kb)throw new Error("RoutingTable is not started");const t=await Iue(e);this.kb.remove(t),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:Uue,value:this.size})}}function zue(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");const r=(0,$l.E)(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return(0,Yl.P)(r)}var Fue=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782];const $ue=15;class Kue{constructor(e){const{peerRouting:t,routingTable:r,refreshInterval:n,refreshQueryTimeout:i,lan:s}=e;this.log=gn(`libp2p:kad-dht:${s?"lan":"wan"}:routing-table:refresh`),this.peerRouting=t,this.routingTable=r,this.refreshInterval=n??wue,this.refreshQueryTimeout=i??bue,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}init(e){}async start(){this.log(`refreshing routing table every ${this.refreshInterval}ms`),this.refreshTable(!0)}async stop(){null!=this.refreshTimeoutId&&clearTimeout(this.refreshTimeoutId)}refreshTable(e=!1){this.log("refreshing routing table");const t=this._maxCommonPrefix(),r=this._getTrackedCommonPrefixLengthsForRefresh(t);this.log(`max common prefix length ${t}`),this.log(`tracked CPLs [ ${r.map((e=>e.toISOString())).join(", ")} ]`),Promise.all(r.map((async(n,i)=>{try{if(await this._refreshCommonPrefixLength(i,n,e),0===this._numPeersForCpl(t)){const t=Math.min(2*(i+1),r.length-1);for(let r=i+1;r<t+1;r++)try{await this._refreshCommonPrefixLength(r,n,e)}catch(WV){this.log.error(WV)}}}catch(WV){this.log.error(WV)}}))).catch((e=>{this.log.error(e)})).then((()=>{this.refreshTimeoutId=setTimeout(this.refreshTable,this.refreshInterval),null!=this.refreshTimeoutId.unref&&this.refreshTimeoutId.unref()})).catch((e=>{this.log.error(e)}))}async _refreshCommonPrefixLength(e,t,r){if(!r&&t.getTime()>Date.now()-this.refreshInterval)return void this.log("not running refresh for cpl %s as time since last refresh not above interval",e);const n=await this._generateRandomPeerId(e);this.log("starting refreshing cpl %s with key %p (routing table size was %s)",e,n,this.routingTable.size);const i=new Ql.TimeoutController(this.refreshQueryTimeout);try{const t=await mY(this.peerRouting.getClosestPeers(n.toBytes(),{signal:i.signal}));this.log(`found ${t} peers that were close to imaginary peer %p`,n),this.log("finished refreshing cpl %s with key %p (routing table size is now %s)",e,n,this.routingTable.size)}finally{i.clear()}}_getTrackedCommonPrefixLengthsForRefresh(e){e>$ue&&(e=$ue);const t=[];for(let r=0;r<=e;r++)t[r]=this.commonPrefixLengthRefreshedAt[r]??new Date;return t}async _generateRandomPeerId(e){if(null==this.routingTable.kb)throw new Error("Routing table not started");const t=uC(2),r=(t[1]<<8)+t[0],n=await this._makePeerId(this.routingTable.kb.localNodeId,r,e);return o_(n)}async _makePeerId(e,t,r){if(r>$ue)throw new Error(`Cannot generate peer ID for common prefix length greater than ${$ue}`);const n=new DataView(e.buffer,e.byteOffset,e.byteLength),i=n.getUint16(0,!1),s=i^32768>>r,o=65535<<16-(r+1),a=s&o|t&~o,c=Fue[a],l=new ArrayBuffer(34),u=new DataView(l,0,l.byteLength);return u.setUint8(0,vl.code),u.setUint8(1,32),u.setUint32(2,c,!1),new Uint8Array(u.buffer,u.byteOffset,u.byteLength)}_maxCommonPrefix(){let e=0;for(const t of this._prefixLengths())t>e&&(e=t);return e}_numPeersForCpl(e){let t=0;for(const r of this._prefixLengths())r===e&&t++;return t}*_prefixLengths(){if(null!=this.routingTable.kb)for(const{id:e}of this.routingTable.kb.toIterable()){const t=zue(this.routingTable.kb.localNodeId,e);let r=0;for(const e of t){if(0!==e)break;r++}yield r}}}var que,Hue;(function(e){let t;e.codec=()=>(null==t&&(t=BT(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.key&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&(t.uint32(18),t.bytes(e.value)),null!=e.author&&(t.uint32(26),t.bytes(e.author)),null!=e.signature&&(t.uint32(34),t.bytes(e.signature)),null!=e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.key=e.bytes();break;case 2:r.value=e.bytes();break;case 3:r.author=e.bytes();break;case 4:r.signature=e.bytes();break;case 5:r.timeReceived=e.string();break;default:e.skipType(7&t);break}}return r}))),t),e.encode=t=>xT(t,e.codec()),e.decode=t=>TT(t,e.codec())})(que||(que={})),function(e){let t,r,n,i,s,o;(function(e){e["PUT_VALUE"]="PUT_VALUE",e["GET_VALUE"]="GET_VALUE",e["ADD_PROVIDER"]="ADD_PROVIDER",e["GET_PROVIDERS"]="GET_PROVIDERS",e["FIND_NODE"]="FIND_NODE",e["PING"]="PING"})(t=e.MessageType||(e.MessageType={})),function(e){e[e["PUT_VALUE"]=0]="PUT_VALUE",e[e["GET_VALUE"]=1]="GET_VALUE",e[e["ADD_PROVIDER"]=2]="ADD_PROVIDER",e[e["GET_PROVIDERS"]=3]="GET_PROVIDERS",e[e["FIND_NODE"]=4]="FIND_NODE",e[e["PING"]=5]="PING"}(r||(r={})),function(e){e.codec=()=>LT(r)}(t=e.MessageType||(e.MessageType={})),function(e){e["NOT_CONNECTED"]="NOT_CONNECTED",e["CONNECTED"]="CONNECTED",e["CAN_CONNECT"]="CAN_CONNECT",e["CANNOT_CONNECT"]="CANNOT_CONNECT"}(n=e.ConnectionType||(e.ConnectionType={})),function(e){e[e["NOT_CONNECTED"]=0]="NOT_CONNECTED",e[e["CONNECTED"]=1]="CONNECTED",e[e["CAN_CONNECT"]=2]="CAN_CONNECT",e[e["CANNOT_CONNECT"]=3]="CANNOT_CONNECT"}(i||(i={})),function(e){e.codec=()=>LT(i)}(n=e.ConnectionType||(e.ConnectionType={})),function(t){let r;t.codec=()=>(null==r&&(r=BT(((t,r,n={})=>{if(!1!==n.lengthDelimited&&r.fork(),null!=t.id&&(r.uint32(10),r.bytes(t.id)),null==t.addrs)throw new Error('Protocol error: required field "addrs" was not found in object');for(const e of t.addrs)r.uint32(18),r.bytes(e);null!=t.connection&&(r.uint32(24),e.ConnectionType.codec().encode(t.connection,r)),!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={addrs:[]},i=null==r?t.len:t.pos+r;while(t.pos<i){const r=t.uint32();switch(r>>>3){case 1:n.id=t.bytes();break;case 2:n.addrs.push(t.bytes());break;case 3:n.connection=e.ConnectionType.codec().decode(t);break;default:t.skipType(7&r);break}}return n}))),r),t.encode=e=>xT(e,t.codec()),t.decode=e=>TT(e,t.codec())}(s=e.Peer||(e.Peer={})),e.codec=()=>(null==o&&(o=BT(((t,r,n={})=>{if(!1!==n.lengthDelimited&&r.fork(),null!=t.type&&(r.uint32(8),e.MessageType.codec().encode(t.type,r)),null!=t.clusterLevelRaw&&(r.uint32(80),r.int32(t.clusterLevelRaw)),null!=t.key&&(r.uint32(18),r.bytes(t.key)),null!=t.record&&(r.uint32(26),r.bytes(t.record)),null==t.closerPeers)throw new Error('Protocol error: required field "closerPeers" was not found in object');for(const i of t.closerPeers)r.uint32(66),e.Peer.codec().encode(i,r);if(null==t.providerPeers)throw new Error('Protocol error: required field "providerPeers" was not found in object');for(const i of t.providerPeers)r.uint32(74),e.Peer.codec().encode(i,r);!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={closerPeers:[],providerPeers:[]},i=null==r?t.len:t.pos+r;while(t.pos<i){const r=t.uint32();switch(r>>>3){case 1:n.type=e.MessageType.codec().decode(t);break;case 10:n.clusterLevelRaw=t.int32();break;case 2:n.key=t.bytes();break;case 3:n.record=t.bytes();break;case 8:n.closerPeers.push(e.Peer.codec().decode(t,t.uint32()));break;case 9:n.providerPeers.push(e.Peer.codec().decode(t,t.uint32()));break;default:t.skipType(7&r);break}}return n}))),o),e.encode=t=>xT(t,e.codec()),e.decode=t=>TT(t,e.codec())}(Hue||(Hue={}));const Gue=Hue.MessageType,Wue=Hue.ConnectionType,Yue=Object.keys(Gue);class Jue{constructor(e,t,r){if(!(t instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=t,this.clusterLevelRaw=r,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){const e=this.clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this.clusterLevelRaw=e}serialize(){return Hue.encode({key:this.key,type:this.type,clusterLevelRaw:this.clusterLevelRaw,closerPeers:this.closerPeers.map(Que),providerPeers:this.providerPeers.map(Que),record:null==this.record?void 0:this.record.serialize().subarray()})}static deserialize(e){const t=Hue.decode(e),r=new Jue(t.type??Hue.MessageType.PUT_VALUE,t.key??Uint8Array.from([]),t.clusterLevelRaw??0);return r.closerPeers=t.closerPeers.map(Xue),r.providerPeers=t.providerPeers.map(Xue),null!=t.record?.length&&(r.record=vP.deserialize(t.record)),r}}function Que(e){const t={id:e.id.toBytes(),addrs:(e.multiaddrs??[]).map((e=>e.bytes)),connection:Wue.CONNECTED};return t}function Xue(e){if(null==e.id)throw new Error("Invalid peer in message");return{id:o_(e.id),multiaddrs:(e.addrs??[]).map((e=>Pp(e))),protocols:[]}}function Zue(e){return{...e,name:"SENDING_QUERY",type:0,messageName:e.type,messageType:Yue.indexOf(e.type.toString())}}function ehe(e){return{...e,name:"PEER_RESPONSE",type:1,messageName:e.messageType,closer:null!=e.closer?e.closer:[],providers:null!=e.providers?e.providers:[]}}function the(e){return{...e,name:"FINAL_PEER",type:2}}function rhe(e){return{...e,name:"QUERY_ERROR",type:3}}function nhe(e){return{...e,name:"PROVIDER",type:4}}function ihe(e){return{...e,name:"VALUE",type:5}}function she(e){return{...e,name:"DIALING_PEER",type:7}}class ohe extends o0{constructor(e){super(),this.components=new S2;const{protocol:t,lan:r}=e;this.log=gn(`libp2p:kad-dht:${r?"lan":"wan"}:network`),this.running=!1,this.protocol=t}init(e){this.components=e}async start(){this.running||(this.running=!0)}async stop(){this.running=!1}isStarted(){return this.running}async*sendRequest(e,t,r={}){if(!this.running)return;this.log("sending %s to %p",t.type,e),yield she({peer:e}),yield Zue({to:e,type:t.type});try{const n=await this.components.getConnectionManager().openConnection(e,r),i=await n.newStream(this.protocol,r),s=await this._writeReadMessage(i,t.serialize(),r);yield ehe({from:e,messageType:s.type,closer:s.closerPeers,providers:s.providerPeers,record:s.record})}catch(WV){yield rhe({from:e,error:WV})}finally{null!=i&&i.close()}}async*sendMessage(e,t,r={}){if(!this.running)return;this.log("sending %s to %p",t.type,e),yield she({peer:e}),yield Zue({to:e,type:t.type});try{const n=await this.components.getConnectionManager().openConnection(e,r),i=await n.newStream(this.protocol,r);await this._writeMessage(i,t.serialize(),r),yield ehe({from:e,messageType:t.type})}catch(WV){yield rhe({from:e,error:WV})}finally{null!=i&&i.close()}}async _writeMessage(e,t,r){null!=r.signal&&(e=X2(e,r.signal)),await QR([t],t3(),e,RR)}async _writeReadMessage(e,t,r){null!=r.signal&&(e=X2(e,r.signal));const n=await QR([t],t3(),e,o3(),(async e=>{const t=await Vq(e);if(null!=t)return t;throw mn(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED")})),i=Jue.deserialize(n);return i.closerPeers.forEach((e=>{this.dispatchEvent(new c0("peer",{detail:e}))})),i.providerPeers.forEach((e=>{this.dispatchEvent(new c0("peer",{detail:e}))})),i}}function ahe(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var che=ahe,lhe=che,uhe=lhe;new Uint8Array(0);const hhe=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},dhe=e=>(new TextEncoder).encode(e),fhe=e=>(new TextDecoder).decode(e);class phe{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class yhe{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return mhe(this,e)}}class ghe{constructor(e){this.decoders=e}or(e){return mhe(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const mhe=(e,t)=>new ghe({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class whe{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new phe(e,t,r),this.decoder=new yhe(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const bhe=({name:e,prefix:t,encode:r,decode:n})=>new whe(e,t,r,n),vhe=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=uhe(r,t);return bhe({prefix:e,name:t,encode:n,decode:e=>hhe(i(e))})},Ehe=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},_he=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},She=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>bhe({prefix:t,name:e,encode(e){return _he(e,n,r)},decode(t){return Ehe(t,n,r,e)}}),Ahe=bhe({prefix:"\0",name:"identity",encode:e=>fhe(e),decode:e=>dhe(e)}),Ihe=She({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Che=She({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),khe=vhe({prefix:"9",name:"base10",alphabet:"0123456789"}),The=She({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Rhe=She({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Phe=She({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),xhe=She({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Dhe=She({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ohe=She({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Nhe=She({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Lhe=She({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Bhe=She({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Uhe=She({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Mhe=She({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),jhe=vhe({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Vhe=vhe({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),zhe=vhe({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Fhe=vhe({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),$he=She({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Khe=She({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),qhe=She({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Hhe=She({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Ghe=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Whe=Ghe.reduce(((e,t,r)=>(e[r]=t,e)),[]),Yhe=Ghe.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);function Jhe(e){return e.reduce(((e,t)=>(e+=Whe[t],e)),"")}function Qhe(e){const t=[];for(const r of e){const e=Yhe[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}const Xhe=bhe({prefix:"🚀",name:"base256emoji",encode:Jhe,decode:Qhe});var Zhe=ide,ede=128,tde=127,rde=~tde,nde=Math.pow(2,31);function ide(e,t,r){t=t||[],r=r||0;var n=r;while(e>=nde)t[r++]=255&e|ede,e/=128;while(e&rde)t[r++]=255&e|ede,e>>>=7;return t[r]=0|e,ide.bytes=r-n+1,t}var sde=cde,ode=128,ade=127;function cde(e,t){var r,n=0,i=(t=t||0,0),s=t,o=e.length;do{if(s>=o)throw cde.bytes=0,new RangeError("Could not decode varint");r=e[s++],n+=i<28?(r&ade)<<i:(r&ade)*Math.pow(2,i),i+=7}while(r>=ode);return cde.bytes=s-t,n}var lde=Math.pow(2,7),ude=Math.pow(2,14),hde=Math.pow(2,21),dde=Math.pow(2,28),fde=Math.pow(2,35),pde=Math.pow(2,42),yde=Math.pow(2,49),gde=Math.pow(2,56),mde=Math.pow(2,63),wde=function(e){return e<lde?1:e<ude?2:e<hde?3:e<dde?4:e<fde?5:e<pde?6:e<yde?7:e<gde?8:e<mde?9:10},bde={encode:Zhe,decode:sde,encodingLength:wde},vde=bde,Ede=vde;const _de=(e,t,r=0)=>(Ede.encode(e,t,r),t),Sde=e=>Ede.encodingLength(e),Ade=(e,t)=>{const r=t.byteLength,n=Sde(e),i=n+Sde(r),s=new Uint8Array(i+r);return _de(e,s,0),_de(r,s,n),s.set(t,i),new Ide(e,r,t,s)};class Ide{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Cde=({name:e,code:t,encode:r})=>new kde(e,t,r);class kde{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ade(this.code,t):t.then((e=>Ade(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Tde=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Rde=Cde({name:"sha2-256",code:18,encode:Tde("SHA-256")}),Pde=Cde({name:"sha2-512",code:19,encode:Tde("SHA-512")}),xde=0,Dde="identity",Ode=hhe,Nde=e=>Ade(xde,Ode(e)),Lde={code:xde,name:Dde,encode:Ode,digest:Nde},Bde="raw",Ude=85,Mde=e=>hhe(e),jde=e=>hhe(e),Vde=new TextEncoder,zde=new TextDecoder,Fde="json",$de=512,Kde=e=>Vde.encode(JSON.stringify(e)),qde=e=>JSON.parse(zde.decode(e));new WeakMap;class Hde{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==record_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==record_node_modules_multiformats_src_cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Hde.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return Hde.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Hde.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return record_node_modules_multiformats_src_cid_format(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Hde)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new Hde(e,r,n,i||record_node_modules_multiformats_src_cid_encodeCID(e,r,n.bytes))}if(!0===t[record_node_modules_multiformats_src_cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,i=Digest.decode(r);return Hde.create(e,n,i)}return null}static create(e,t,r){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==record_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${record_node_modules_multiformats_src_cid_DAG_PB_CODE}) block encoding`);return new Hde(e,t,r,r.bytes);case 1:{const n=record_node_modules_multiformats_src_cid_encodeCID(e,t,r.bytes);return new Hde(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Hde.create(0,record_node_modules_multiformats_src_cid_DAG_PB_CODE,e)}static createV1(e,t){return Hde.create(1,e,t)}static decode(e){const[t,r]=Hde.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Hde.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Digest.Digest(t.multihashCode,t.digestSize,i,n),o=0===t.version?Hde.createV0(s):Hde.createV1(t.codec,s);return[o,e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),i=record_node_modules_multiformats_src_cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a,l=c-s;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:l,size:c}}static parse(e,t){const[r,n]=record_node_modules_multiformats_src_cid_parseCIDtoBytes(e,t),i=Hde.decode(n);return record_node_modules_multiformats_src_cid_baseCache(i).set(r,e),i}}Symbol.for("@ipld/js-cid/CID");const Gde={...wr,...br,...vr,...Er,..._r,...Sr,...Ar,...Ir,...Cr,...kr};function Wde(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Yde(e=0){return null!=globalThis.Buffer?.allocUnsafe?Wde(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Jde(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Qde=Jde("utf8","u",(e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)}),(e=>{const t=new TextEncoder;return t.encode(e.substring(1))})),Xde=Jde("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=Yde(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Zde={utf8:Qde,"utf-8":Qde,hex:Gde.base16,latin1:Xde,ascii:Xde,binary:Xde,...Gde};var efe=Zde;function tfe(e,t="utf8"){const r=efe[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function rfe(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function nfe(e,t){const r=t.key,n=tfe(r),i=n.split("/");if(i.length<3)return;const s=e[i[1].toString()];if(null==s){const e="Invalid record keytype";throw mn(new Error(e),"ERR_INVALID_RECORD_KEY_TYPE")}return s(r,t.value)}const ife=async(e,t)=>{if(!(e instanceof Uint8Array))throw mn(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(e.byteLength<5)throw mn(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");const r=tfe(e.subarray(0,4));if("/pk/"!==r)throw mn(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");const n=e.slice(4),i=await Rde.digest(t);if(!rfe(n,i.bytes))throw mn(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")},sfe={pk:ife};function ofe(e,t,r){if(0===r.length){const e="No records given";throw mn(new Error(e),"ERR_NO_RECORDS_RECEIVED")}const n=tfe(t),i=n.split("/");if(i.length<3){const e="Record key does not have a selector function";throw mn(new Error(e),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}const s=e[i[1].toString()];if(null==s){const e=`Unrecognized key prefix: ${i[1]}`;throw mn(new Error(e),"ERR_UNRECOGNIZED_KEY_PREFIX")}return 1===r.length?0:s(t,r)}function afe(e,t){return 0}const cfe={pk:afe};class lfe{constructor(e){this.components=new S2;const{validators:t,selectors:r,peerRouting:n,queryManager:i,routingTable:s,network:o,lan:a}=e;this.log=gn(`libp2p:kad-dht:${a?"lan":"wan"}:content-fetching`),this.validators=t,this.selectors=r,this.peerRouting=n,this.queryManager=i,this.routingTable=s,this.network=o}init(e){this.components=e}async putLocal(e,t){const r=Cue(e);await this.components.getDatastore().put(r,t)}async getLocal(e){this.log("getLocal %b",e);const t=Cue(e);this.log("fetching record for key %k",t);const r=await this.components.getDatastore().get(t);this.log("found %k in local datastore",t);const n=vP.deserialize(r);return await nfe(this.validators,n),n}async*sendCorrectionRecord(e,t,r,n={}){this.log("sendCorrection for %b",e);const i=await Pue(e,r);for(const{value:s,from:o}of t){if(k_(s,r)){this.log("record was ok");continue}if(this.components.getPeerId().equals(o)){try{const t=Cue(e);this.log(`Storing corrected record for key ${t.toString()}`),await this.components.getDatastore().put(t,i.subarray())}catch(WV){this.log.error("Failed error correcting self",WV)}continue}let t=!1;const a=new Jue(Gue.PUT_VALUE,e,0);a.record=vP.deserialize(i);for await(const e of this.network.sendRequest(o,a,n))"PEER_RESPONSE"===e.name&&null!=e.record&&k_(e.record.value,vP.deserialize(i).value)&&(t=!0),yield e;t||(yield rhe({from:o,error:mn(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})),this.log.error("Failed error correcting entry")}}async*put(e,t,r={}){this.log("put key %b value %b",e,t);const n=await Pue(e,t),i=Cue(e);this.log(`storing record for key ${i.toString()}`),await this.components.getDatastore().put(i,n.subarray()),yield*QR(this.peerRouting.getClosestPeers(e,{signal:r.signal}),(t=>qR(t,(t=>async()=>{if("FINAL_PEER"!==t.name)return[t];const i=[],s=new Jue(Gue.PUT_VALUE,e,0);s.record=vP.deserialize(n),this.log("send put to %p",t.peer.id);for await(const e of this.network.sendRequest(t.peer.id,s,r))i.push(e),"PEER_RESPONSE"===e.name&&(null!=e.record&&k_(e.record.value,vP.deserialize(n).value)||i.push(rhe({from:t.peer.id,error:mn(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})));return i}))),(e=>fx(e,{ordered:!1,concurrency:yue})),(async function*(e){for await(const t of e)yield*t}))}async*get(e,t={}){this.log("get %b",e);const r=[];for await(const o of this.getMany(e,t))"VALUE"===o.name&&r.push(o),yield o;if(0===r.length)return;const n=r.map((e=>e.value));let i=0;try{i=ofe(this.selectors,e,n)}catch(WV){if("ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY"!==WV.code)throw WV}const s=n[i];if(this.log("GetValue %b %b",e,s),null==s)throw mn(new Error("best value was not found"),"ERR_NOT_FOUND");yield*this.sendCorrectionRecord(e,r,s,t),yield r[i]}async*getMany(e,t={}){this.log("getMany values for %b",e);try{const t=await this.getLocal(e);yield ihe({value:t.value,from:this.components.getPeerId()})}catch(WV){this.log("error getting local value for %b",e,WV)}const r=await Aue(e),n=this.routingTable.closestPeers(r);this.log("found %d peers in routing table",n.length);const i=this,s=async function*({peer:t,signal:r}){for await(const n of i.peerRouting.getValueOrPeers(t,e,{signal:r}))yield n,"PEER_RESPONSE"===n.name&&null!=n.record&&(yield ihe({from:t,value:n.record.value}))};yield*this.queryManager.run(e,n,s,t)}}class ufe{constructor(e){this.components=new S2;const{network:t,peerRouting:r,queryManager:n,routingTable:i,providers:s,lan:o}=e;this.log=gn(`libp2p:kad-dht:${o?"lan":"wan"}:content-routing`),this.network=t,this.peerRouting=r,this.queryManager=n,this.routingTable=i,this.providers=s}init(e){this.components=e}async*provide(e,t,r={}){this.log("provide %s",e),await this.providers.addProvider(e,this.components.getPeerId());const n=new Jue(Gue.ADD_PROVIDER,e.bytes,0);n.providerPeers=[{id:this.components.getPeerId(),multiaddrs:t,protocols:[]}];let i=0;const s=t=>async()=>{if("FINAL_PEER"!==t.name)return[t];const s=[];this.log("putProvider %s to %p",e,t.peer.id);try{this.log("sending provider record for %s to %p",e,t.peer.id);for await(const o of this.network.sendMessage(t.peer.id,n,r))"PEER_RESPONSE"===o.name&&(this.log("sent provider record for %s to %p",e,t.peer.id),i++),s.push(o)}catch(WV){this.log.error("error sending provide record to peer %p",t.peer.id,WV),s.push(rhe({from:t.peer.id,error:WV}))}return s};yield*QR(this.peerRouting.getClosestPeers(e.multihash.bytes,r),(e=>qR(e,(e=>s(e)))),(e=>fx(e,{ordered:!1,concurrency:yue})),(async function*(e){for await(const t of e)yield*t})),this.log("sent provider records to %d peers",i)}async*findProviders(e,t){const r=this.routingTable.kBucketSize,n=e.multihash.bytes,i=await Aue(n),s=this;this.log("findProviders %c",e);const o=await this.providers.getProviders(e);if(o.length>0){const e=[];for(const t of o.slice(0,r))e.push({id:t,multiaddrs:(await this.components.getPeerStore().addressBook.get(t)??[]).map((e=>e.multiaddr)),protocols:[]});yield ehe({from:this.components.getPeerId(),messageType:Gue.GET_PROVIDERS,providers:e}),yield nhe({from:this.components.getPeerId(),providers:e})}if(o.length>=r)return;const a=async function*({peer:e,signal:t}){const r=new Jue(Gue.GET_PROVIDERS,n,0);yield*s.network.sendRequest(e,r,{signal:t})},c=new Set(o.map((e=>e.toString())));for await(const l of this.queryManager.run(n,this.routingTable.closestPeers(i),a,t))if(yield l,"PEER_RESPONSE"===l.name){this.log("Found %d provider entries for %c and %d closer peers",l.providers.length,e,l.closer.length);const t=[];for(const e of l.providers)c.has(e.id.toString())||(c.add(e.id.toString()),t.push(e));if(t.length>0&&(yield nhe({from:l.from,providers:t})),c.size===r)return}}}class hfe{constructor(e,t){this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map((e=>e.peerId))}async add(e){if(null!=this.peerDistances.find((t=>t.peerId.equals(e))))return;const t=await Iue(e),r={peerId:e,distance:zue(this.originDhtKey,t)};this.peerDistances.push(r),this.peerDistances.sort(((e,t)=>LY(e.distance,t.distance))),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(0===e.length)return!1;if(0===this.length)return!0;const t=await Promise.all(e.map(Iue)),r=this.peerDistances[this.peerDistances.length-1].distance;for(const n of t){const e=zue(this.originDhtKey,n);if(LY(e,r)<0)return!0}return!1}}class dfe{constructor(e){this.components=new S2;const{routingTable:t,network:r,validators:n,queryManager:i,lan:s}=e;this.routingTable=t,this.network=r,this.validators=n,this.queryManager=i,this.log=gn(`libp2p:kad-dht:${s?"lan":"wan"}:peer-routing`)}init(e){this.components=e}async findPeerLocal(e){let t;const r=await this.routingTable.find(e);if(null!=r){this.log("findPeerLocal found %p in routing table",e);try{t=await this.components.getPeerStore().get(r)}catch(WV){if("ERR_NOT_FOUND"!==WV.code)throw WV}}if(null==t)try{t=await this.components.getPeerStore().get(e)}catch(WV){if("ERR_NOT_FOUND"!==WV.code)throw WV}if(null!=t)return this.log("findPeerLocal found %p in peer store",e),{id:t.id,multiaddrs:t.addresses.map((e=>e.multiaddr)),protocols:[]}}async*_getValueSingle(e,t,r={}){const n=new Jue(Gue.GET_VALUE,t,0);yield*this.network.sendRequest(e,n,r)}async*getPublicKeyFromNode(e,t={}){const r=kue(e);for await(const n of this._getValueSingle(e,r,t))if(yield n,"PEER_RESPONSE"===n.name&&null!=n.record){const t=await c_(dT({bytes:n.record.value}));if(!t.equals(e))throw mn(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");if(null==t.publicKey)throw mn(new Error("public key missing"),"ERR_PUBLIC_KEY_MISSING");yield ihe({from:e,value:t.publicKey})}throw mn(new Error(`Node not responding with its public key: ${e.toString()}`),"ERR_INVALID_RECORD")}async*findPeer(e,t={}){this.log("findPeer %p",e);const r=await this.findPeerLocal(e);if(null!=r)return this.log("found local"),void(yield the({from:this.components.getPeerId(),peer:r}));const n=await Iue(e),i=this.routingTable.closestPeers(n),s=i.find((t=>t.equals(e)));if(null!=s)try{const t=await this.components.getPeerStore().get(e);return this.log("found in peerStore"),void(yield the({from:this.components.getPeerId(),peer:{id:t.id,multiaddrs:t.addresses.map((e=>e.multiaddr)),protocols:[]}}))}catch(WV){if("ERR_NOT_FOUND"!==WV.code)throw WV}const o=this,a=async function*({peer:t,signal:r}){const n=new Jue(Gue.FIND_NODE,e.toBytes(),0);for await(const i of o.network.sendRequest(t,n,{signal:r}))if(yield i,"PEER_RESPONSE"===i.name){const t=i.closer.find((t=>t.id.equals(e)));null!=t&&(yield the({from:i.from,peer:t}))}};let c=!1;for await(const l of this.queryManager.run(e.toBytes(),i,a,t))"FINAL_PEER"===l.name&&(c=!0),yield l;c||(yield rhe({from:this.components.getPeerId(),error:mn(new Error("Not found"),"ERR_NOT_FOUND")}))}async*getClosestPeers(e,t={}){this.log("getClosestPeers to %b",e);const r=await Aue(e),n=this.routingTable.closestPeers(r),i=this,s=new hfe(r,this.routingTable.kBucketSize);await Promise.all(n.map((async e=>await s.add(e))));const o=async function*({peer:t,signal:r}){i.log("closerPeersSingle %s from %p",C_(e,"base32"),t);const n=new Jue(Gue.FIND_NODE,e,0);yield*i.network.sendRequest(t,n,{signal:r})};for await(const a of this.queryManager.run(e,n,o,t))yield a,"PEER_RESPONSE"===a.name&&await Promise.all(a.closer.map((async e=>await s.add(e.id))));this.log("found %d peers close to %b",s.length,e);for(const a of s.peers)yield the({from:this.components.getPeerId(),peer:{id:a,multiaddrs:(await this.components.getPeerStore().addressBook.get(a)??[]).map((e=>e.multiaddr)),protocols:[]}})}async*getValueOrPeers(e,t,r={}){for await(const n of this._getValueSingle(e,t,r)){if("PEER_RESPONSE"===n.name&&null!=n.record)try{await this._verifyRecordOnline(n.record)}catch(WV){const t="invalid record received, discarded";this.log(t),yield rhe({from:n.from,error:mn(new Error(t),"ERR_INVALID_RECORD")});continue}yield n}}async _verifyRecordOnline(e){if(null==e.timeReceived)throw mn(new Error("invalid record received"),"ERR_INVALID_RECORD");await nfe(this.validators,new vP(e.key,e.value,e.timeReceived))}async getCloserPeersOffline(e,t){const r=await Aue(e),n=this.routingTable.closestPeers(r),i=[];for(const s of n)if(!s.equals(t))try{const e=await this.components.getPeerStore().addressBook.get(s),t=await this.components.getPeerStore().protoBook.get(s);i.push({id:s,multiaddrs:e.map((e=>e.multiaddr)),protocols:t})}catch(WV){if("ERR_NOT_FOUND"!==WV.code)throw WV}return i.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",i.length,e,t):this.log("getCloserPeersOffline could not find peer closer to %b than %p",e,t),i}}const ffe=gn("libp2p:kad-dht:providers");class pfe{constructor(e={}){this.components=new S2;const{cacheSize:t,cleanupInterval:r,provideValidity:n}=e;this.cleanupInterval=r??fue,this.provideValidity=n??due,this.cache=Gw(t??hue),this.syncQueue=new Lb({concurrency:1}),this.started=!1}init(e){this.components=e}isStarted(){return this.started}async start(){this.started||(this.started=!0,this.cleaner=setInterval((()=>{this._cleanup().catch((e=>{ffe.error(e)}))}),this.cleanupInterval))}async stop(){this.started=!1,null!=this.cleaner&&(clearInterval(this.cleaner),this.cleaner=void 0)}async _cleanup(){return await this.syncQueue.add((async()=>{const e=Date.now();let t=0,r=0;const n=new Map,i=this.components.getDatastore().batch(),s=this.components.getDatastore().query({prefix:uue});for await(const o of s)try{const{cid:e,peerId:s}=mfe(o.key),a=bfe(o.value).getTime(),c=Date.now(),l=c-a,u=l>this.provideValidity;if(ffe("comparing: %d - %d = %d > %d %s",c,a,l,this.provideValidity,u?"(expired)":""),u){r++,i.delete(o.key);const t=n.get(e)??new Set;t.add(s),n.set(e,t)}t++}catch(WV){ffe.error(WV.message)}n.size>0?(ffe("deleting %d / %d entries",r,t),await i.commit()):ffe("nothing to delete");for(const[o,a]of n){const e=yfe(o),t=this.cache.get(e);if(null!=t){for(const e of a)t.delete(e);0===t.size?this.cache.remove(e):this.cache.set(e,t)}}ffe("Cleanup successful (%dms)",Date.now()-e)}))}async _getProvidersMap(e){const t=yfe(e);let r=this.cache.get(t);return null==r&&(r=await wfe(this.components.getDatastore(),e),this.cache.set(t,r)),r}async addProvider(e,t){return await this.syncQueue.add((async()=>{ffe("%p provides %s",t,e);const r=await this._getProvidersMap(e);ffe("loaded %s provs",r.size);const n=new Date;r.set(t.toString(),n);const i=yfe(e);this.cache.set(i,r),await gfe(this.components.getDatastore(),e,t,n)}))}async getProviders(e){return await this.syncQueue.add((async()=>{ffe("get providers for %s",e);const t=await this._getProvidersMap(e);return[...t.keys()].map((e=>s_(e)))}))}}function yfe(e){const t="string"===typeof e?e:C_(e.multihash.bytes,"base32");return`${uue}/${t}`}async function gfe(e,t,r,n){const i=[yfe(t),"/",r.toString()].join(""),s=new Ew(i),o=Uint8Array.from(Of.encode(n.getTime()));return await e.put(s,o)}function mfe(e){const t=e.toString().split("/");if(5!==t.length)throw new Error(`incorrectly formatted provider entry key in datastore: ${e.toString()}`);return{cid:t[3],peerId:t[4]}}async function wfe(e,t){const r=new Map,n=e.query({prefix:yfe(t)});for await(const i of n){const{peerId:e}=mfe(i.key);r.set(e,bfe(i.value))}return r}function bfe(e){return new Date(Of.decode(e))}const vfe=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");async function*Efe(e){const{key:t,startingPeer:r,ourPeerId:n,signal:i,query:s,alpha:o,pathIndex:a,numPaths:c,cleanUp:l,queryFuncTimeout:u,log:h,peersSeen:d}=e,f=new Lb({concurrency:o}),p=await Aue(t);function y(e,r){if(null==e)return;d.add(e);const o=BigInt("0x"+C_(zue(r,p),"base16"));f.add((async()=>{let r;const l=[i];null!=u&&(r=new Ql.TimeoutController(u),l.push(r.signal));const g=(0,Iw.anySignal)(l);try{for await(const r of s({key:t,peer:e,signal:g,pathIndex:a,numPaths:c})){if(g.aborted)return;if("PEER_RESPONSE"===r.name)for(const i of r.closer){if(d.has(i.id)){h("already seen %p in query",i.id);continue}if(n.equals(i.id)){h("not querying ourselves");continue}const r=await Iue(i.id),s=BigInt("0x"+C_(zue(r,p),"base16"));s>o?h("skipping %p as they are not closer to %b than %p",i.id,t,e):(h("querying closer peer %p",i.id),y(i.id,r))}f.emit("completed",r)}r?.clear()}catch(WV){i.aborted?f.emit("error",WV):f.emit("completed",rhe({from:e,error:WV}))}finally{r?.clear()}}),{priority:vfe-o}).catch((e=>{h.error(e)}))}y(r,await Iue(r)),yield*_fe(f,i,l,h)}async function*_fe(e,t,r,n){let i=d3(),s=!0;const o=[],a=()=>{s&&(n("clean up queue, results %d, queue size %d, pending tasks %d",o.length,e.size,e.pending),s=!1,e.clear(),o.splice(0,o.length))};e.on("completed",(e=>{o.push(e),i.resolve()})),e.on("error",(e=>{n("queue error",e),a(),i.reject(e)})),e.on("idle",(()=>{n("queue idle"),s=!1,i.resolve()})),t.addEventListener("abort",(()=>{n("abort queue");const e=s;a(),e&&i.reject(mn(new Error("Query aborted"),"ERR_QUERY_ABORTED"))})),r.addEventListener("cleanup",(()=>{a(),i.resolve()}));while(s){await i.promise,i=d3();while(o.length>0){const e=o.shift();null!=e&&(yield e)}}yield*o}const Sfe="running-queries";class Afe{constructor(e){this.components=new S2;const{lan:t=!1,disjointPaths:r=pue,alpha:n=yue}=e;this.disjointPaths=r??pue,this.controllers=new Set,this.running=!1,this.alpha=n??yue,this.lan=t,this.queries=0}init(e){this.components=e}isStarted(){return this.running}async start(){this.running=!0}async stop(){this.running=!1;for(const e of this.controllers)e.abort();this.controllers.clear()}async*run(e,t,r,n={}){if(!this.running)throw new Error("QueryManager not started");let i;if(null==n.signal){i=new Ql.TimeoutController(vue),n.signal=i.signal;try{null!=Ote.setMaxListeners&&(0,Ote.setMaxListeners)(1/0,i.signal)}catch{}}const s=new AbortController;this.controllers.add(s);const o=[s.signal];null!=n.signal&&o.push(n.signal);const a=(0,Iw.anySignal)(o);try{null!=Ote.setMaxListeners&&(0,Ote.setMaxListeners)(1/0,a)}catch{}const c=gn(`libp2p:kad-dht:${this.lan?"lan":"wan"}:query:`+C_(e,"base58btc")),l=t.slice(0,Math.min(this.disjointPaths,t.length)),u=Date.now(),h=new o0;try{if(c("query:start"),this.queries++,this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:Sfe,value:this.queries}),0===t.length)return void c.error("Running query with no peers");const o=new Xte,d=l.map(((t,i)=>Efe({key:e,startingPeer:t,ourPeerId:this.components.getPeerId(),signal:a,query:r,pathIndex:i,numPaths:l.length,alpha:this.alpha,cleanUp:h,queryFuncTimeout:n.queryFuncTimeout,log:c,peersSeen:o})));for await(const e of HR(...d))yield e,"QUERY_ERROR"===e.name&&c("error",e.error)}catch(WV){if(this.running||"ERR_QUERY_ABORTED"!==WV.code)throw WV}finally{this.controllers.delete(s),null!=i&&i.clear(),this.queries--,this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:Sfe,value:this.queries}),h.dispatchEvent(new c0("cleanup")),c("query:done in %dms",Date.now()-u)}}}const Ife=gn("libp2p:kad-dht:rpc:handlers:add-provider");class Cfe{constructor(e){const{providers:t}=e;this.providers=t}init(){}async handle(e,t){if(Ife("start"),null==t.key||0===t.key.length)throw mn(new Error("Missing key"),"ERR_MISSING_KEY");let r;try{r=ji.decode(t.key)}catch(WV){throw mn(new Error("Invalid CID"),"ERR_INVALID_CID")}null!=t.providerPeers&&0!==t.providerPeers.length||Ife.error("no providers found in message"),await Promise.all(t.providerPeers.map((async t=>{t.id.equals(e)?t.multiaddrs.length<1?Ife("no valid addresses for provider %p. Ignore",e):(Ife("received provider %p for %s (addrs %s)",e,r,t.multiaddrs.map((e=>e.toString()))),await this.providers.addProvider(r,t.id)):Ife("invalid provider peer %p from %p",t.id,e)})))}}const kfe=gn("libp2p:kad-dht:rpc:handlers:find-node");class Tfe{constructor(e){this.components=new S2;const{peerRouting:t,lan:r}=e;this.peerRouting=t,this.lan=Boolean(r)}init(e){this.components=e}async handle(e,t){kfe("incoming request from %p for peers closer to %b",e,t.key);let r=[];r=k_(this.components.getPeerId().toBytes(),t.key)?[{id:this.components.getPeerId(),multiaddrs:this.components.getAddressManager().getAddresses().map((e=>e.decapsulateCode(Df("p2p").code))),protocols:[]}]:await this.peerRouting.getCloserPeersOffline(t.key,e),r=r.map(this.lan?Sue:_ue).filter((({multiaddrs:e})=>e.length));const n=new Jue(t.type,new Uint8Array(0),t.clusterLevel);return r.length>0?n.closerPeers=r:kfe("could not find any peers closer to %b than %p",t.key,e),n}}const Rfe=gn("libp2p:kad-dht:rpc:handlers:get-providers");class Pfe{constructor(e){this.components=new S2;const{peerRouting:t,providers:r,lan:n}=e;this.peerRouting=t,this.providers=r,this.lan=Boolean(n)}init(e){this.components=e}async handle(e,t){let r;try{r=ji.decode(t.key)}catch(WV){throw mn(new Error("Invalid CID"),"ERR_INVALID_CID")}Rfe("%p asking for providers for %s",e,r);const[n,i]=await Promise.all([this.providers.getProviders(r),this.peerRouting.getCloserPeersOffline(t.key,e)]),s=await this._getPeers(n),o=await this._getPeers(i.map((({id:e})=>e))),a=new Jue(t.type,t.key,t.clusterLevel);return s.length>0&&(a.providerPeers=s),o.length>0&&(a.closerPeers=o),Rfe("got %s providers %s closerPeers",s.length,o.length),a}async _getAddresses(e){const t=await this.components.getPeerStore().addressBook.get(e);return t.map((e=>e.multiaddr))}async _getPeers(e){const t=[],r=this.lan?Sue:_ue;for(const n of e){const e=r({id:n,multiaddrs:await this._getAddresses(n),protocols:[]});e.multiaddrs.length>0&&t.push(e)}return t}}const xfe=gn("libp2p:kad-dht:rpc:handlers:get-value");class Dfe{constructor(e){this.components=new S2;const{peerRouting:t}=e;this.peerRouting=t}init(e){this.components=e}async handle(e,t){const r=t.key;if(xfe("%p asked for key %b",e,r),null==r||0===r.length)throw mn(new Error("Invalid key"),"ERR_INVALID_KEY");const n=new Jue(Gue.GET_VALUE,r,t.clusterLevel);if(Tue(r)){xfe("is public key");const e=Rue(r);let t;try{const r=await this.components.getPeerStore().keyBook.get(e);if(null==r)throw mn(new Error("No public key found in key book"),"ERR_NOT_FOUND");t=r}catch(WV){if("ERR_NOT_FOUND"!==WV.code)throw WV}if(null!=t)return xfe("returning found public key"),n.record=new vP(r,t,new Date),n}const[i,s]=await Promise.all([this._checkLocalDatastore(r),this.peerRouting.getCloserPeersOffline(t.key,e)]);return null!=i&&(xfe("had record for %b in local datastore",r),n.record=i),s.length>0&&(xfe("had %s closer peers in routing table",s.length),n.closerPeers=s),n}async _checkLocalDatastore(e){xfe("checkLocalDatastore looking for %b",e);const t=Cue(e);let r;try{r=await this.components.getDatastore().get(t)}catch(WV){if("ERR_NOT_FOUND"===WV.code)return;throw WV}const n=vP.deserialize(r);if(null==n)throw mn(new Error("Invalid record"),"ERR_INVALID_RECORD");if(!(null==n.timeReceived||Date.now()-n.timeReceived.getTime()>sue))return n;await this.components.getDatastore().delete(t)}}const Ofe=gn("libp2p:kad-dht:rpc:handlers:ping");class Nfe{async handle(e,t){return Ofe("ping from %p",e),t}init(){}}class Lfe{constructor(e){this.components=new S2;const{validators:t}=e;this.log=gn("libp2p:kad-dht:rpc:handlers:put-value"),this.validators=t}init(e){this.components=e}async handle(e,t){const r=t.key;this.log("%p asked us to store value for key %b",e,r);const n=t.record;if(null==n){const t=`Empty record from: ${e.toString()}`;throw this.log.error(t),mn(new Error(t),"ERR_EMPTY_RECORD")}try{await nfe(this.validators,n),n.timeReceived=new Date;const e=Cue(n.key);await this.components.getDatastore().put(e,n.serialize().subarray()),this.log("put record for %b into datastore under key %k",r,e)}catch(WV){this.log("did not put record for key %b into datastore %o",r,WV)}return t}}class Bfe{constructor(e){const{providers:t,peerRouting:r,validators:n,lan:i}=e;this.log=gn("libp2p:kad-dht:rpc"),this.routingTable=e.routingTable,this.handlers={[Gue.GET_VALUE]:new Dfe({peerRouting:r}),[Gue.PUT_VALUE]:new Lfe({validators:n}),[Gue.FIND_NODE]:new Tfe({peerRouting:r,lan:i}),[Gue.ADD_PROVIDER]:new Cfe({providers:t}),[Gue.GET_PROVIDERS]:new Pfe({peerRouting:r,providers:t,lan:i}),[Gue.PING]:new Nfe}}init(e){for(const t of Object.values(this.handlers))t.init(e)}async handleMessage(e,t){try{await this.routingTable.add(e)}catch(WV){this.log.error("Failed to update the kbucket store",WV)}const r=this.handlers[t.type];if(null!=r)return await r.handle(e,t);this.log.error(`no handler found for message type: ${t.type}`)}onIncomingStream(e){Promise.resolve().then((async()=>{const{stream:t,connection:r}=e,n=r.remotePeer;try{await this.routingTable.add(n)}catch(WV){this.log.error(WV)}const i=this;await QR(t,o3(),(async function*(e){for await(const t of e){const e=Jue.deserialize(t);i.log("incoming %s from %p",e.type,n);const r=await i.handleMessage(n,e);null!=r&&(yield r.serialize())}}),t3(),t)})).catch((e=>{this.log.error(e)}))}}class Ufe extends o0{constructor(e){super(),this.components=new S2;const{protocol:t,lan:r}=e;this.log=gn("libp2p:kad-dht:topology-listener:"+(r?"lan":"wan")),this.running=!1,this.protocol=t}init(e){this.components=e}isStarted(){return this.running}async start(){if(this.running)return;this.running=!0;const e=n0({onConnect:e=>{this.log("observed peer %p with protocol %s",e,this.protocol),this.dispatchEvent(new c0("peer",{detail:e}))}});this.registrarId=await this.components.getRegistrar().register(this.protocol,e)}stop(){this.running=!1,null!=this.registrarId&&(this.components.getRegistrar().unregister(this.registrarId),this.registrarId=void 0)}}class Mfe{constructor(e){this.components=new S2;const{peerRouting:t,lan:r,count:n,interval:i,queryTimeout:s}=e;this.log=gn(`libp2p:kad-dht:${r?"lan":"wan"}:query-self`),this.running=!1,this.peerRouting=t,this.count=n??pue,this.interval=i??gue,this.queryTimeout=s??mue}init(e){this.components=e}isStarted(){return this.running}async start(){this.running||(this.running=!0,this._querySelf())}async stop(){this.running=!1,null!=this.timeoutId&&clearTimeout(this.timeoutId),null!=this.controller&&this.controller.abort()}_querySelf(){Promise.resolve().then((async()=>{const e=new Ql.TimeoutController(this.queryTimeout);try{this.controller=new AbortController;const t=(0,Iw.anySignal)([this.controller.signal,e.signal]);try{null!=Ote.setMaxListeners&&(0,Ote.setMaxListeners)(1/0,t)}catch{}const r=await QR(this.peerRouting.getClosestPeers(this.components.getPeerId().toBytes(),{signal:t}),(e=>xR(e,this.count)),(async e=>await mY(e)));this.log("query ran successfully - found %d peers",r)}catch(WV){this.log("query error",WV)}finally{this.timeoutId=setTimeout(this._querySelf.bind(this),this.interval),e.clear()}})).catch((e=>{this.log("query error",e)}))}}const jfe=32,Vfe=64;class zfe extends o0{constructor(e){super(),this.components=new S2;const{kBucketSize:t,clientMode:r,validators:n,selectors:i,querySelfInterval:s,lan:o,protocolPrefix:a,pingTimeout:c,pingConcurrency:l,maxInboundStreams:u,maxOutboundStreams:h}=e;this.running=!1,this.lan=Boolean(o),this.log=gn("libp2p:kad-dht:"+(!0===o?"lan":"wan")),this.protocol=`${a??aue}${!0===o?oue:""}${cue}`,this.kBucketSize=t??20,this.clientMode=r??!0,this.maxInboundStreams=u??jfe,this.maxOutboundStreams=h??Vfe,this.routingTable=new Vue({kBucketSize:t,lan:this.lan,pingTimeout:c,pingConcurrency:l,protocol:this.protocol}),this.providers=new pfe,this.validators={...sfe,...n},this.selectors={...cfe,...i},this.network=new ohe({protocol:this.protocol,lan:this.lan}),this.queryManager=new Afe({disjointPaths:Math.ceil(this.kBucketSize/2),lan:o}),this.peerRouting=new dfe({routingTable:this.routingTable,network:this.network,validators:this.validators,queryManager:this.queryManager,lan:this.lan}),this.contentFetching=new lfe({validators:this.validators,selectors:this.selectors,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,network:this.network,lan:this.lan}),this.contentRouting=new ufe({network:this.network,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,providers:this.providers,lan:this.lan}),this.routingTableRefresh=new Kue({peerRouting:this.peerRouting,routingTable:this.routingTable,lan:this.lan}),this.rpc=new Bfe({routingTable:this.routingTable,providers:this.providers,peerRouting:this.peerRouting,validators:this.validators,lan:this.lan}),this.topologyListener=new Ufe({protocol:this.protocol,lan:this.lan}),this.querySelf=new Mfe({peerRouting:this.peerRouting,interval:s,lan:this.lan}),this.network.addEventListener("peer",(e=>{const t=e.detail;this.onPeerConnect(t).catch((e=>{this.log.error("could not add %p to routing table",t.id,e)})),this.dispatchEvent(new c0("peer",{detail:t}))})),this.topologyListener.addEventListener("peer",(e=>{const t=e.detail;Promise.resolve().then((async()=>{const e=await this.components.getPeerStore().addressBook.get(t),r={id:t,multiaddrs:e.map((e=>e.multiaddr)),protocols:[]};await this.onPeerConnect(r)})).catch((e=>{this.log.error("could not add %p to routing table",t,e)}))}))}get[vte](){return!0}get[Symbol.toStringTag](){return"@libp2p/kad-dht"}init(e){this.components=e,this.routingTable.init(e),this.providers.init(e),this.network.init(e),this.queryManager.init(e),this.peerRouting.init(e),this.contentFetching.init(e),this.contentRouting.init(e),this.routingTableRefresh.init(e),this.rpc.init(e),this.topologyListener.init(e),this.querySelf.init(e)}async onPeerConnect(e){if(this.log("peer %p connected with protocols %s",e.id,e.protocols),e=this.lan?Sue(e):_ue(e),0!==e.multiaddrs.length)try{await this.routingTable.add(e.id)}catch(WV){this.log.error("could not add %p to routing table",e.id,WV)}else this.log("ignoring %p as they do not have any %s addresses in %s",e.id,this.lan?"private":"public",e.multiaddrs.map((e=>e.toString())))}isStarted(){return this.running}async getMode(){return this.clientMode?"client":"server"}async setMode(e){await this.components.getRegistrar().unhandle(this.protocol),"client"===e?(this.log("enabling client mode"),this.clientMode=!0):(this.log("enabling server mode"),this.clientMode=!1,await this.components.getRegistrar().handle(this.protocol,this.rpc.onIncomingStream.bind(this.rpc),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))}async start(){this.running=!0,await this.setMode(this.clientMode?"client":"server"),await Promise.all([this.providers.start(),this.queryManager.start(),this.network.start(),this.routingTable.start(),this.topologyListener.start(),this.querySelf.start()]),await this.routingTableRefresh.start()}async stop(){this.running=!1,await Promise.all([this.providers.stop(),this.queryManager.stop(),this.network.stop(),this.routingTable.stop(),this.routingTableRefresh.stop(),this.topologyListener.stop(),this.querySelf.stop()])}async*put(e,t,r={}){yield*this.contentFetching.put(e,t,r)}async*get(e,t={}){yield*this.contentFetching.get(e,t)}async*provide(e,t={}){yield*this.contentRouting.provide(e,this.components.getAddressManager().getAddresses(),t)}async*findProviders(e,t={}){yield*this.contentRouting.findProviders(e,t)}async*findPeer(e,t={}){yield*this.peerRouting.findPeer(e,t)}async*getClosestPeers(e,t={}){yield*this.peerRouting.getClosestPeers(e,t)}async refreshRoutingTable(){await this.routingTableRefresh.refreshTable(!0)}}const Ffe=gn("libp2p:kad-dht");class $fe extends o0{constructor(e,t){super(),this.components=new S2,this.wan=e,this.lan=t,this.wan.addEventListener("peer",(e=>{this.dispatchEvent(new c0("peer",{detail:e.detail}))})),this.lan.addEventListener("peer",(e=>{this.dispatchEvent(new c0("peer",{detail:e.detail}))}))}get[vte](){return!0}get[Symbol.toStringTag](){return"@libp2p/dual-kad-dht"}init(e){this.components=e,this.wan.init(e),this.lan.init(e)}isStarted(){return this.wan.isStarted()&&this.lan.isStarted()}async getMode(){return await this.wan.getMode()}async setMode(e){await this.wan.setMode(e)}async start(){await Promise.all([this.lan.start(),this.wan.start()])}async stop(){await Promise.all([this.lan.stop(),this.wan.stop()])}async*put(e,t,r={}){for await(const n of HR(this.lan.put(e,t,r),this.wan.put(e,t,r)))yield n}async*get(e,t={}){let r=!1,n=!1;for await(const i of HR(this.lan.get(e,t),this.wan.get(e,t)))yield i,"DIALING_PEER"===i.name&&(r=!0),"VALUE"===i.name&&(r=!0,null!=i.value&&(n=!0)),"SENDING_QUERY"===i.name&&(r=!0);if(!r)throw mn(new Error("No peers found in routing table!"),"ERR_NO_PEERS_IN_ROUTING_TABLE");n||(yield rhe({from:this.components.getPeerId(),error:mn(new Error("Not found"),"ERR_NOT_FOUND")}))}async*provide(e,t={}){let r=0,n=0;const i=[],s=[this.lan];"server"===await this.wan.getMode()&&s.push(this.wan);for await(const o of HR(...s.map((r=>r.provide(e,t)))))yield o,"SENDING_QUERY"===o.name&&r++,"QUERY_ERROR"===o.name&&i.push(o.error),"PEER_RESPONSE"===o.name&&"ADD_PROVIDER"===o.messageName&&(Ffe("sent provider record for %s to %p",e,o.from),n++);if(0===n){if(i.length>0)throw mn(new Error(`Failed to provide to ${i.length} of ${r} peers`),"ERR_PROVIDES_FAILED",{errors:i});throw mn(new Error("Failed to provide - no peers found"),"ERR_PROVIDES_FAILED")}}async*findProviders(e,t={}){yield*HR(this.lan.findProviders(e,t),this.wan.findProviders(e,t))}async*findPeer(e,t={}){let r=!1;for await(const n of HR(this.lan.findPeer(e,t),this.wan.findPeer(e,t)))yield n,"SENDING_QUERY"!==n.name&&"FINAL_PEER"!==n.name||(r=!0);if(!r)throw mn(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED")}async*getClosestPeers(e,t={}){yield*HR(this.lan.getClosestPeers(e,t),this.wan.getClosestPeers(e,t))}async refreshRoutingTable(){await Promise.all([this.lan.refreshRoutingTable(),this.wan.refreshRoutingTable()])}}class Kfe extends $fe{constructor(e){super(new zfe({protocolPrefix:"/ipfs",...e,lan:!1}),new zfe({protocolPrefix:"/ipfs",...e,clientMode:!1,lan:!0}))}}const qfe=gn("libp2p:bootstrap");class Hfe extends o0{constructor(e={list:[]}){if(null==e.list||0===e.list.length)throw new Error("Bootstrap requires a list of peer addresses");super(),this.interval=e.interval??1e4,this.list=[];for(const t of e.list){if(!Qp.matches(t)){qfe.error("Invalid multiaddr");continue}const e=Pp(t),r=e.getPeerId();if(null==r){qfe.error("Invalid bootstrap multiaddr without peer id");continue}const n={id:s_(r),multiaddrs:[e],protocols:[]};this.list.push(n)}}get[vte](){return!0}get[Symbol.toStringTag](){return"@libp2p/bootstrap"}isStarted(){return Boolean(this.timer)}start(){null==this.timer&&(this.timer=setInterval((()=>this._discoverBootstrapPeers()),this.interval),qfe("Starting bootstrap node discovery"),this._discoverBootstrapPeers())}_discoverBootstrapPeers(){null!=this.timer&&this.list.forEach((e=>{this.dispatchEvent(new c0("peer",{detail:e}))}))}stop(){null!=this.timer&&clearInterval(this.timer),this.timer=void 0}}Hfe.tag="bootstrap";var Gfe=WebSocket,Wfe=r(507);function Yfe(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var Jfe=Yfe,Qfe=Jfe,Xfe=Qfe;new Uint8Array(0);const Zfe=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},epe=e=>(new TextEncoder).encode(e),tpe=e=>(new TextDecoder).decode(e);class rpe{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class npe{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return spe(this,e)}}class ipe{constructor(e){this.decoders=e}or(e){return spe(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const spe=(e,t)=>new ipe({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class ope{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new rpe(e,t,r),this.decoder=new npe(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ape=({name:e,prefix:t,encode:r,decode:n})=>new ope(e,t,r,n),cpe=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=Xfe(r,t);return ape({prefix:e,name:t,encode:n,decode:e=>Zfe(i(e))})},lpe=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},upe=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},hpe=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>ape({prefix:t,name:e,encode(e){return upe(e,n,r)},decode(t){return lpe(t,n,r,e)}}),dpe=ape({prefix:"\0",name:"identity",encode:e=>tpe(e),decode:e=>epe(e)}),fpe=hpe({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ppe=hpe({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ype=cpe({prefix:"9",name:"base10",alphabet:"0123456789"}),gpe=hpe({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),mpe=hpe({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),wpe=hpe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bpe=hpe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),vpe=hpe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Epe=hpe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),_pe=hpe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Spe=hpe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ape=hpe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ipe=hpe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Cpe=hpe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),kpe=cpe({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Tpe=cpe({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Rpe=cpe({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ppe=cpe({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),xpe=hpe({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Dpe=hpe({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ope=hpe({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Npe=hpe({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Lpe=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Bpe=Lpe.reduce(((e,t,r)=>(e[r]=t,e)),[]),Upe=Lpe.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);function Mpe(e){return e.reduce(((e,t)=>(e+=Bpe[t],e)),"")}function jpe(e){const t=[];for(const r of e){const e=Upe[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}const Vpe=ape({prefix:"🚀",name:"base256emoji",encode:Mpe,decode:jpe});var zpe=Hpe,Fpe=128,$pe=127,Kpe=~$pe,qpe=Math.pow(2,31);function Hpe(e,t,r){t=t||[],r=r||0;var n=r;while(e>=qpe)t[r++]=255&e|Fpe,e/=128;while(e&Kpe)t[r++]=255&e|Fpe,e>>>=7;return t[r]=0|e,Hpe.bytes=r-n+1,t}var Gpe=Jpe,Wpe=128,Ype=127;function Jpe(e,t){var r,n=0,i=(t=t||0,0),s=t,o=e.length;do{if(s>=o)throw Jpe.bytes=0,new RangeError("Could not decode varint");r=e[s++],n+=i<28?(r&Ype)<<i:(r&Ype)*Math.pow(2,i),i+=7}while(r>=Wpe);return Jpe.bytes=s-t,n}var Qpe=Math.pow(2,7),Xpe=Math.pow(2,14),Zpe=Math.pow(2,21),eye=Math.pow(2,28),tye=Math.pow(2,35),rye=Math.pow(2,42),nye=Math.pow(2,49),iye=Math.pow(2,56),sye=Math.pow(2,63),oye=function(e){return e<Qpe?1:e<Xpe?2:e<Zpe?3:e<eye?4:e<tye?5:e<rye?6:e<nye?7:e<iye?8:e<sye?9:10},aye={encode:zpe,decode:Gpe,encodingLength:oye},cye=aye,lye=cye;const uye=(e,t,r=0)=>(lye.encode(e,t,r),t),hye=e=>lye.encodingLength(e),dye=(e,t)=>{const r=t.byteLength,n=hye(e),i=n+hye(r),s=new Uint8Array(i+r);return uye(e,s,0),uye(r,s,n),s.set(t,i),new fye(e,r,t,s)};class fye{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const pye=({name:e,code:t,encode:r})=>new yye(e,t,r);class yye{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?dye(this.code,t):t.then((e=>dye(this.code,e)))}throw Error("Unknown type, must be binary type")}}const gye=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),mye=pye({name:"sha2-256",code:18,encode:gye("SHA-256")}),wye=pye({name:"sha2-512",code:19,encode:gye("SHA-512")}),bye=0,vye="identity",Eye=Zfe,_ye=e=>dye(bye,Eye(e)),Sye={code:bye,name:vye,encode:Eye,digest:_ye},Aye="raw",Iye=85,Cye=e=>Zfe(e),kye=e=>Zfe(e),Tye=new TextEncoder,Rye=new TextDecoder,Pye="json",xye=512,Dye=e=>Tye.encode(JSON.stringify(e)),Oye=e=>JSON.parse(Rye.decode(e));new WeakMap;class Nye{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==it_ws_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==it_ws_node_modules_multiformats_src_cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Nye.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return Nye.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Nye.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return it_ws_node_modules_multiformats_src_cid_format(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Nye)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new Nye(e,r,n,i||it_ws_node_modules_multiformats_src_cid_encodeCID(e,r,n.bytes))}if(!0===t[it_ws_node_modules_multiformats_src_cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,i=Digest.decode(r);return Nye.create(e,n,i)}return null}static create(e,t,r){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==it_ws_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${it_ws_node_modules_multiformats_src_cid_DAG_PB_CODE}) block encoding`);return new Nye(e,t,r,r.bytes);case 1:{const n=it_ws_node_modules_multiformats_src_cid_encodeCID(e,t,r.bytes);return new Nye(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Nye.create(0,it_ws_node_modules_multiformats_src_cid_DAG_PB_CODE,e)}static createV1(e,t){return Nye.create(1,e,t)}static decode(e){const[t,r]=Nye.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Nye.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Digest.Digest(t.multihashCode,t.digestSize,i,n),o=0===t.version?Nye.createV0(s):Nye.createV1(t.codec,s);return[o,e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),i=it_ws_node_modules_multiformats_src_cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a,l=c-s;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:l,size:c}}static parse(e,t){const[r,n]=it_ws_node_modules_multiformats_src_cid_parseCIDtoBytes(e,t),i=Nye.decode(n);return it_ws_node_modules_multiformats_src_cid_baseCache(i).set(r,e),i}}Symbol.for("@ipld/js-cid/CID");const Lye={...Dr,...Or,...Nr,...Lr,...Br,...Ur,...Mr,...jr,...Vr,...zr};function Bye(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Uye(e=0){return null!=globalThis.Buffer?.allocUnsafe?Bye(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Mye(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const jye=Mye("utf8","u",(e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)}),(e=>{const t=new TextEncoder;return t.encode(e.substring(1))})),Vye=Mye("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=Uye(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),zye={utf8:jye,"utf-8":jye,hex:Lye.base16,latin1:Vye,ascii:Vye,binary:Vye,...Lye};var Fye=zye;function $ye(e,t="utf8"){const r=Fye[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Bye(globalThis.Buffer.from(e,"utf-8"))}function Kye(e){return e instanceof ArrayBuffer||"ArrayBuffer"===e?.constructor?.name&&"number"===typeof e?.byteLength}var qye=e=>{e.binaryType="arraybuffer";const t=async()=>await new Promise(((t,r)=>{if(i)return t();if(null!=n)return r(n);const s=t=>{e.removeEventListener("open",o),e.removeEventListener("error",a),t()},o=()=>s(t),a=t=>{s((()=>r(t.error??new Error(`connect ECONNREFUSED ${e.url}`))))};e.addEventListener("open",o),e.addEventListener("error",a)})),r=async function*(){const r=new Wfe.zN((({push:t,stop:r,fail:n})=>{const i=e=>{let r=null;"string"===typeof e.data&&(r=$ye(e.data)),Kye(e.data)&&(r=new Uint8Array(e.data)),e.data instanceof Uint8Array&&(r=e.data),null!=r&&t(r)},s=e=>n(e.error??new Error("Socket error"));return e.addEventListener("message",i),e.addEventListener("error",s),e.addEventListener("close",r),()=>{e.removeEventListener("message",i),e.removeEventListener("error",s),e.removeEventListener("close",r)}}),{highWaterMark:1/0});await t();for await(const e of r)yield Kye(e)?new Uint8Array(e):e}();let n,i=1===e.readyState;return e.addEventListener("open",(()=>{i=!0,n=null})),e.addEventListener("close",(()=>{i=!1,n=null})),e.addEventListener("error",(t=>{i||(n=t.error??new Error(`connect ECONNREFUSED ${e.url}`))})),Object.assign(r,{connected:t})},Hye=e=>{if(e.readyState>=2)throw new Error("socket closed");if(1!==e.readyState)return new Promise(((t,r)=>{function n(){e.removeEventListener("open",i),e.removeEventListener("error",s)}function i(){n(),t()}function s(t){n(),r(t.error??new Error(`connect ECONNREFUSED ${e.url}`))}e.addEventListener("open",i),e.addEventListener("error",s)}))},Gye=(e,t)=>{t=t??{},t.closeOnEnd=!1!==t.closeOnEnd;const r=async r=>{for await(const t of r){try{await Hye(e)}catch(WV){if("socket closed"===WV.message)break;throw WV}e.send(t)}if(null!=t.closeOnEnd&&e.readyState<=1)return await new Promise(((t,r)=>{e.addEventListener("close",(e=>{if(e.wasClean||1006===e.code)t();else{const t=Object.assign(new Error("ws error"),{event:e});r(t)}})),setTimeout((()=>e.close()))}))};return r},Wye=(e,t)=>{t=t??{};const r=qye(e);let n=t.remoteAddress,i=t.remotePort;if(null!=e.url)try{const t=new URL(e.url);n=t.hostname,i=parseInt(t.port,10)}catch{}if(null==n||null==i)throw new Error("Remote connection did not have address and/or port");const s={sink:Gye(e,t),source:r,connected:async()=>await r.connected(),close:async()=>{e.readyState!==e.CONNECTING&&e.readyState!==e.OPEN||await new Promise((t=>{e.addEventListener("close",(()=>{t()})),e.close()}))},destroy:()=>{null!=e.terminate?e.terminate():e.close()},remoteAddress:n,remotePort:i,socket:e};return s};const Yye={http:"ws",https:"wss"},Jye="ws";var Qye=(e,t)=>(0,py.relative)(e,t,Yye,Jye);function Xye(e,t){const r="undefined"===typeof window?"":window.location;t=t??{};const n=Qye(e,r.toString()),i=new Gfe(n,t.websocket);return Wye(i,t)}function Zye(){throw new Error("WebSocket Servers can not be created in the browser!")}const ege=421,tge=290,rge=6,nge=478,ige=2e3;class sge extends Error{constructor(e){super(e),this.name="TimeoutError"}}class oge extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const age=e=>void 0===globalThis.DOMException?new oge(e):new DOMException(e),cge=e=>{const t=void 0===e.reason?age("This operation was aborted."):e.reason;return t instanceof Error?t:age(t)};function lge(e,t){const{milliseconds:r,fallback:n,message:i,customTimers:s={setTimeout:setTimeout,clearTimeout:clearTimeout}}=t;let o;const a=new Promise(((a,c)=>{if("number"!==typeof r||1!==Math.sign(r))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(r!==Number.POSITIVE_INFINITY){if(t.signal){const{signal:e}=t;e.aborted&&c(cge(e)),e.addEventListener("abort",(()=>{c(cge(e))}))}o=s.setTimeout.call(void 0,(()=>{if(n){try{a(n())}catch(o){c(o)}return}const t="string"===typeof i?i:`Promise timed out after ${r} milliseconds`,s=i instanceof Error?i:new sge(t);"function"===typeof e.cancel&&e.cancel(),c(s)}),r),(async()=>{try{a(await e)}catch(t){c(t)}finally{s.clearTimeout.call(void 0,o)}})()}else a(e)}));return a.clear=()=>{s.clearTimeout.call(void 0,o),o=void 0},a}const uge=gn("libp2p:websockets:socket");function hge(e,t,r){r=r??{};const n={async sink(t){null!=r?.signal&&(t=J2(t,r.signal));try{await e.sink(t)}catch(WV){"aborted"!==WV.type&&uge.error(WV)}},source:null!=r.signal?J2(e.source,r.signal):e.source,remoteAddr:t,timeline:{open:Date.now()},async close(){const t=Date.now();try{await lge(e.close(),{milliseconds:ige})}catch(WV){const{host:i,port:s}=n.remoteAddr.toOptions();uge("timeout closing stream to %s:%s after %dms, destroying it manually",i,s,Date.now()-t),e.destroy()}finally{n.timeline.close=Date.now()}}};return e.socket.addEventListener("close",(()=>{null==n.timeline.close&&(n.timeline.close=Date.now())}),{once:!0}),n}function dge(e){return e.filter((e=>{if(e.protoCodes().includes(tge))return!1;const t=e.decapsulateCode(ege);return Vp.matches(t)||zp.matches(t)}))}function fge(e){return e.filter((e=>{if(e.protoCodes().includes(tge))return!1;const t=e.decapsulateCode(ege);return zp.matches(t)&&Np.matches(t.decapsulateCode(rge).decapsulateCode(nge))}))}const pge=gn("libp2p:websockets");class yge{constructor(e){this.init=e}get[Symbol.toStringTag](){return"@libp2p/websockets"}get[bte](){return!0}async dial(e,t){pge("dialing %s",e),t=t??{};const r=await this._connect(e,t),n=hge(r,e);pge("new outbound connection %s",n.remoteAddr);const i=await t.upgrader.upgradeOutbound(n);return pge("outbound connection %s upgraded",n.remoteAddr),i}async _connect(e,t){if(!0===t?.signal?.aborted)throw new Fle;const r=e.toOptions();pge("dialing %s:%s",r.host,r.port);const n=d3(),i=e=>{pge.error("connection error:",e),n.reject(e)},s=Xye(nH(e),this.init);if(null!=s.socket.on?s.socket.on("error",i):s.socket.onerror=i,null==t.signal)return await Promise.race([s.connected(),n.promise]),pge("connected %s",e),s;let o;const a=new Promise(((e,r)=>{if(o=()=>{r(new Fle),s.close().catch((e=>{pge.error("error closing raw socket",e)}))},!0===t?.signal?.aborted)return o();t?.signal?.addEventListener("abort",o)}));try{await Promise.race([a,n.promise,s.connected()])}finally{null!=o&&t?.signal?.removeEventListener("abort",o)}return pge("connected %s",e),s}createListener(e){return Zye({...this.init,...e})}filter(e){return e=Array.isArray(e)?e:[e],null!=this.init?.filter?this.init?.filter(e):Poe||Noe?fge(e):dge(e)}}function gge(e){return new Uint8Array(e)}var mge;(function(e){e[e["NEW_STREAM"]=0]="NEW_STREAM",e[e["MESSAGE_RECEIVER"]=1]="MESSAGE_RECEIVER",e[e["MESSAGE_INITIATOR"]=2]="MESSAGE_INITIATOR",e[e["CLOSE_RECEIVER"]=3]="CLOSE_RECEIVER",e[e["CLOSE_INITIATOR"]=4]="CLOSE_INITIATOR",e[e["RESET_RECEIVER"]=5]="RESET_RECEIVER",e[e["RESET_INITIATOR"]=6]="RESET_INITIATOR"})(mge||(mge={}));const wge=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),bge=Object.freeze({NEW_STREAM:mge.NEW_STREAM,MESSAGE:mge.MESSAGE_INITIATOR,CLOSE:mge.CLOSE_INITIATOR,RESET:mge.RESET_INITIATOR}),vge=Object.freeze({MESSAGE:mge.MESSAGE_RECEIVER,CLOSE:mge.CLOSE_RECEIVER,RESET:mge.RESET_RECEIVER}),Ege=10240;class _ge{constructor(){this._pool=gge(Ege),this._poolOffset=0}write(e){const t=this._pool;let r=this._poolOffset;Of.encode(e.id<<3|e.type,t,r),r+=Of.encode.bytes,e.type!==mge.NEW_STREAM&&e.type!==mge.MESSAGE_INITIATOR&&e.type!==mge.MESSAGE_RECEIVER||null==e.data?Of.encode(0,t,r):Of.encode(e.data.length,t,r),r+=Of.encode.bytes;const n=t.subarray(this._poolOffset,r);return Ege-r<100?(this._pool=gge(Ege),this._poolOffset=0):this._poolOffset=r,e.type!==mge.NEW_STREAM&&e.type!==mge.MESSAGE_INITIATOR&&e.type!==mge.MESSAGE_RECEIVER||null==e.data?[n]:[n,...e.data instanceof Uint8Array?[e.data]:e.data]}}const Sge=new _ge;async function*Age(e){for await(const t of e)if(Array.isArray(t))for(const e of t)yield*Sge.write(e);else yield*Sge.write(t)}class Ige{constructor(){this._buffer=new XL,this._headerInfo=null}write(e){if(null==e||0===e.length)return[];this._buffer.append(e);const t=[];while(0!==this._buffer.length){if(null==this._headerInfo)try{this._headerInfo=this._decodeHeader(this._buffer)}catch(r){break}const{id:e,type:n,length:i,offset:s}=this._headerInfo,o=this._buffer.length-s;if(o<i)break;const a={id:e,type:n};n!==mge.NEW_STREAM&&n!==mge.MESSAGE_INITIATOR&&n!==mge.MESSAGE_RECEIVER||(a.data=this._buffer.sublist(s,s+i)),t.push(a),this._buffer.consume(s+i),this._headerInfo=null}return t}_decodeHeader(e){const{value:t,offset:r}=Tge(e),{value:n,offset:i}=Tge(e,r),s=7&t;if(null==wge[s])throw new Error(`Invalid type received: ${s}`);return{id:t>>3,type:s,offset:r+i,length:n}}}const Cge=128,kge=127;function Tge(e,t=0){let r,n=0,i=0,s=t;const o=e.length;do{if(s>=o||i>49)throw t=0,new RangeError("Could not decode varint");r=e.get(s++),n+=i<28?(r&kge)<<i:(r&kge)*Math.pow(2,i),i+=7}while(r>=Cge);return t=s-t,{value:n,offset:t}}async function*Rge(e){const t=new Ige;for await(const r of e){const e=t.write(r);e.length>0&&(yield e)}}const Pge=1<<20;function xge(e){const t=e??Pge,r=e=>{if((e.type===mge.NEW_STREAM||e.type===mge.MESSAGE_INITIATOR||e.type===mge.MESSAGE_RECEIVER)&&e.data.byteLength>t)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return e=>async function*(){for await(const t of e)Array.isArray(t)?(t.forEach(r),yield*t):(r(t),yield t)}()}const Dge=gn("libp2p:mplex:stream"),Oge="ERR_STREAM_RESET",Nge="ERR_STREAM_ABORT",Lge="ERR_SINK_ENDED",Bge="ERR_DOUBLE_SINK";function Uge(e){const{id:t,name:r,send:n,onEnd:i,type:s="initiator",maxMsgSize:o=Pge}=e,a=new AbortController,c=new AbortController,l=new AbortController,u="initiator"===s?bge:vge,h="initiator"===s?`i${t}`:`r${t}`,d=`${null==r?t:r}`;let f,p=!1,y=!1,g=!1;const m={open:Date.now()},w=e=>{p||(p=!0,Dge.trace("%s stream %s source end - err: %o",s,d,e),null!=e&&null==f&&(f=e),y&&(E.stat.timeline.close=Date.now(),null!=i&&i(f)))},b=e=>{y||(y=!0,Dge.trace("%s stream %s sink end - err: %o",s,d,e),null!=e&&null==f&&(f=e),p&&(m.close=Date.now(),null!=i&&i(f)))},v=LR({onEnd:w}),E={close:()=>{Dge.trace("%s stream %s close",s,d),E.closeRead(),E.closeWrite()},closeRead:()=>{Dge.trace("%s stream %s closeRead",s,d),p||v.end()},closeWrite:()=>{if(Dge.trace("%s stream %s closeWrite",s,d),!y){l.abort();try{n({id:t,type:u.CLOSE})}catch(WV){Dge.trace("%s stream %s error sending close",s,r,WV)}b()}},abort:e=>{Dge.trace("%s stream %s abort",s,d,e),v.end(e),a.abort(),b(e)},reset:()=>{const e=mn(new Error("stream reset"),Oge);c.abort(),v.end(e),b(e)},sink:async e=>{if(g)throw mn(new Error("sink already called on stream"),Bge);if(g=!0,y)throw mn(new Error("stream closed for writing"),Lge);e=J2(e,(0,Iw.anySignal)([a.signal,c.signal,l.signal]));try{"initiator"===s&&n({id:t,type:bge.NEW_STREAM,data:new XL(Jl(d))});const r=new XL;for await(const i of e)if(i.length<=o)n({id:t,type:u.MESSAGE,data:i instanceof XL?i:new XL(i)});else{r.append(i);while(0!==r.length){if(r.length<=o){n({id:t,type:u.MESSAGE,data:r.sublist()}),r.consume(r.length);break}n({id:t,type:u.MESSAGE,data:r.sublist(0,o)}),r.consume(o)}}}catch(WV){if("aborted"===WV.type&&"The operation was aborted"===WV.message){if(l.signal.aborted)return;c.signal.aborted&&(WV.message="stream reset",WV.code=Oge),a.signal.aborted&&(WV.message="stream aborted",WV.code=Nge)}if(WV.code===Oge)Dge.trace("%s stream %s reset",s,r);else{Dge.trace("%s stream %s error",s,r,WV);try{n({id:t,type:u.RESET})}catch(WV){Dge.trace("%s stream %s error sending reset",s,r,WV)}}return v.end(WV),void b(WV)}try{n({id:t,type:u.CLOSE})}catch(WV){Dge.trace("%s stream %s error sending close",s,r,WV)}b()},source:v,sourcePush:e=>{v.push(e)},sourceReadableLength(){return v.readableLength},stat:{direction:"initiator"===s?"outbound":"inbound",timeline:m},metadata:{},id:h};return E}var Mge=r(8558);const jge=gn("libp2p:mplex"),Vge=1024,zge=1024,Fge=4194304,$ge=5;function Kge(e){const t={...e,type:`${wge[e.type]} (${e.type})`};return e.type===mge.NEW_STREAM&&(t.data=C_(e.data instanceof Uint8Array?e.data:e.data.subarray())),e.type!==mge.MESSAGE_INITIATOR&&e.type!==mge.MESSAGE_RECEIVER||(t.data=C_(e.data instanceof Uint8Array?e.data:e.data.subarray(),"base16")),t}class qge{constructor(e,t){this.protocol="/mplex/6.7.0",t=t??{},this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._init=t,this.sink=this._createSink();const r=this._createSource();this._source=r,this.source=r,this.closeController=new AbortController,this.rateLimiter=new Mge.RateLimiterMemory({points:t.disconnectThreshold??$ge,duration:1})}init(e){}get streams(){const e=[];for(const t of this._streams.initiators.values())e.push(t);for(const t of this._streams.receivers.values())e.push(t);return e}newStream(e){if(this.closeController.signal.aborted)throw new Error("Muxer already closed");const t=this._streamId++;e=null==e?t.toString():e.toString();const r=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:r})}close(e){this.closeController.signal.aborted||(null!=e?this.streams.forEach((t=>t.abort(e))):this.streams.forEach((e=>e.close())),this.closeController.abort())}_newReceiverStream(e){const{id:t,name:r}=e,n=this._streams.receivers;return this._newStream({id:t,name:r,type:"receiver",registry:n})}_newStream(e){const{id:t,name:r,type:n,registry:i}=e;if(jge("new %s stream %s %s",n,t),"initiator"===n&&this._streams.initiators.size===(this._init.maxOutboundStreams??zge))throw mn(new Error("Too many outbound streams open"),"ERR_TOO_MANY_OUTBOUND_STREAMS");if(i.has(t))throw new Error(`${n} stream ${t} already exists!`);const s=e=>{jge.enabled&&jge.trace("%s stream %s send",n,t,Kge(e)),this._source.push(e)},o=()=>{jge("%s stream with id %s and protocol %s ended",n,t,a.stat.protocol),i.delete(t),null!=this._init.onStreamEnd&&this._init.onStreamEnd(a)},a=Uge({id:t,name:r,send:s,type:n,onEnd:o,maxMsgSize:this._init.maxMsgSize});return i.set(t,a),a}_createSink(){const e=async e=>{const t=[this.closeController.signal];null!=this._init.signal&&t.push(this._init.signal),e=J2(e,Iw(t));try{await QR(e,Rge,xge(this._init.maxMsgSize),(async e=>{for await(const t of e)await this._handleIncoming(t)})),this._source.end()}catch(WV){jge("error in sink",WV),this._source.end(WV)}};return e}_createSource(){const e=e=>{this.close(e)},t=BR({objectMode:!0,onEnd:e});return Object.assign(Age(t),{push:t.push,end:t.end,return:t.return})}async _handleIncoming(e){const{id:t,type:r}=e;if(jge.enabled&&jge.trace("incoming message",Kge(e)),e.type===mge.NEW_STREAM){if(this._streams.receivers.size===(this._init.maxInboundStreams??Vge)){jge("too many inbound streams open"),this._source.push({id:t,type:mge.RESET_RECEIVER});try{await this.rateLimiter.consume("new-stream",1)}catch{return jge("rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection"),void this._source.end(new Error("Too many open streams"))}return}const r=this._newReceiverStream({id:t,name:C_(e.data instanceof Uint8Array?e.data:e.data.subarray())});return void(null!=this._init.onIncomingStream&&this._init.onIncomingStream(r))}const n=1===(1&r)?this._streams.initiators:this._streams.receivers,i=n.get(t);if(null==i)return void jge("missing stream %s for message type %s",t,wge[r]);const s=this._init.maxStreamBufferSize??Fge;switch(r){case mge.MESSAGE_INITIATOR:case mge.MESSAGE_RECEIVER:if(i.sourceReadableLength()>s){this._source.push({id:e.id,type:r===mge.MESSAGE_INITIATOR?mge.RESET_RECEIVER:mge.RESET_INITIATOR});const t=mn(new Error("Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers"),"ERR_STREAM_INPUT_BUFFER_FULL");return void i.abort(t)}i.sourcePush(e.data);break;case mge.CLOSE_INITIATOR:case mge.CLOSE_RECEIVER:i.closeRead();break;case mge.RESET_INITIATOR:case mge.RESET_RECEIVER:i.reset();break;default:jge("unknown message type %s",r)}}}class Hge{constructor(e={}){this.protocol="/mplex/6.7.0",this.components=new S2,this._init=e}init(e){this.components=e}createStreamMuxer(e={}){return new qge(this.components,{...e,...this._init})}}var Gge=r(512),Wge=r(7664),Yge=r(3989),Jge=r(5501);const Qge={hashSHA256(e){return(0,Yge.vp)(e)},getHKDF(e,t){const r=new Gge.t(Yge.mE,t,e),n=r.expand(96),i=n,s=i.subarray(0,32),o=i.subarray(32,64),a=i.subarray(64,96);return[s,o,a]},generateX25519KeyPair(){const e=Wge.Au();return{publicKey:e.publicKey,privateKey:e.secretKey}},generateX25519KeyPairFromSeed(e){const t=Wge._w(e);return{publicKey:t.publicKey,privateKey:t.secretKey}},generateX25519SharedKey(e,t){return Wge.gi(e,t)},chaCha20Poly1305Encrypt(e,t,r,n){const i=new Jge.OK(n);return i.seal(t,e,r)},chaCha20Poly1305Decrypt(e,t,r,n){const i=new Jge.OK(n);return i.open(t,e,r)}};function Xge(e,t={}){const r=wre(e),n=o3.fromReader(r.reader,t),i={read:async e=>{const{value:t}=await r.reader.next(e);if(null==t)throw new Error("Value is null");return t},readLP:async()=>{const{value:e}=await n.next();if(null==e)throw new Error("Value is null");return e},readPB:async e=>{const t=await i.readLP();if(null==t)throw new Error("Value is null");const r=t instanceof Uint8Array?t:t.slice();return e.decode(r)},write:e=>{e instanceof Uint8Array?r.writer.push(e):r.writer.push(e.slice())},writeLP:e=>{i.write(t3.single(e,t))},writePB:(e,t)=>{i.writeLP(t.encode(e))},pb:e=>({read:async()=>await i.readPB(e),write:t=>i.writePB(t,e)}),unwrap:()=>(r.rest(),r.stream)};return i}function Zge(){const e=d3();let t=!1;return{sink:async r=>{if(t)throw new Error("already piped");t=!0,e.resolve(r)},source:async function*(){const t=await e.promise;yield*t}()}}function eme(){const e=Zge(),t=Zge();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}const tme=65535,rme=tme-16,nme=Boolean(globalThis.process?.env?.DUMP_SESSION_KEYS);function ime(e){return async function*(t){for await(const r of t)for(let t=0;t<r.length;t+=rme){let n=t+rme;n>r.length&&(n=r.length);const i=e.encrypt(r.subarray(t,n),e.session);yield i}}}function sme(e){return async function*(t){for await(const r of t)for(let t=0;t<r.length;t+=tme){let n=t+tme;n>r.length&&(n=r.length);const{plaintext:i,valid:s}=await e.decrypt(r.subarray(t,n),e.session);if(!s)throw new Error("Failed to validate decrypted chunk");yield i}}}const ome=e=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e),ame=e=>{const t=ome(2);return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint16(0,e,!1),t};ame.bytes=2;const cme=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};function lme(e){return(0,UT.concat)([e.ne,e.ciphertext],e.ne.length+e.ciphertext.length)}function ume(e){return(0,UT.concat)([e.ne,e.ns,e.ciphertext],e.ne.length+e.ns.length+e.ciphertext.length)}function hme(e){return(0,UT.concat)([e.ns,e.ciphertext],e.ns.length+e.ciphertext.length)}function dme(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:new Uint8Array(0)}}function fme(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}function pme(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}cme.bytes=2;class yme extends Error{constructor(e="Unexpected Peer"){super(e),this.code=yme.code}static get code(){return"ERR_UNEXPECTED_PEER"}}class gme extends Error{constructor(e="Invalid crypto exchange"){super(e),this.code=gme.code}static get code(){return"ERR_INVALID_CRYPTO_EXCHANGE"}}class mme extends Error{constructor(e="Invalid crypto transmission"){super(e),this.code=mme.code}static get code(){return"ERR_INVALID_CRYPTO_TRANSMISSION"}}var wme;(function(e){let t;(function(e){let t;e.codec=()=>(null==t&&(t=BT(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null==e.identityKey)throw new Error('Protocol error: required field "identityKey" was not found in object');if(t.uint32(10),t.bytes(e.identityKey),null==e.identitySig)throw new Error('Protocol error: required field "identitySig" was not found in object');if(t.uint32(18),t.bytes(e.identitySig),null==e.data)throw new Error('Protocol error: required field "data" was not found in object');t.uint32(26),t.bytes(e.data),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0),data:new Uint8Array(0)},n=null==t?e.len:e.pos+t;while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.identityKey=e.bytes();break;case 2:r.identitySig=e.bytes();break;case 3:r.data=e.bytes();break;default:e.skipType(7&t);break}}if(null==r.identityKey)throw new Error('Protocol error: value for required field "identityKey" was not found in protobuf');if(null==r.identitySig)throw new Error('Protocol error: value for required field "identitySig" was not found in protobuf');if(null==r.data)throw new Error('Protocol error: value for required field "data" was not found in protobuf');return r}))),t),e.encode=t=>xT(t,e.codec()),e.decode=t=>TT(t,e.codec())})(t=e.NoiseHandshakePayload||(e.NoiseHandshakePayload={}))})(wme||(wme={}));const bme=wme.NoiseHandshakePayload;async function vme(e,t,r){const n=await _me(e,Ime(t)),i=r??new Uint8Array(0);if(null==e.publicKey)throw new Error("PublicKey was missing from local PeerId");return Eme(e.publicKey,n,i)}function Eme(e,t,r){return bme.encode({identityKey:e,identitySig:t,data:r??new Uint8Array(0)}).subarray()}async function _me(e,t){if(null==e.privateKey)throw new Error("PrivateKey was missing from PeerId");const r=await fT(e.privateKey);return await r.sign(t)}async function Sme(e){return await c_(e.identityKey)}function Ame(e){return bme.decode(e)}function Ime(e){const t=Jl("noise-libp2p-static-key:");return(0,UT.concat)([t,e],t.length+e.length)}async function Cme(e,t,r){const n=await c_(t.identityKey);if(!n.equals(r))throw new Error("Peer ID doesn't match libp2p public key.");const i=Ime(e);if(null==n.publicKey)throw new Error("PublicKey was missing from PeerId");if(null==t.identitySig)throw new Error("Signature was missing from message");const s=hT(n.publicKey),o=await s.verify(i,t.identitySig);if(!o)throw new Error("Static key doesn't match to peer that signed payload!");return n}function kme(e){return e instanceof Uint8Array&&32===e.length}const Tme=gn("libp2p:noise");let Rme;function Pme(e){Rme(`LOCAL_STATIC_PUBLIC_KEY ${C_(e.publicKey,"hex")}`),Rme(`LOCAL_STATIC_PRIVATE_KEY ${C_(e.privateKey,"hex")}`)}function xme(e){e?(Rme(`LOCAL_PUBLIC_EPHEMERAL_KEY ${C_(e.publicKey,"hex")}`),Rme(`LOCAL_PRIVATE_EPHEMERAL_KEY ${C_(e.privateKey,"hex")}`)):Rme("Missing local ephemeral keys.")}function Dme(e){Rme(`REMOTE_STATIC_PUBLIC_KEY ${C_(e,"hex")}`)}function Ome(e){Rme(`REMOTE_EPHEMERAL_PUBLIC_KEY ${C_(e,"hex")}`)}function Nme(e){e.cs1&&e.cs2?(Rme(`CIPHER_STATE_1 ${e.cs1.n.getUint64()} ${C_(e.cs1.k,"hex")}`),Rme(`CIPHER_STATE_2 ${e.cs2.n.getUint64()} ${C_(e.cs2.k,"hex")}`)):Rme("Missing cipher state.")}Rme=nme?Tme:Object.assign((()=>{}),{enabled:!1,trace:()=>{},error:()=>{}});const Lme=0,Bme=4294967295,Ume="Cipherstate has reached maximum n, a new handshake must be performed";class Mme{constructor(e=Lme){this.n=e,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>Bme)throw new Error(Ume)}}class jme{constructor(e){this.crypto=e}encryptWithAd(e,t,r){const n=this.encrypt(e.k,e.n,t,r);return e.n.increment(),n}decryptWithAd(e,t,r){const{plaintext:n,valid:i}=this.decrypt(e.k,e.n,t,r);return i&&e.n.increment(),{plaintext:n,valid:i}}hasKey(e){return!this.isEmptyKey(e.k)}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(e){const t=this.createEmptyKey();return k_(t,e)}encrypt(e,t,r,n){return t.assertValue(),this.crypto.chaCha20Poly1305Encrypt(n,t.getBytes(),r,e)}encryptAndHash(e,t){let r;return r=this.hasKey(e.cs)?this.encryptWithAd(e.cs,e.h,t):t,this.mixHash(e,r),r}decrypt(e,t,r,n){t.assertValue();const i=this.crypto.chaCha20Poly1305Decrypt(n,t.getBytes(),r,e);return i?{plaintext:i,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(e,t){let r,n=!0;return this.hasKey(e.cs)?({plaintext:r,valid:n}=this.decryptWithAd(e.cs,e.h,t)):r=t,this.mixHash(e,t),{plaintext:r,valid:n}}dh(e,t){try{const r=this.crypto.generateX25519SharedKey(e,t);return 32===r.length?r:r.subarray(0,32)}catch(r){const e=r;return Tme(e.message),new Uint8Array(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){const r=this.crypto.hashSHA256((0,UT.concat)([e,t],e.length+t.length));return r}mixKey(e,t){const[r,n]=this.crypto.getHKDF(e.ck,t);e.cs=this.initializeKey(n),e.ck=r}initializeKey(e){return{k:e,n:new Mme}}initializeSymmetric(e){const t=Jl(e,"utf-8"),r=this.hashProtocolName(t),n=r,i=this.createEmptyKey(),s=this.initializeKey(i);return{cs:s,ck:n,h:r}}hashProtocolName(e){if(e.length<=32){const t=new Uint8Array(32);return t.set(e),t}return this.getHash(e,new Uint8Array(0))}split(e){const[t,r]=this.crypto.getHKDF(e.ck,new Uint8Array(0)),n=this.initializeKey(t),i=this.initializeKey(r);return{cs1:n,cs2:i}}writeMessageRegular(e,t){const r=this.encryptWithAd(e,new Uint8Array(0),t),n=this.createEmptyKey(),i=new Uint8Array(0);return{ne:n,ns:i,ciphertext:r}}readMessageRegular(e,t){return this.decryptWithAd(e,new Uint8Array(0),t.ciphertext)}}class Vme extends jme{initializeInitiator(e,t,r,n){const i="Noise_XX_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(i);this.mixHash(s,e);const o=new Uint8Array(32);return{ss:s,s:t,rs:r,psk:n,re:o}}initializeResponder(e,t,r,n){const i="Noise_XX_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(i);this.mixHash(s,e);const o=new Uint8Array(32);return{ss:s,s:t,rs:r,psk:n,re:o}}writeMessageA(e,t,r){const n=new Uint8Array(0);e.e=void 0!==r?r:this.crypto.generateX25519KeyPair();const i=e.e.publicKey;this.mixHash(e.ss,i);const s=this.encryptAndHash(e.ss,t);return{ne:i,ns:n,ciphertext:s}}writeMessageB(e,t){e.e=this.crypto.generateX25519KeyPair();const r=e.e.publicKey;this.mixHash(e.ss,r),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const n=e.s.publicKey,i=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));const s=this.encryptAndHash(e.ss,t);return{ne:r,ns:i,ciphertext:s}}writeMessageC(e,t){const r=e.s.publicKey,n=this.encryptAndHash(e.ss,r);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));const i=this.encryptAndHash(e.ss,t),s=this.createEmptyKey(),o={ne:s,ns:n,ciphertext:i},{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,messageBuffer:o,cs1:a,cs2:c}}readMessageA(e,t){return kme(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if(kme(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const{plaintext:r,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&kme(r)&&(e.rs=r),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:i,valid:s}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:i,valid:n&&s}}readMessageC(e,t){const{plaintext:r,valid:n}=this.decryptAndHash(e.ss,t.ns);if(n&&kme(r)&&(e.rs=r),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:i,valid:s}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:o,cs2:a}=this.split(e.ss);return{h:e.ss.h,plaintext:i,valid:n&&s,cs1:o,cs2:a}}initSession(e,t,r){const n=this.createEmptyKey(),i=new Uint8Array(32);let s;return s=e?this.initializeInitiator(t,r,i,n):this.initializeResponder(t,r,i,n),{hs:s,i:e,mc:0}}sendMessage(e,t,r){let n;if(0===e.mc)n=this.writeMessageA(e.hs,t,r);else if(1===e.mc)n=this.writeMessageB(e.hs,t);else if(2===e.mc){const{h:r,messageBuffer:i,cs1:s,cs2:o}=this.writeMessageC(e.hs,t);n=i,e.h=r,e.cs1=s,e.cs2=o}else{if(!(e.mc>2))throw new Error("Session invalid.");if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,t)}}return e.mc++,n}recvMessage(e,t){let r=new Uint8Array(0),n=!1;if(0===e.mc)({plaintext:r,valid:n}=this.readMessageA(e.hs,t));else if(1===e.mc)({plaintext:r,valid:n}=this.readMessageB(e.hs,t));else if(2===e.mc){const{h:i,plaintext:s,valid:o,cs1:a,cs2:c}=this.readMessageC(e.hs,t);r=s,n=o,e.h=i,e.cs1=a,e.cs2=c}return e.mc++,{plaintext:r,valid:n}}}class zme{constructor(e,t,r,n,i,s,o,a){this.isInitiator=e,this.payload=t,this.prologue=r,this.staticKeypair=i,this.connection=s,o&&(this.remotePeer=o),this.xx=a??new Vme(n),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair),this.remoteEarlyData=new Uint8Array(0)}async propose(){if(Pme(this.session.hs.s),this.isInitiator){Tme("Stage 0 - Initiator starting to send first message.");const e=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP(lme(e)),Tme("Stage 0 - Initiator finished sending first message."),xme(this.session.hs.e)}else{Tme("Stage 0 - Responder waiting to receive first message...");const e=dme((await this.connection.readLP()).subarray()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new gme("xx handshake stage 0 validation fail");Tme("Stage 0 - Responder received first message."),Ome(this.session.hs.re)}}async exchange(){if(this.isInitiator){Tme("Stage 1 - Initiator waiting to receive first message from responder...");const t=fme((await this.connection.readLP()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,t);if(!n)throw new gme("xx handshake stage 1 validation fail");Tme("Stage 1 - Initiator received the message."),Ome(this.session.hs.re),Dme(this.session.hs.rs),Tme("Initiator going to check remote's signature...");try{const e=Ame(r);this.remotePeer=this.remotePeer||await Sme(e),await Cme(this.session.hs.rs,e,this.remotePeer),this.setRemoteEarlyData(e.data)}catch(e){const t=e;throw new yme(`Error occurred while verifying signed payload: ${t.message}`)}Tme("All good with the signature!")}else{Tme("Stage 1 - Responder sending out first message with signed payload and static key.");const e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(ume(e)),Tme("Stage 1 - Responder sent the second handshake message with signed payload."),xme(this.session.hs.e)}}async finish(){if(this.isInitiator){Tme("Stage 2 - Initiator sending third handshake message.");const e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(hme(e)),Tme("Stage 2 - Initiator sent message with signed payload.")}else{Tme("Stage 2 - Responder waiting for third handshake message...");const t=pme((await this.connection.readLP()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,t);if(!n)throw new gme("xx handshake stage 2 validation fail");Tme("Stage 2 - Responder received the message, finished handshake.");try{const e=Ame(r);this.remotePeer=this.remotePeer||await Sme(e),await Cme(this.session.hs.rs,e,this.remotePeer),this.setRemoteEarlyData(e.data)}catch(e){const t=e;throw new yme(`Error occurred while verifying signed payload: ${t.message}`)}}Nme(this.session)}encrypt(e,t){const r=this.getCS(t);return this.xx.encryptWithAd(r,new Uint8Array(0),e)}decrypt(e,t){const r=this.getCS(t,!1);return this.xx.decryptWithAd(r,new Uint8Array(0),e)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new gme("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=e)}}class Fme{constructor(e,t,r=Qge,n){this.protocol="/noise",this.earlyData=t??new Uint8Array(0),this.crypto=r,this.staticKeys=e?this.crypto.generateX25519KeyPairFromSeed(e):this.crypto.generateX25519KeyPair(),this.prologue=n??new Uint8Array(0)}async secureOutbound(e,t,r){const n=Xge(t,{lengthEncoder:ame,lengthDecoder:cme,maxDataLength:tme}),i=await this.performHandshake({connection:n,isInitiator:!0,localPeer:e,remotePeer:r}),s=await this.createSecureConnection(n,i);return{conn:s,remoteEarlyData:i.remoteEarlyData,remotePeer:i.remotePeer}}async secureInbound(e,t,r){const n=Xge(t,{lengthEncoder:ame,lengthDecoder:cme,maxDataLength:tme}),i=await this.performHandshake({connection:n,isInitiator:!1,localPeer:e,remotePeer:r}),s=await this.createSecureConnection(n,i);return{conn:s,remoteEarlyData:i.remoteEarlyData,remotePeer:i.remotePeer}}async performHandshake(e){const t=await vme(e.localPeer,this.staticKeys.publicKey,this.earlyData);return await this.performXXHandshake(e,t)}async performXXHandshake(e,t){const{isInitiator:r,remotePeer:n,connection:i}=e,s=new zme(r,t,this.prologue,this.crypto,this.staticKeys,i,n);try{await s.propose(),await s.exchange(),await s.finish()}catch(o){if(o instanceof Error)throw o.message=`Error occurred during XX handshake: ${o.message}`,o}return s}async createSecureConnection(e,t){const[r,n]=eme(),i=e.unwrap();return await QR(r,ime(t),t3({lengthEncoder:ame}),i,o3({lengthDecoder:cme}),sme(t),r),n}}const $me=Wr.bind({ignoreUndefined:!0,concatArrays:!0});function Kme({options:e={},peerId:t,multiaddrs:r=[],repo:n,keychainConfig:i={},config:s={}}){const{datastore:o}=n,a=qme({options:e,config:s,datastore:o,keychainConfig:i,peerId:t,multiaddrs:r});return"function"===typeof e.libp2p?e.libp2p({libp2pOptions:a,options:e,config:s,datastore:o,peerId:t}):eue(a)}function qme({options:e,config:t,datastore:r,keychainConfig:n,peerId:i,multiaddrs:s}){const o=()=>{const e=VR(t,"Pubsub.Router")||"gossipsub",r=h3();if(!r[e])throw mn(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${e} router.`),"ERR_NOT_SUPPORTED");return r[e]},a={datastore:r,peerId:i},c={addresses:{listen:s.map((e=>e.toString())),announce:VR(e,"addresses.announce",VR(t,"Addresses.Announce",[])),noAnnounce:VR(e,"addresses.noAnnounce",VR(t,"Addresses.NoAnnounce",[]))},connectionManager:VR(e,"connectionManager",{maxConnections:VR(e,"config.Swarm.ConnMgr.HighWater",VR(t,"Swarm.ConnMgr.HighWater")),minConnections:VR(e,"config.Swarm.ConnMgr.LowWater",VR(t,"Swarm.ConnMgr.LowWater"))}),keychain:n,identify:{host:{agentVersion:`js-ipfs/${FK}`}},contentRouters:[],peerRouters:[],peerDiscovery:[],transports:[],streamMuxers:[new Hge({maxInboundStreams:256,maxOutboundStreams:1024})],connectionEncryption:[new Fme],relay:{enabled:VR(e,"relay.enabled",VR(t,"relay.enabled",!0)),hop:{enabled:VR(e,"relay.hop.enabled",VR(t,"relay.hop.enabled",!1)),active:VR(e,"relay.hop.active",VR(t,"relay.hop.active",!1))}},nat:{enabled:!VR(t,"Swarm.DisableNatPortMap",!1)}};VR(e,"config.Pubsub.Enabled",VR(t,"Pubsub.Enabled",!0))&&(c.pubsub=o()),"none"!==VR(t,"Routing.Type","dhtclient")&&(c.dht=new Kfe({clientMode:"dhtserver"!==VR(t,"Routing.Type","dht"),kBucketSize:VR(e,"dht.kBucketSize",20),validators:{ipns:wR},selectors:{ipns:zR}}));const l=VR(e,"config.Bootstrap",VR(t,"Bootstrap",[]));l.length>0&&c.peerDiscovery?.push(new Hfe({list:l}));let u=VR(e,"libp2p",void 0);"function"===typeof u&&(u=void 0);const h=$me(a,Cte(),c,u),d=VR(e,"config.Addresses.Delegates",VR(t,"Addresses.Delegates",[]));if(d.length>0){const e=d[Math.floor(Math.random()*d.length)],t=Pp(e).toOptions(),r={host:t.host,protocol:443===parseInt(t.port)?"https":"http",port:t.port},n=d8(r);h.contentRouters?.push(new E3(n)),h.peerRouters?.push(new g3(n))}return VR(e,"config.Discovery.MDNS.Enabled",VR(t,"Discovery.MDNS.Enabled",!0))||(h.peerDiscovery=h.peerDiscovery?.filter((e=>null!=e&&"@libp2p/mdns"!==e[Symbol.toStringTag]))),null==h.transports&&(h.transports=[]),null==h.transports.find((e=>"@libp2p/websockets"===e[Symbol.toStringTag]))&&h.transports.push(new yge),h}const Hme=Wr.bind({ignoreUndefined:!0}),Gme=gn("ipfs:components:peer:storage");class Wme{constructor(e,t,r,n,i){this.print=n,this.peerId=e,this.keychain=t,this.repo=r,this.print=n,this.isNew=i}static async start(e,t,r){const{repoAutoMigrate:n,repo:i,onMigrationProgress:s}=r,o="string"===typeof i||null==i?EX(e,t,{path:i,autoMigrate:n,onMigrationProgress:s}):i,{peerId:a,keychain:c,isNew:l}=await Yme(e,o,r);return new Wme(a,c,o,e,l)}}const Yme=async(e,t,r)=>{if(!t.closed)return{...await ewe(t,r),isNew:!1};try{return await t.open(),{...await ewe(t,r),isNew:!1}}catch(WV){if(WV.code!==sQ)throw WV;if(r.init&&!1===r.init.allowNew)throw new Fl("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await Jme(e,t,r),isNew:!0}}},Jme=async(e,t,r)=>{const n=r.init||{},i=await t.exists();if(Gme("repo exists?",i),!0===i)throw new Error("repo already exists");const s=n.privateKey?await Qme(n.privateKey):await Xme(e,n),o=Zme(s);Gme("peer identity: %s",o.PeerID);const a={...Hme(rwe(ax(),n.profiles),r.config),Identity:o};await t.init(a),await t.open(),Gme("repo opened");const c={pass:r.pass};try{c.dek=await t.config.get("Keychain.DEK")}catch(WV){if("ERR_NOT_FOUND"!==WV.code)throw WV}const l=await Kme({options:void 0,multiaddrs:void 0,peerId:s,repo:t,config:a,keychainConfig:c});return await t.datastore.has(new Ew("/info/self"))||await l.keychain.importPeer("self",s),await t.config.set("Keychain",{DEK:l.keychain.init.dek}),{peerId:s,keychain:l.keychain}},Qme=async e=>{if(Gme("using user-supplied private-key"),YE(e))return e;const t=Jl(e,"base64pad"),r=await fT(t);return await c_(r.public.bytes,r.bytes)},Xme=(e,{algorithm:t="Ed25519",bits:r=2048})=>{if(e("generating %s keypair...",t),"Ed25519"===t)return Ule();if("RSA"===t)return Mle({bits:r});throw mn(new Error("Unknown PeerId algorithm"),"ERR_UNKNOWN_PEER_ID_ALGORITHM")},Zme=e=>{if(null==e.privateKey)throw mn(new Error("Private key missing"),"ERR_MISSING_PRIVATE_KEY");return{PeerID:e.toString(),PrivKey:C_(e.privateKey,"base64pad")}},ewe=async(e,t)=>{const r=t.config,n=t.init&&t.init.profiles||[],i=t.pass,s=await e.config.getAll(),o=twe(rwe(s,n),r);if(s!==o&&await e.config.replace(o),!o.Identity||!o.Identity.PrivKey)throw new Bl("No private key was found in the config, please intialize the repo");const a=Jl(o.Identity.PrivKey,"base64pad"),c=await fT(a),l=await c_(c.public.bytes,c.bytes),u=await Kme({options:void 0,multiaddrs:void 0,peerId:l,repo:e,config:o,keychainConfig:{pass:i,...o.Keychain}});return{peerId:l,keychain:u.keychain}},twe=(e,t)=>t?Hme(e,t):e,rwe=(e,t)=>(t||[]).reduce(((e,t)=>{const r=ZK[t];if(!r)throw new Error(`Could not find profile with name '${t}'`);return Gme("applying profile %s",t),r.transform(e)}),e);var nwe=r(2838);function iwe(e){let t=new Uint8Array(e.reduce(((e,t)=>e+Of.encodingLength(t)),0)),r=0;for(const n of e)t=Of.encode(n,t,r),r+=Of.encodingLength(n);return t}var swe=iwe;class owe{constructor(e,t,r){this._refCounter=1,this.cid=e,this.priority=t||1,this.wantType=r}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){const e=this.cid.toString(Ti);return`WantlistEntry <key: ${e}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}}const awe=wn.Reader,cwe=wn.Writer,lwe=wn.util,uwe=wn.roots["ipfs-bitswap"]||(wn.roots["ipfs-bitswap"]={}),hwe=uwe.Message=(()=>{function e(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.wantlist=null,e.prototype.blocks=lwe.emptyArray,e.prototype.payload=lwe.emptyArray,e.prototype.blockPresences=lwe.emptyArray,e.prototype.pendingBytes=0,e.encode=function(e,t){if(t||(t=cwe.create()),null!=e.wantlist&&Object.hasOwnProperty.call(e,"wantlist")&&uwe.Message.Wantlist.encode(e.wantlist,t.uint32(10).fork()).ldelim(),null!=e.blocks&&e.blocks.length)for(var r=0;r<e.blocks.length;++r)t.uint32(18).bytes(e.blocks[r]);if(null!=e.payload&&e.payload.length)for(r=0;r<e.payload.length;++r)uwe.Message.Block.encode(e.payload[r],t.uint32(26).fork()).ldelim();if(null!=e.blockPresences&&e.blockPresences.length)for(r=0;r<e.blockPresences.length;++r)uwe.Message.BlockPresence.encode(e.blockPresences[r],t.uint32(34).fork()).ldelim();return null!=e.pendingBytes&&Object.hasOwnProperty.call(e,"pendingBytes")&&t.uint32(40).int32(e.pendingBytes),t},e.decode=function(e,t){e instanceof awe||(e=awe.create(e));var r=void 0===t?e.len:e.pos+t,n=new uwe.Message;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.wantlist=uwe.Message.Wantlist.decode(e,e.uint32());break;case 2:n.blocks&&n.blocks.length||(n.blocks=[]),n.blocks.push(e.bytes());break;case 3:n.payload&&n.payload.length||(n.payload=[]),n.payload.push(uwe.Message.Block.decode(e,e.uint32()));break;case 4:n.blockPresences&&n.blockPresences.length||(n.blockPresences=[]),n.blockPresences.push(uwe.Message.BlockPresence.decode(e,e.uint32()));break;case 5:n.pendingBytes=e.int32();break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof uwe.Message)return e;var t=new uwe.Message;if(null!=e.wantlist){if("object"!==typeof e.wantlist)throw TypeError(".Message.wantlist: object expected");t.wantlist=uwe.Message.Wantlist.fromObject(e.wantlist)}if(e.blocks){if(!Array.isArray(e.blocks))throw TypeError(".Message.blocks: array expected");t.blocks=[];for(var r=0;r<e.blocks.length;++r)"string"===typeof e.blocks[r]?lwe.base64.decode(e.blocks[r],t.blocks[r]=lwe.newBuffer(lwe.base64.length(e.blocks[r])),0):e.blocks[r].length>=0&&(t.blocks[r]=e.blocks[r])}if(e.payload){if(!Array.isArray(e.payload))throw TypeError(".Message.payload: array expected");t.payload=[];for(r=0;r<e.payload.length;++r){if("object"!==typeof e.payload[r])throw TypeError(".Message.payload: object expected");t.payload[r]=uwe.Message.Block.fromObject(e.payload[r])}}if(e.blockPresences){if(!Array.isArray(e.blockPresences))throw TypeError(".Message.blockPresences: array expected");t.blockPresences=[];for(r=0;r<e.blockPresences.length;++r){if("object"!==typeof e.blockPresences[r])throw TypeError(".Message.blockPresences: object expected");t.blockPresences[r]=uwe.Message.BlockPresence.fromObject(e.blockPresences[r])}}return null!=e.pendingBytes&&(t.pendingBytes=0|e.pendingBytes),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.blocks=[],r.payload=[],r.blockPresences=[]),t.defaults&&(r.wantlist=null,r.pendingBytes=0),null!=e.wantlist&&e.hasOwnProperty("wantlist")&&(r.wantlist=uwe.Message.Wantlist.toObject(e.wantlist,t)),e.blocks&&e.blocks.length){r.blocks=[];for(var n=0;n<e.blocks.length;++n)r.blocks[n]=t.bytes===String?lwe.base64.encode(e.blocks[n],0,e.blocks[n].length):t.bytes===Array?Array.prototype.slice.call(e.blocks[n]):e.blocks[n]}if(e.payload&&e.payload.length){r.payload=[];for(n=0;n<e.payload.length;++n)r.payload[n]=uwe.Message.Block.toObject(e.payload[n],t)}if(e.blockPresences&&e.blockPresences.length){r.blockPresences=[];for(n=0;n<e.blockPresences.length;++n)r.blockPresences[n]=uwe.Message.BlockPresence.toObject(e.blockPresences[n],t)}return null!=e.pendingBytes&&e.hasOwnProperty("pendingBytes")&&(r.pendingBytes=e.pendingBytes),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message"},e.Wantlist=function(){function e(e){if(this.entries=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.entries=lwe.emptyArray,e.prototype.full=!1,e.encode=function(e,t){if(t||(t=cwe.create()),null!=e.entries&&e.entries.length)for(var r=0;r<e.entries.length;++r)uwe.Message.Wantlist.Entry.encode(e.entries[r],t.uint32(10).fork()).ldelim();return null!=e.full&&Object.hasOwnProperty.call(e,"full")&&t.uint32(16).bool(e.full),t},e.decode=function(e,t){e instanceof awe||(e=awe.create(e));var r=void 0===t?e.len:e.pos+t,n=new uwe.Message.Wantlist;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.entries&&n.entries.length||(n.entries=[]),n.entries.push(uwe.Message.Wantlist.Entry.decode(e,e.uint32()));break;case 2:n.full=e.bool();break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof uwe.Message.Wantlist)return e;var t=new uwe.Message.Wantlist;if(e.entries){if(!Array.isArray(e.entries))throw TypeError(".Message.Wantlist.entries: array expected");t.entries=[];for(var r=0;r<e.entries.length;++r){if("object"!==typeof e.entries[r])throw TypeError(".Message.Wantlist.entries: object expected");t.entries[r]=uwe.Message.Wantlist.Entry.fromObject(e.entries[r])}}return null!=e.full&&(t.full=Boolean(e.full)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.entries=[]),t.defaults&&(r.full=!1),e.entries&&e.entries.length){r.entries=[];for(var n=0;n<e.entries.length;++n)r.entries[n]=uwe.Message.Wantlist.Entry.toObject(e.entries[n],t)}return null!=e.full&&e.hasOwnProperty("full")&&(r.full=e.full),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.Wantlist"},e.WantType=function(){const e={},t=Object.create(e);return t[e[0]="Block"]=0,t[e[1]="Have"]=1,t}(),e.Entry=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.block=lwe.newBuffer([]),e.prototype.priority=0,e.prototype.cancel=!1,e.prototype.wantType=0,e.prototype.sendDontHave=!1,e.encode=function(e,t){return t||(t=cwe.create()),null!=e.block&&Object.hasOwnProperty.call(e,"block")&&t.uint32(10).bytes(e.block),null!=e.priority&&Object.hasOwnProperty.call(e,"priority")&&t.uint32(16).int32(e.priority),null!=e.cancel&&Object.hasOwnProperty.call(e,"cancel")&&t.uint32(24).bool(e.cancel),null!=e.wantType&&Object.hasOwnProperty.call(e,"wantType")&&t.uint32(32).int32(e.wantType),null!=e.sendDontHave&&Object.hasOwnProperty.call(e,"sendDontHave")&&t.uint32(40).bool(e.sendDontHave),t},e.decode=function(e,t){e instanceof awe||(e=awe.create(e));var r=void 0===t?e.len:e.pos+t,n=new uwe.Message.Wantlist.Entry;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.block=e.bytes();break;case 2:n.priority=e.int32();break;case 3:n.cancel=e.bool();break;case 4:n.wantType=e.int32();break;case 5:n.sendDontHave=e.bool();break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof uwe.Message.Wantlist.Entry)return e;var t=new uwe.Message.Wantlist.Entry;switch(null!=e.block&&("string"===typeof e.block?lwe.base64.decode(e.block,t.block=lwe.newBuffer(lwe.base64.length(e.block)),0):e.block.length>=0&&(t.block=e.block)),null!=e.priority&&(t.priority=0|e.priority),null!=e.cancel&&(t.cancel=Boolean(e.cancel)),e.wantType){case"Block":case 0:t.wantType=0;break;case"Have":case 1:t.wantType=1;break}return null!=e.sendDontHave&&(t.sendDontHave=Boolean(e.sendDontHave)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.block="":(r.block=[],t.bytes!==Array&&(r.block=lwe.newBuffer(r.block))),r.priority=0,r.cancel=!1,r.wantType=t.enums===String?"Block":0,r.sendDontHave=!1),null!=e.block&&e.hasOwnProperty("block")&&(r.block=t.bytes===String?lwe.base64.encode(e.block,0,e.block.length):t.bytes===Array?Array.prototype.slice.call(e.block):e.block),null!=e.priority&&e.hasOwnProperty("priority")&&(r.priority=e.priority),null!=e.cancel&&e.hasOwnProperty("cancel")&&(r.cancel=e.cancel),null!=e.wantType&&e.hasOwnProperty("wantType")&&(r.wantType=t.enums===String?uwe.Message.Wantlist.WantType[e.wantType]:e.wantType),null!=e.sendDontHave&&e.hasOwnProperty("sendDontHave")&&(r.sendDontHave=e.sendDontHave),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.Wantlist.Entry"},e}(),e}(),e.Block=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.prefix=lwe.newBuffer([]),e.prototype.data=lwe.newBuffer([]),e.encode=function(e,t){return t||(t=cwe.create()),null!=e.prefix&&Object.hasOwnProperty.call(e,"prefix")&&t.uint32(10).bytes(e.prefix),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),t},e.decode=function(e,t){e instanceof awe||(e=awe.create(e));var r=void 0===t?e.len:e.pos+t,n=new uwe.Message.Block;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.prefix=e.bytes();break;case 2:n.data=e.bytes();break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof uwe.Message.Block)return e;var t=new uwe.Message.Block;return null!=e.prefix&&("string"===typeof e.prefix?lwe.base64.decode(e.prefix,t.prefix=lwe.newBuffer(lwe.base64.length(e.prefix)),0):e.prefix.length>=0&&(t.prefix=e.prefix)),null!=e.data&&("string"===typeof e.data?lwe.base64.decode(e.data,t.data=lwe.newBuffer(lwe.base64.length(e.data)),0):e.data.length>=0&&(t.data=e.data)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.prefix="":(r.prefix=[],t.bytes!==Array&&(r.prefix=lwe.newBuffer(r.prefix))),t.bytes===String?r.data="":(r.data=[],t.bytes!==Array&&(r.data=lwe.newBuffer(r.data)))),null!=e.prefix&&e.hasOwnProperty("prefix")&&(r.prefix=t.bytes===String?lwe.base64.encode(e.prefix,0,e.prefix.length):t.bytes===Array?Array.prototype.slice.call(e.prefix):e.prefix),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?lwe.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.Block"},e}(),e.BlockPresenceType=function(){const e={},t=Object.create(e);return t[e[0]="Have"]=0,t[e[1]="DontHave"]=1,t}(),e.BlockPresence=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.cid=lwe.newBuffer([]),e.prototype.type=0,e.encode=function(e,t){return t||(t=cwe.create()),null!=e.cid&&Object.hasOwnProperty.call(e,"cid")&&t.uint32(10).bytes(e.cid),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),t},e.decode=function(e,t){e instanceof awe||(e=awe.create(e));var r=void 0===t?e.len:e.pos+t,n=new uwe.Message.BlockPresence;while(e.pos<r){var i=e.uint32();switch(i>>>3){case 1:n.cid=e.bytes();break;case 2:n.type=e.int32();break;default:e.skipType(7&i);break}}return n},e.fromObject=function(e){if(e instanceof uwe.Message.BlockPresence)return e;var t=new uwe.Message.BlockPresence;switch(null!=e.cid&&("string"===typeof e.cid?lwe.base64.decode(e.cid,t.cid=lwe.newBuffer(lwe.base64.length(e.cid)),0):e.cid.length>=0&&(t.cid=e.cid)),e.type){case"Have":case 0:t.type=0;break;case"DontHave":case 1:t.type=1;break}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.cid="":(r.cid=[],t.bytes!==Array&&(r.cid=lwe.newBuffer(r.cid))),r.type=t.enums===String?"Have":0),null!=e.cid&&e.hasOwnProperty("cid")&&(r.cid=t.bytes===String?lwe.base64.encode(e.cid,0,e.cid.length):t.bytes===Array?Array.prototype.slice.call(e.cid):e.cid),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?uwe.Message.BlockPresenceType[e.type]:e.type),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,wn.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.BlockPresence"},e}(),e})(),dwe={Block:hwe.Wantlist.WantType.Block,Have:hwe.Wantlist.WantType.Have},fwe=(e,t)=>Array.prototype.slice.call(t,0).sort(((t,r)=>{const n=e(t),i=e(r);return n<i?-1:n>i?1:0}));class pwe{constructor(e,t){this.set=t?xne({system:"ipfs",component:"bitswap",metric:"wantlist",metrics:t.metrics}):new Map,this._stats=e}get length(){return this.set.size}add(e,t,r){const n=e.toString(Ti),i=this.set.get(n);i?(i.inc(),i.priority=t,i.wantType===dwe.Have&&r===dwe.Block&&(i.wantType=r)):(this.set.set(n,new owe(e,t,r)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){const t=e.toString(Ti),r=this.set.get(t);r&&(r.dec(),r.hasRefs()||(this.set.delete(t),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(fwe((e=>e[1].key),Array.from(this.set.entries())))}contains(e){const t=e.toString(Ti);return this.set.has(t)}get(e){const t=e.toString(Ti);return this.set.get(t)}}pwe.Entry=owe;const ywe=pwe.Entry;class gwe{constructor(e,t,r,n,i){this.entry=new ywe(e,t,r),this.cancel=Boolean(n),this.sendDontHave=Boolean(i)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){const e=this.cid.toString(Ti);return`BitswapMessageEntry ${e} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}}const mwe=(e,t)=>{const r=["bitswap"];return t&&r.push(t),e&&r.push(`${e.toString().slice(0,8)}`),Object.assign(Jr(r.join(":")),{error:Jr(r.concat(["error"]).join(":"))})},wwe=(e,t)=>{if(e.size!==t.size)return!1;for(const[r,n]of e){const e=t.get(r);if(void 0===e)return!1;if(n instanceof Uint8Array&&e instanceof Uint8Array&&!k_(n,e))return!1;if(n instanceof gwe&&e instanceof gwe&&!n.equals(e))return!1}return!0};class bwe{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return 0===this.blocks.size&&0===this.wantlist.size&&0===this.blockPresences.size}addEntry(e,t,r,n,i){null==r&&(r=bwe.WantType.Block);const s=e.toString(Ti),o=this.wantlist.get(s);o?(o.wantType===r&&(o.priority=t),n&&(o.cancel=Boolean(n)),i&&(o.sendDontHave=Boolean(i)),r===bwe.WantType.Block&&o.wantType===bwe.WantType.Have&&(o.wantType=r)):this.wantlist.set(s,new gwe(e,t,r,n,i))}addBlock(e,t){const r=e.toString(Ti);this.blocks.set(r,t)}addHave(e){const t=e.toString(Ti);this.blockPresences.has(t)||this.blockPresences.set(t,bwe.BlockPresenceType.Have)}addDontHave(e){const t=e.toString(Ti);this.blockPresences.has(t)||this.blockPresences.set(t,bwe.BlockPresenceType.DontHave)}cancel(e){const t=e.toString(Ti);this.wantlist.delete(t),this.addEntry(e,0,bwe.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){const e={wantlist:{entries:Array.from(this.wantlist.values()).map((e=>({block:e.cid.bytes,priority:Number(e.priority),cancel:Boolean(e.cancel)}))),full:!!this.full||void 0},blocks:Array.from(this.blocks.values())};return hwe.encode(e).finish()}serializeToBitswap110(){const e={wantlist:{entries:Array.from(this.wantlist.values()).map((e=>({block:e.cid.bytes,priority:Number(e.priority),wantType:e.wantType,cancel:Boolean(e.cancel),sendDontHave:Boolean(e.sendDontHave)}))),full:!!this.full||void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(const[t,r]of this.blocks.entries()){const n=ji.parse(t),i=n.version,s=n.code,o=n.multihash.code,a=n.multihash.digest.length,c=swe([i,s,o,a]);e.payload.push(new hwe.Block({prefix:c,data:r}))}for(const[t,r]of this.blockPresences)e.blockPresences.push(new hwe.BlockPresence({cid:ji.parse(t).bytes,type:r}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),hwe.encode(e).finish()}equals(e){return!!(this.full===e.full&&this.pendingBytes===e.pendingBytes&&wwe(this.wantlist,e.wantlist)&&wwe(this.blocks,e.blocks)&&wwe(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){const e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}}bwe.deserialize=async(e,t)=>{const r=hwe.decode(e),n=r.wantlist&&r.wantlist.full||!1,i=new bwe(n);return r.wantlist&&r.wantlist.entries&&r.wantlist.entries.forEach((e=>{if(!e.block)return;const t=ji.decode(e.block);i.addEntry(t,e.priority||0,e.wantType,Boolean(e.cancel),Boolean(e.sendDontHave))})),r.blockPresences&&r.blockPresences.forEach((e=>{if(!e.cid)return;const t=ji.decode(e.cid);e.type===bwe.BlockPresenceType.Have?i.addHave(t):i.addDontHave(t)})),r.blocks.length>0?(await Promise.all(r.blocks.map((async e=>{const t=await vl.digest(e),r=ji.createV0(t);i.addBlock(r,e)}))),i):r.payload.length>0?(await Promise.all(r.payload.map((async e=>{if(!e.prefix||!e.data)return;const r=nwe(e.prefix),n=r[0],s=r[1],o=r[2],a=o===vl.code?vl:t&&await t.getHasher(o);if(!a)throw mn(new Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");const c=await a.digest(e.data),l=ji.create(n,s,c);i.addBlock(l,e.data)}))),i.setPendingBytes(r.pendingBytes),i):i},bwe.blockPresenceSize=e=>e.bytes.length+1,bwe.Entry=gwe,bwe.WantType={Block:hwe.Wantlist.WantType.Block,Have:hwe.Wantlist.WantType.Have},bwe.BlockPresenceType={Have:hwe.BlockPresenceType.Have,DontHave:hwe.BlockPresenceType.DontHave};const vwe=3,Ewe=Math.pow(2,31)-1,_we=1e3,Swe=1;var Awe=Iwe;function Iwe(e,t,r){var n=null,i=null,s=function(){n&&(clearTimeout(n),i=null,n=null)},o=function(){var e=i;s(),e&&e()},a=function(){if(!t)return e.apply(this,arguments);var o=this,a=arguments,c=r&&!n;return s(),i=function(){e.apply(o,a)},n=setTimeout((function(){if(n=null,!c){var e=i;return i=null,e()}}),t),c?i():void 0};return a.cancel=s,a.flush=o,a}class Cwe{constructor(e,t,r){this.peerId=t,this.network=r,this.refcnt=1,this._entries=[],this._log=mwe(e,"msgqueue"),this.sendEntries=Awe(this._sendEntries.bind(this),Swe)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;const e=new bwe(!1);this._entries.forEach((t=>{t.cancel?e.cancel(t.cid):e.addEntry(t.cid,t.priority)})),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(WV){return void this._log.error("cant connect to peer %s: %s",this.peerId.toString(),WV.message)}this._log("sending message to peer %s",this.peerId.toString()),this.network.sendMessage(this.peerId,e).catch((e=>{this._log.error("send error: %s",e.message)}))}}class kwe{constructor(e,t,r,n){this.peers=xne({system:"ipfs",component:"bitswap",metric:"want-manager-peers",metrics:n.metrics}),this.wantlist=new pwe(r,n),this.network=t,this._stats=r,this._peerId=e,this._log=mwe(e,"want")}_addEntries(e,t,r){const n=e.map(((e,r)=>new bwe.Entry(e,Ewe-r,bwe.WantType.Block,t)));n.forEach((e=>{e.cancel?r?this.wantlist.removeForce(e.cid.toString(Ti)):this.wantlist.remove(e.cid):(this._log("adding to wl"),this.wantlist.add(e.cid,e.priority))}));for(const i of this.peers.values())i.addEntries(n)}_startPeerHandler(e){let t=this.peers.get(e.toString());if(t)return void t.refcnt++;t=new Cwe(this._peerId,e,this.network);const r=new bwe(!0);for(const n of this.wantlist.entries())r.addEntry(n[1].cid,n[1].priority);return t.addMessage(r),this.peers.set(e.toString(),t),t}_stopPeerHandler(e){const t=this.peers.get(e.toString());t&&(t.refcnt--,t.refcnt>0||this.peers.delete(e.toString()))}wantBlocks(e,t={}){this._addEntries(e,!1),t&&t.signal&&t.signal.addEventListener("abort",(()=>{this.cancelWants(e)}))}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach((e=>this.disconnected(e.peerId)))}}const Twe="/ipfs/bitswap/1.0.0",Rwe="/ipfs/bitswap/1.1.0",Pwe="/ipfs/bitswap/1.2.0",xwe=32,Dwe=128,Owe=3e4;class Nwe{constructor(e,t,r,n={}){this._log=mwe(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[Twe],n.b100Only||(this._protocols.unshift(Rwe),this._protocols.unshift(Pwe)),this._stats=r,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=n.hashLoader,this._maxInboundStreams=n.maxInboundStreams??xwe,this._maxOutboundStreams=n.maxOutboundStreams??Dwe,this._incomingStreamTimeout=n.incomingStreamTimeout??Owe}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection,{maxInboundStreams:this._maxInboundStreams,maxOutboundStreams:this._maxOutboundStreams});const e=n0({onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect});this._registrarIds=[];for(const t of this._protocols)this._registrarIds.push(await this._libp2p.registrar.register(t,e));this._libp2p.getConnections().forEach((e=>{this._onPeerConnect(e.remotePeer)}))}async stop(){if(this._running=!1,await this._libp2p.unhandle(this._protocols),null!=this._registrarIds){for(const e of this._registrarIds)this._libp2p.registrar.unregister(e);this._registrarIds=[]}}_onConnection({stream:e,connection:t}){if(!this._running)return;const r=new Ql.TimeoutController(this._incomingStreamTimeout);Promise.resolve().then((async()=>{this._log("incoming new bitswap %s connection from %p",e.stat.protocol,t.remotePeer),await QR(J2(e.source,r.signal),o3(),(async e=>{for await(const n of e){try{const e=await bwe.deserialize(n.subarray(),this._hashLoader);await this._bitswap._receiveMessage(t.remotePeer,e)}catch(WV){this._bitswap._receiveError(WV);break}r.reset()}}))})).catch((t=>{this._log(t),e.abort(t)})).finally((()=>{r.clear(),e.close()}))}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,t={}){return this._libp2p.contentRouting.findProviders(e,t)}async findAndConnect(e,t){const r=[];let n=0;for await(const i of this.findProviders(e,t))if(this._log(`connecting to provider ${i.id}`),r.push(this.connectTo(i.id,t).catch((e=>{this._log.error(e)}))),n++,n===vwe)break;await Promise.all(r)}async provide(e,t){await this._libp2p.contentRouting.provide(e,t)}async sendMessage(e,t){if(!this._running)throw new Error("network isn't running");const r=e.toString();this._log("sendMessage to %s",r,t);const n=await this._libp2p.dial(e),i=await n.newStream([Pwe,Rwe,Twe]);await Lwe(i,t,this._log),this._updateSentStats(e,t.blocks)}async connectTo(e,t){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,t)}_updateSentStats(e,t){const r=e.toString();if(this._stats){for(const e of t.values())this._stats.push(r,"dataSent",e.length);this._stats.push(r,"blocksSent",t.size)}}}async function Lwe(e,t,r){try{let r;switch(e.stat.protocol){case Twe:r=t.serializeToBitswap100();break;case Rwe:case Pwe:r=t.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+e.stat.protocol)}await QR([r],t3(),e)}catch(WV){r(WV)}finally{e.close()}}class Bwe{constructor(e){this.partner=e,this.wantlist=new pwe,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesRecv+=e}wants(e,t,r){this.wantlist.add(e,t,r)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}}class Uwe extends Map{constructor(e,t){super(),this._cmp=t||this._defaultSort,this._keys=[];for(const[r,n]of e||[])this.set(r,n)}update(e){if(e<0||e>=this._keys.length)return;const t=this._keys[e];this._keys.splice(e,1);const r=this._find(t);this._keys.splice(r,0,t)}set(e,t){if(this.has(e)){const t=this.indexOf(e);this._keys.splice(t,1)}super.set(e,t);const r=this._find(e);return this._keys.splice(r,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;const t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;const t=this._find(e);if(this._keys[t]===e)return t;for(let r=1;r<this._keys.length;r++){if(this._keys[t+r]===e)return t+r;if(this._keys[t-r]===e)return t-r}return-1}_find(e){let t=0,r=this._keys.length;while(t<r){const n=t+r>>>1,i=this._kCmp(this._keys[n],e);if(i<0)t=n+1;else{if(!(i>0))return n;r=n}}return t}*keys(){for(const e of this._keys)yield e}*values(){for(const e of this._keys)yield this.get(e)}*entries(){for(const e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,t){if(e)for(const r of this._keys)e.apply(t,[[r,this.get(r)]])}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}}const Mwe={hasNewInfo(){return!1},merge(){}};class jwe{constructor(e=Mwe){this._taskMerger=e,this._byPeer=new Uwe([],Vwe.compare)}pushTasks(e,t){let r=this._byPeer.get(e.toString());r||(r=new Vwe(e,this._taskMerger)),r.pushTasks(t),this._byPeer.set(e.toString(),r)}popTasks(e){const t=this._head();if(void 0===t)return{tasks:[],pendingSize:0};const{tasks:r,pendingSize:n}=t.popTasks(e);if(0===r.length)return{tasks:r,pendingSize:n};const i=t.peerId;return t.isIdle()?this._byPeer.delete(i.toString()):this._byPeer.update(0),{peerId:i,tasks:r,pendingSize:n}}_head(){if(0!==this._byPeer.size)for(const[,e]of this._byPeer)return e}remove(e,t){const r=this._byPeer.get(t.toString());r&&r.remove(e)}tasksDone(e,t){const r=this._byPeer.get(e.toString());if(!r)return;const n=this._byPeer.indexOf(e.toString());for(const i of t)r.taskDone(i);this._byPeer.update(n)}}class Vwe{constructor(e,t){this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new zwe,this._active=new Set}pushTasks(e){for(const t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;const t=this._pending.get(e.topic);if(t)return e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),void this._taskMerger.merge(e,t);this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){const t=[];for(const r of this._active)r.topic===e.topic&&t.push(r);return 0===t.length||this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0;const r=[],n=this._pending.tasks();for(let i=0;i<n.length&&t<e;i++){const e=n[i];r.push(e),t+=e.size,this._pending.delete(e.topic),this._activeTotalSize+=e.size,this._active.add(e)}return{tasks:r,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return 0===this._pending.length&&0===this._active.size}static compare(e,t){return 0===e[1]._pending.length?1:0===t[1]._pending.length?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}}class zwe{constructor(){this._tasks=new Uwe([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce(((e,t)=>e+t.task.size),0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map((e=>e.task))}updatePriority(e,t){const r=this._tasks.get(e);if(!r)return;const n=this._tasks.indexOf(e);r.task.priority=t,this._tasks.update(n)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}}const Fwe={hasNewInfo(e,t){let r=!1,n=!1;for(const i of t)i.data.haveBlock&&(r=!0),i.data.isWantBlock&&(n=!0);return!(n||!e.data.isWantBlock)||!(r||!e.data.haveBlock)},merge(e,t){const r=e.data,n=t.data;!n.haveBlock&&r.haveBlock&&(n.haveBlock=r.haveBlock,n.blockSize=r.blockSize),!n.isWantBlock&&r.isWantBlock&&(n.isWantBlock=!0,n.haveBlock&&!r.haveBlock||(n.haveBlock=r.haveBlock,t.size=e.size)),n.isWantBlock&&n.haveBlock&&(t.size=n.blockSize)}},$we=bwe.WantType,Kwe=16384,qwe=1024;class Hwe{constructor(e,t,r,n,i,s={}){this._log=mwe(e,"engine"),this.blockstore=t,this.network=r,this._stats=n,this._opts=this._processOpts(s),this.ledgerMap=xne({system:"ipfs",component:"bitswap",metric:"ledger-map",metrics:i.metrics}),this._running=!1,this._requestQueue=new jwe(Fwe)}_processOpts(e){return{maxSizeReplaceHasWithBlock:qwe,targetMessageSize:Kwe,...e}}_scheduleProcessTasks(){setTimeout((()=>{this._processTasks()}))}async _processTasks(){if(!this._running)return;const{peerId:e,tasks:t,pendingSize:r}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(0===t.length)return;const n=new bwe(!1);n.setPendingBytes(r);const i=[],s=new Map;for(const a of t){const e=ji.parse(a.topic);a.data.haveBlock?a.data.isWantBlock?(i.push(e),s.set(a.topic,a.data)):n.addHave(e):n.addDontHave(e)}const o=await this._getBlocks(i);for(const[a,c]of s){const e=ji.parse(a),t=o.get(a);t?n.addBlock(e,t):c.sendDontHave&&n.addDontHave(e)}if(n.empty)return e&&this._requestQueue.tasksDone(e,t),void this._scheduleProcessTasks();try{e&&await this.network.sendMessage(e,n);for(const[t,r]of o.entries())e&&this.messageSent(e,ji.parse(t),r)}catch(WV){this._log.error(WV)}e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks()}wantlistForPeer(e){const t=e.toString(),r=this.ledgerMap.get(t);return r?r.wantlist.sortedEntries():new Map}ledgerForPeer(e){const t=e.toString(),r=this.ledgerMap.get(t);return r?{peer:r.partner,value:r.debtRatio(),sent:r.accounting.bytesSent,recv:r.accounting.bytesRecv,exchanged:r.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map((e=>e.partner))}receivedBlocks(e){if(e.length){for(const t of this.ledgerMap.values())for(const r of e){const e=t.wantlistContains(r.cid);if(!e)continue;const n=r.data.length,i=this._sendAsBlock(e.wantType,n);let s=n;i||(s=bwe.blockPresenceSize(e.cid)),this._requestQueue.pushTasks(t.partner,[{topic:e.cid.toString(Ti),priority:e.priority,size:s,data:{blockSize:n,isWantBlock:i,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,t){const r=this._findOrCreate(e);if(t.empty)return;if(t.full&&(r.wantlist=new pwe),this._updateBlockAccounting(t.blocks,r),0===t.wantlist.size)return void this._scheduleProcessTasks();const n=[],i=[];t.wantlist.forEach((e=>{e.cancel?(r.cancelWant(e.cid),n.push(e.cid)):(r.wants(e.cid,e.priority,e.wantType),i.push(e))})),this._cancelWants(e,n),await this._addWants(e,i),this._scheduleProcessTasks()}_cancelWants(e,t){for(const r of t)this._requestQueue.remove(r.toString(Ti),e)}async _addWants(e,t){const r=await this._getBlockSizes(t.map((e=>e.cid))),n=[];for(const i of t){const t=i.cid.toString(Ti),s=r.get(t);if(null==s)i.sendDontHave&&n.push({topic:t,priority:i.priority,size:bwe.blockPresenceSize(i.cid),data:{isWantBlock:i.wantType===$we.Block,blockSize:0,haveBlock:!1,sendDontHave:i.sendDontHave}});else{const e=this._sendAsBlock(i.wantType,s);let r=s;e||(r=bwe.blockPresenceSize(i.cid)),n.push({topic:t,priority:i.priority,size:r,data:{isWantBlock:e,blockSize:s,haveBlock:!0,sendDontHave:i.sendDontHave}})}this._requestQueue.pushTasks(e,n)}}_sendAsBlock(e,t){return e===$we.Block||t<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){const t=await this._getBlocks(e);return new Map([...t].map((([e,t])=>[e,t.length])))}async _getBlocks(e){const t=new Map;return await Promise.all(e.map((async e=>{try{const r=await this.blockstore.get(e);t.set(e.toString(Ti),r)}catch(r){"ERR_NOT_FOUND"!==r.code&&this._log.error("failed to query blockstore for %s: %s",e,r)}}))),t}_updateBlockAccounting(e,t){for(const r of e.values())this._log("got block (%s bytes)",r.length),t.receivedBytes(r.length)}messageSent(e,t,r){const n=this._findOrCreate(e);n.sentBytes(r.length),n.wantlist.remove(t)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){this.ledgerMap.delete(e.toString())}_findOrCreate(e){const t=e.toString(),r=this.ledgerMap.get(t);if(r)return r;const n=new Bwe(e);return this.ledgerMap.set(t,n),this._stats&&this._stats.push(t,"peerCount",1),n}start(){this._running=!0}stop(){this._running=!1}}const Gwe=e=>`unwant:${C_(e.multihash.bytes,"base64")}`,Wwe=e=>`block:${C_(e.multihash.bytes,"base64")}`;class Ywe extends Ote.EventEmitter{constructor(e){super(),this.setMaxListeners(_we),this._log=mwe(e,"notif")}hasBlock(e,t){const r=Wwe(e);this._log(r),this.emit(r,t)}wantBlock(e,t={}){if(!e)throw new Error("Not a valid cid");const r=Wwe(e),n=Gwe(e);return this._log(`wantBlock:${e}`),new Promise(((i,s)=>{const o=()=>{this.removeListener(r,a),s(new Error(`Block for ${e} unwanted`))},a=e=>{this.removeListener(n,o),i(e)};this.once(n,o),this.once(r,a),t&&t.signal&&t.signal.addEventListener("abort",(()=>{this.removeListener(r,a),this.removeListener(n,o),s(new Error(`Want for ${e} aborted`))}))}))}unwantBlock(e){const t=Gwe(e);this._log(t),this.emit(t)}}var Jwe=r(3573);class Qwe extends Ote.EventEmitter{constructor(e,t){super(),this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach((e=>{this._stats[e]=BigInt(0),this._movingAverages[e]={},this._options.movingAverageIntervals.forEach((t=>{const r=this._movingAverages[e][t]=Jwe(t);r.push(this._frequencyLastTime,0)}))})),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){const e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;while(this._queue.length){const t=e=this._queue.shift();t&&this._applyOp(t)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){const t=e-this._frequencyLastTime;t&&Object.keys(this._stats).forEach((r=>{this._updateFrequencyFor(r,t,e)})),this._frequencyLastTime=e}_updateFrequencyFor(e,t,r){const n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;const i=n/t*1e3;let s=this._movingAverages[e];s||(s=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach((e=>{let t=s[e];t||(t=s[e]=Jwe(e)),t.push(r,i)}))}_applyOp(e){const t=e[0],r=e[1];if("number"!==typeof r)throw new Error(`invalid increment number: ${r}`);Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(r),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=r}}const Xwe={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[6e4,3e5,9e5]};class Zwe extends Ote.EventEmitter{constructor(e,t=[],r=Xwe){super();const n=Object.assign({},Xwe,r);if("number"!==typeof n.computeThrottleTimeout)throw new Error("need computeThrottleTimeout");if("number"!==typeof n.computeThrottleMaxQueueSize)throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=t,this._options=n,this._enabled=this._options.enabled,this._global=new Qwe(t,n),this._global.on("update",(e=>this.emit("update",e))),this._peers=xne({system:"ipfs",component:"bitswap",metric:"stats-peers",metrics:e.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(const e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){const t="string"!==typeof e&&e.toString?e.toString():`${e}`;return this._peers.get(t)}push(e,t,r){if(this._enabled&&(this._global.push(t,r),e)){let n=this._peers.get(e);n||(n=new Qwe(this._initialCounters,this._options),this._peers.set(e,n)),n.push(t,r)}}disconnected(e){const t=e.toString(),r=this._peers.get(t);r&&(r.stop(),this._peers.delete(t))}}const ebe={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},tbe=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"];class rbe extends pX{constructor(e,t,r={}){super(),this._libp2p=e,this._log=mwe(this.peerId),this._options=Object.assign({},ebe,r),this._stats=new Zwe(e,tbe,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new Nwe(e,this,this._stats,{hashLoader:r.hashLoader,maxInboundStreams:r.maxInboundStreams,maxOutboundStreams:r.maxOutboundStreams,incomingStreamTimeout:r.incomingStreamTimeout}),this.blockstore=t,this.engine=new Hwe(this.peerId,t,this.network,this._stats,e),this.wm=new kwe(this.peerId,this.network,this._stats,e),this.notifications=new Ywe(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,t){try{await this.engine.messageReceived(e,t)}catch(WV){this._log("failed to receive message",t)}if(0===t.blocks.size)return;const r=[];for(const[n,i]of t.blocks.entries()){const e=ji.parse(n);r.push({wasWanted:this.wm.wantlist.contains(e),cid:e,data:i})}this.wm.cancelWants(r.filter((({wasWanted:e})=>e)).map((({cid:e})=>e))),await Promise.all(r.map((({cid:t,wasWanted:r,data:n})=>this._handleReceivedBlock(e,t,n,r))))}async _handleReceivedBlock(e,t,r,n){this._log("received block");const i=await this.blockstore.has(t);this._updateReceiveCounters(e.toString(),t,r,i),n&&await this.put(t,r)}_updateReceiveCounters(e,t,r,n){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",r.length),n&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",r.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,t={}){const r=(e,t)=>(this.wm.wantBlocks([e],t),this.notifications.wantBlock(e,t));let n=!1;const i=async(e,t)=>{try{const r=await this.blockstore.get(e,t);return r}catch(WV){if("ERR_NOT_FOUND"!==WV.code)throw WV;return n||(n=!0,this.network.findAndConnect(e,t).catch((e=>this._log.error(e)))),r(e,t)}},s=new AbortController,o=t.signal?(0,Iw.anySignal)([t.signal,s.signal]):s.signal;try{const t=await Promise.race([this.notifications.wantBlock(e,{signal:o}),i(e,{signal:o})]);return t}finally{s.abort()}}async*getMany(e,t={}){for await(const r of e)yield this.get(r,t)}unwant(e){const t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach((e=>this.notifications.unwantBlock(e)))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,t,r){await this.blockstore.put(e,t),this._sendHaveBlockNotifications(e,t)}async*putMany(e,t){for await(const{key:r,value:n}of this.blockstore.putMany(e,t))this._sendHaveBlockNotifications(r,n),yield{key:r,value:n}}_sendHaveBlockNotifications(e,t){this.notifications.hasBlock(e,t),this.engine.receivedBlocks([{cid:e,data:t}]),this.network.provide(e).catch((e=>{this._log.error("Failed to provide: %s",e.message)}))}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this._stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}}const nbe=(e,t,r={})=>new rbe(e,t,r);function ibe(e){return e=e||new Error("Not Found"),mn(e,"ERR_NOT_FOUND")}function sbe(e){return e=e||new Error("Aborted"),mn(e,"ERR_ABORTED")}function obe(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var r=0,n=0,i=0,s=t.length;while(i!==s&&0===t[i])i++,r++;var o=(s-i)*u+1>>>0,l=new Uint8Array(o);while(i!==s){for(var h=t[i],d=0,f=o-1;(0!==h||d<n)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}var p=o-n;while(p!==o&&0===l[p])p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(l[p]);return y}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var n=0,i=0;while(e[t]===c)n++,t++;var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);while(e[t]){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){var f=s-i;while(f!==s&&0===o[f])f++;var p=new Uint8Array(n+(s-f)),y=n;while(f!==s)p[y++]=o[f++];return p}}}function f(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var abe=obe,cbe=abe,lbe=cbe;new Uint8Array(0);const ube=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class hbe{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class dbe{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return pbe(this,e)}}class fbe{constructor(e){this.decoders=e}or(e){return pbe(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const pbe=(e,t)=>new fbe({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class ybe{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new hbe(e,t,r),this.decoder=new dbe(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const gbe=({name:e,prefix:t,encode:r,decode:n})=>new ybe(e,t,r,n),mbe=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=lbe(r,t);return gbe({prefix:e,name:t,encode:n,decode:e=>ube(i(e))})},wbe=(e,t,r,n)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;while("="===e[s-1])--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError(`Non-${n} character`);c=c<<r|t,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},bbe=(e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>r)o-=r,s+=t[i&a>>o]}if(o&&(s+=t[i&a<<r-o]),n)while(s.length*r&7)s+="=";return s},vbe=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>gbe({prefix:t,name:e,encode(e){return bbe(e,n,r)},decode(t){return wbe(t,n,r,e)}});vbe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),vbe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),vbe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),vbe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),vbe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),vbe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),vbe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),vbe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),vbe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});Math.pow(2,31);Math.pow(2,7),Math.pow(2,14),Math.pow(2,21),Math.pow(2,28),Math.pow(2,35),Math.pow(2,42),Math.pow(2,49),Math.pow(2,56),Math.pow(2,63);mbe({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),mbe({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),new WeakMap;class Ebe{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==blockstore_core_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==blockstore_core_node_modules_multiformats_src_cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ebe.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return Ebe.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Ebe.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return blockstore_core_node_modules_multiformats_src_cid_format(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Ebe)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new Ebe(e,r,n,i||blockstore_core_node_modules_multiformats_src_cid_encodeCID(e,r,n.bytes))}if(!0===t[blockstore_core_node_modules_multiformats_src_cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,i=Digest.decode(r);return Ebe.create(e,n,i)}return null}static create(e,t,r){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==blockstore_core_node_modules_multiformats_src_cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${blockstore_core_node_modules_multiformats_src_cid_DAG_PB_CODE}) block encoding`);return new Ebe(e,t,r,r.bytes);case 1:{const n=blockstore_core_node_modules_multiformats_src_cid_encodeCID(e,t,r.bytes);return new Ebe(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Ebe.create(0,blockstore_core_node_modules_multiformats_src_cid_DAG_PB_CODE,e)}static createV1(e,t){return Ebe.create(1,e,t)}static decode(e){const[t,r]=Ebe.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Ebe.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),s=new Digest.Digest(t.multihashCode,t.digestSize,i,n),o=0===t.version?Ebe.createV0(s):Ebe.createV1(t.codec,s);return[o,e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),i=blockstore_core_node_modules_multiformats_src_cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const s=t,o=r(),a=r(),c=t+a,l=c-s;return{version:n,codec:i,multihashCode:o,digestSize:a,multihashSize:l,size:c}}static parse(e,t){const[r,n]=blockstore_core_node_modules_multiformats_src_cid_parseCIDtoBytes(e,t),i=Ebe.decode(n);return blockstore_core_node_modules_multiformats_src_cid_baseCache(i).set(r,e),i}}Symbol.for("@ipld/js-cid/CID");class _be extends pX{constructor(e,t){super(),this.child=e,this.bitswap=t}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(e,t,r={}){await this.has(e)||(this.bitswap.isStarted()?await this.bitswap.put(e,t,r):await this.child.put(e,t,r))}async*putMany(e,t={}){const r=PR(e,(async({key:e})=>!await this.has(e)));this.bitswap.isStarted()?yield*this.bitswap.putMany(r,t):yield*this.child.putMany(r,t)}async get(e,t={}){return!await this.has(e)&&this.bitswap.isStarted()?this.bitswap.get(e,t):this.child.get(e,t)}async*getMany(e,t={}){const r=LR({objectMode:!0}),n=LR({objectMode:!0});Promise.resolve().then((async()=>{for await(const t of e)!await this.has(t)&&this.bitswap.isStarted()?r.push(t):n.push(t);r.end(),n.end()})),yield*HR(this.bitswap.getMany(r,t),this.child.getMany(n,t))}async delete(e,t){await this.child.delete(e,t)}async*deleteMany(e,t){yield*this.child.deleteMany(e,t)}async has(e,t={}){return this.child.has(e,t)}async*query(e,t={}){yield*this.child.query(e,t)}async*queryKeys(e,t={}){yield*this.child.queryKeys(e,t)}}class Sbe{constructor(e,t,r,n,i){this.peerId=e,this.libp2p=t,this.bitswap=r,this.repo=n,this.blockstore=i}static async start({peerId:e,repo:t,print:r,hashers:n,options:i}){t.closed&&await t.open();const s=await t.config.getAll(),o=await Kme({options:i,repo:t,peerId:e,multiaddrs:Abe(e,s),config:s,keychainConfig:void 0});await o.start();for(const l of o.getMultiaddrs())r(`Swarm listening on ${l.toString()}`);const a=nbe(o,t.blocks,{statsEnabled:!0,hashLoader:n,maxInboundStreams:1024,maxOutboundStreams:1024});await a.start();const c=new _be(t.blocks,a);return t.blocks=c,t.pins.blockstore=c,new Sbe(e,o,a,t,c)}static async stop(e){e.repo.blocks=e.blockstore.unwrap(),e.repo.pins.blockstore=e.blockstore.unwrap(),await e.bitswap.stop(),await e.libp2p.stop()}}const Abe=(e,t)=>{const r=e.toString(),n=[],i=t.Addresses&&t.Addresses.Swarm||[];for(const s of i){let e=Pp(s);if(e.protoCodes().includes(Ibe))throw mn(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");const t=e.getPeerId();t&&t!==r&&(e=e.encapsulate(`/p2p/${r}`)),n.push(e)}return n},Ibe=479;function Cbe({network:e}){async function t(t={}){const r=[],{libp2p:n}=await e.use(t);return await n.peerStore.forEach((e=>{r.push({id:e.id,addrs:e.addresses.map((e=>e.multiaddr))})})),r}return xw(t)}function kbe({network:e}){async function t(t,r={}){const{libp2p:n}=await e.use(r);await n.dial(t,r)}return xw(t)}function Tbe({network:e}){async function t(t,r={}){const{libp2p:n}=await e.use(r);await n.hangUp(t)}return xw(t)}function Rbe({network:e}){async function t(t={}){const{libp2p:r}=await e.use(t);return r.getMultiaddrs()}return xw(t)}function Pbe({network:e}){async function t(t={}){const{libp2p:r}=await e.use(t);if(t.verbose){const e=[];for(const n of r.getConnections()){const r={addr:n.remoteAddr,peer:n.remotePeer};(t.verbose||t.direction)&&(r.direction=n.stat.direction),t.verbose&&(r.muxer=n.stat.multiplexer,r.latency="n/a",r.streams=[]),e.push(r)}return e}const n=new Map;for(const e of r.getConnections()){const t={addr:e.remoteAddr,peer:e.remotePeer};n.set(e.remotePeer.toString(),t)}return Array.from(n.values())}return xw(t)}class xbe{constructor({network:e}){this.addrs=Cbe({network:e}),this.connect=kbe({network:e}),this.disconnect=Tbe({network:e}),this.localAddrs=Rbe({network:e}),this.peers=Pbe({network:e})}}const Dbe={success:!0,time:0,text:""};function Obe({network:e}){async function*t(t,r={}){const{libp2p:n}=await e.use();r.count=r.count||10;const i=await n.peerStore.get(t);let s=i&&i.id;if(!s){yield{...Dbe,text:`Looking up peer ${t}`};const e=await n.peerRouting.findPeer(t);s=e&&e.id}if(!s)throw new Error("Peer was not found");yield{...Dbe,text:`PING ${s.toString()}`};let o=0,a=0;for(let e=0;e<r.count;e++)try{const e=await n.ping(s);a+=e,o++,yield{...Dbe,time:e}}catch(WV){yield{...Dbe,success:!1,text:WV.toString()}}if(o){const e=a/o;yield{...Dbe,text:`Average latency: ${e}ms`}}}return xw(t)}const Nbe="/ipns/";function Lbe(e){let t;if(e.startsWith(Nbe)&&(e=e.substring(Nbe.length)),"1"!==e[0]&&"Q"!==e[0]||(e=`z${e}`),"z"===e[0]&&(t=Ti.decode(e)),"k"===e[0]&&(t=hl.decode(e)),!t)throw new Error("Could not parse string");if(1!==t[0]&&114!==t[1]&&(t=(0,UT.concat)([[1,114],t])),40!==t.length)throw new Error("Incorrect length "+t.length);return(0,UT.concat)([Jl(Nbe),t.subarray(2)])}function Bbe({network:e,repo:t,peerId:r}){const{get:n,put:i,findProvs:s,findPeer:o,provide:a,query:c}={async*get(t,n={}){const{libp2p:i}=await Ube(e,r,n),s=t instanceof Uint8Array?t:Lbe(t);if(null==i.dht)throw mn(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*i.dht.get(s,n)},async*put(t,n,i){const{libp2p:s}=await Ube(e,r,i),o=t instanceof Uint8Array?t:Lbe(t);if(null==s.dht)throw mn(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*s.dht.put(o,n,i)},async*findProvs(t,n={}){const{libp2p:i}=await Ube(e,r,n);if(null==i.dht)throw mn(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*i.dht.findProviders(t,{signal:n.signal})},async*findPeer(t,n={}){const{libp2p:i}=await Ube(e,r,n);if(null==i.dht)throw mn(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*i.dht.findPeer(t,{signal:n.signal})},async*provide(n,i={recursive:!1}){const{libp2p:s}=await Ube(e,r,i),o=await t.blocks.has(n);if(!o)throw mn(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(i.recursive)throw mn(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");if(null==s.dht)throw mn(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*s.dht.provide(n)},async*query(t,n={}){const{libp2p:i}=await Ube(e,r,n);let s;const o=ji.asCID(t);if(s=null!=o?o.multihash.bytes:s_(t.toString()).toBytes(),null==i.dht)throw mn(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*i.dht.getClosestPeers(s,n)}};return{get:xw(n),put:xw(i),findProvs:xw(s),findPeer:xw(o),provide:xw(a),query:xw(c)}}const Ube=async(e,t,r)=>{const n=await e.use(r);if(null!=n.libp2p.dht)return n;{const e=async function*(){yield{from:t,name:"QUERY_ERROR",type:3,error:new Fl("dht not enabled")}};return{libp2p:{dht:{get:e,put:e,findProviders:e,findPeer:e,provide:e,getClosestPeers:e}}}}};function Mbe({network:e,config:t}){const r=VR(t||{},"Pubsub.Enabled",!0),n={};let i;return{subscribe:r?xw(s):jbe,unsubscribe:r?xw(o):jbe,publish:r?xw(a):jbe,ls:r?xw(c):jbe,peers:r?xw(l):jbe};async function s(t,r,s={}){const{libp2p:o}=await e.use(s);o.pubsub.subscribe(t),null==i&&(i=e=>{const t=e.detail;n[t.topic]&&n[t.topic].forEach((e=>{"function"!==typeof e?null!=e&&null!=e.handleEvent&&e.handleEvent(t):e(t)}))},o.pubsub.addEventListener("message",i)),null!=r&&(null==n[t]&&(n[t]=[]),n[t].push(r))}async function o(t,r,s={}){const{libp2p:o}=await e.use(s);null!=r&&null!=n[t]&&(n[t]=n[t].filter((e=>e!==r)),0===n[t].length&&delete n[t]),"function"!==typeof r&&delete n[t],null==n[t]&&o.pubsub.unsubscribe(t),0===Object.keys(n).length&&(o.pubsub.removeEventListener("message",i),i=void 0)}async function a(t,r,n={}){const{libp2p:i}=await e.use(n);if(!r)throw mn(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await i.pubsub.publish(t,r)}async function c(t={}){const{libp2p:r}=await e.use(t);return r.pubsub.getTopics()}async function l(t,r={}){const{libp2p:n}=await e.use(r);return n.pubsub.getSubscribers(t)}}const jbe=async()=>{throw new Fl("pubsub not enabled")},Vbe=Wr.bind({ignoreUndefined:!0}),zbe=gn("ipfs"),Fbe=3e4;class $be{constructor({print:e,storage:t,codecs:r,options:n}){const{peerId:i,repo:s,keychain:o}=t,a=Kw.create(Sbe),c=uH(n.preload),l=Kb(),u=qb({network:a}),h=new kP(n),d=Object.values(Ol);(n.ipld&&n.ipld.hashers?n.ipld.hashers:[]).forEach((e=>d.push(e))),this.hashers=new k3({hashers:d,loadHasher:n.ipld&&n.ipld.loadHasher});const f=Object.values(Dl);(n.ipld&&n.ipld.bases?n.ipld.bases:[]).forEach((e=>f.push(e))),this.bases=new S3({bases:f,loadBase:n.ipld&&n.ipld.loadBase});const p=new E_({repo:s,codecs:r}),y=new wx({codecs:r,hashers:this.hashers,preload:c,repo:s}),g=new zP({dns:l,ipns:h,repo:s,codecs:r,peerId:i,isOnline:u,keychain:o,options:n}),m=l_({repo:s,codecs:r,bases:this.bases,name:g}),w=new Zq({repo:s,codecs:r,hashers:this.hashers,preload:c}),b=Object.assign(KP({repo:s,codecs:r,resolve:m,preload:c}),{local:QP({repo:t.repo})}),{add:v,addAll:E,cat:_,get:S,ls:A}=new zK({preload:c,repo:s,options:n.EXPERIMENTAL,hashers:this.hashers}),I=BW({repo:s,preload:c,hashers:this.hashers,options:n}),C=dH({files:I,preload:c,options:n.preload});this.preload=c,this.name=g,this.ipns=h,this.pin=p,this.resolve=m,this.block=y,this.refs=b,this.start=qw({network:a,peerId:i,repo:s,preload:c,ipns:h,mfsPreload:C,print:e,keychain:o,hashers:this.hashers,options:n}),this.stop=Hw({network:a,preload:c,mfsPreload:C,ipns:h,repo:s}),this.dht=Bbe({network:a,repo:s,peerId:i}),this.pubsub=Mbe({network:a,config:n.config}),this.dns=l,this.isOnline=u,this.id=GK({network:a,peerId:i}),this.version=qK({repo:s}),this.bitswap=new rx({network:a}),this.bootstrap=new ux({repo:s}),this.config=tq({repo:s}),this.ping=Obe({network:a}),this.add=v,this.addAll=E,this.cat=_,this.get=S,this.ls=A,this.dag=w,this.files=I,this.key=new HW({keychain:o}),this.object=new sY({preload:c,codecs:r,repo:s}),this.repo=new hY({repo:s,hashers:this.hashers}),this.stats=new pY({repo:s,network:a}),this.swarm=new xbe({network:a}),Object.defineProperty(this,"libp2p",{get(){const e=a.try();return e?e.libp2p:void 0}});const k=()=>Promise.reject(mn(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),T=async function*(){throw mn(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=k,this.diag={cmds:k,net:k,sys:k},this.log={level:k,ls:k,tail:T},this.mount=k,this.codecs=r}async init(){throw new Ml}}const Kbe=async e=>{const t=ks({Data:new xn({type:"directory"}).marshal(),Links:[]}),r=await e.block.put(t,{mhtype:"sha2-256",format:"dag-pb"});return await e.pin.add(r),r},qbe=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!Yr.isTest,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}});async function Hbe(e={}){e=Vbe(qbe(),e);const t=e.init||{},r={name:il.name,code:il.code,encode:e=>e,decode:e=>e},n=Object.values(Nl);[s,o,c,l,r].concat(e.ipld&&e.ipld.codecs||[]).forEach((e=>n.push(e)));const i=new I3({codecs:n,loadCodec:e.ipld&&e.ipld.loadCodec}),a=e.silent?zbe:console.log;zbe("creating repo");const u=await Wme.start(a,i,e);zbe("getting repo config");const h=await u.repo.config.getAll(),d=new $be({storage:u,print:a,codecs:i,options:{...e,config:h}});if(zbe("starting preload"),await d.preload.start(),zbe("starting storage"),d.ipns.startOffline(u),u.isNew&&!t.emptyRepo){const e=await Kbe(d);if(zbe("adding default assets"),await Ll({addAll:d.addAll,print:a}),zbe("initializing IPNS keyspace"),null==u.peerId.publicKey)throw mn(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");const t=new Ql.TimeoutController(Fbe);try{await d.ipns.initializeKeyspace(u.peerId,Jl(`/ipfs/${e}`),{signal:t.signal})}finally{t.clear()}}return!1!==e.start&&(zbe("starting node"),await d.start()),d}var Gbe=r(2596);const Wbe=Hbe,Ybe=Gbe,Jbe=h8},3160:function(e,t,r){"use strict";r.d(t,{E:function(){return i}});var n=r(6867);function i(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?(0,n.P)(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}},605:function(e,t,r){"use strict";r.r(t),r.d(t,{concat:function(){return s}});var n=r(3160),i=r(6867);function s(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const r=(0,n.E)(t);let s=0;for(const n of e)r.set(n,s),s+=n.length;return(0,i.P)(r)}},6867:function(e,t,r){"use strict";function n(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}r.d(t,{P:function(){return n}})}}]);
//# sourceMappingURL=chunk-vendors.7ea90d9f.js.map